import{_ as L}from"./nuxt-link-C2FRAMUz.js";import{e as N,al as z,p as P,r as u,g as j,c as n,a as e,h as i,b as c,w as m,t as o,A as E,d as r,k as T,v as B,o as l}from"#entry";import{_ as I}from"./_plugin-vue_export-helper-DlAUqK2U.js";const V={class:"mb-6 flex items-center gap-2 text-sm text-[#5D4A44]/60"},R={key:0,class:"flex items-center justify-center py-20"},$={key:1,class:"bg-red-50 border border-red-200 rounded-xl p-6"},M={class:"text-red-600 text-sm"},G={key:2,class:"space-y-6"},q={class:"bg-white rounded-xl shadow-sm p-6 border border-[#EAD5D3]/40"},H={class:"flex items-start justify-between mb-4"},U={class:"text-3xl font-['Lora'] text-[#5D4A44] mb-2"},O={class:"text-[#5D4A44]/70"},J={class:"grid grid-cols-1 lg:grid-cols-3 gap-6"},K={class:"lg:col-span-2 space-y-6"},Q={class:"bg-white rounded-xl shadow-sm p-6 border border-[#EAD5D3]/40"},W={class:"grid grid-cols-2 gap-4 text-[#5D4A44]"},X={class:"font-medium"},Y={class:"font-medium"},Z={class:"inline-flex items-center gap-1 px-3 py-1 bg-[#F9F7F3] rounded-full text-sm"},ee={class:"font-medium"},te={class:"font-medium"},se={class:"bg-gradient-to-br from-[#D8AFA0]/10 to-[#EAD5D3]/20 rounded-xl shadow-sm p-6 border border-[#EAD5D3]/40"},ae={class:"space-y-3"},oe={class:"flex justify-between items-center"},ne={class:"text-xl font-bold text-[#5D4A44]"},re={class:"border-t border-[#EAD5D3]/40 pt-3 space-y-2"},le={class:"flex justify-between items-center"},ie={class:"text-lg font-semibold text-green-700"},de={class:"flex justify-between items-center"},ue={class:"text-lg font-medium text-[#5D4A44]/80"},ce={class:"border-t border-[#EAD5D3]/40 pt-3"},me={class:"flex justify-between items-center"},pe={class:"bg-white rounded-xl shadow-sm p-6 border border-[#EAD5D3]/40"},xe={class:"flex items-center justify-between mb-4"},be={key:0,class:"text-sm text-green-600 flex items-center gap-1"},fe={class:"space-y-6"},ve={class:"bg-white rounded-xl shadow-sm p-6 border border-[#EAD5D3]/40"},ge={class:"space-y-3"},De={class:"bg-[#F9F7F3] rounded-xl p-6 border border-[#EAD5D3]/40"},Ae={class:"space-y-2 text-xs text-[#5D4A44]/70"},ye={key:0},_e=N({__name:"[id]",setup(we){const f=z(),v=P(),s=u(null),_=u(!0),g=u(null),p=u(""),x=u(!1);j(async()=>{try{const{data:a,error:t}=await v.from("citas").select(`
        *,
        pacientes:paciente_id (
          id,
          nombre_completo,
          email
        )
      `).eq("id",f.params.id).single();if(t)throw t;s.value=a,p.value=a?.notas_terapeuta||""}catch(a){console.error("Error al cargar sesiÃ³n:",a),g.value=a.message||"No se pudo cargar la sesiÃ³n"}finally{_.value=!1}});const D=a=>a?new Date(a).toLocaleDateString("es-ES",{weekday:"long",year:"numeric",month:"long",day:"numeric"}):"Fecha no disponible",w=a=>a?new Date(a).toLocaleTimeString("es-ES",{hour:"2-digit",minute:"2-digit"}):"--:--",A=a=>new Intl.NumberFormat("es-ES",{style:"currency",currency:"EUR"}).format(a),C=a=>({pendiente:"bg-yellow-100 text-yellow-700",confirmada:"bg-blue-100 text-blue-700",realizada:"bg-green-100 text-green-700",cancelada:"bg-red-100 text-red-700"})[a]||"bg-gray-100 text-gray-700",k=a=>({pendiente:"â³ Pendiente",confirmada:"âœ“ Confirmada",realizada:"âœ“ Realizada",cancelada:"âœ• Cancelada"})[a]||a;let h;const S=()=>{clearTimeout(h),h=setTimeout(()=>{F()},2e3)},F=async()=>{if(s.value){x.value=!0;try{const{error:a}=await v.from("citas").update({notas_terapeuta:p.value}).eq("id",f.params.id);if(a)throw a;setTimeout(()=>{x.value=!1},500)}catch(a){console.error("Error al guardar notas:",a),alert("No se pudieron guardar las notas. Intenta nuevamente."),x.value=!1}}},y=async a=>{if(confirm(`Â¿Confirmas cambiar el estado a "${a}"?`))try{const{error:t}=await v.from("citas").update({estado:a}).eq("id",f.params.id);if(t)throw t;s.value.estado=a}catch(t){console.error("Error al cambiar estado:",t),alert("Error al actualizar la cita: "+(t.message||"Intenta nuevamente."))}};return(a,t)=>{const d=L;return l(),n("div",null,[e("nav",V,[c(d,{to:"/terapeuta/dashboard",class:"hover:text-[#D8AFA0] transition-colors"},{default:m(()=>[...t[4]||(t[4]=[r(" Dashboard ",-1)])]),_:1}),t[6]||(t[6]=e("span",null,"/",-1)),c(d,{to:"/terapeuta/sesiones",class:"hover:text-[#D8AFA0] transition-colors"},{default:m(()=>[...t[5]||(t[5]=[r(" Sesiones ",-1)])]),_:1}),t[7]||(t[7]=e("span",null,"/",-1)),t[8]||(t[8]=e("span",{class:"text-[#5D4A44]"},"Detalle",-1))]),_.value?(l(),n("div",R,[...t[9]||(t[9]=[e("div",{class:"text-center"},[e("div",{class:"inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-[#D8AFA0]"}),e("p",{class:"mt-4 text-[#5D4A44]/60"},"Cargando sesiÃ³n...")],-1)])])):g.value?(l(),n("div",$,[t[11]||(t[11]=e("h3",{class:"text-red-800 font-['Lora'] text-lg mb-2"},"Error al cargar la sesiÃ³n",-1)),e("p",M,o(g.value),1),c(d,{to:"/terapeuta/sesiones",class:"mt-4 inline-block text-red-700 hover:text-red-900 text-sm font-medium"},{default:m(()=>[...t[10]||(t[10]=[r(" â† Volver a sesiones ",-1)])]),_:1})])):s.value?(l(),n("div",G,[e("div",q,[e("div",H,[e("div",null,[e("h1",U," SesiÃ³n #"+o(s.value.id.slice(0,8)),1),e("p",O,o(D(s.value.fecha))+" a las "+o(w(s.value.fecha)),1)]),e("span",{class:E(["px-4 py-2 rounded-full text-sm font-medium",C(s.value.estado)])},o(k(s.value.estado)),3)])]),e("div",J,[e("div",K,[e("div",Q,[t[19]||(t[19]=e("h2",{class:"font-['Lora'] text-xl text-[#5D4A44] mb-4 flex items-center gap-2"},[e("span",{class:"text-2xl"},"ðŸ“‹"),r(" Detalles de la SesiÃ³n ")],-1)),e("div",W,[e("div",null,[t[13]||(t[13]=e("p",{class:"text-sm text-[#5D4A44]/60 mb-1"},"Paciente",-1)),c(d,{to:`/terapeuta/pacientes/${s.value.paciente_id}`,class:"font-medium hover:text-[#D8AFA0] transition-colors flex items-center gap-1"},{default:m(()=>[r(o(s.value.pacientes?.nombre||"Sin nombre")+" ",1),t[12]||(t[12]=e("span",{class:"text-xs"},"â†’",-1))]),_:1},8,["to"])]),e("div",null,[t[14]||(t[14]=e("p",{class:"text-sm text-[#5D4A44]/60 mb-1"},"Fecha",-1)),e("p",X,o(D(s.value.fecha)),1)]),e("div",null,[t[15]||(t[15]=e("p",{class:"text-sm text-[#5D4A44]/60 mb-1"},"Hora",-1)),e("p",Y,o(w(s.value.fecha)),1)]),e("div",null,[t[16]||(t[16]=e("p",{class:"text-sm text-[#5D4A44]/60 mb-1"},"Modalidad",-1)),e("span",Z,[e("span",null,o(s.value.modalidad==="online"?"ðŸ’»":"ðŸ¥"),1),e("span",null,o(s.value.modalidad==="online"?"Online":"Presencial"),1)])]),e("div",null,[t[17]||(t[17]=e("p",{class:"text-sm text-[#5D4A44]/60 mb-1"},"DuraciÃ³n",-1)),e("p",ee,o(s.value.duracion||50)+" minutos",1)]),e("div",null,[t[18]||(t[18]=e("p",{class:"text-sm text-[#5D4A44]/60 mb-1"},"Bono vinculado",-1)),e("p",te,o(s.value.bono_id?"SÃ­":"SesiÃ³n individual"),1)])])]),e("div",se,[t[24]||(t[24]=e("h3",{class:"text-lg font-['Lora'] text-[#5D4A44] mb-4 flex items-center gap-2"},[e("span",{class:"text-2xl"},"ðŸ’°"),r(" Resumen Financiero ")],-1)),e("div",ae,[e("div",oe,[t[20]||(t[20]=e("span",{class:"text-[#5D4A44]/70"},"Precio total de la sesiÃ³n",-1)),e("span",ne,o(A(s.value.precio_total||50)),1)]),e("div",re,[e("div",le,[t[21]||(t[21]=e("span",{class:"text-[#5D4A44]/70"},"Terapeuta (70%)",-1)),e("span",ie,o(A((s.value.precio_total||50)*.7)),1)]),e("div",de,[t[22]||(t[22]=e("span",{class:"text-[#5D4A44]/70"},"Consulta (30%)",-1)),e("span",ue,o(A((s.value.precio_total||50)*.3)),1)])]),e("div",ce,[e("div",me,[t[23]||(t[23]=e("span",{class:"text-[#5D4A44]/70"},"Estado del pago",-1)),e("span",{class:E(["px-3 py-1 rounded-full text-sm font-medium",s.value.pagado?"bg-green-100 text-green-700":"bg-orange-100 text-orange-700"])},o(s.value.pagado?"âœ“ Pagado":"â³ Pendiente"),3)])])])]),e("div",pe,[e("div",xe,[t[26]||(t[26]=e("h3",{class:"text-lg font-['Lora'] text-[#5D4A44] flex items-center gap-2"},[e("span",{class:"text-2xl"},"ðŸ“"),r(" Notas Privadas del Terapeuta ")],-1)),x.value?(l(),n("span",be,[...t[25]||(t[25]=[e("svg",{class:"animate-spin h-4 w-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),r(" Guardando... ",-1)])])):i("",!0)]),T(e("textarea",{"onUpdate:modelValue":t[0]||(t[0]=b=>p.value=b),onInput:S,class:"w-full h-48 border border-[#EAD5D3] rounded-lg p-4 bg-[#F9F7F3] font-['Lato'] text-[#5D4A44] focus:ring-2 focus:ring-[#D8AFA0] focus:border-transparent outline-none resize-none",placeholder:"Anota observaciones, temas tratados, tareas asignadas, aspectos a trabajar en prÃ³ximas sesiones..."},null,544),[[B,p.value]]),e("div",{class:"mt-3 flex items-center justify-between"},[t[27]||(t[27]=e("p",{class:"text-xs text-[#5D4A44]/50"}," Las notas se guardan automÃ¡ticamente. Solo tÃº puedes verlas. ",-1)),e("button",{onClick:F,class:"px-4 py-2 bg-[#D8AFA0] hover:bg-[#C89B8A] text-white rounded-lg transition-colors text-sm font-medium"}," Guardar ahora ")])])]),e("div",fe,[e("div",ve,[t[30]||(t[30]=e("h3",{class:"font-['Lora'] text-lg text-[#5D4A44] mb-4"},"Acciones",-1)),e("div",ge,[s.value.estado==="pendiente"?(l(),n("button",{key:0,onClick:t[1]||(t[1]=b=>y("confirmada")),class:"w-full px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg transition-colors text-sm font-medium"}," âœ“ Confirmar SesiÃ³n ")):i("",!0),s.value.estado==="confirmada"?(l(),n("button",{key:1,onClick:t[2]||(t[2]=b=>y("realizada")),class:"w-full px-4 py-2 bg-[#D8AFA0] hover:bg-[#C89B8A] text-white rounded-lg transition-colors text-sm font-medium"}," âœ“ Marcar como Realizada ")):i("",!0),["pendiente","confirmada"].includes(s.value.estado)?(l(),n("button",{key:2,onClick:t[3]||(t[3]=b=>y("cancelada")),class:"w-full px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg transition-colors text-sm font-medium"}," âœ• Cancelar SesiÃ³n ")):i("",!0),c(d,{to:`/terapeuta/pacientes/${s.value.paciente_id}`,class:"w-full block px-4 py-2 bg-white border border-[#EAD5D3] text-[#5D4A44] hover:bg-[#F9F7F3] rounded-lg transition-colors text-sm font-medium text-center"},{default:m(()=>[...t[28]||(t[28]=[r(" Ver Perfil del Paciente ",-1)])]),_:1},8,["to"]),t[29]||(t[29]=e("button",{class:"w-full px-4 py-2 bg-white border border-[#EAD5D3] text-[#5D4A44] hover:bg-[#F9F7F3] rounded-lg transition-colors text-sm font-medium"}," ðŸ“„ Generar Recibo ",-1))])]),e("div",De,[t[31]||(t[31]=e("h4",{class:"font-['Lora'] text-sm text-[#5D4A44] mb-3"},"InformaciÃ³n",-1)),e("div",Ae,[e("p",null,"â€¢ Creada: "+o(D(s.value.created_at)),1),e("p",null,"â€¢ ID: "+o(s.value.id),1),s.value.bono_id?(l(),n("p",ye,"â€¢ Bono: "+o(s.value.bono_id.slice(0,8)),1)):i("",!0)])])])])])):i("",!0)])}}}),Ce=I(_e,[["__scopeId","data-v-f7095ca9"]]);export{Ce as default};
