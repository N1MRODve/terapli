import{_ as K}from"./ML1yDnzB.js";import{e as Q,m as W,r as d,E as X,g as Z,D as ee,c as i,b as M,w as te,_ as oe,o as l,a as t,j as A,l as S,F as h,x as y,k as s,t as n,A as ae,z as w,d as C,v as se,h as ne}from"#entry";import{u as re}from"./CPLUyJxJ.js";import"./Bi0YyG7H.js";import"./mZ3toP8Y.js";import"./DRclOuRO.js";import"./B5My0XuL.js";import"./G1mM6o1b.js";import"./BreoAuwB.js";import"./Byc3y-S3.js";import"./CQZt9cKZ.js";import"./BaRJRhc1.js";import"./DlAUqK2U.js";const ie={class:"mb-6 flex flex-wrap gap-3"},le=["value"],de=["onClick"],ce={class:"mr-2"},ue={key:0,class:"bg-white rounded-xl shadow-sm border border-[#EAD5D3]/40 p-6"},me={class:"mb-6 flex items-center gap-4"},be={class:"mb-6"},pe={class:"text-2xl font-serif font-semibold text-cafe mb-1"},fe={class:"text-cafe/60"},ge={key:0,class:"text-center py-12"},ve={key:1,class:"text-center py-12"},xe={class:"text-cafe/60"},_e={key:2,class:"space-y-4"},he={class:"flex items-start justify-between"},ye={class:"flex-1"},we={class:"flex items-center gap-3 mb-2"},Ce={class:"text-3xl"},De={class:"text-lg font-semibold text-cafe"},ke={class:"text-sm text-cafe/60"},Ne={key:0,class:"mt-3 p-3 bg-white/50 rounded-lg"},Ee={class:"text-sm text-cafe/70"},Me={class:"flex flex-col gap-2"},Ae={key:1,class:"bg-white rounded-xl shadow-sm border border-[#EAD5D3]/40 p-6"},Se={class:"text-center py-12"},Te={class:"text-cafe/60"},Pe=Q({__name:"agenda",setup(Ve){const{getCitasPorDia:T,getTerapeutas:V,listenRealtimeCitasGlobal:F}=re(),$=W(),u=d("dia"),r=d(x(new Date)),m=d(""),f=d(!1),c=d([]),D=d([]),p=d(null),g=d(!1),v=d(""),z=d(""),R=[{id:"dia",nombre:"D√≠a",icono:"üìÖ"},{id:"semana",nombre:"Semana",icono:"üìÜ"},{id:"mes",nombre:"Mes",icono:"üóìÔ∏è"}];async function L(){const a=await V();D.value=a}async function b(){f.value=!0;try{if(m.value)c.value=await T(r.value,m.value);else{const{data:a,error:e}=await $.from("vista_agenda_terapeutas").select("*").eq("fecha_cita",r.value).neq("estado","cancelada").order("hora_inicio",{ascending:!0});e?(console.error("Error al cargar citas:",e),c.value=[]):c.value=a||[]}}finally{f.value=!1}}function k(){u.value==="dia"&&b()}function N(a){const e=new Date(r.value);e.setDate(e.getDate()+a),r.value=x(e),b()}function j(){r.value=x(new Date),b()}function B(a){v.value=r.value,g.value=!0}function G(){g.value=!1,v.value=""}function U(){b()}function x(a){return a.toISOString().split("T")[0]||""}function E(a){const e=new Date(a+"T00:00:00"),_=["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"];return`${e.getDate()} de ${_[e.getMonth()]} de ${e.getFullYear()}`}function q(a){return{presencial:"üè•",online:"üíª",telefonica:"üìû"}[a]||"üìÖ"}function H(a){return{confirmada:"border-green-400",pendiente:"border-yellow-400",cancelada:"border-red-400",realizada:"border-blue-400"}[a]||"border-gray-400"}function I(a){return{confirmada:"bg-green-100 text-green-700",pendiente:"bg-yellow-100 text-yellow-700",cancelada:"bg-red-100 text-red-700",realizada:"bg-blue-100 text-blue-700"}[a]||"bg-gray-100 text-gray-700"}function J(){p.value=F(O)}function O(a,e){console.log("üì° Evento Realtime global recibido:",a,e),b()}function P(){p.value&&(p.value.unsubscribe(),p.value=null)}return X([u,r,m],()=>{k()}),Z(async()=>{await L(),await b(),J()}),ee(()=>{P()}),(a,e)=>{const _=K,Y=oe;return l(),i("div",null,[M(Y,{name:"coordinacion"},{default:te(()=>[e[13]||(e[13]=t("div",{class:"mb-8"},[t("h1",{class:"text-4xl font-serif font-bold text-cafe mb-2"}," Agenda Global "),t("p",{class:"text-lg text-cafe/70"}," Gesti√≥n y coordinaci√≥n de todas las sesiones de terapeutas ")],-1)),t("div",ie,[A(t("select",{"onUpdate:modelValue":e[0]||(e[0]=o=>S(m)?m.value=o:null),class:"px-4 py-2 rounded-lg border border-[#EAD5D3]/40 bg-white text-cafe focus:ring-2 focus:ring-terracota focus:border-transparent",onChange:k},[e[5]||(e[5]=t("option",{value:""},"Todos los terapeutas",-1)),(l(!0),i(h,null,y(s(D),o=>(l(),i("option",{key:o.id,value:o.id},n(o.nombre_completo),9,le))),128))],544),[[ae,s(m)]]),(l(),i(h,null,y(R,o=>t("button",{key:o.id,onClick:Fe=>u.value=o.id,class:w(["px-5 py-2.5 rounded-lg font-medium transition-all",s(u)===o.id?"bg-terracota text-white shadow-md":"bg-white text-cafe hover:bg-terracota/10 border border-[#EAD5D3]/40"])},[t("span",ce,n(o.icono),1),C(" "+n(o.nombre),1)],10,de)),64)),t("button",{onClick:e[1]||(e[1]=o=>B()),class:"ml-auto px-5 py-2.5 rounded-lg font-medium bg-gradient-to-r from-terracota to-rosa text-white hover:from-terracota/90 hover:to-rosa/90 shadow-md transition-all"},[...e[6]||(e[6]=[t("span",{class:"mr-2"},"+",-1),C(" Nueva Cita ",-1)])])]),s(u)==="dia"?(l(),i("div",ue,[t("div",me,[t("button",{onClick:e[2]||(e[2]=o=>N(-1)),class:"p-2 hover:bg-terracota/10 rounded-lg transition-colors"}," ‚Üê Anterior "),A(t("input",{"onUpdate:modelValue":e[3]||(e[3]=o=>S(r)?r.value=o:null),type:"date",class:"flex-1 px-4 py-2 bg-base-bg rounded-lg border border-transparent focus:border-terracota focus:outline-none focus:ring-2 focus:ring-terracota/20"},null,512),[[se,s(r)]]),t("button",{onClick:j,class:"px-4 py-2 bg-terracota/10 text-terracota rounded-lg hover:bg-terracota/20 transition-colors font-medium"}," Hoy "),t("button",{onClick:e[4]||(e[4]=o=>N(1)),class:"p-2 hover:bg-terracota/10 rounded-lg transition-colors"}," Siguiente ‚Üí ")]),t("div",be,[t("h2",pe,n(E(s(r))),1),t("p",fe,n(s(c).length)+" cita"+n(s(c).length!==1?"s":"")+" programada"+n(s(c).length!==1?"s":""),1)]),s(f)?(l(),i("div",ge,[...e[7]||(e[7]=[t("div",{class:"inline-block animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-terracota"},null,-1)])])):s(c).length===0?(l(),i("div",ve,[e[8]||(e[8]=t("span",{class:"text-6xl mb-4 block"},"üìÖ",-1)),e[9]||(e[9]=t("p",{class:"text-lg text-cafe font-medium mb-2"},"Sin citas programadas",-1)),t("p",xe,"No hay citas para "+n(E(s(r))),1)])):(l(),i("div",_e,[(l(!0),i(h,null,y(s(c),o=>(l(),i("div",{key:o.cita_id,class:w(["bg-gradient-to-r from-base-bg to-white rounded-lg p-5 border-l-4 hover:shadow-md transition-all",H(o.estado)])},[t("div",he,[t("div",ye,[t("div",we,[t("span",Ce,n(q(o.modalidad)),1),t("div",null,[t("h3",De,n(o.paciente_nombre),1),t("p",ke,n(o.hora_inicio)+" - "+n(o.hora_fin)+" ¬∑ "+n(o.terapeuta_nombre),1)])]),o.observaciones?(l(),i("div",Ne,[t("p",Ee,[e[10]||(e[10]=t("span",{class:"font-medium"},"Notas:",-1)),C(" "+n(o.observaciones),1)])])):ne("",!0)]),t("div",Me,[t("span",{class:w(["px-3 py-1 rounded-full text-xs font-medium",I(o.estado)])},n(o.estado),3)])])],2))),128))]))])):(l(),i("div",Ae,[t("div",Se,[e[11]||(e[11]=t("span",{class:"text-6xl mb-4 block"},"üóìÔ∏è",-1)),e[12]||(e[12]=t("p",{class:"text-lg text-cafe font-medium mb-2"},"Vista en desarrollo",-1)),t("p",Te,"La vista "+n(s(u))+" estar√° disponible pronto",1)])])),M(_,{mostrar:s(g),"fecha-preseleccionada":s(v),"hora-preseleccionada":s(z),onCerrar:G,onCitaCreada:U},null,8,["mostrar","fecha-preseleccionada","hora-preseleccionada"])]),_:1})])}}});export{Pe as default};
