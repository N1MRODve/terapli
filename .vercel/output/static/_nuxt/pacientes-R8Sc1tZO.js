import{c as d,o as r,a as o,e as H,r as C,I as To,b as m,l as e,k as y,h as k,v as M,m as Z,t as i,A as T,x as q,F as U,y as R,d as _,g as vo,D as Io,i as Uo,j as I,z as eo,p as Vo,L as Do,J as z,K as O,X as so,T as co}from"#entry";import{r as No}from"./MagnifyingGlassIcon-B5My0XuL.js";import{r as K}from"./XMarkIcon-DWNj0d99.js";import{r as jo,b as Fo,a as Lo}from"./EyeIcon-C_-OWEOm.js";import{r as zo}from"./PlusIcon-UqRq4KLf.js";import{_ as G}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{r as Oo}from"./UserGroupIcon-Byc3y-S3.js";import{r as bo}from"./CheckCircleIcon-Bi0YyG7H.js";import{r as Q}from"./TicketIcon-DRclOuRO.js";import{r as X}from"./ExclamationTriangleIcon-BreoAuwB.js";import{r as Zo}from"./FunnelIcon-CO-pjLeZ.js";import{a as Ro,r as uo}from"./XCircleIcon-DIGsvT-h.js";import{r as Ho}from"./EnvelopeIcon-CVHiCNXI.js";import{r as Go}from"./PhoneIcon-B4J2dtua.js";import{r as fo}from"./PencilIcon-QJyqa3i7.js";import{r as Wo}from"./TrashIcon-c8JhvyFk.js";import{r as mo}from"./UserIcon-G1mM6o1b.js";import{r as po}from"./ArrowPathIcon-CzZelkbp.js";import{r as Jo}from"./CheckIcon-BAcWvHoW.js";import{r as Ko}from"./DocumentTextIcon-Dp_75vtG.js";import{r as Qo}from"./ChartBarIcon-Cii-u9ml.js";import{r as Xo}from"./CalendarIcon-mZ3toP8Y.js";import{r as Yo}from"./ChevronRightIcon-Ck2OajRo.js";function os(c,$){return r(),d("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 6.75a.75.75 0 1 1 0-1.5.75.75 0 0 1 0 1.5ZM12 12.75a.75.75 0 1 1 0-1.5.75.75 0 0 1 0 1.5ZM12 18.75a.75.75 0 1 1 0-1.5.75.75 0 0 1 0 1.5Z"})])}function ss(c,$){return r(),d("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[o("path",{"fill-rule":"evenodd",d:"M8.25 6.75a3.75 3.75 0 1 1 7.5 0 3.75 3.75 0 0 1-7.5 0ZM15.75 9.75a3 3 0 1 1 6 0 3 3 0 0 1-6 0ZM2.25 9.75a3 3 0 1 1 6 0 3 3 0 0 1-6 0ZM6.31 15.117A6.745 6.745 0 0 1 12 12a6.745 6.745 0 0 1 6.709 7.498.75.75 0 0 1-.372.568A12.696 12.696 0 0 1 12 21.75c-2.305 0-4.47-.612-6.337-1.684a.75.75 0 0 1-.372-.568 6.787 6.787 0 0 1 1.019-4.38Z","clip-rule":"evenodd"}),o("path",{d:"M5.082 14.254a8.287 8.287 0 0 0-1.308 5.135 9.687 9.687 0 0 1-1.764-.44l-.115-.04a.563.563 0 0 1-.373-.487l-.01-.121a3.75 3.75 0 0 1 3.57-4.047ZM20.226 19.389a8.287 8.287 0 0 0-1.308-5.135 3.75 3.75 0 0 1 3.57 4.047l-.01.121a.563.563 0 0 1-.373.486l-.115.04c-.567.2-1.156.349-1.764.441Z"})])}const es={class:"pacientes-header"},ts={class:"header-left"},as={class:"header-icon"},ns={class:"header-center"},is={class:"search-container"},ls={class:"header-right"},rs={class:"header-stats"},ds={class:"stat-item"},cs={class:"stat-value"},us={class:"stat-item activos"},ms={class:"stat-value"},ps=H({__name:"PacientesHeader",props:{busqueda:{default:""},totalPacientes:{default:0},pacientesActivos:{default:0}},emits:["update:busqueda","nuevo-paciente","importar","exportar"],setup(c,{emit:$}){const b=c,g=$,h=C(b.busqueda);To(()=>b.busqueda,p=>{h.value=p});const x=()=>{g("update:busqueda",h.value)},B=()=>{h.value="",g("update:busqueda","")};return(p,v)=>(r(),d("header",es,[o("div",ts,[o("div",as,[m(e(ss),{class:"w-6 h-6 text-white"})]),v[4]||(v[4]=o("div",{class:"header-text"},[o("h1",{class:"header-title"},"Pacientes"),o("p",{class:"header-subtitle"},"Gesti√≥n y seguimiento de todos los pacientes de la cl√≠nica")],-1))]),o("div",ns,[o("div",is,[m(e(No),{class:"search-icon"}),y(o("input",{"onUpdate:modelValue":v[0]||(v[0]=A=>Z(h)?h.value=A:null),onInput:x,type:"search",placeholder:"Buscar por nombre, email o tel√©fono...",class:"search-input","aria-label":"Buscar pacientes"},null,544),[[M,e(h)]]),e(h)?(r(),d("button",{key:0,onClick:B,class:"search-clear","aria-label":"Limpiar b√∫squeda"},[m(e(K),{class:"w-4 h-4"})])):k("",!0)])]),o("div",ls,[o("div",rs,[o("div",ds,[o("span",cs,i(c.totalPacientes),1),v[5]||(v[5]=o("span",{class:"stat-label"},"Total",-1))]),v[7]||(v[7]=o("div",{class:"stat-divider"},null,-1)),o("div",us,[o("span",ms,i(c.pacientesActivos),1),v[6]||(v[6]=o("span",{class:"stat-label"},"Activos",-1))])]),o("button",{onClick:v[1]||(v[1]=A=>g("importar")),class:"action-btn action-btn-tertiary","aria-label":"Importar pacientes",title:"Importar"},[m(e(jo),{class:"w-4 h-4"})]),o("button",{onClick:v[2]||(v[2]=A=>g("exportar")),class:"action-btn action-btn-tertiary","aria-label":"Exportar pacientes",title:"Exportar"},[m(e(Fo),{class:"w-4 h-4"})]),o("button",{onClick:v[3]||(v[3]=A=>g("nuevo-paciente")),class:"action-btn action-btn-primary","aria-label":"Crear nuevo paciente"},[m(e(zo),{class:"w-4 h-4"}),v[8]||(v[8]=o("span",null,"Nuevo Paciente",-1))])])]))}}),vs=Object.assign(G(ps,[["__scopeId","data-v-500e1e84"]]),{__name:"PacientesHeader"}),bs={class:"metricas-grid"},fs={class:"metrica-card"},_s={class:"metrica-icon icon-total"},gs={class:"metrica-content"},hs={class:"metrica-valor"},$s={class:"metrica-card"},ws={class:"metrica-icon icon-activos"},ys={class:"metrica-content"},ks={class:"metrica-valor activos"},Cs={class:"metrica-card"},Ps={class:"metrica-icon icon-bonos"},xs={class:"metrica-content"},As={class:"metrica-valor bonos"},Es={class:"metrica-icon icon-alerta"},Ms={class:"metrica-content"},Bs={class:"metrica-valor alerta"},Ss=H({__name:"PacientesMetricas",props:{totalPacientes:{},pacientesActivos:{},bonosActivos:{},bonosPorAgotar:{}},setup(c){return($,b)=>(r(),d("div",bs,[o("div",fs,[o("div",_s,[m(e(Oo),{class:"w-6 h-6"})]),o("div",gs,[o("span",hs,i(c.totalPacientes),1),b[0]||(b[0]=o("span",{class:"metrica-label"},"Total Pacientes",-1))])]),o("div",$s,[o("div",ws,[m(e(bo),{class:"w-6 h-6"})]),o("div",ys,[o("span",ks,i(c.pacientesActivos),1),b[1]||(b[1]=o("span",{class:"metrica-label"},"Activos",-1))])]),o("div",Cs,[o("div",Ps,[m(e(Q),{class:"w-6 h-6"})]),o("div",xs,[o("span",As,i(c.bonosActivos),1),b[2]||(b[2]=o("span",{class:"metrica-label"},"Bonos Activos",-1))])]),o("div",{class:T(["metrica-card",{alerta:c.bonosPorAgotar>0}])},[o("div",Es,[m(e(X),{class:"w-6 h-6"})]),o("div",Ms,[o("span",Bs,i(c.bonosPorAgotar),1),b[3]||(b[3]=o("span",{class:"metrica-label"},"Por Agotar",-1))])],2)]))}}),qs=Object.assign(G(Ss,[["__scopeId","data-v-51297926"]]),{__name:"PacientesMetricas"}),Ts={class:"filtros-bar"},Is={class:"filtros-row"},Us={class:"filtros-icon"},Vs={class:"filtro-select-wrapper"},Ds=["value"],Ns={class:"filtro-select-wrapper"},js=["value"],Fs=["value"],Ls={class:"chips-container"},zs={key:0,class:"resultados-badge"},Os=H({__name:"PacientesFiltros",props:{filtroEstado:{default:""},filtroTerapeuta:{default:""},filtroBono:{default:""},terapeutas:{default:()=>[]},totalResultados:{default:0},totalPacientes:{default:0}},emits:["update:filtroEstado","update:filtroTerapeuta","update:filtroBono","limpiar-filtros"],setup(c,{emit:$}){const b=c,g=$,h=q(()=>b.filtroEstado||b.filtroTerapeuta||b.filtroBono),x=q(()=>h.value&&b.totalResultados!==b.totalPacientes);return(B,p)=>(r(),d("div",Ts,[o("div",Is,[o("div",Us,[m(e(Zo),{class:"w-4 h-4"})]),o("div",Vs,[o("select",{value:c.filtroEstado,onChange:p[0]||(p[0]=v=>g("update:filtroEstado",v.target.value)),class:"filtro-select","aria-label":"Filtrar por estado"},[...p[6]||(p[6]=[o("option",{value:""},"Todos los estados",-1),o("option",{value:"activo"},"Activos",-1),o("option",{value:"inactivo"},"Inactivos",-1)])],40,Ds)]),o("div",Ns,[o("select",{value:c.filtroTerapeuta,onChange:p[1]||(p[1]=v=>g("update:filtroTerapeuta",v.target.value)),class:"filtro-select","aria-label":"Filtrar por terapeuta"},[p[7]||(p[7]=o("option",{value:""},"Todos los terapeutas",-1)),(r(!0),d(U,null,R(c.terapeutas,v=>(r(),d("option",{key:v.id,value:v.id},i(v.nombre),9,Fs))),128))],40,js)]),p[12]||(p[12]=o("div",{class:"filtros-divider"},null,-1)),o("div",Ls,[o("button",{onClick:p[2]||(p[2]=v=>g("update:filtroBono",c.filtroBono==="con-bono"?"":"con-bono")),class:T(["filter-chip",{active:c.filtroBono==="con-bono"}])},[m(e(Q),{class:"w-3.5 h-3.5"}),p[8]||(p[8]=_(" Con bono ",-1))],2),o("button",{onClick:p[3]||(p[3]=v=>g("update:filtroBono",c.filtroBono==="sin-bono"?"":"sin-bono")),class:T(["filter-chip",{active:c.filtroBono==="sin-bono"}])},[m(e(Ro),{class:"w-3.5 h-3.5"}),p[9]||(p[9]=_(" Sin bono ",-1))],2),o("button",{onClick:p[4]||(p[4]=v=>g("update:filtroBono",c.filtroBono==="por-agotar"?"":"por-agotar")),class:T(["filter-chip chip-alerta",{active:c.filtroBono==="por-agotar"}])},[m(e(X),{class:"w-3.5 h-3.5"}),p[10]||(p[10]=_(" Por agotar ",-1))],2)]),p[13]||(p[13]=o("div",{class:"flex-1"},null,-1)),e(x)?(r(),d("div",zs,i(c.totalResultados)+" de "+i(c.totalPacientes),1)):k("",!0),e(h)?(r(),d("button",{key:1,onClick:p[5]||(p[5]=v=>g("limpiar-filtros")),class:"limpiar-btn"},[m(e(K),{class:"w-4 h-4"}),p[11]||(p[11]=_(" Limpiar ",-1))])):k("",!0)])]))}}),Zs=Object.assign(G(Os,[["__scopeId","data-v-87eef75a"]]),{__name:"PacientesFiltros"}),Rs={class:"tabla-container"},Hs={key:0,class:"loading-state"},Gs={key:1,class:"empty-state"},Ws={class:"table-wrapper"},Js={class:"pacientes-table"},Ks=["onClick"],Qs={class:"td-paciente"},Xs={class:"paciente-info"},Ys={class:"avatar"},oe={class:"paciente-texto"},se={class:"paciente-nombre"},ee={class:"paciente-area"},te={class:"td-contacto"},ae={class:"contacto-info"},ne=["href","title"],ie={class:"contacto-texto"},le=["href"],re={class:"td-terapeuta"},de={key:0,class:"terapeuta-nombre"},ce={key:1,class:"sin-asignar"},ue={class:"td-bono"},me={class:"bono-info"},pe={class:"bono-sesiones"},ve={class:"sesiones-valor"},be={class:"sesiones-total"},fe={class:"bono-progreso"},_e={key:0,class:"bono-alerta"},ge={key:1,class:"sin-bono"},he={class:"td-sesiones"},$e={class:"sesiones-info"},we={class:"sesiones-total-num"},ye={class:"sesiones-label"},ke={class:"td-estado"},Ce={class:"td-acciones"},Pe=["onClick"],xe=["onClick"],Ae={class:"menu-wrapper"},Ee=["onClick"],Me=["onClick"],Be=["onClick"],Se={key:0,class:"paginacion"},qe={class:"paginacion-info"},Te={class:"paginacion-controles"},Ie=["disabled"],Ue=["onClick"],Ve={key:1,class:"pag-dots"},De=["disabled"],Ne=H({__name:"PacientesTabla",props:{pacientes:{},cargando:{type:Boolean,default:!1},paginaActual:{default:1},porPagina:{default:15}},emits:["ver-detalle","editar","eliminar","whatsapp","cambiar-pagina"],setup(c,{emit:$}){const b=c,g=$,h=C(null),x=q(()=>Math.ceil(b.pacientes.length/b.porPagina)),B=q(()=>{const w=(b.paginaActual-1)*b.porPagina,u=w+b.porPagina;return b.pacientes.slice(w,u)}),p=w=>w?w.split(" ").map(u=>u[0]).join("").toUpperCase().substring(0,2):"??",v=(w,u)=>{const t=w==="activo"||u;return{label:t?"Activo":"Inactivo",class:t?"estado-activo":"estado-inactivo"}},A=w=>w?w.sesiones_restantes===0?{label:"Agotado",class:"bono-agotado",icon:"warning"}:w.sesiones_restantes===1?{label:"√öltima sesi√≥n",class:"bono-ultimo",icon:"warning"}:w.sesiones_restantes===2?{label:"Por agotar",class:"bono-bajo",icon:"warning"}:{label:"Activo",class:"bono-activo",icon:"check"}:{label:"Sin bono",class:"bono-sin",icon:"none"},F=w=>{h.value=h.value===w?null:w},V=()=>{h.value=null};return vo(()=>{document.addEventListener("click",V)}),Io(()=>{document.removeEventListener("click",V)}),(w,u)=>(r(),d("div",Rs,[c.cargando?(r(),d("div",Hs,[...u[6]||(u[6]=[o("div",{class:"loading-spinner"},null,-1),o("p",null,"Cargando pacientes...",-1)])])):c.pacientes.length===0?(r(),d("div",Gs,[...u[7]||(u[7]=[Uo('<div class="empty-icon" data-v-fbffeefb><svg class="w-16 h-16" fill="none" viewBox="0 0 24 24" stroke="currentColor" data-v-fbffeefb><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z" data-v-fbffeefb></path></svg></div><h3 class="empty-title" data-v-fbffeefb>No se encontraron pacientes</h3><p class="empty-description" data-v-fbffeefb>Intenta con otros t√©rminos de b√∫squeda o ajusta los filtros</p>',3)])])):(r(),d(U,{key:2},[o("div",Ws,[o("table",Js,[u[12]||(u[12]=o("thead",null,[o("tr",null,[o("th",{class:"th-paciente"},"Paciente"),o("th",{class:"th-contacto"},"Contacto"),o("th",{class:"th-terapeuta"},"Terapeuta"),o("th",{class:"th-bono"},"Estado Bono"),o("th",{class:"th-sesiones"},"Sesiones"),o("th",{class:"th-estado"},"Estado"),o("th",{class:"th-acciones"},"Acciones")])],-1)),o("tbody",null,[(r(!0),d(U,null,R(e(B),t=>(r(),d("tr",{key:t.id,class:"fila-paciente",onClick:l=>g("ver-detalle",t)},[o("td",Qs,[o("div",Xs,[o("div",Ys,[o("span",null,i(p(t.nombre_completo)),1)]),o("div",oe,[o("span",se,i(t.nombre_completo),1),o("span",ee,i(t.area_de_acompanamiento||"Sin √°rea asignada"),1)])])]),o("td",te,[o("div",ae,[o("a",{href:`mailto:${t.email}`,class:"contacto-item",onClick:u[0]||(u[0]=I(()=>{},["stop"])),title:t.email},[m(e(Ho),{class:"w-4 h-4"}),o("span",ie,i(t.email),1)],8,ne),t.telefono?(r(),d("a",{key:0,href:`tel:${t.telefono}`,class:"contacto-item",onClick:u[1]||(u[1]=I(()=>{},["stop"]))},[m(e(Go),{class:"w-4 h-4"}),o("span",null,i(t.telefono),1)],8,le)):k("",!0)])]),o("td",re,[t.terapeuta_nombre?(r(),d("span",de,i(t.terapeuta_nombre),1)):(r(),d("span",ce,"Sin asignar"))]),o("td",ue,[o("div",me,[t.bono_activo?(r(),d("div",{key:0,class:T(["bono-detalle",A(t.bono_activo).class])},[o("div",pe,[o("span",ve,i(t.bono_activo.sesiones_restantes),1),o("span",be,"/"+i(t.bono_activo.sesiones_totales),1)]),o("div",fe,[o("div",{class:"bono-progreso-fill",style:eo({width:`${t.bono_activo.sesiones_restantes/t.bono_activo.sesiones_totales*100}%`})},null,4)]),t.bono_activo.sesiones_restantes<=2?(r(),d("div",_e,[m(e(X),{class:"w-3 h-3"}),o("span",null,i(t.bono_activo.sesiones_restantes===0?"Agotado":"Renovar"),1)])):k("",!0)],2)):(r(),d("span",ge,"Sin bono"))])]),o("td",he,[o("div",$e,[o("span",we,i(t.total_citas||0),1),o("span",ye,i(t.sesiones_completadas||0)+" completadas",1)])]),o("td",ke,[o("span",{class:T(["estado-badge",v(t.estado,t.activo).class])},[u[8]||(u[8]=o("span",{class:"estado-dot"},null,-1)),_(" "+i(v(t.estado,t.activo).label),1)],2)]),o("td",Ce,[o("div",{class:"acciones-group",onClick:u[3]||(u[3]=I(()=>{},["stop"]))},[t.telefono?(r(),d("button",{key:0,onClick:l=>g("whatsapp",t),class:"btn-accion btn-whatsapp",title:"WhatsApp"},[...u[9]||(u[9]=[o("svg",{class:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24"},[o("path",{d:"M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.890-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413Z"})],-1)])],8,Pe)):k("",!0),o("button",{onClick:l=>g("ver-detalle",t),class:"btn-accion btn-ver",title:"Ver detalles"},[m(e(Lo),{class:"w-5 h-5"})],8,xe),o("div",Ae,[o("button",{onClick:I(l=>F(t.id),["stop"]),class:"btn-accion btn-menu",title:"M√°s opciones"},[m(e(os),{class:"w-5 h-5"})],8,Ee),e(h)===t.id?(r(),d("div",{key:0,class:"menu-dropdown",onClick:u[2]||(u[2]=I(()=>{},["stop"]))},[o("button",{onClick:l=>{g("editar",t),V()},class:"menu-item"},[m(e(fo),{class:"w-4 h-4"}),u[10]||(u[10]=_(" Editar paciente ",-1))],8,Me),o("button",{onClick:l=>{g("eliminar",t),V()},class:"menu-item menu-item-danger"},[m(e(Wo),{class:"w-4 h-4"}),u[11]||(u[11]=_(" Eliminar paciente ",-1))],8,Be)])):k("",!0)])])])],8,Ks))),128))])])]),e(x)>1?(r(),d("div",Se,[o("div",qe," Mostrando "+i((c.paginaActual-1)*c.porPagina+1)+" - "+i(Math.min(c.paginaActual*c.porPagina,c.pacientes.length))+" de "+i(c.pacientes.length),1),o("div",Te,[o("button",{onClick:u[4]||(u[4]=t=>g("cambiar-pagina",c.paginaActual-1)),disabled:c.paginaActual===1,class:"pag-btn"},[...u[13]||(u[13]=[o("svg",{class:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1)])],8,Ie),(r(!0),d(U,null,R(e(x),t=>(r(),d(U,{key:t},[t===1||t===e(x)||t>=c.paginaActual-1&&t<=c.paginaActual+1?(r(),d("button",{key:0,onClick:l=>g("cambiar-pagina",t),class:T(["pag-btn pag-num",{active:t===c.paginaActual}])},i(t),11,Ue)):t===c.paginaActual-2||t===c.paginaActual+2?(r(),d("span",Ve," ... ")):k("",!0)],64))),128)),o("button",{onClick:u[5]||(u[5]=t=>g("cambiar-pagina",c.paginaActual+1)),disabled:c.paginaActual===e(x),class:"pag-btn"},[...u[14]||(u[14]=[o("svg",{class:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1)])],8,De)])])):k("",!0)],64))]))}}),je=Object.assign(G(Ne,[["__scopeId","data-v-fbffeefb"]]),{__name:"PacientesTabla"}),Fe={class:"pacientes-page"},Le={class:"modal-container"},ze={class:"modal-header"},Oe={class:"modal-header-left"},Ze={class:"modal-avatar"},Re={class:"modal-title-group"},He={class:"modal-title"},Ge={class:"modal-subtitle"},We={class:"modal-header-actions"},Je={class:"modal-body"},Ke={key:0,class:"edit-form"},Qe={class:"edit-alert"},Xe={class:"form-section"},Ye={class:"form-section-title"},ot={class:"form-grid"},st={class:"form-field"},et={class:"form-field"},tt={class:"form-field"},at={class:"form-field"},nt=["value"],it={class:"form-field"},lt={class:"form-field"},rt={class:"form-section"},dt={class:"form-section-title"},ct={class:"toggle-field"},ut={class:"toggle-status"},mt={class:"form-actions"},pt=["disabled"],vt=["disabled"],bt={key:1,class:"detail-view"},ft={class:"detail-header"},_t={class:"detail-badges"},gt={key:0,class:"badge badge-purple"},ht={class:"detail-actions"},$t={class:"detail-section"},wt={class:"detail-section-title"},yt={class:"info-grid"},kt={class:"info-card"},Ct={class:"info-value"},Pt={class:"info-card"},xt={class:"info-value"},At={class:"info-card"},Et={class:"info-value"},Mt={class:"info-card"},Bt={class:"info-value"},St={class:"info-card"},qt={class:"info-value"},Tt={class:"info-card"},It={class:"info-value capitalize"},Ut={class:"detail-section"},Vt={class:"detail-section-title"},Dt={class:"stats-grid"},Nt={class:"stat-card stat-blue"},jt={class:"stat-value"},Ft={class:"stat-card stat-green"},Lt={class:"stat-value"},zt={class:"stat-card stat-purple"},Ot={class:"stat-value"},Zt={class:"stat-card stat-orange"},Rt={class:"stat-value"},Ht={key:0,class:"detail-section"},Gt={class:"detail-section-title"},Wt={class:"bono-card"},Jt={class:"bono-header"},Kt={class:"bono-value"},Qt={class:"bono-percent"},Xt={class:"percent-value"},Yt={class:"bono-progress"},oa={key:0,class:"bono-alert"},sa={class:"bono-alert-title"},ea={class:"detail-section"},ta={class:"detail-section-title"},aa={class:"info-grid cols-2"},na={class:"info-card"},ia={class:"info-value"},la={key:0,class:"info-card"},ra={class:"info-value"},da={class:"modal-footer"},ca={class:"modal-container modal-lg"},ua={class:"modal-header"},ma={class:"form-section"},pa={class:"form-grid"},va={class:"form-field"},ba={class:"form-field"},fa={class:"form-field"},_a={class:"form-section"},ga={class:"form-field"},ha=["value"],$a={class:"form-section bono-migration"},wa={class:"bono-migration-header"},ya={key:0,class:"bono-migration-form"},ka={class:"form-grid"},Ca={class:"form-field"},Pa={class:"form-field"},xa=["value"],Aa={class:"form-field"},Ea=["max","disabled"],Ma={class:"form-field"},Ba={class:"form-field"},Sa={class:"form-field"},qa={class:"bono-summary"},Ta={class:"bono-summary-content"},Ia={class:"bono-summary-progress"},Ua={class:"bono-summary-labels"},Va={class:"bono-summary-bar"},Da={class:"bono-summary-count"},Na={class:"count-value"},ja={class:"count-total"},Fa={class:"form-section"},La={class:"form-field"},za={class:"toggle-field"},Oa={class:"form-actions"},Za=["disabled"],Ra=H({__name:"pacientes",setup(c){const $=Vo(),b=Do(),g=C(!0),h=C([]),x=C([]),B=C(""),p=C(""),v=C(""),A=C(""),F=C(1),V=C(15),w=C(!1),u=C(!1),t=C({nombre_completo:"",email:"",telefono:"+34 ",terapeuta_id:null,notas:"",activo:!0,tiene_bono_existente:!1,bono:{tipo:"",sesiones_totales:0,sesiones_consumidas:0,fecha_compra:null,monto_total:0,estado_pago:"pagado"}}),l=C(null),Y=C(!1),S=C(!1),f=C({}),D=C(!1),oo=q(()=>h.value.length),to=q(()=>h.value.filter(a=>a.estado==="activo"||a.activo).length),_o=q(()=>h.value.filter(a=>a.bono_activo&&a.bono_activo.sesiones_restantes>0).length),go=q(()=>h.value.filter(a=>a.bono_activo&&a.bono_activo.sesiones_restantes<=1).length),ao=q(()=>{let a=[...h.value];if(B.value.trim()){const s=B.value.toLowerCase();a=a.filter(P=>P.nombre_completo?.toLowerCase().includes(s)||P.email?.toLowerCase().includes(s)||P.telefono?.includes(s))}return p.value==="activo"?a=a.filter(s=>s.estado==="activo"||s.activo):p.value==="inactivo"&&(a=a.filter(s=>s.estado==="inactivo"||!s.activo)),v.value&&(a=a.filter(s=>s.terapeuta_id===v.value)),A.value==="con-bono"?a=a.filter(s=>s.bono_activo&&s.bono_activo.sesiones_restantes>0):A.value==="sin-bono"?a=a.filter(s=>!s.bono_activo):A.value==="por-agotar"&&(a=a.filter(s=>s.bono_activo&&s.bono_activo.sesiones_restantes<=2)),a}),ho=a=>a?a.split(" ").map(s=>s[0]).join("").toUpperCase().substring(0,2):"PA",no=a=>a?new Date(a).toLocaleDateString("es-ES",{day:"2-digit",month:"short",year:"numeric"}):"No especificada",$o=a=>a===0?"bg-red":a===1?"bg-orange":a===2?"bg-amber":"bg-green",wo=()=>{B.value="",p.value="",v.value="",A.value="",F.value=1},yo=()=>{alert("Funcionalidad de importaci√≥n pr√≥ximamente")},ko=()=>{alert("Funcionalidad de exportaci√≥n pr√≥ximamente")},io=a=>{l.value=a,Y.value=!0,S.value=!1},L=()=>{Y.value=!1,S.value=!1,setTimeout(()=>{l.value=null},300)},lo=()=>{f.value={nombre_completo:l.value.nombre_completo||"",email:l.value.email||"",telefono:l.value.telefono||"",terapeuta_id:l.value.terapeuta_id||null,area_de_acompanamiento:l.value.area_de_acompanamiento||"",frecuencia:l.value.frecuencia||"",activo:l.value.activo??!0},S.value=!0},Co=()=>{S.value=!1,f.value={}},Po=async()=>{if(!f.value.nombre_completo||!f.value.email){alert("El nombre y el email son obligatorios");return}D.value=!0;try{const{error:a}=await $.from("pacientes").update({nombre_completo:f.value.nombre_completo.trim(),email:f.value.email.trim().toLowerCase(),telefono:f.value.telefono?.trim()||null,terapeuta_id:f.value.terapeuta_id||null,area_de_acompanamiento:f.value.area_de_acompanamiento||null,frecuencia:f.value.frecuencia||null,activo:f.value.activo,updated_at:new Date().toISOString()}).eq("id",l.value.id);if(a)throw a;alert("‚úÖ Paciente actualizado correctamente"),Object.assign(l.value,f.value),await J(),S.value=!1}catch(a){console.error("Error al actualizar paciente:",a),alert(`‚ùå Error al actualizar: ${a.message}`)}finally{D.value=!1}},W=()=>{w.value=!1,t.value={nombre_completo:"",email:"",telefono:"+34 ",terapeuta_id:null,notas:"",activo:!0,tiene_bono_existente:!1,bono:{tipo:"",sesiones_totales:0,sesiones_consumidas:0,fecha_compra:null,monto_total:0,estado_pago:"pagado"}}},xo=()=>{switch(t.value.bono.tipo){case"semanal":t.value.bono.sesiones_totales=4;break;case"quincenal":t.value.bono.sesiones_totales=2;break;case"mensual":t.value.bono.sesiones_totales=1;break;default:t.value.bono.sesiones_totales=0}t.value.bono.sesiones_consumidas>t.value.bono.sesiones_totales&&(t.value.bono.sesiones_consumidas=0)},Ao=async()=>{u.value=!0;try{if(t.value.tiene_bono_existente){if(t.value.bono.sesiones_consumidas>t.value.bono.sesiones_totales){alert("‚ùå Las sesiones consumidas no pueden ser mayores a las sesiones totales"),u.value=!1;return}if(!t.value.bono.tipo){alert("‚ùå Debe seleccionar el tipo de bono"),u.value=!1;return}}const a={nombre_completo:t.value.nombre_completo.trim(),email:t.value.email.trim().toLowerCase(),telefono:t.value.telefono.trim(),terapeuta_id:t.value.terapeuta_id||null,notas:t.value.notas.trim()||null,activo:t.value.activo,created_at:new Date().toISOString()},{data:s,error:P}=await $.from("pacientes").insert([a]).select().single();if(P)throw P;if(t.value.tiene_bono_existente){const j=t.value.bono.sesiones_totales-t.value.bono.sesiones_consumidas,E={paciente_id:s.id,tipo_bono:t.value.bono.tipo,sesiones_totales:t.value.bono.sesiones_totales,sesiones_restantes:j,estado:j>0?"activo":"agotado",monto_total:t.value.bono.monto_total||0,estado_pago:t.value.bono.estado_pago,fecha_pago:t.value.bono.fecha_compra||new Date().toISOString(),created_at:new Date().toISOString(),updated_at:new Date().toISOString()},{error:n}=await $.from("bonos").insert([E]);n&&(console.error("Error al crear bono:",n),alert(`‚ö†Ô∏è Paciente creado, pero hubo un error al crear el bono: ${n.message}`))}const N=t.value.tiene_bono_existente?`‚úÖ Paciente y bono creados exitosamente: ${s.nombre_completo}
üé´ Bono: ${t.value.bono.sesiones_totales-t.value.bono.sesiones_consumidas} sesiones restantes`:`‚úÖ Paciente creado exitosamente: ${s.nombre_completo}`;alert(N),W(),await J()}catch(a){console.error("Error al crear paciente:",a),alert(`‚ùå Error al crear el paciente: ${a.message}`)}finally{u.value=!1}},ro=a=>{if(!a.telefono){alert("Este paciente no tiene tel√©fono registrado");return}const s=a.telefono.replace(/\D/g,""),P=encodeURIComponent(`Hola ${a.nombre_completo}, te escribo desde el consultorio de Psic√≥loga Karem.`);window.open(`https://wa.me/${s}?text=${P}`,"_blank")},Eo=a=>{confirm(`‚ö†Ô∏è ¬øEst√°s seguro de que deseas eliminar a ${a.nombre_completo}?

Esta acci√≥n eliminar√°:
‚Ä¢ El paciente
‚Ä¢ Todos sus bonos
‚Ä¢ Todas sus citas
‚Ä¢ Todo su historial

Esta acci√≥n NO se puede deshacer.`)&&Mo(a)},Mo=async a=>{try{await $.from("bonos").delete().eq("paciente_id",a.id),await $.from("citas").delete().eq("paciente_id",a.id);const{error:s}=await $.from("pacientes").delete().eq("id",a.id);if(s)throw s;alert(`‚úÖ Paciente ${a.nombre_completo} eliminado exitosamente`),await J()}catch(s){console.error("Error al eliminar paciente:",s),alert(`‚ùå Error al eliminar el paciente: ${s.message}`)}},Bo=async()=>{try{const{data:a,error:s}=await $.from("terapeutas").select("id, nombre_completo").order("nombre_completo",{ascending:!0});if(s)throw s;x.value=a?.map(P=>({id:P.id,nombre:P.nombre_completo}))||[]}catch(a){console.error("Error al cargar terapeutas:",a),x.value=[]}},J=async()=>{g.value=!0;try{const{data:a,error:s}=await $.from("pacientes").select("*").order("nombre_completo",{ascending:!0});if(s)throw s;if(!a){h.value=[];return}const P=[...new Set(a.map(E=>E.terapeuta_id).filter(Boolean))],N=new Map;if(P.length>0){const{data:E}=await $.from("terapeutas").select("id, nombre_completo").in("id",P);E?.forEach(n=>N.set(n.id,n.nombre_completo))}const j=await Promise.all(a.map(async E=>{const{data:n}=await $.from("bonos").select("id, sesiones_totales, sesiones_restantes, created_at, estado").eq("paciente_id",E.id).in("estado",["activo","pendiente"]).gt("sesiones_restantes",0).order("created_at",{ascending:!1}).limit(1).maybeSingle(),{count:So}=await $.from("citas").select("*",{count:"exact",head:!0}).eq("paciente_id",E.id),{count:qo}=await $.from("citas").select("*",{count:"exact",head:!0}).eq("paciente_id",E.id).eq("estado","realizada");return{...E,terapeuta_nombre:N.get(E.terapeuta_id)||null,estado:E.activo?"activo":"inactivo",total_citas:So||0,sesiones_completadas:qo||0,bono_activo:n?{...n,fecha_compra:n.created_at}:null}}));h.value=j}catch(a){console.error("Error al cargar pacientes:",a),h.value=[]}finally{g.value=!1}};return vo(()=>{Bo(),J()}),(a,s)=>{const P=vs,N=qs,j=Zs,E=je;return r(),d("div",Fe,[m(P,{busqueda:e(B),"onUpdate:busqueda":s[0]||(s[0]=n=>Z(B)?B.value=n:null),"total-pacientes":e(oo),"pacientes-activos":e(to),onNuevoPaciente:s[1]||(s[1]=n=>w.value=!0),onImportar:yo,onExportar:ko},null,8,["busqueda","total-pacientes","pacientes-activos"]),m(N,{"total-pacientes":e(oo),"pacientes-activos":e(to),"bonos-activos":e(_o),"bonos-por-agotar":e(go)},null,8,["total-pacientes","pacientes-activos","bonos-activos","bonos-por-agotar"]),m(j,{"filtro-estado":e(p),"onUpdate:filtroEstado":s[2]||(s[2]=n=>Z(p)?p.value=n:null),"filtro-terapeuta":e(v),"onUpdate:filtroTerapeuta":s[3]||(s[3]=n=>Z(v)?v.value=n:null),"filtro-bono":e(A),"onUpdate:filtroBono":s[4]||(s[4]=n=>Z(A)?A.value=n:null),terapeutas:e(x),"total-resultados":e(ao).length,"total-pacientes":e(oo),onLimpiarFiltros:wo},null,8,["filtro-estado","filtro-terapeuta","filtro-bono","terapeutas","total-resultados","total-pacientes"]),m(E,{pacientes:e(ao),cargando:e(g),"pagina-actual":e(F),"por-pagina":e(V),onVerDetalle:io,onEditar:s[5]||(s[5]=n=>{io(n),lo()}),onEliminar:Eo,onWhatsapp:ro,onCambiarPagina:s[6]||(s[6]=n=>F.value=n)},null,8,["pacientes","cargando","pagina-actual","por-pagina"]),(r(),z(co,{to:"body"},[e(Y)&&e(l)?(r(),d("div",{key:0,class:"modal-overlay",onClick:I(L,["self"])},[o("div",Le,[o("div",ze,[o("div",Oe,[o("div",Ze,i(ho(e(l).nombre_completo)),1),o("div",Re,[o("h2",He,i(e(l).nombre_completo),1),o("p",Ge,i(e(S)?"Editando informaci√≥n del paciente":"Informaci√≥n del paciente"),1)])]),o("div",We,[e(S)?k("",!0):(r(),d("button",{key:0,onClick:lo,class:"modal-btn-icon",title:"Editar paciente"},[m(e(fo),{class:"w-5 h-5"})])),o("button",{onClick:L,class:"modal-btn-icon"},[m(e(K),{class:"w-6 h-6"})])])]),o("div",Je,[e(S)?(r(),d("div",Ke,[o("div",Qe,[m(e(uo),{class:"w-5 h-5"}),s[29]||(s[29]=o("div",null,[o("p",{class:"edit-alert-title"},"Modo de edici√≥n activado"),o("p",{class:"edit-alert-text"},"Modifica los campos necesarios y guarda los cambios")],-1))]),o("div",Xe,[o("h3",Ye,[m(e(mo),{class:"w-5 h-5"}),s[30]||(s[30]=_(" Informaci√≥n Personal ",-1))]),o("div",ot,[o("div",st,[s[31]||(s[31]=o("label",{class:"form-label"},[_("Nombre Completo "),o("span",{class:"required"},"*")],-1)),y(o("input",{"onUpdate:modelValue":s[7]||(s[7]=n=>e(f).nombre_completo=n),type:"text",class:"form-input",placeholder:"Nombre completo"},null,512),[[M,e(f).nombre_completo]])]),o("div",et,[s[32]||(s[32]=o("label",{class:"form-label"},[_("Email "),o("span",{class:"required"},"*")],-1)),y(o("input",{"onUpdate:modelValue":s[8]||(s[8]=n=>e(f).email=n),type:"email",class:"form-input",placeholder:"correo@ejemplo.com"},null,512),[[M,e(f).email]])]),o("div",tt,[s[33]||(s[33]=o("label",{class:"form-label"},"Tel√©fono",-1)),y(o("input",{"onUpdate:modelValue":s[9]||(s[9]=n=>e(f).telefono=n),type:"tel",class:"form-input",placeholder:"+34 600 000 000"},null,512),[[M,e(f).telefono]])]),o("div",at,[s[35]||(s[35]=o("label",{class:"form-label"},"Terapeuta Asignado",-1)),y(o("select",{"onUpdate:modelValue":s[10]||(s[10]=n=>e(f).terapeuta_id=n),class:"form-select"},[s[34]||(s[34]=o("option",{value:null},"Sin asignar",-1)),(r(!0),d(U,null,R(e(x),n=>(r(),d("option",{key:n.id,value:n.id},i(n.nombre),9,nt))),128))],512),[[O,e(f).terapeuta_id]])]),o("div",it,[s[36]||(s[36]=o("label",{class:"form-label"},"√Årea de Acompa√±amiento",-1)),y(o("input",{"onUpdate:modelValue":s[11]||(s[11]=n=>e(f).area_de_acompanamiento=n),type:"text",class:"form-input",placeholder:"Ej: Ansiedad, Depresi√≥n"},null,512),[[M,e(f).area_de_acompanamiento]])]),o("div",lt,[s[38]||(s[38]=o("label",{class:"form-label"},"Frecuencia",-1)),y(o("select",{"onUpdate:modelValue":s[12]||(s[12]=n=>e(f).frecuencia=n),class:"form-select"},[...s[37]||(s[37]=[o("option",{value:""},"Seleccionar...",-1),o("option",{value:"semanal"},"Semanal",-1),o("option",{value:"quincenal"},"Quincenal",-1),o("option",{value:"mensual"},"Mensual",-1),o("option",{value:"ocasional"},"Ocasional",-1)])],512),[[O,e(f).frecuencia]])])])]),o("div",rt,[o("h3",dt,[m(e(bo),{class:"w-5 h-5"}),s[39]||(s[39]=_(" Estado del Paciente ",-1))]),o("div",ct,[y(o("input",{"onUpdate:modelValue":s[13]||(s[13]=n=>e(f).activo=n),type:"checkbox",id:"activo-edicion",class:"toggle-input"},null,512),[[so,e(f).activo]]),s[40]||(s[40]=o("label",{for:"activo-edicion",class:"toggle-label"}," Paciente activo ",-1)),o("span",ut,i(e(f).activo?"Activo":"Inactivo"),1)])]),o("div",mt,[o("button",{onClick:Co,disabled:e(D),class:"btn btn-secondary"}," Cancelar ",8,pt),o("button",{onClick:Po,disabled:e(D),class:"btn btn-primary"},[e(D)?(r(),z(e(po),{key:0,class:"w-4 h-4 animate-spin"})):(r(),z(e(Jo),{key:1,class:"w-4 h-4"})),_(" "+i(e(D)?"Guardando...":"Guardar Cambios"),1)],8,vt)])])):(r(),d("div",bt,[o("div",ft,[o("div",_t,[o("span",{class:T(["badge",e(l).activo?"badge-success":"badge-gray"])},[s[41]||(s[41]=o("span",{class:"badge-dot"},null,-1)),_(" "+i(e(l).activo?"Activo":"Inactivo"),1)],2),e(l).bono_activo?(r(),d("span",gt,[m(e(Q),{class:"w-4 h-4"}),_(" Bono: "+i(e(l).bono_activo.sesiones_restantes)+"/"+i(e(l).bono_activo.sesiones_totales),1)])):k("",!0)]),o("div",ht,[e(l).telefono?(r(),d("button",{key:0,onClick:s[14]||(s[14]=n=>ro(e(l))),class:"btn btn-whatsapp"},[...s[42]||(s[42]=[o("svg",{class:"w-4 h-4",fill:"currentColor",viewBox:"0 0 24 24"},[o("path",{d:"M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.890-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413Z"})],-1),_(" WhatsApp ",-1)])])):k("",!0),o("button",{onClick:s[15]||(s[15]=()=>{L(),e(b).push(`/coordinadora/pacientes/${e(l).id}`)}),class:"btn btn-primary"},[m(e(Ko),{class:"w-4 h-4"}),s[43]||(s[43]=_(" Historial Completo ",-1))])])]),o("div",$t,[o("h3",wt,[m(e(mo),{class:"w-5 h-5"}),s[44]||(s[44]=_(" Informaci√≥n Personal ",-1))]),o("div",yt,[o("div",kt,[s[45]||(s[45]=o("span",{class:"info-label"},"Nombre Completo",-1)),o("span",Ct,i(e(l).nombre_completo||"No especificado"),1)]),o("div",Pt,[s[46]||(s[46]=o("span",{class:"info-label"},"Email",-1)),o("span",xt,i(e(l).email||"No especificado"),1)]),o("div",At,[s[47]||(s[47]=o("span",{class:"info-label"},"Tel√©fono",-1)),o("span",Et,i(e(l).telefono||"No especificado"),1)]),o("div",Mt,[s[48]||(s[48]=o("span",{class:"info-label"},"Terapeuta Asignado",-1)),o("span",Bt,i(e(l).terapeuta_nombre||"Sin asignar"),1)]),o("div",St,[s[49]||(s[49]=o("span",{class:"info-label"},"√Årea de Acompa√±amiento",-1)),o("span",qt,i(e(l).area_de_acompanamiento||"No especificado"),1)]),o("div",Tt,[s[50]||(s[50]=o("span",{class:"info-label"},"Frecuencia",-1)),o("span",It,i(e(l).frecuencia||"No especificada"),1)])])]),o("div",Ut,[o("h3",Vt,[m(e(Qo),{class:"w-5 h-5"}),s[51]||(s[51]=_(" Estad√≠sticas de Sesiones ",-1))]),o("div",Dt,[o("div",Nt,[o("span",jt,i(e(l).total_citas||0),1),s[52]||(s[52]=o("span",{class:"stat-label"},"Total Citas",-1))]),o("div",Ft,[o("span",Lt,i(e(l).sesiones_completadas||0),1),s[53]||(s[53]=o("span",{class:"stat-label"},"Completadas",-1))]),o("div",zt,[o("span",Ot,i(e(l).bono_activo?.sesiones_restantes||0),1),s[54]||(s[54]=o("span",{class:"stat-label"},"Restantes",-1))]),o("div",Zt,[o("span",Rt,i(e(l).bono_activo?.sesiones_totales||0),1),s[55]||(s[55]=o("span",{class:"stat-label"},"Total Bono",-1))])])]),e(l).bono_activo?(r(),d("div",Ht,[o("h3",Gt,[m(e(Q),{class:"w-5 h-5"}),s[56]||(s[56]=_(" Bono Activo ",-1))]),o("div",Wt,[o("div",Jt,[o("div",null,[s[57]||(s[57]=o("p",{class:"bono-label"},"Progreso del Bono",-1)),o("p",Kt,i(e(l).bono_activo.sesiones_restantes)+" / "+i(e(l).bono_activo.sesiones_totales),1),s[58]||(s[58]=o("p",{class:"bono-subtext"},"sesiones disponibles",-1))]),o("div",Qt,[o("span",Xt,i(Math.round((e(l).bono_activo.sesiones_totales-e(l).bono_activo.sesiones_restantes)/e(l).bono_activo.sesiones_totales*100))+"%",1),s[59]||(s[59]=o("span",{class:"percent-label"},"consumido",-1))])]),o("div",Yt,[o("div",{class:T(["bono-progress-bar",$o(e(l).bono_activo.sesiones_restantes)]),style:eo({width:`${(e(l).bono_activo.sesiones_totales-e(l).bono_activo.sesiones_restantes)/e(l).bono_activo.sesiones_totales*100}%`})},null,6)]),e(l).bono_activo.sesiones_restantes<=1?(r(),d("div",oa,[m(e(X),{class:"w-5 h-5"}),o("div",null,[o("p",sa,i(e(l).bono_activo.sesiones_restantes===0?"Bono agotado":"Solo queda 1 sesi√≥n"),1),s[60]||(s[60]=o("p",{class:"bono-alert-text"},"Se recomienda renovar el bono para continuar las sesiones",-1))])])):k("",!0)])])):k("",!0),o("div",ea,[o("h3",ta,[m(e(Xo),{class:"w-5 h-5"}),s[61]||(s[61]=_(" Fechas del Sistema ",-1))]),o("div",aa,[o("div",na,[s[62]||(s[62]=o("span",{class:"info-label"},"Fecha de Registro",-1)),o("span",ia,i(no(e(l).created_at)),1)]),e(l).updated_at?(r(),d("div",la,[s[63]||(s[63]=o("span",{class:"info-label"},"√öltima Actualizaci√≥n",-1)),o("span",ra,i(no(e(l).updated_at)),1)])):k("",!0)])])]))]),o("div",da,[o("button",{onClick:L,class:"btn btn-secondary"}," Cerrar "),e(S)?k("",!0):(r(),d("button",{key:0,onClick:s[16]||(s[16]=()=>{L(),e(b).push(`/coordinadora/pacientes/${e(l).id}`)}),class:"btn btn-primary"},[s[64]||(s[64]=_(" Ver Historial Completo ",-1)),m(e(Yo),{class:"w-4 h-4"})]))])])])):k("",!0)])),(r(),z(co,{to:"body"},[e(w)?(r(),d("div",{key:0,class:"modal-overlay",onClick:I(W,["self"])},[o("div",ca,[o("div",ua,[s[65]||(s[65]=o("h2",{class:"modal-title"},"Crear Nuevo Paciente",-1)),o("button",{onClick:W,class:"modal-btn-icon"},[m(e(K),{class:"w-5 h-5"})])]),o("form",{onSubmit:I(Ao,["prevent"]),class:"modal-body"},[o("div",ma,[s[69]||(s[69]=o("h3",{class:"form-section-title"},"Informaci√≥n Personal",-1)),o("div",pa,[o("div",va,[s[66]||(s[66]=o("label",{class:"form-label"},[_("Nombre Completo "),o("span",{class:"required"},"*")],-1)),y(o("input",{"onUpdate:modelValue":s[17]||(s[17]=n=>e(t).nombre_completo=n),type:"text",required:"",class:"form-input",placeholder:"Ej: Juan P√©rez Garc√≠a"},null,512),[[M,e(t).nombre_completo]])]),o("div",ba,[s[67]||(s[67]=o("label",{class:"form-label"},[_("Email "),o("span",{class:"required"},"*")],-1)),y(o("input",{"onUpdate:modelValue":s[18]||(s[18]=n=>e(t).email=n),type:"email",required:"",class:"form-input",placeholder:"correo@ejemplo.com"},null,512),[[M,e(t).email]])]),o("div",fa,[s[68]||(s[68]=o("label",{class:"form-label"},[_("Tel√©fono "),o("span",{class:"required"},"*")],-1)),y(o("input",{"onUpdate:modelValue":s[19]||(s[19]=n=>e(t).telefono=n),type:"tel",required:"",class:"form-input",placeholder:"+34 612 345 678"},null,512),[[M,e(t).telefono]])])])]),o("div",_a,[s[72]||(s[72]=o("h3",{class:"form-section-title"},"Asignaci√≥n",-1)),o("div",ga,[s[71]||(s[71]=o("label",{class:"form-label"},"Terapeuta Asignado",-1)),y(o("select",{"onUpdate:modelValue":s[20]||(s[20]=n=>e(t).terapeuta_id=n),class:"form-select"},[s[70]||(s[70]=o("option",{value:null},"Sin asignar",-1)),(r(!0),d(U,null,R(e(x),n=>(r(),d("option",{key:n.id,value:n.id},i(n.nombre),9,ha))),128))],512),[[O,e(t).terapeuta_id]])])]),o("div",$a,[o("div",wa,[m(e(uo),{class:"w-5 h-5"}),s[73]||(s[73]=o("div",null,[o("h3",{class:"form-section-title mb-0"},"Migraci√≥n de Datos (Opcional)"),o("p",{class:"form-section-hint"},"Si el paciente viene con un bono existente, completa esta informaci√≥n")],-1)),y(o("input",{"onUpdate:modelValue":s[21]||(s[21]=n=>e(t).tiene_bono_existente=n),type:"checkbox",class:"toggle-checkbox"},null,512),[[so,e(t).tiene_bono_existente]])]),e(t).tiene_bono_existente?(r(),d("div",ya,[o("div",ka,[o("div",Ca,[s[75]||(s[75]=o("label",{class:"form-label"},[_("Tipo de Bono "),o("span",{class:"required"},"*")],-1)),y(o("select",{"onUpdate:modelValue":s[22]||(s[22]=n=>e(t).bono.tipo=n),onChange:xo,required:"",class:"form-select"},[...s[74]||(s[74]=[o("option",{value:""},"Seleccionar...",-1),o("option",{value:"semanal"},"Semanal (4 sesiones/mes)",-1),o("option",{value:"quincenal"},"Quincenal (2 sesiones/mes)",-1),o("option",{value:"mensual"},"Mensual (1 sesi√≥n/mes)",-1)])],544),[[O,e(t).bono.tipo]])]),o("div",Pa,[s[76]||(s[76]=o("label",{class:"form-label"},"Sesiones Totales",-1)),o("input",{value:e(t).bono.sesiones_totales,type:"number",disabled:"",class:"form-input disabled"},null,8,xa)]),o("div",Aa,[s[77]||(s[77]=o("label",{class:"form-label"},[_("Sesiones Consumidas "),o("span",{class:"required"},"*")],-1)),y(o("input",{"onUpdate:modelValue":s[23]||(s[23]=n=>e(t).bono.sesiones_consumidas=n),type:"number",min:"0",max:e(t).bono.sesiones_totales||0,required:"",disabled:!e(t).bono.tipo,class:"form-input"},null,8,Ea),[[M,e(t).bono.sesiones_consumidas,void 0,{number:!0}]])]),o("div",Ma,[s[78]||(s[78]=o("label",{class:"form-label"},"Fecha del √öltimo Pago",-1)),y(o("input",{"onUpdate:modelValue":s[24]||(s[24]=n=>e(t).bono.fecha_compra=n),type:"date",class:"form-input"},null,512),[[M,e(t).bono.fecha_compra]])]),o("div",Ba,[s[79]||(s[79]=o("label",{class:"form-label"},"Monto Pagado (‚Ç¨)",-1)),y(o("input",{"onUpdate:modelValue":s[25]||(s[25]=n=>e(t).bono.monto_total=n),type:"number",min:"0",step:"0.01",class:"form-input",placeholder:"0.00"},null,512),[[M,e(t).bono.monto_total,void 0,{number:!0}]])]),o("div",Sa,[s[81]||(s[81]=o("label",{class:"form-label"},"Estado del Pago",-1)),y(o("select",{"onUpdate:modelValue":s[26]||(s[26]=n=>e(t).bono.estado_pago=n),class:"form-select"},[...s[80]||(s[80]=[o("option",{value:"pagado"},"Pagado",-1),o("option",{value:"pendiente"},"Pendiente",-1),o("option",{value:"parcial"},"Pago Parcial",-1)])],512),[[O,e(t).bono.estado_pago]])])]),o("div",qa,[s[82]||(s[82]=o("p",{class:"bono-summary-title"},"Resumen del Bono:",-1)),o("div",Ta,[o("div",Ia,[o("div",Ua,[o("span",null,i(e(t).bono.sesiones_consumidas||0)+" consumidas",1),o("span",null,i((e(t).bono.sesiones_totales||0)-(e(t).bono.sesiones_consumidas||0))+" restantes",1)]),o("div",Va,[o("div",{class:"bono-summary-fill",style:eo({width:`${e(t).bono.sesiones_totales>0?e(t).bono.sesiones_consumidas/e(t).bono.sesiones_totales*100:0}%`})},null,4)])]),o("div",Da,[o("span",Na,i((e(t).bono.sesiones_totales||0)-(e(t).bono.sesiones_consumidas||0)),1),o("span",ja,"de "+i(e(t).bono.sesiones_totales||0),1)])])])])):k("",!0)]),o("div",Fa,[s[85]||(s[85]=o("h3",{class:"form-section-title"},"Informaci√≥n Adicional",-1)),o("div",La,[s[83]||(s[83]=o("label",{class:"form-label"},"Notas",-1)),y(o("textarea",{"onUpdate:modelValue":s[27]||(s[27]=n=>e(t).notas=n),rows:"3",class:"form-textarea",placeholder:"Notas adicionales sobre el paciente..."},null,512),[[M,e(t).notas]])]),o("div",za,[y(o("input",{"onUpdate:modelValue":s[28]||(s[28]=n=>e(t).activo=n),type:"checkbox",id:"activo-nuevo",class:"toggle-input"},null,512),[[so,e(t).activo]]),s[84]||(s[84]=o("label",{for:"activo-nuevo",class:"toggle-label"},"Paciente Activo",-1))])]),o("div",Oa,[o("button",{type:"button",onClick:W,class:"btn btn-secondary"}," Cancelar "),o("button",{type:"submit",disabled:e(u),class:"btn btn-primary"},[e(u)?(r(),z(e(po),{key:0,class:"w-4 h-4 animate-spin"})):k("",!0),_(" "+i(e(u)?"Creando...":"Crear Paciente"),1)],8,Za)])],32)])])):k("",!0)]))])}}}),fn=G(Ra,[["__scopeId","data-v-56b06e95"]]);export{fn as default};
