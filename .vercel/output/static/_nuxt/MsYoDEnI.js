import{J as Be,r as C,q as N,K as Re,B as He,e as he,c as l,o as i,a as e,g as S,y as _,t as d,k as v,d as ge,E as fe,F as M,s as F,i as ce,b as pe,I as Me}from"#entry";import{_ as ve}from"./DlAUqK2U.js";import{u as xe}from"./Cy0_MzJF.js";import{r as be}from"./BqC9m6KG.js";function Fe(){const u=xe(),k=Be(),p=C([]),B=C(!1),R=C(null),$=C(null),b=C({});C(new Map);const I=N(()=>{const a=new Date().toISOString().split("T")[0];return p.value.filter(t=>t.fecha_cita===a)}),j=N(()=>p.value.filter(a=>a.estado==="pendiente"||a.estado==="confirmada")),y=N(()=>p.value.filter(a=>a.estado==="completada"||a.estado==="realizada")),X=N(()=>p.value.filter(a=>a.bono&&a.bono.sesiones_restantes<=2&&a.bono.sesiones_restantes>0&&(a.estado==="pendiente"||a.estado==="confirmada"))),V=async a=>{try{if(B.value=!0,R.value=null,!k.value?.id)throw new Error("Usuario no autenticado");let t=u.from("citas").select(`
          id,
          fecha_cita,
          hora_inicio,
          hora_fin,
          estado,
          modalidad,
          observaciones,
          paciente_id,
          terapeuta_id,
          bono_id,
          sesion_descontada,
          consumo_registrado,
          paciente:pacientes (
            id,
            nombre_completo,
            telefono,
            email
          ),
          bono:bonos (
            id,
            sesiones_restantes,
            sesiones_totales,
            estado
          )
        `).eq("terapeuta_id",k.value.id);a?.fechaInicio&&(t=t.gte("fecha_cita",a.fechaInicio)),a?.fechaFin&&(t=t.lte("fecha_cita",a.fechaFin)),a?.incluirCompletadas||(t=t.in("estado",["pendiente","confirmada"])),t=t.order("fecha_cita",{ascending:!0}).order("hora_inicio",{ascending:!0});const{data:c,error:s}=await t;if(s)throw s;return p.value=c||[],console.log(`‚úÖ [Agenda] Cargadas ${p.value.length} citas`),p.value}catch(t){throw console.error("‚ùå [Agenda] Error al cargar citas:",t),R.value=t.message||"Error al cargar citas",t}finally{B.value=!1}},re=async a=>{try{console.log(`üîÑ [Agenda] Completando cita: ${a}`);const{data:t,error:c}=await u.rpc("completar_cita",{p_cita_id:a});if(c)throw console.error("‚ùå [Agenda] Error en RPC:",c),c;const s=t;if(s.success){console.log("‚úÖ [Agenda] Cita completada exitosamente");const m=p.value.findIndex(f=>f.id===a);if(m!==-1){const f=p.value[m];f&&(f.estado="completada",f.sesion_descontada=!0,f.consumo_registrado=!0,f.bono&&s.sesiones_despues!==void 0&&(f.bono.sesiones_restantes=s.sesiones_despues,s.bono_completado&&(f.bono.estado="completado")))}return s.alerta?L(s):x("success",s.message),await V(),s}else return s.warning?(console.warn("‚ö†Ô∏è [Agenda] Advertencia:",s.message),x("warning",s.message)):(console.error("‚ùå [Agenda] Error:",s.message),x("error",s.message||"No se pudo completar la cita")),s}catch(t){console.error("‚ùå [Agenda] Error al completar cita:",t);const c=t.message||"Error desconocido al completar cita";return x("error",c),{success:!1,message:c,error:t.code||"unknown_error"}}},O=async a=>{try{const{data:t,error:c}=await u.rpc("obtener_historial_bono",{p_bono_id:a});if(c)throw c;return console.log(`‚úÖ [Agenda] Historial de bono obtenido: ${t?.length||0} movimientos`),t||[]}catch(t){throw console.error("‚ùå [Agenda] Error al obtener historial:",t),t}},T=async a=>{try{const{data:t,error:c}=await u.rpc("verificar_bono_citas",{p_bono_id:a});if(c)throw c;return console.log("‚úÖ [Agenda] Verificaci√≥n de bono:",t),t?.alerta&&console.warn("‚ö†Ô∏è [Agenda] Alerta en bono:",t.mensaje_alerta),t}catch(t){throw console.error("‚ùå [Agenda] Error al verificar bono:",t),t}},D=C([]),U=async()=>{try{console.log("üîç [Agenda] Detectando inconsistencias...");const{data:a,error:t}=await u.from("citas").select(`
          id,
          fecha_cita,
          hora_inicio,
          hora_fin,
          estado,
          modalidad,
          observaciones,
          paciente_id,
          terapeuta_id,
          bono_id,
          sesion_descontada,
          consumo_registrado,
          paciente:pacientes (
            id,
            nombre_completo,
            telefono,
            email
          ),
          bono:bonos (
            id,
            sesiones_restantes,
            sesiones_totales,
            estado
          )
        `).in("estado",["completada","realizada"]).not("bono_id","is",null).or("sesion_descontada.eq.false,consumo_registrado.eq.false").eq("terapeuta_id",k.value?.id||"");if(t)throw t;return D.value=a||[],D.value.length>0?console.warn(`‚ö†Ô∏è [Agenda] ${D.value.length} cita(s) con inconsistencias detectadas`):console.log("‚úÖ [Agenda] No se detectaron inconsistencias"),D.value}catch(a){return console.error("‚ùå [Agenda] Error al detectar inconsistencias:",a),D.value=[],[]}},Z=async a=>{try{console.log(`üîÑ [Agenda] Re-sincronizando bono para cita: ${a}`);const{data:t,error:c}=await u.rpc("actualizar_bono_por_cita",{p_cita_id:a});if(c)throw c;const s=t;return s.success?(console.log("‚úÖ [Agenda] Bono re-sincronizado exitosamente"),s.warning==="ya_descontada"?x("info","Esta sesi√≥n ya estaba descontada"):(x("success","Bono re-sincronizado correctamente"),s.alerta&&s.mensaje_alerta&&setTimeout(()=>{x("warning",s.mensaje_alerta)},500)),await Promise.all([V(),U()]),s):(console.warn("‚ö†Ô∏è [Agenda] No se pudo re-sincronizar:",s.message),x("warning",s.message||"No se pudo re-sincronizar"),s)}catch(t){throw console.error("‚ùå [Agenda] Error al re-sincronizar bono:",t),x("error","Error al re-sincronizar el bono"),t}},W=async()=>{if(D.value.length===0){x("info","No hay citas pendientes de sincronizaci√≥n");return}try{console.log(`üîÑ [Agenda] Re-sincronizando ${D.value.length} citas...`);let a=0,t=0,c=0;for(const f of D.value)try{const h=await Z(f.id);h.success?h.warning==="ya_descontada"?c++:a++:t++,await new Promise(A=>setTimeout(A,300))}catch{t++}const s=[];a>0&&s.push(`${a} sincronizada(s)`),c>0&&s.push(`${c} ya estaba(n) descontada(s)`),t>0&&s.push(`${t} fallida(s)`);const m=`‚úÖ Re-sincronizaci√≥n completa: ${s.join(", ")}`;x(t===0?"success":"warning",m),console.log("‚úÖ [Agenda] Re-sincronizaci√≥n masiva completada:",{exitosos:a,yaDescontados:c,fallidos:t})}catch(a){console.error("‚ùå [Agenda] Error en re-sincronizaci√≥n masiva:",a),x("error","Error al re-sincronizar todas las citas")}},z=()=>{if(!k.value?.id){console.warn("‚ö†Ô∏è [Agenda] No se puede suscribir sin usuario autenticado");return}$.value&&u.removeChannel($.value),console.log("üì° [Agenda] Iniciando suscripci√≥n Realtime..."),$.value=u.channel(`citas_terapeuta_${k.value.id}`).on("postgres_changes",{event:"*",schema:"public",table:"citas",filter:`terapeuta_id=eq.${k.value.id}`},async a=>{console.log("üì° [Realtime] Cambio detectado en citas:",a.eventType),await V(),a.eventType==="INSERT"?x("info","Nueva cita agregada a tu agenda"):a.eventType==="UPDATE"?x("info","Una cita ha sido actualizada"):a.eventType==="DELETE"&&x("warning","Una cita ha sido eliminada")}).subscribe(a=>{a==="SUBSCRIBED"?console.log("‚úÖ [Realtime] Suscripci√≥n activa"):a==="CHANNEL_ERROR"?console.error("‚ùå [Realtime] Error en suscripci√≥n"):a==="TIMED_OUT"&&console.warn("‚ö†Ô∏è [Realtime] Tiempo de espera agotado")})},J=()=>{$.value&&(console.log("üì° [Realtime] Cerrando suscripci√≥n..."),u.removeChannel($.value),$.value=null)},x=(a,t)=>{typeof window<"u"&&window.$toast?window.$toast[a](t):console.log(`${{success:"‚úÖ",error:"‚ùå",warning:"‚ö†Ô∏è",info:"‚ÑπÔ∏è"}[a]} [Agenda] ${t}`)},L=a=>{if(!a.alerta||!a.mensaje_alerta)return;const t=a.tipo_alerta==="bono_agotado"?"success":(a.tipo_alerta==="ultima_sesion","warning");x(t,a.mensaje_alerta)};Re(()=>{k.value?.id&&(V(),z())}),He(()=>{J()});const ee=N(()=>{let a=p.value;if(b.value.paciente&&(a=a.filter(t=>t.paciente?.nombre_completo.toLowerCase().includes(b.value.paciente.toLowerCase()))),b.value.busqueda){const t=b.value.busqueda.toLowerCase();a=a.filter(c=>c.paciente?.nombre_completo.toLowerCase().includes(t)||c.observaciones?.toLowerCase().includes(t)||c.fecha_cita.includes(t))}return b.value.estado&&b.value.estado.length>0&&(a=a.filter(t=>b.value.estado.includes(t.estado))),b.value.area_terapeutica&&(a=a.filter(t=>t.area_terapeutica===b.value.area_terapeutica)),b.value.tipo_sesion&&b.value.tipo_sesion.length>0&&(a=a.filter(t=>t.tipo_sesion&&b.value.tipo_sesion.includes(t.tipo_sesion))),b.value.fecha_desde&&(a=a.filter(t=>t.fecha_cita>=b.value.fecha_desde)),b.value.fecha_hasta&&(a=a.filter(t=>t.fecha_cita<=b.value.fecha_hasta)),a}),oe=a=>{b.value={...a}},te=()=>{b.value={}},K=async(a,t,c,s)=>{try{B.value=!0;const{data:m,error:f}=await u.from("citas").update({fecha_cita:t,hora_inicio:c,hora_fin:s||c,updated_at:new Date().toISOString()}).eq("id",a).select().single();if(f)throw f;const h=p.value.findIndex(A=>A.id===a);return h!==-1&&m&&(p.value[h]={...p.value[h],...m}),{success:!0,cita:m}}catch(m){return console.error("Error al reprogramar cita:",m),{success:!1,error:m.message}}finally{B.value=!1}},ne=async(a,t,c)=>{try{const{data:s,error:m}=await u.from("citas").update({notas_rapidas:t,enlace_videollamada:c,updated_at:new Date().toISOString()}).eq("id",a).select().single();if(m)throw m;const f=p.value.findIndex(h=>h.id===a);return f!==-1&&s&&(p.value[f]={...p.value[f],...s}),{success:!0}}catch(s){return console.error("Error al actualizar notas:",s),{success:!1,error:s.message}}},se=async a=>{try{const t=a||k.value?.id;if(!t)throw new Error("ID de terapeuta requerido");const{data:c,error:s}=await u.from("terapeutas").select("disponibilidad").eq("id",t).single();if(s)throw s;return c?.disponibilidad||[]}catch(t){return console.error("Error al obtener disponibilidad:",t),[]}},ie=(a,t)=>{const c=new Date(a+"T00:00:00").getDay(),s=p.value.filter(h=>h.fecha_cita===a),m=t.filter(h=>h.dia_semana===c&&h.disponible);if(m.length===0)return[];const f=[];return m.forEach(h=>{const A=h.hora_inicio,Q=h.hora_fin;s.some(q=>q.hora_inicio>=A&&q.hora_inicio<Q||q.hora_fin>A&&q.hora_fin<=Q||q.hora_inicio<=A&&q.hora_fin>=Q)||f.push({hora_inicio:A,hora_fin:Q})}),f},ae=async a=>{try{const t=p.value.find(h=>h.id===a);if(!t||!t.paciente)return{success:!1,error:"Cita no encontrada"};const c=new Date(t.fecha_cita+"T"+t.hora_inicio),s=new Date;return new Date(c.getTime()-1440*60*1e3)>s&&!t.recordatorio_24h_enviado&&(await u.from("notificaciones").insert({usuario_id:t.paciente_id,tipo:"cita",titulo:"üìÖ Recordatorio: Cita ma√±ana",mensaje:`Tu cita est√° programada para ma√±ana ${t.fecha_cita} a las ${t.hora_inicio}`,metadata:{cita_id:a,tipo_recordatorio:"24h",fecha_cita:t.fecha_cita,hora:t.hora_inicio}}),await u.from("citas").update({recordatorio_24h_enviado:!0}).eq("id",a)),new Date(c.getTime()-14400*1e3)>s&&!t.recordatorio_4h_enviado&&(await u.from("notificaciones").insert({usuario_id:t.paciente_id,tipo:"cita",titulo:"‚è∞ Recordatorio: Cita en 4 horas",mensaje:`Tu cita est√° programada para hoy ${t.fecha_cita} a las ${t.hora_inicio}`,metadata:{cita_id:a,tipo_recordatorio:"4h",fecha_cita:t.fecha_cita,hora:t.hora_inicio,enlace_videollamada:t.enlace_videollamada}}),await u.from("citas").update({recordatorio_4h_enviado:!0}).eq("id",a)),{success:!0}}catch(t){return console.error("Error al programar recordatorios:",t),{success:!1,error:t.message}}},Y=(a,t)=>{const c=p.value.filter(s=>{const m=s.fecha_cita===a,f=t?s.terapeuta_id===t:!0,h=["pendiente","confirmada"].includes(s.estado);return m&&f&&h});return{total:c.length,confirmadas:c.filter(s=>s.estado==="confirmada").length,pendientes:c.filter(s=>s.estado==="pendiente").length}};return{citas:p,loading:B,error:R,filtros:b,citasDelDia:I,citasPendientes:j,citasCompletadas:y,citasConBonoProximoAgotar:X,citasFiltradas:ee,getCitasDelTerapeuta:V,completarCita:re,obtenerHistorialBono:O,verificarBonoCitas:T,citasPendientesSync:D,detectarInconsistencias:U,resincronizarBono:Z,resincronizarTodos:W,aplicarFiltros:oe,limpiarFiltros:te,reprogramarCita:K,actualizarNotasRapidas:ne,obtenerDisponibilidad:se,calcularHuecosLibres:ie,programarRecordatorios:ae,calcularCargaDiaria:Y,obtenerResumenSemanal:a=>{const t=new Date(a+"T00:00:00"),c=[];for(let s=0;s<7;s++){const m=new Date(t);m.setDate(t.getDate()+s);const f=m.toISOString().split("T")[0]||"";if(!f)continue;const h=Y(f);c.push({fecha:f,dia:m.toLocaleDateString("es-ES",{weekday:"short"}),citas:h.total,confirmadas:h.confirmadas,pendientes:h.pendientes})}return c},obtenerResumenMensual:(a,t)=>{const c=new Date(a,t+1,0),s=new Map;for(let m=1;m<=c.getDate();m++){const h=new Date(a,t,m).toISOString().split("T")[0]||"";if(!h)continue;const A=Y(h);s.set(h,{dia:m,citas:A.total,confirmadas:A.confirmadas,pendientes:A.pendientes})}return s},suscribirCitasRealtime:z,desuscribirCitasRealtime:J}}const Ne={class:"flex items-start justify-between gap-4"},Le={class:"flex-1 min-w-0"},Oe={class:"flex items-center gap-3 mb-2 flex-wrap"},qe={class:"flex items-center gap-2"},Pe={class:"truncate"},Ve={key:0,class:"text-gray-400"},Ie={key:1,class:"capitalize truncate"},Ue={key:0,class:"flex items-center gap-2"},We={class:"truncate"},Je={class:"flex items-center justify-between gap-2"},Ke={class:"flex-1 min-w-0"},Ye={class:"text-xs font-medium text-gray-700 mb-1"},Ge={class:"flex items-center gap-2 flex-wrap"},Qe={class:"text-xs text-gray-500 capitalize"},Xe={key:1,class:"mt-3 p-3 bg-gray-50 border border-gray-200 rounded-lg"},Ze={key:2,class:"mt-3 p-2 bg-gray-50 rounded text-xs text-gray-700"},et={class:"flex flex-col gap-2"},tt=he({__name:"TarjetaCita",props:{cita:{},compact:{type:Boolean}},emits:["completar","verHistorial"],setup(u,{emit:k}){const p=u,B=k,R=j=>j.substring(0,5),$=N(()=>{const j=p.cita.estado;return{pendiente:"bg-yellow-100 text-yellow-800 border-yellow-300",confirmada:"bg-blue-100 text-blue-800 border-blue-300",completada:"bg-green-100 text-green-800 border-green-300",realizada:"bg-green-100 text-green-800 border-green-300",cancelada:"bg-red-100 text-red-800 border-red-300"}[j]||"bg-gray-100 text-gray-800 border-gray-300"}),b=N(()=>{if(!p.cita.bono)return null;const j=p.cita.bono.sesiones_restantes,y=p.cita.bono.estado;return y==="completado"||j===0?{color:"text-red-600",icono:"üö´",alerta:!0,mensajeAlerta:"Bono agotado",clase:"bg-red-50 border-red-200"}:j===1?{color:"text-orange-600",icono:"‚ö†Ô∏è",alerta:!0,mensajeAlerta:"√öltima sesi√≥n del bono",clase:"bg-orange-50 border-orange-200"}:j<=2?{color:"text-yellow-600",icono:"‚ö†Ô∏è",alerta:!0,mensajeAlerta:"Pocas sesiones restantes",clase:"bg-yellow-50 border-yellow-200"}:y==="activo"?{color:"text-green-600",icono:"‚úì",alerta:!1,mensajeAlerta:null,clase:"bg-green-50 border-green-200"}:{color:"text-gray-600",icono:"‚ÑπÔ∏è",alerta:!1,mensajeAlerta:null,clase:"bg-gray-50 border-gray-200"}}),I=N(()=>p.cita.estado==="pendiente"||p.cita.estado==="confirmada");return(j,y)=>(i(),l("div",{class:_(["border rounded-xl shadow-sm hover:shadow-md transition-all duration-200 bg-white overflow-hidden",u.compact?"p-3":"p-5"])},[e("div",Ne,[e("div",Le,[e("div",Oe,[e("h3",{class:_([u.compact?"text-base":"text-lg","font-semibold text-gray-900 truncate"])},d(u.cita.paciente?.nombre_completo||"Paciente"),3),e("span",{class:_(["px-3 py-1 text-xs font-medium rounded-full border",v($)])},d(u.cita.estado.toUpperCase()),3)]),e("div",{class:_(["space-y-1",u.compact?"text-xs":"text-sm","text-gray-600"])},[e("div",qe,[y[2]||(y[2]=e("svg",{class:"h-4 w-4 flex-shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),e("span",Pe,d(R(u.cita.hora_inicio))+" - "+d(R(u.cita.hora_fin)),1),u.cita.modalidad?(i(),l("span",Ve,"‚Ä¢")):S("",!0),u.cita.modalidad?(i(),l("span",Ie,d(u.cita.modalidad),1)):S("",!0)]),u.cita.paciente?.telefono&&!u.compact?(i(),l("div",Ue,[y[3]||(y[3]=e("svg",{class:"h-4 w-4 flex-shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})],-1)),e("span",We,d(u.cita.paciente.telefono),1)])):S("",!0)],2),u.cita.bono?(i(),l("div",{key:0,class:_(["mt-3 p-3 rounded-lg border",v(b)?.clase||"bg-gray-50 border-gray-200"])},[e("div",Je,[e("div",Ke,[e("p",Ye,d(v(b)?.icono)+" Bono de Sesiones ",1),e("div",Ge,[e("p",{class:_(["text-sm font-semibold",v(b)?.color||"text-gray-900"])},d(u.cita.bono.sesiones_restantes)+" / "+d(u.cita.bono.sesiones_totales)+" sesiones ",3),e("span",Qe," ("+d(u.cita.bono.estado)+") ",1)]),v(b)?.alerta?(i(),l("p",{key:0,class:_(["mt-2 text-xs font-medium",v(b).color])},d(v(b).mensajeAlerta),3)):S("",!0)]),u.compact?S("",!0):(i(),l("button",{key:0,onClick:y[0]||(y[0]=X=>B("verHistorial",u.cita.bono.id)),class:"text-xs text-blue-600 hover:text-blue-800 font-medium whitespace-nowrap px-2 py-1 hover:bg-blue-50 rounded transition-colors",type:"button"}," üìä Historial "))])],2)):(i(),l("div",Xe,[...y[4]||(y[4]=[e("p",{class:"text-xs text-gray-500 italic flex items-center gap-2"},[e("svg",{class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})]),ge(" Sin bono activo - Consulta individual ")],-1)])])),u.cita.observaciones&&!u.compact?(i(),l("div",Ze,[y[5]||(y[5]=e("p",{class:"font-medium text-gray-500 mb-1"},"Observaciones:",-1)),ge(" "+d(u.cita.observaciones),1)])):S("",!0)]),e("div",et,[v(I)?(i(),l("button",{key:0,onClick:y[1]||(y[1]=X=>B("completar",u.cita.id)),class:_(["px-4 py-2 bg-green-600 text-white font-medium rounded-lg hover:bg-green-700 transition-colors",u.compact?"text-xs":"text-sm"]),type:"button"}," ‚úÖ Completar ",2)):u.cita.estado==="completada"||u.cita.estado==="realizada"?(i(),l("span",{key:1,class:_(["px-4 py-2 bg-green-100 text-green-800 font-medium rounded-lg text-center",u.compact?"text-xs":"text-sm"])}," ‚úì Completada ",2)):S("",!0)])])],2))}}),at=Object.assign(ve(tt,[["__scopeId","data-v-3085384e"]]),{__name:"TarjetaCita"}),ot={class:"space-y-3"},st={class:"bg-white/90 backdrop-blur-sm rounded-2xl shadow-sm border border-white/30 p-4"},rt={class:"flex items-center justify-between gap-3 mb-3"},nt={class:"flex items-center gap-3"},it={class:"text-sm text-neutral-600"},lt={class:"flex items-center gap-2"},ct={class:"flex bg-neutral-100 rounded-xl p-1"},dt={class:"flex items-center gap-1"},ut=["disabled"],mt={key:0},gt={key:1},ft={key:0,class:"flex flex-wrap gap-2"},pt=["onClick"],bt={key:0,class:"bg-gradient-to-r from-amber-50 to-orange-50 border border-amber-200 rounded-2xl p-4 mb-4 shadow-sm"},ht={class:"flex items-center gap-3"},vt={class:"flex-1"},xt={class:"text-sm font-medium text-amber-900"},_t={key:1,class:"bg-white/90 backdrop-blur-sm rounded-2xl shadow-sm border border-white/30 overflow-hidden flex flex-col",style:{height:"calc(100vh - 200px)"}},yt={class:"sticky top-0 z-10 bg-gradient-to-r from-white/95 via-white/90 to-white/95 backdrop-blur-md border-b border-neutral-200 shadow-sm p-4"},wt={class:"flex items-center justify-between"},kt={class:"font-['Elms_Sans'] font-semibold text-lg text-neutral-800"},Dt={class:"text-sm text-neutral-600 mt-1"},Ct={class:"flex-1 overflow-y-auto"},St={key:0,class:"flex items-center justify-center py-16"},Et={class:"text-center"},At={class:"text-neutral-600 text-sm"},$t={key:1,class:"divide-y divide-neutral-100"},jt=["data-hora"],Tt={class:"w-20 p-3 text-sm font-medium text-neutral-600 border-r border-neutral-200 bg-neutral-50/50 flex-shrink-0"},zt={class:"flex-1 p-3 cursor-pointer hover:bg-[#027368]/5 transition-colors relative group/cell"},Bt={key:0,class:"absolute inset-0 flex items-center justify-center opacity-0 group-hover/cell:opacity-100 transition-opacity pointer-events-none"},Rt=["onDragstart"],Ht={class:"flex items-start justify-between gap-3"},Mt={class:"opacity-0 group-hover:opacity-100 transition-opacity flex-shrink-0"},Ft={class:"flex-1"},Nt={class:"font-medium text-sm text-neutral-800"},Lt={class:"flex items-center gap-2 mt-1"},Ot={class:"text-xs text-neutral-600 font-medium"},qt={class:"text-xs px-2 py-1 rounded-lg bg-white/60 text-neutral-700"},Pt={class:"flex items-center gap-2"},Vt={key:1,class:"text-xs text-neutral-400 italic"},It={key:2,class:"bg-white/90 backdrop-blur-sm rounded-2xl shadow-sm border border-white/30 overflow-hidden flex flex-col",style:{height:"calc(100vh - 200px)"}},Ut={class:"min-w-[800px] overflow-x-auto flex-1 flex flex-col"},Wt={class:"sticky top-0 z-10 bg-white border-b border-gray-200 shadow-sm"},Jt={class:"grid grid-cols-8"},Kt={class:"flex items-center justify-center gap-1"},Yt={class:"text-xs font-medium text-gray-600 uppercase"},Gt={class:"text-xs text-gray-500"},Qt={class:"flex-1 overflow-y-auto"},Xt={class:"divide-y divide-gray-100"},Zt=["data-hora"],ea={class:"p-3 text-sm font-medium text-gray-600 border-r border-gray-100 bg-gray-50 sticky left-0"},ta=["onDragover","onDrop"],aa={key:0,class:"absolute inset-0 flex items-center justify-center opacity-0 group-hover/cell:opacity-100 transition-opacity pointer-events-none"},oa=["onDragstart"],sa={class:"opacity-0 group-hover:opacity-100 transition-opacity absolute top-1 left-1"},ra={class:"pl-5"},na={class:"font-semibold truncate text-sm"},ia={class:"text-xs text-gray-600 mt-0.5"},la={class:"flex items-center gap-1 mt-1"},ca={class:"text-xs px-1.5 py-0.5 rounded-full bg-white/60"},da={key:0,class:"text-xs text-green-700"},ua={key:3},ma={class:"flex flex-wrap gap-2 mb-6"},ga=["onClick"],fa={key:0,class:"bg-red-50 border-l-4 border-red-400 p-4 mb-6"},pa={class:"text-red-700"},ba={key:1,class:"text-center py-12"},ha={key:2,class:"text-center py-12 bg-gray-50 rounded-lg"},va={class:"mt-1 text-sm text-gray-500"},xa={key:3,class:"space-y-4"},_a={class:"bg-white rounded-lg shadow-xl max-w-3xl w-full max-h-[90vh] overflow-hidden"},ya={class:"px-6 py-4 overflow-y-auto max-h-[calc(90vh-140px)]"},wa={key:0,class:"text-center py-8"},ka={key:1},Da={key:0,class:"mb-6 p-4 bg-blue-50 rounded-lg"},Ca={class:"grid grid-cols-3 gap-4 text-center"},Sa={class:"text-2xl font-bold text-blue-600"},Ea={class:"text-2xl font-bold text-green-600"},Aa={key:0,class:"mt-3 p-2 bg-yellow-100 border border-yellow-300 rounded text-sm text-yellow-800"},$a={key:0,class:"text-center py-8 text-gray-500"},ja={key:1,class:"space-y-3"},Ta={class:"flex items-start justify-between"},za={class:"flex-1"},Ba={class:"flex items-center gap-2 mb-1"},Ra={class:"text-xs text-gray-500"},Ha={class:"text-sm text-gray-700"},Ma={class:"text-right ml-4"},Fa={class:"text-sm font-semibold text-gray-900"},Na=he({__name:"AgendaTerapeuta",setup(u){const{citas:k,loading:p,error:B,citasDelDia:R,citasPendientes:$,citasCompletadas:b,citasConBonoProximoAgotar:I,completarCita:j,getCitasDelTerapeuta:y,obtenerHistorialBono:X,verificarBonoCitas:V}=Fe(),re=xe(),O=C("hoy"),T=C("calendario"),D=C(new Date),U=C(!1),Z=C(null),W=C([]),z=C(null),J=C(!1),x=C(null),L=C(null),ee=["11:00","12:00","13:00","17:00","18:00","19:00","20:00","21:00","22:00"],oe=N(()=>{const n=new Date(D.value),o=n.getDay(),E=o===0?-6:1-o;n.setDate(n.getDate()+E);const r=[];for(let w=0;w<7;w++){const g=new Date(n);g.setDate(n.getDate()+w),r.push({fecha:g.toISOString().split("T")[0],nombreDia:g.toLocaleDateString("es-ES",{weekday:"short"}),numeroDia:g.getDate(),mes:g.toLocaleDateString("es-ES",{month:"short"})})}return r}),te=N(()=>{switch(O.value){case"hoy":return R.value;case"pendientes":return $.value;case"completadas":return b.value;default:return k.value}}),K=n=>n.substring(0,5),ne=n=>n.toLocaleDateString("es-ES",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),se=n=>n.toLocaleDateString("es-ES",{weekday:"long",day:"numeric",month:"long",year:"numeric"}),ie=n=>({pendiente:"bg-amber-100 text-amber-700 border border-amber-200",confirmada:"bg-green-100 text-green-700 border border-green-200",completada:"bg-blue-100 text-blue-700 border border-blue-200",realizada:"bg-blue-100 text-blue-700 border border-blue-200",cancelada:"bg-red-100 text-red-700 border border-red-200"})[n]||"bg-gray-100 text-gray-700 border border-gray-200",ae=n=>{const o=new Date().toISOString().split("T")[0];return n===o},Y=n=>{const o=new Date(D.value);T.value==="dia"?o.setDate(o.getDate()+n):o.setDate(o.getDate()+n*7),D.value=o},de=()=>{D.value=new Date},G=n=>{const o=D.value.toISOString().split("T")[0];return k.value.filter(E=>E.fecha_cita===o&&E.hora_inicio?.startsWith(n))},a=n=>({pendiente:"bg-yellow-100 border-l-4 border-yellow-500",confirmada:"bg-green-100 border-l-4 border-green-500",completada:"bg-blue-100 border-l-4 border-blue-500",realizada:"bg-blue-100 border-l-4 border-blue-500",cancelada:"bg-red-100 border-l-4 border-red-500"})[n]||"bg-gray-100 border-l-4 border-gray-500",t=n=>({pendiente:"Pendiente",confirmada:"Confirmada",completada:"Completada",realizada:"Realizada",cancelada:"Cancelada"})[n]||n,c=n=>n===0?"text-red-600 font-bold":n===1?"text-orange-600 font-semibold":n<=2?"text-yellow-600 font-medium":"text-green-600",s=(n,o)=>k.value.filter(E=>E.fecha_cita===n&&E.hora_inicio?.startsWith(o)),m=(n,o)=>{x.value=o,n.dataTransfer&&(n.dataTransfer.effectAllowed="move",n.dataTransfer.setData("text/html",n.target.innerHTML)),n.target.style.opacity="0.5"},f=n=>{n.target.style.opacity="1",x.value=null,L.value=null},h=(n,o,E)=>{n.preventDefault(),n.dataTransfer&&(n.dataTransfer.dropEffect="move"),L.value={fecha:o,hora:E}},A=n=>{L.value=null},Q=(n,o)=>L.value?.fecha===n&&L.value?.hora===o,ue=async(n,o,E)=>{if(n.preventDefault(),!x.value)return;const r=x.value,w=o,g=E;if(k.value.find(H=>H.fecha_cita===w&&H.hora_inicio?.startsWith(g)&&H.id!==r.id)){alert("Ya existe una cita en ese horario"),x.value=null,L.value=null;return}const we=((H,ke)=>{const[De,Ce]=H.split(":").map(Number),[Se,Ee]=ke.split(":").map(Number),[Ae,$e]=r.hora_inicio.split(":").map(Number),je=(Se||0)*60+(Ee||0)-((Ae||0)*60+($e||0)),me=(De||0)*60+(Ce||0)+je,Te=Math.floor(me/60),ze=me%60;return`${String(Te).padStart(2,"0")}:${String(ze).padStart(2,"0")}:00`})(g,r.hora_fin);try{const{error:H}=await re.from("citas").update({fecha_cita:w,hora_inicio:g+":00",hora_fin:we,updated_at:new Date().toISOString()}).eq("id",r.id);if(H){console.error("Error al mover cita:",H),alert("Error al mover la cita");return}await y()}catch(H){console.error("Error al mover cita:",H),alert("Error al mover la cita")}finally{x.value=null,L.value=null}},q=async n=>{if(confirm("¬øEst√°s seguro de marcar esta cita como completada?"))try{(await j(n)).success&&console.log("Cita completada")}catch(o){console.error("Error al completar cita:",o)}},_e=async n=>{try{J.value=!0,Z.value=n,U.value=!0;const[o,E]=await Promise.all([X(n),V(n)]);W.value=o,z.value=E}catch(o){console.error("Error al cargar historial:",o)}finally{J.value=!1}},le=()=>{U.value=!1,Z.value=null,W.value=[],z.value=null},ye=async()=>{try{await y()}catch(n){console.error("Error al recargar citas:",n)}};return(n,o)=>{const E=at;return i(),l("div",ot,[e("div",st,[e("div",rt,[e("div",nt,[o[10]||(o[10]=e("h1",{class:"text-xl font-['Elms_Sans'] font-bold text-neutral-800"},"Mi Agenda",-1)),e("span",it,d(ne(D.value)),1)]),e("div",lt,[e("div",ct,[e("button",{onClick:o[0]||(o[0]=r=>T.value="dia"),class:_(["px-3 py-1.5 rounded-lg text-sm font-medium transition-all",T.value==="dia"?"bg-white text-neutral-800 shadow-sm":"text-neutral-600 hover:text-neutral-800"])}," D√≠a ",2),e("button",{onClick:o[1]||(o[1]=r=>T.value="calendario"),class:_(["px-3 py-1.5 rounded-lg text-sm font-medium transition-all",T.value==="calendario"?"bg-white text-neutral-800 shadow-sm":"text-neutral-600 hover:text-neutral-800"])}," Semana ",2),e("button",{onClick:o[2]||(o[2]=r=>T.value="lista"),class:_(["px-3 py-1.5 rounded-lg text-sm font-medium transition-all",T.value==="lista"?"bg-white text-neutral-800 shadow-sm":"text-neutral-600 hover:text-neutral-800"])}," Lista ",2)]),e("div",dt,[e("button",{onClick:o[3]||(o[3]=r=>Y(-1)),class:"p-2 rounded-lg hover:bg-neutral-100 text-neutral-700 transition-all",title:"Anterior"}," ‚Üê "),e("button",{onClick:de,class:"px-3 py-1.5 bg-gradient-to-r from-[#04BF9D] to-[#027368] text-white hover:from-[#027368] hover:to-[#04BF9D] rounded-lg text-sm font-medium transition-all"}," Hoy "),e("button",{onClick:o[4]||(o[4]=r=>Y(1)),class:"p-2 rounded-lg hover:bg-neutral-100 text-neutral-700 transition-all",title:"Siguiente"}," ‚Üí ")]),e("button",{onClick:ye,class:"px-4 py-2 bg-white/80 backdrop-blur-sm border border-neutral-200 rounded-xl hover:bg-neutral-50 transition-all text-sm font-medium shadow-sm",disabled:v(p)},[v(p)?(i(),l("span",mt,"Actualizando...")):(i(),l("span",gt,"‚Üª Actualizar"))],8,ut)])]),T.value==="lista"?(i(),l("div",ft,[(i(!0),l(M,null,F([{key:"hoy",label:"Hoy",count:v(R).length},{key:"pendientes",label:"Pendientes",count:v($).length},{key:"completadas",label:"Completadas",count:v(b).length},{key:"todas",label:"Todas",count:v(k).length}],r=>(i(),l("button",{key:r.key,onClick:w=>O.value=r.key,class:_(["px-3 py-1.5 rounded-xl text-sm font-medium transition-all shadow-sm",O.value===r.key?"bg-gradient-to-r from-[#04BF9D] to-[#027368] text-white":"bg-white text-neutral-700 hover:bg-neutral-50 border border-neutral-200"])},d(r.label)+" ("+d(r.count)+") ",11,pt))),128))])):S("",!0)]),v(I).length>0?(i(),l("div",bt,[e("div",ht,[o[12]||(o[12]=e("div",{class:"w-10 h-10 rounded-xl bg-gradient-to-br from-[#F2B33D] to-[#F2B33D]/70 flex items-center justify-center flex-shrink-0"},[e("svg",{class:"h-5 w-5 text-white",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z","clip-rule":"evenodd"})])],-1)),e("div",vt,[e("p",xt," Atenci√≥n: "+d(v(I).length)+" paciente(s) con pocas sesiones restantes ",1),o[11]||(o[11]=e("p",{class:"text-xs text-amber-700 mt-1"}," Considera informar a estos pacientes para renovar sus bonos ",-1))])])])):S("",!0),T.value==="dia"?(i(),l("div",_t,[e("div",yt,[e("div",wt,[e("div",null,[e("h3",kt,d(se(D.value)),1),e("p",Dt,d(G?Object.values(ee).reduce((r,w)=>r+G(w).length,0):0)+" citas programadas ",1)])])]),e("div",Ct,[te.value.length===0?(i(),l("div",St,[e("div",Et,[o[13]||(o[13]=e("div",{class:"w-16 h-16 mx-auto mb-4 rounded-full bg-gradient-to-br from-[#027368]/10 to-[#04BF9D]/10 flex items-center justify-center"},[e("svg",{class:"w-8 h-8 text-[#027368]",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})])],-1)),o[14]||(o[14]=e("h3",{class:"font-['Elms_Sans'] font-medium text-neutral-800 mb-2"},"No hay citas programadas",-1)),e("p",At,d(se(D.value))+" est√° libre",1)])])):(i(),l("div",$t,[(i(),l(M,null,F(ee,(r,w)=>e("div",{key:r,"data-hora":r,class:"flex hover:bg-neutral-50/50 transition-colors"},[e("div",Tt,d(r),1),e("div",zt,[G(r).length===0?(i(),l("div",Bt,[...o[15]||(o[15]=[e("span",{class:"text-xs text-[#027368] font-medium bg-white px-3 py-1.5 rounded-full shadow-sm border border-white/50"}," Horario libre ",-1)])])):S("",!0),(i(!0),l(M,null,F(G(r),g=>(i(),l("div",{key:g.id,draggable:"true",onDragstart:P=>m(P,g),onDragend:o[5]||(o[5]=P=>f(P)),class:_(["mb-2 p-3 rounded-xl transition-all hover:shadow-md hover:ring-2 hover:ring-[#027368]/30 group relative cursor-move backdrop-blur-sm",a(g.estado)]),onClick:o[6]||(o[6]=ce(()=>{},["stop"])),title:"Arrastra para mover a otra hora"},[e("div",Ht,[e("div",Mt,[pe(v(be),{class:"w-4 h-4 text-neutral-500"})]),e("div",Ft,[e("p",Nt,d(g.paciente?.nombre_completo||"Sin nombre"),1),e("div",Lt,[e("span",Ot,d(K(g.hora_inicio))+" - "+d(K(g.hora_fin)),1),e("span",qt,d(g.modalidad),1)])]),e("div",Pt,[e("span",{class:_(["text-xs px-2 py-1 rounded-lg font-medium whitespace-nowrap",ie(g.estado)])},d(t(g.estado)),3)])])],42,Rt))),128)),G(r).length===0?(i(),l("div",Vt," Sin citas programadas ")):S("",!0)])],8,jt)),64))]))])])):T.value==="calendario"?(i(),l("div",It,[e("div",Ut,[e("div",Wt,[e("div",Jt,[o[16]||(o[16]=e("div",{class:"p-2 border-r border-gray-200 bg-gray-50"},null,-1)),(i(!0),l(M,null,F(oe.value,r=>(i(),l("div",{key:r.fecha,class:_(["p-2 text-center border-r border-gray-200 last:border-r-0",ae(r.fecha)?"bg-blue-50":"bg-white"])},[e("div",Kt,[e("span",Yt,d(r.nombreDia),1),e("span",{class:_(["text-lg font-bold text-gray-900",ae(r.fecha)?"text-blue-600":""])},d(r.numeroDia),3)]),e("div",Gt,d(r.mes),1)],2))),128))])]),e("div",Qt,[e("div",Xt,[(i(),l(M,null,F(ee,r=>e("div",{key:r,"data-hora":r,class:"grid grid-cols-8"},[e("div",ea,d(r),1),(i(!0),l(M,null,F(oe.value,w=>(i(),l("div",{key:`${w.fecha}-${r}`,class:_(["p-2 border-r border-gray-100 last:border-r-0 hover:bg-blue-50/30 transition-colors min-h-[70px] cursor-pointer relative group/cell",[ae(w.fecha)?"bg-blue-50/20":"",Q(w.fecha,r)?"bg-blue-100 ring-2 ring-blue-500 ring-inset":""]]),onDragover:g=>h(g,w.fecha,r),onDragleave:o[9]||(o[9]=g=>A()),onDrop:g=>ue(g,w.fecha,r)},[s(w.fecha,r).length===0?(i(),l("div",aa,[...o[17]||(o[17]=[e("span",{class:"text-xs text-blue-600 font-medium bg-white px-2 py-1 rounded-full shadow-sm"}," Libre ",-1)])])):S("",!0),(i(!0),l(M,null,F(s(w.fecha,r),g=>(i(),l("div",{key:g.id,draggable:"true",onDragstart:P=>m(P,g),onDragend:o[7]||(o[7]=P=>f(P)),class:_(["text-xs p-2 rounded-lg mb-1.5 hover:shadow-lg hover:ring-2 hover:ring-blue-400 transition-all group relative cursor-move",a(g.estado)]),onClick:o[8]||(o[8]=ce(()=>{},["stop"])),title:"Arrastra para mover"},[e("div",sa,[pe(v(be),{class:"w-3 h-3 text-gray-500"})]),e("div",ra,[e("p",na,d(g.paciente?.nombre_completo||"Sin nombre"),1),e("p",ia,d(K(g.hora_inicio))+" - "+d(K(g.hora_fin)),1),e("div",la,[e("span",ca,d(g.modalidad),1),g.bono?(i(),l("span",da," Bono ")):S("",!0)])])],42,oa))),128))],42,ta))),128))],8,Zt)),64))])])])])):(i(),l("div",ua,[e("div",ma,[(i(!0),l(M,null,F([{key:"hoy",label:"Hoy",count:v(R).length},{key:"pendientes",label:"Pendientes",count:v($).length},{key:"completadas",label:"Completadas",count:v(b).length},{key:"todas",label:"Todas",count:v(k).length}],r=>(i(),l("button",{key:r.key,onClick:w=>O.value=r.key,class:_(["px-4 py-2 rounded-lg font-medium transition-colors",O.value===r.key?"bg-blue-600 text-white":"bg-white text-gray-700 hover:bg-gray-50 border border-gray-300"])},d(r.label)+" ("+d(r.count)+") ",11,ga))),128))]),v(B)?(i(),l("div",fa,[e("p",pa,d(v(B)),1)])):S("",!0),v(p)&&v(k).length===0?(i(),l("div",ba,[...o[18]||(o[18]=[e("div",{class:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"},null,-1),e("p",{class:"text-gray-600"},"Cargando citas...",-1)])])):te.value.length===0?(i(),l("div",ha,[o[19]||(o[19]=e("svg",{class:"mx-auto h-12 w-12 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1)),o[20]||(o[20]=e("h3",{class:"mt-2 text-sm font-medium text-gray-900"},"No hay citas",-1)),e("p",va,d(O.value==="hoy"?"No tienes citas programadas para hoy.":"No hay citas en esta categor√≠a."),1)])):(i(),l("div",xa,[(i(!0),l(M,null,F(te.value,r=>(i(),fe(E,{key:r.id,cita:r,onCompletar:q,onVerHistorial:_e},null,8,["cita"]))),128))]))])),(i(),fe(Me,{to:"body"},[U.value?(i(),l("div",{key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",onClick:ce(le,["self"])},[e("div",_a,[e("div",{class:"px-6 py-4 border-b border-gray-200 flex items-center justify-between"},[o[22]||(o[22]=e("h2",{class:"text-xl font-bold text-gray-900"},"Historial del Bono",-1)),e("button",{onClick:le,class:"text-gray-400 hover:text-gray-600 transition-colors"},[...o[21]||(o[21]=[e("svg",{class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),e("div",ya,[J.value?(i(),l("div",wa,[...o[23]||(o[23]=[e("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"},null,-1)])])):(i(),l("div",ka,[z.value?(i(),l("div",Da,[o[27]||(o[27]=e("h3",{class:"font-semibold text-gray-900 mb-3"},"Resumen",-1)),e("div",Ca,[e("div",null,[e("p",Sa,d(z.value.bono.sesiones_totales),1),o[24]||(o[24]=e("p",{class:"text-xs text-gray-600"},"Sesiones Totales",-1))]),e("div",null,[e("p",Ea,d(z.value.bono.sesiones_usadas),1),o[25]||(o[25]=e("p",{class:"text-xs text-gray-600"},"Sesiones Usadas",-1))]),e("div",null,[e("p",{class:_(["text-2xl font-bold",c(z.value.bono.sesiones_restantes)])},d(z.value.bono.sesiones_restantes),3),o[26]||(o[26]=e("p",{class:"text-xs text-gray-600"},"Sesiones Restantes",-1))])]),z.value.alerta?(i(),l("div",Aa,d(z.value.mensaje_alerta),1)):S("",!0)])):S("",!0),e("div",null,[o[28]||(o[28]=e("h3",{class:"font-semibold text-gray-900 mb-3"},"Movimientos",-1)),W.value.length===0?(i(),l("div",$a," No hay movimientos registrados ")):(i(),l("div",ja,[(i(!0),l(M,null,F(W.value,r=>(i(),l("div",{key:r.id,class:"border border-gray-200 rounded-lg p-4 hover:bg-gray-50 transition-colors"},[e("div",Ta,[e("div",za,[e("div",Ba,[e("span",{class:_(["px-2 py-1 text-xs font-medium rounded",r.tipo_movimiento==="descuento"?"bg-red-100 text-red-700":r.tipo_movimiento==="reembolso"?"bg-green-100 text-green-700":"bg-gray-100 text-gray-700"])},d(r.tipo_movimiento),3),e("span",Ra,d(new Date(r.fecha).toLocaleString("es-ES")),1)]),e("p",Ha,d(r.motivo),1)]),e("div",Ma,[e("p",Fa,d(r.sesiones_antes)+" ‚Üí "+d(r.sesiones_despues),1),e("p",{class:_(["text-xs font-medium",r.sesiones_modificadas>0?"text-red-600":"text-green-600"])},d(r.sesiones_modificadas>0?"-":"+")+d(Math.abs(r.sesiones_modificadas)),3)])])]))),128))]))])]))]),e("div",{class:"px-6 py-4 border-t border-gray-200 flex justify-end"},[e("button",{onClick:le,class:"px-4 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300 transition-colors"}," Cerrar ")])])])):S("",!0)]))])}}}),Ia=Object.assign(ve(Na,[["__scopeId","data-v-040d0550"]]),{__name:"AgendaTerapeuta"});export{Ia as _,at as a,Fe as u};
