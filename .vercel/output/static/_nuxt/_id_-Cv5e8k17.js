import{r as p,I as _e,c as l,o as i,a as e,j as b,d as y,k as s,t as n,m as G,v as ce,E as fe,l as ge,p as H,O as qe,e as Ve,g as Ue,B as Le,al as Oe,L as Ge,z as x,s as He,b as re,A as be,n as h,K as ve,F as $,i as A,y as de}from"#entry";import{_ as he}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{_ as Ke}from"./ModalNuevaCita-zx-2eD6_.js";import{M as Ye}from"./ModalDetallesCita-CxtIMQaR.js";import{u as We}from"./useCitas-CnBtv5jB.js";import"./CheckCircleIcon-Bi0YyG7H.js";import"./CalendarIcon-mZ3toP8Y.js";import"./TicketIcon-DRclOuRO.js";import"./MagnifyingGlassIcon-B5My0XuL.js";import"./XCircleIcon-DIGsvT-h.js";import"./UserIcon-G1mM6o1b.js";import"./ExclamationTriangleIcon-BreoAuwB.js";import"./UserGroupIcon-Byc3y-S3.js";import"./ClockIcon-CQZt9cKZ.js";import"./DocumentTextIcon-Dp_75vtG.js";import"./PhoneIcon-B4J2dtua.js";import"./CheckBadgeIcon-CuVUaEjS.js";import"./PaymentMethodSelector-BdCeWAUw.js";import"./useToast-Cq0GyJHs.js";import"./ModalNuevoBono-DZsr-zos.js";import"./useBonos-BSiCGD07.js";import"./XMarkIcon-DWNj0d99.js";import"./PencilIcon-QJyqa3i7.js";import"./CalendarDaysIcon-C0vq0F4x.js";import"./ChevronDownIcon-BwiNUDLV.js";import"./PlusIcon-UqRq4KLf.js";const Qe={class:"bg-white rounded-xl shadow-sm border border-[#E2E8F0]/40 p-6"},Je={class:"flex items-center justify-between mb-4"},Xe={key:0,class:"min-h-[200px]"},Ze={key:0,class:"prose prose-sm max-w-none text-cafe/80 whitespace-pre-wrap"},et={key:1,class:"text-center py-8"},tt={key:1},st=["onKeydown"],ot={class:"mt-2 flex items-center justify-between text-xs text-cafe/60"},at={key:0},nt={class:"mt-4 flex items-center gap-3"},lt=["disabled"],it={key:0},rt={key:1},dt=["disabled"],ct={key:2,class:"mt-4 pt-4 border-t border-gray-100"},pt={class:"text-xs text-cafe/50"},ut={__name:"NotasPrivadas",props:{pacienteId:{type:String,required:!0},contenido:{type:String,default:""},ultimaActualizacion:{type:String,default:null}},emits:["guardar","actualizar"],setup(F,{emit:D}){const S=F,Z=D,w=p(!1),f=p(!1),_=p(S.contenido),E=p(S.contenido),d=p(null);_e(()=>S.contenido,v=>{w.value||(_.value=v,E.value=v)});const u=()=>{w.value=!0,qe(()=>{d.value?.focus()})},k=()=>{_.value=E.value,w.value=!1},T=async()=>{if(!f.value){f.value=!0;try{await Z("guardar",{pacienteId:S.pacienteId,contenido:_.value}),E.value=_.value,w.value=!1;const v=event?.target;v&&(v.textContent="‚úì Guardado",setTimeout(()=>{v.textContent="üíæ Guardar cambios"},2e3))}catch(v){console.error("Error al guardar notas:",v),alert("Hubo un error al guardar las notas. Por favor, int√©ntalo de nuevo.")}finally{f.value=!1}}},M=v=>v?new Date(v).toLocaleString("es-ES",{day:"numeric",month:"long",year:"numeric",hour:"2-digit",minute:"2-digit"}):"";return(v,g)=>(i(),l("div",Qe,[e("div",Je,[g[1]||(g[1]=e("h3",{class:"font-serif text-lg font-semibold text-cafe flex items-center gap-2"},[e("span",{class:"text-xl"},"üìù"),y(" Notas Cl√≠nicas Privadas ")],-1)),s(w)?b("",!0):(i(),l("button",{key:0,onClick:u,class:"px-3 py-1.5 text-sm bg-purple-600 text-white rounded-lg hover:bg-purple-600/90 transition-colors"}," ‚úèÔ∏è Editar "))]),g[5]||(g[5]=e("div",{class:"mb-4 p-3 bg-rosa/20 border border-rosa rounded-lg"},[e("p",{class:"text-xs text-cafe/70 flex items-start gap-2"},[e("span",{class:"text-purple-600"},"üîí"),e("span",null," Esta informaci√≥n es estrictamente confidencial y solo visible para ti como terapeuta. Cumple con los est√°ndares de protecci√≥n de datos cl√≠nicos. ")])],-1)),s(w)?(i(),l("div",tt,[G(e("textarea",{ref_key:"textareaRef",ref:d,"onUpdate:modelValue":g[0]||(g[0]=R=>H(_)?_.value=R:null),placeholder:`Anota observaciones, reflexiones o aspectos a seguir trabajando...

‚Ä¢ Progreso observado en la sesi√≥n
‚Ä¢ Temas pendientes de abordar
‚Ä¢ Estrategias que funcionan
‚Ä¢ Aspectos que requieren atenci√≥n`,class:"w-full min-h-[300px] px-4 py-3 bg-base-bg rounded-lg border border-purple-600/30 focus:border-purple-600 focus:outline-none focus:ring-2 focus:ring-purple-300/20 transition-all text-cafe resize-y",onKeydown:[fe(ge(T,["meta"]),["enter"]),fe(ge(T,["ctrl"]),["enter"])]},null,40,st),[[ce,s(_)]]),e("div",ot,[g[4]||(g[4]=e("span",null," üí° Presiona Cmd/Ctrl + Enter para guardar r√°pidamente ",-1)),F.ultimaActualizacion?(i(),l("span",at," √öltima actualizaci√≥n: "+n(M(F.ultimaActualizacion)),1)):b("",!0)]),e("div",nt,[e("button",{onClick:T,disabled:s(f),class:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-600/90 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2"},[s(f)?(i(),l("span",it,"‚è≥")):(i(),l("span",rt,"üíæ")),e("span",null,n(s(f)?"Guardando...":"Guardar cambios"),1)],8,lt),e("button",{onClick:k,disabled:s(f),class:"px-4 py-2 bg-white border border-cafe/20 text-cafe rounded-lg hover:bg-gray-50 transition-colors"}," Cancelar ",8,dt)])])):(i(),l("div",Xe,[s(_)?(i(),l("div",Ze,n(s(_)),1)):(i(),l("div",et,[g[2]||(g[2]=e("span",{class:"text-5xl mb-3 block opacity-40"},"üìã",-1)),g[3]||(g[3]=e("p",{class:"text-cafe/50 italic"}," A√∫n no hay notas registradas para este paciente ",-1)),e("button",{onClick:u,class:"mt-4 px-4 py-2 text-sm bg-purple-600/10 text-purple-600 rounded-lg hover:bg-purple-600/20 transition-colors"}," A√±adir primera nota ")]))])),!s(w)&&F.ultimaActualizacion?(i(),l("div",ct,[e("p",pt," √öltima modificaci√≥n: "+n(M(F.ultimaActualizacion)),1)])):b("",!0)]))}},xt=he(ut,[["__scopeId","data-v-b66842cb"]]),mt={class:"pb-20"},ft={key:0,class:"text-center py-12"},gt={key:1,class:"text-center py-12"},bt={class:"bg-white rounded-xl p-6 shadow-sm hover:shadow-md transition-shadow duration-300"},vt={class:"text-cafe/60 mb-4"},_t={key:2},ht={class:"bg-white rounded-xl p-6 shadow-sm hover:shadow-md transition-shadow duration-300 mb-6"},yt={class:"flex flex-col lg:flex-row lg:items-start lg:justify-between gap-6"},wt={class:"flex items-start gap-4"},kt={class:"text-3xl font-serif font-bold text-cafe mb-2"},Ct={class:"flex flex-wrap items-center gap-3 mb-3"},Pt={class:"text-cafe/60 text-sm flex items-center gap-1"},Dt={class:"space-y-1 text-sm"},St={key:0,class:"text-cafe/70 flex items-center gap-2"},Et={key:1,class:"text-cafe/70 flex items-center gap-2"},$t={key:2,class:"text-cafe/70 flex items-center gap-2"},At={class:"grid grid-cols-1 lg:grid-cols-3 gap-6 mb-6"},Tt={class:"bg-white rounded-xl p-6 shadow-sm hover:shadow-md transition-shadow duration-300"},zt={class:"space-y-3"},jt={class:"flex items-center justify-between p-3 bg-base-bg rounded-lg"},Nt={class:"font-bold text-cafe text-lg"},Bt={class:"flex items-center justify-between p-3 bg-green-50 rounded-lg"},Ft={class:"font-bold text-green-600 text-lg"},Mt={class:"flex items-center justify-between p-3 bg-yellow-50 rounded-lg"},Rt={class:"font-bold text-yellow-600 text-lg"},It={class:"flex items-center justify-between p-3 bg-blue-50 rounded-lg"},qt={class:"font-bold text-blue-600 text-lg"},Vt={class:"bg-white rounded-xl p-6 shadow-sm hover:shadow-md transition-shadow duration-300"},Ut={key:0,class:"space-y-4"},Lt={class:"p-3 bg-gradient-to-r from-purple-100 to-purple-50 border border-purple-200 rounded-lg"},Ot={class:"text-sm font-bold text-purple-900"},Gt={class:"text-center p-4 bg-gradient-to-br from-purple-600/10 to-rosa/20 rounded-xl"},Ht={class:"text-4xl font-bold text-purple-600 mb-1"},Kt={class:"text-sm text-cafe/70"},Yt={class:"space-y-2"},Wt={class:"flex justify-between text-sm"},Qt={class:"font-medium text-cafe"},Jt={class:"w-full bg-gray-200 rounded-full h-2.5"},Xt={class:"pt-3 border-t space-y-2 text-sm"},Zt={class:"flex justify-between"},es={class:"font-medium text-cafe"},ts={class:"flex justify-between"},ss={class:"font-medium text-cafe"},os={class:"flex justify-between"},as={class:"font-medium text-cafe"},ns={class:"flex justify-between"},ls={key:1,class:"text-center py-8"},is={class:"text-xs text-cafe/40 mb-4"},rs={class:"bg-white rounded-xl p-6 shadow-sm hover:shadow-md transition-shadow duration-300"},ds={class:"space-y-3"},cs={class:"p-3 bg-base-bg rounded-lg"},ps={class:"text-sm font-medium text-cafe"},us={class:"p-3 bg-base-bg rounded-lg"},xs={class:"text-sm font-medium text-cafe"},ms={key:0,class:"p-4 bg-gradient-to-br from-purple-600/20 to-rosa/20 border-2 border-purple-600/40 rounded-lg"},fs={class:"text-base font-bold text-cafe mb-3"},gs={class:"flex items-center gap-2 flex-wrap"},bs={class:"text-xs px-3 py-1.5 bg-white border border-purple-600/30 rounded-full font-medium flex items-center gap-1"},vs={key:0,class:"mt-3 pt-3 border-t border-purple-600/20"},_s={class:"text-xs text-cafe"},hs={key:1,class:"p-4 bg-yellow-50 border border-yellow-200 rounded-lg"},ys={class:"p-3 bg-base-bg rounded-lg"},ws={class:"text-sm font-medium text-cafe"},ks={class:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6"},Cs={class:"bg-white rounded-xl p-6 shadow-sm hover:shadow-md transition-shadow duration-300"},Ps={class:"flex items-center justify-between mb-4"},Ds=["value"],Ss={class:"grid grid-cols-2 gap-3"},Es={class:"p-3 bg-gradient-to-br from-purple-50 to-rosa/20 rounded-lg text-center"},$s={class:"text-3xl font-bold text-purple-600"},As={class:"p-3 bg-red-50 rounded-lg text-center"},Ts={class:"text-3xl font-bold text-red-500"},zs={class:"p-3 bg-yellow-50 rounded-lg text-center"},js={class:"text-2xl font-bold text-yellow-600"},Ns={class:"p-3 bg-green-50 rounded-lg text-center"},Bs={class:"text-2xl font-bold text-green-600"},Fs={class:"bg-white rounded-xl p-6 shadow-sm hover:shadow-md transition-shadow duration-300"},Ms={class:"flex items-center justify-between mb-4"},Rs=["value"],Is={key:0},qs={class:"text-4xl font-bold text-red-600 mb-2"},Vs={class:"text-xs text-red-500 mt-1"},Us={key:1},Ls={class:"bg-white rounded-xl p-6 shadow-sm hover:shadow-md transition-shadow duration-300 mb-6"},Os={class:"flex flex-col lg:flex-row lg:items-center justify-between gap-4 mb-4"},Gs={class:"flex items-center gap-3 flex-wrap"},Hs={class:"flex items-center gap-2"},Ks={class:"flex items-center gap-2"},Ys={key:0,class:"overflow-x-auto"},Ws={class:"w-full text-sm"},Qs={class:"px-4 py-3 text-cafe/60"},Js={class:"px-4 py-3"},Xs={class:"font-medium text-cafe"},Zs={class:"text-xs text-cafe/60"},eo={class:"px-4 py-3"},to={class:"px-4 py-3"},so={class:"px-4 py-3 text-right font-medium text-cafe"},oo={class:"px-4 py-3"},ao={key:0,class:"inline-flex items-center gap-1 px-2 py-1 text-xs rounded-full bg-green-100 text-green-700"},no={key:1,class:"inline-flex items-center gap-1 px-2 py-1 text-xs rounded-full bg-red-100 text-red-700"},lo={key:2,class:"text-xs text-cafe/50"},io={key:1,class:"text-center py-12"},ro={class:"mb-6"},co={class:"border-b border-gray-200"},po={class:"-mb-px flex space-x-8 overflow-x-auto"},uo=["onClick"],xo={class:"mr-2"},mo={key:0,class:"ml-2 px-2 py-0.5 text-xs rounded-full bg-purple-600 text-white"},fo={class:"space-y-6"},go={key:0},bo={class:"bg-white rounded-xl p-6 shadow-sm hover:shadow-md transition-shadow duration-300"},vo={key:0,class:"space-y-3"},_o={class:"flex items-start justify-between gap-4"},ho={class:"flex-1"},yo={class:"flex items-center gap-2 mb-2"},wo={class:"text-lg font-semibold text-cafe"},ko={class:"text-base font-medium text-purple-600"},Co={class:"flex flex-wrap items-center gap-2 mb-2"},Po={key:0,class:"text-sm text-cafe/60 mt-2"},Do=["onClick"],So={key:1,class:"text-center py-12"},Eo={key:1},$o={class:"bg-white rounded-xl p-6 shadow-sm hover:shadow-md transition-shadow duration-300"},Ao={key:0,class:"space-y-3"},To={class:"flex items-start justify-between gap-4"},zo={class:"flex-1"},jo={class:"flex items-center gap-2 mb-2"},No={class:"text-base font-semibold text-cafe"},Bo={class:"text-sm text-cafe/60"},Fo={class:"flex items-center gap-2 mb-2"},Mo={key:0,class:"text-sm text-cafe/70 mt-2 bg-white p-3 rounded-lg border border-gray-100"},Ro={key:1,class:"text-sm text-cafe/60 mt-2"},Io={key:1,class:"text-center py-12"},qo={key:2},Vo={class:"bg-white rounded-xl p-6 shadow-sm hover:shadow-md transition-shadow duration-300"},Uo={key:0,class:"space-y-3"},Lo={class:"flex items-start justify-between gap-4"},Oo={class:"flex-1"},Go={class:"flex items-center gap-2 mb-2"},Ho={class:"text-base font-semibold text-cafe"},Ko={class:"text-base font-medium text-purple-600"},Yo={class:"flex items-center gap-2 mb-2"},Wo={key:0,class:"text-sm text-cafe/60 mt-2"},Qo={class:"flex gap-2"},Jo=["onClick"],Xo=["onClick"],Zo={key:1,class:"text-center py-12"},ea={key:3},ta={class:"bg-white rounded-xl p-6 shadow-sm hover:shadow-md transition-shadow duration-300"},sa={key:0,class:"space-y-3"},oa={class:"flex items-start justify-between gap-4"},aa={class:"flex-1"},na={class:"flex items-center gap-2 mb-2"},la={class:"text-base font-semibold text-cafe"},ia={class:"text-sm text-cafe/60"},ra={class:"flex flex-wrap items-center gap-2"},da={key:1,class:"text-center py-12"},ca={class:"mt-6"},pa={class:"bg-white rounded-xl p-6 shadow-sm hover:shadow-md transition-shadow duration-300"},ua=Ve({__name:"[id]",setup(F){const D=Ue(),S=Le(),{getCitas:Z}=We(),w=Oe();Ge();const f=x(()=>w.params.id||""),_=p(!0),E=p(null),d=p(null),u=p(null),k=p([]),T=p(""),M=p(null),v=p([]),g=new Date().getFullYear(),R=p(g),K=p(g),z=p(""),j=p(""),pe=x(()=>{const o=[];for(let t=g;t>=g-4;t--)o.push(t);return o}),I=p("proximas"),ee=p(!1),te=p(null),se=p(!1),oe=p(null),ye=x(()=>[{id:"proximas",nombre:"Pr√≥ximas Sesiones",icono:"üìÖ",badge:N.value.proximas||null},{id:"completadas",nombre:"Completadas",icono:"‚úÖ",badge:N.value.completadas||null},{id:"pendientes",nombre:"Pendientes",icono:"‚è≥",badge:N.value.pendientes||null},{id:"anteriores",nombre:"Historial",icono:"üìö",badge:null}]),Y=async()=>{_.value=!0,E.value=null;try{if(!S.value){E.value="Usuario no autenticado";return}const{data:o,error:t}=await D.from("pacientes").select("*").eq("id",f.value).single();if(t)throw t;const r=o.nombre_completo||o.email||"Sin nombre";d.value={...o,nombre_completo:r,email:o.email||"",telefono:o.telefono||""};const c=await Z();k.value=c.filter(P=>P.paciente_id===f.value),await we(),await ke(),await Ce()}catch(o){console.error("Error al cargar paciente:",o),E.value=o.message||"Error desconocido"}finally{_.value=!1}},we=async()=>{try{const{data:o,error:t}=await D.from("bonos").select("*").eq("paciente_id",f.value).in("estado",["activo","pendiente"]).gt("sesiones_restantes",0).order("created_at",{ascending:!1}).limit(1).maybeSingle();if(t){console.warn("[Bonos] Error en consulta:",t.message);return}if(o){const r=o.sesiones_totales||0,c=o.sesiones_restantes||0,P=r-c;u.value={...o,sesiones_usadas:P,sesiones_disponibles:c,porcentaje_uso:r>0?Math.round(P/r*100):0},console.info(`[Bonos] Bono activo cargado para paciente: ${o.tipo} (${c}/${r} disponibles)`)}else u.value=null,console.info("[Bonos] No se encontr√≥ bono activo para este paciente")}catch(o){console.warn("[Bonos] Error inesperado:",o)}},ke=async()=>{try{const{data:o,error:t}=await D.from("pagos").select("*").eq("paciente_id",f.value).order("created_at",{ascending:!1});if(t){console.warn("[Pagos] Error al cargar:",t.message);return}v.value=o||[],console.info(`[Pagos] Cargados ${v.value.length} pagos para el paciente`)}catch(o){console.warn("[Pagos] Error inesperado:",o)}},Ce=async()=>{try{const{data:o}=await D.from("notas_terapeuticas").select("contenido, updated_at").eq("paciente_id",f.value).eq("terapeuta_id",S.value?.id).order("updated_at",{ascending:!1}).limit(1).maybeSingle();o&&(T.value=o.contenido||"",M.value=o.updated_at)}catch(o){console.error("Error al cargar notas:",o)}},Pe=async({pacienteId:o,contenido:t})=>{try{const{data:r}=await D.from("notas_terapeuticas").select("id").eq("paciente_id",o).eq("terapeuta_id",S.value?.id).maybeSingle();r?await D.from("notas_terapeuticas").update({contenido:t,updated_at:new Date().toISOString()}).eq("id",r.id):await D.from("notas_terapeuticas").insert({paciente_id:o,terapeuta_id:S.value?.id,contenido:t}),T.value=t,M.value=new Date().toISOString()}catch(r){throw console.error("Error al guardar notas:",r),r}},U=x(()=>{const o=new Date;return k.value.filter(t=>["pendiente","confirmada"].includes(t.estado)&&new Date(t.fecha_cita)>=o).sort((t,r)=>new Date(t.fecha_cita).getTime()-new Date(r.fecha_cita).getTime())}),L=x(()=>k.value.filter(o=>o.estado==="realizada").sort((o,t)=>new Date(t.fecha_cita).getTime()-new Date(o.fecha_cita).getTime())),ae=x(()=>k.value.filter(o=>o.estado==="pendiente").sort((o,t)=>new Date(o.fecha_cita).getTime()-new Date(t.fecha_cita).getTime())),ue=x(()=>k.value.sort((o,t)=>new Date(t.fecha_cita).getTime()-new Date(o.fecha_cita).getTime())),N=x(()=>({total:k.value.length,completadas:L.value.length,pendientes:ae.value.length,proximas:U.value.length})),W=x(()=>{const o=R.value,t=k.value.filter(m=>new Date(m.fecha_cita).getFullYear()===o),r=t.length,c=t.filter(m=>m.estado==="realizada").length,P=t.filter(m=>m.estado==="cancelada").length,a=t.filter(m=>["pendiente","confirmada"].includes(m.estado)).length;return{total:r,realizadas:c,canceladas:P,programadas:a}}),Q=x(()=>{const o=K.value,t=v.value.filter(a=>new Date(a.created_at||a.fecha).getFullYear()===o&&a.estado==="pendiente"),r=k.value.filter(a=>new Date(a.fecha_cita).getFullYear()===o&&a.estado==="realizada"&&!a.pagado),c=t.reduce((a,m)=>a+(m.monto||0),0),P=r.reduce((a,m)=>a+(m.precio_sesion||0),0);return{totalPendiente:c+P,cantidadPendientes:t.length+r.length,haDeuda:c+P>0}}),ne=x(()=>{let o=[...k.value];if(z.value){const t=new Date(z.value);o=o.filter(r=>new Date(r.fecha_cita)>=t)}if(j.value){const t=new Date(j.value);o=o.filter(r=>new Date(r.fecha_cita)<=t)}return o.sort((t,r)=>new Date(r.fecha_cita).getTime()-new Date(t.fecha_cita).getTime())}),De=x(()=>{const o=L.value;return o.length>0?o[o.length-1].fecha_cita:null}),Se=x(()=>{const o=L.value;return o.length>0?o[0].fecha_cita:null}),C=x(()=>U.value.length>0?U.value[0]:null),q=x(()=>d.value?.nombre_completo||"Sin nombre"),Ee=x(()=>{if(!q.value)return"?";const o=q.value.split(" ");return o.length>=2&&o[0]&&o[1]?`${o[0][0]}${o[1][0]}`.toUpperCase():q.value.substring(0,2).toUpperCase()}),$e=x(()=>{const o=["#D8AFA0","#C89B8A","#B7C6B0","#A8C5B5","#D4A5A5","#C4B5A0"],t=f.value.charCodeAt(0)%o.length;return o[t]}),Ae=x(()=>d.value?d.value.activo?d.value.metadata?.en_pausa?"En pausa":"En proceso":"Finalizado":""),Te=x(()=>d.value?d.value.activo?d.value.metadata?.en_pausa?"bg-yellow-100 text-yellow-700":"bg-green-100 text-green-700":"bg-gray-100 text-gray-600":""),le=x(()=>d.value?.tipo_bono?{a_demanda:"A Demanda (1 sesi√≥n)",quincenal:"Quincenal (2 sesiones/mes)",semanal:"Semanal (4 sesiones/mes)"}[d.value.tipo_bono]||d.value.tipo_bono:""),B=o=>{if(!o)return"";try{return new Date(o+"T00:00:00").toLocaleDateString("es-ES",{weekday:"short",day:"numeric",month:"short",year:"numeric"})}catch{return o}},ze=(o,t)=>{if(!o)return"";try{return new Date(o+"T"+(t||"00:00:00")).toLocaleString("es-ES",{weekday:"long",day:"numeric",month:"long",year:"numeric",hour:"2-digit",minute:"2-digit"})}catch{return o}},J=o=>new Intl.NumberFormat("es-ES",{style:"currency",currency:"EUR"}).format(o||0),je=o=>{if(!o)return"";const t=new Date(o),c=Math.floor((new Date().getTime()-t.getTime())/(1e3*60*60*24));return c<30?`${c} d√≠as`:c<365?`${Math.floor(c/30)} meses`:`${Math.floor(c/365)} a√±os`},V=o=>({presencial:"üè•",online:"üíª",telefonica:"üìû"})[o]||"üìã",O=o=>({presencial:"bg-green-100 text-green-700",online:"bg-purple-600/20 text-purple-600",telefonica:"bg-blue-100 text-blue-700"})[o]||"bg-gray-100 text-gray-700",ie=o=>({pendiente:"bg-yellow-100 text-yellow-700",confirmada:"bg-green-100 text-green-700",realizada:"bg-blue-100 text-blue-700",cancelada:"bg-red-100 text-red-700"})[o]||"bg-gray-100 text-gray-700",xe=()=>{if(!f.value){console.error("[Paciente/[id]] ERROR: ID de paciente no v√°lido");return}console.log("[Paciente/[id]] Navegando a bonos del paciente:",f.value),de(`/terapeuta/pacientes/${f.value}/bonos`)},Ne=()=>{const o=d.value?.telefono;if(!o){alert("Este paciente no tiene tel√©fono registrado");return}const t=o.replace(/\D/g,""),r=encodeURIComponent(`Hola ${q.value}, ¬øc√≥mo est√°s?`),c=`https://wa.me/${t}?text=${r}`;window.open(c,"_blank")},X=()=>{d.value&&(te.value={id:d.value.id,nombre:q.value,email:d.value.email,telefono:d.value.telefono,frecuencia:d.value.frecuencia||"semanal",area_acompanamiento:d.value.area_de_acompanamiento},ee.value=!0)},Be=()=>{ee.value=!1,te.value=null},Fe=()=>{Y()},me=o=>{oe.value=o,se.value=!0},Me=()=>{se.value=!1,oe.value=null},Re=async o=>{try{const{data:t,error:r}=await D.rpc("confirmar_cita_y_descontar_bono",{p_cita_id:o});if(r)throw r;if(!t.success){console.error("Error en la confirmaci√≥n:",t.error),alert(t.error||"Error al confirmar la cita");return}let c=`Cita confirmada con ${t.paciente_nombre||"paciente"}`;t.bono_id&&(c+=`
Sesiones restantes en bono: ${t.sesiones_restantes}`,t.bono_agotado?c+=`
‚ö†Ô∏è BONO AGOTADO`:t.sesiones_restantes<=2&&(c+=`
‚ö†Ô∏è Pocas sesiones restantes`)),alert(c),await Y()}catch(t){console.error("Error al confirmar cita:",t),alert("Error al confirmar la cita: "+t.message)}},Ie=()=>{alert("Funci√≥n de editar en desarrollo")};return He(()=>{Y()}),_e(()=>w.params.id,()=>{w.params.id&&Y()}),(o,t)=>{const r=xt,c=Ke,P=Ye;return i(),l("div",mt,[e("button",{onClick:t[0]||(t[0]=a=>("navigateTo"in o?o.navigateTo:s(de))("/terapeuta/pacientes")),class:"mb-6 flex items-center gap-2 text-cafe hover:text-purple-600 transition-colors"},[...t[7]||(t[7]=[e("span",null,"‚Üê",-1),e("span",null,"Volver a lista de pacientes",-1)])]),s(_)?(i(),l("div",ft,[...t[8]||(t[8]=[e("div",{class:"animate-spin w-12 h-12 border-4 border-purple-600 border-t-transparent rounded-full mx-auto mb-4"},null,-1),e("p",{class:"text-cafe/60"},"Cargando informaci√≥n del paciente...",-1)])])):s(E)?(i(),l("div",gt,[e("div",bt,[t[9]||(t[9]=e("span",{class:"text-6xl mb-4 block"},"‚ùå",-1)),t[10]||(t[10]=e("h3",{class:"text-xl font-serif font-semibold text-cafe mb-2"}," No se pudo cargar la informaci√≥n ",-1)),e("p",vt,n(s(E)),1),e("button",{onClick:t[1]||(t[1]=a=>("navigateTo"in o?o.navigateTo:s(de))("/terapeuta/pacientes")),class:"px-6 py-3 bg-purple-600 text-white rounded-lg hover:bg-purple-600/90 transition-colors"}," Volver a la lista ")])])):s(d)?(i(),l("div",_t,[e("div",ht,[e("div",yt,[e("div",wt,[e("div",{class:"w-20 h-20 rounded-full flex items-center justify-center text-white font-bold text-2xl flex-shrink-0",style:be({backgroundColor:s($e)})},n(s(Ee)),5),e("div",null,[e("h1",kt,n(s(q)),1),e("div",Ct,[e("span",{class:h(["px-3 py-1 text-sm font-medium rounded-full",s(Te)])},n(s(Ae)),3),e("span",Pt,[t[11]||(t[11]=e("span",null,"üìß",-1)),e("span",null,n(s(d).email),1)])]),e("div",Dt,[s(d).telefono?(i(),l("div",St,[t[12]||(t[12]=e("span",null,"üì±",-1)),e("span",null,n(s(d).telefono),1)])):b("",!0),s(d).area_de_acompanamiento?(i(),l("div",Et,[t[14]||(t[14]=e("span",null,"üéØ",-1)),e("span",null,[t[13]||(t[13]=e("strong",null,"√Årea:",-1)),y(" "+n(s(d).area_de_acompanamiento),1)])])):b("",!0),s(d).tipo_bono?(i(),l("div",$t,[t[16]||(t[16]=e("span",null,"üé´",-1)),e("span",null,[t[15]||(t[15]=e("strong",null,"Tipo de Bono:",-1)),y(" "+n(s(le)),1)])])):b("",!0)])])]),e("div",{class:"flex flex-wrap gap-2"},[e("button",{onClick:xe,class:"px-4 py-2 bg-purple-500 text-white rounded-lg hover:bg-purple-600 transition-colors text-sm flex items-center gap-2"},[...t[17]||(t[17]=[e("span",null,"üé´",-1),e("span",null,"Gestionar Bonos",-1)])]),e("button",{onClick:Ne,class:"px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors text-sm flex items-center gap-2"},[...t[18]||(t[18]=[e("span",null,"üí¨",-1),e("span",null,"WhatsApp",-1)])]),e("button",{onClick:X,class:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-600/90 transition-colors text-sm flex items-center gap-2"},[...t[19]||(t[19]=[e("span",null,"üìÖ",-1),e("span",null,"Agendar sesi√≥n",-1)])]),e("button",{onClick:Ie,class:"px-4 py-2 bg-white border border-purple-600/30 text-purple-600 rounded-lg hover:bg-purple-600/5 transition-colors text-sm flex items-center gap-2"},[...t[20]||(t[20]=[e("span",null,"‚úèÔ∏è",-1),e("span",null,"Editar",-1)])])])])]),e("div",At,[e("div",Tt,[t[25]||(t[25]=e("h2",{class:"font-serif text-xl font-semibold text-cafe flex items-center gap-2 mb-4"},[e("span",{class:"text-2xl"},"üìä"),y(" Resumen ")],-1)),e("div",zt,[e("div",jt,[t[21]||(t[21]=e("span",{class:"text-sm text-cafe/70"},"Total sesiones",-1)),e("span",Nt,n(s(N).total),1)]),e("div",Bt,[t[22]||(t[22]=e("span",{class:"text-sm text-cafe/70"},"Completadas",-1)),e("span",Ft,n(s(N).completadas),1)]),e("div",Mt,[t[23]||(t[23]=e("span",{class:"text-sm text-cafe/70"},"Pendientes",-1)),e("span",Rt,n(s(N).pendientes),1)]),e("div",It,[t[24]||(t[24]=e("span",{class:"text-sm text-cafe/70"},"Pr√≥ximas",-1)),e("span",qt,n(s(N).proximas),1)])])]),e("div",Vt,[t[35]||(t[35]=e("h2",{class:"font-serif text-xl font-semibold text-cafe flex items-center gap-2 mb-4"},[e("span",{class:"text-2xl"},"üé´"),y(" Bono Contratado ")],-1)),s(u)?(i(),l("div",Ut,[e("div",Lt,[t[26]||(t[26]=e("div",{class:"text-xs text-purple-700 font-medium mb-1"},"Tipo de Bono",-1)),e("div",Ot,n(s(le)),1)]),e("div",Gt,[e("div",Ht,n(s(u).sesiones_disponibles),1),e("div",Kt," de "+n(s(u).sesiones_totales)+" sesiones disponibles ",1)]),e("div",Yt,[e("div",Wt,[t[27]||(t[27]=e("span",{class:"text-cafe/70"},"Progreso",-1)),e("span",Qt,n(s(u).porcentaje_uso)+"%",1)]),e("div",Jt,[e("div",{class:"h-2.5 rounded-full bg-gradient-to-r from-purple-600 to-rosa transition-all",style:be({width:`${s(u).porcentaje_uso}%`})},null,4)])]),e("div",Xt,[e("div",Zt,[t[28]||(t[28]=e("span",{class:"text-cafe/70"},"Sesiones usadas:",-1)),e("span",es,n(s(u).sesiones_usadas),1)]),e("div",ts,[t[29]||(t[29]=e("span",{class:"text-cafe/70"},"Monto total:",-1)),e("span",ss,n(J(s(u).monto_total||s(u).precio)),1)]),e("div",os,[t[30]||(t[30]=e("span",{class:"text-cafe/70"},"Precio por sesi√≥n:",-1)),e("span",as,n(J(s(u).precio_por_sesion||(s(u).monto_total||s(u).precio)/s(u).sesiones_totales)),1)]),e("div",ns,[t[31]||(t[31]=e("span",{class:"text-cafe/70"},"Estado:",-1)),e("span",{class:h(["font-medium capitalize",{"text-green-600":s(u).estado==="activo","text-yellow-600":s(u).estado==="pendiente","text-gray-600":s(u).estado==="vencido"}])},n(s(u).estado),3)])])])):(i(),l("div",ls,[t[33]||(t[33]=e("span",{class:"text-5xl mb-3 block opacity-40"},"üé´",-1)),t[34]||(t[34]=e("p",{class:"text-sm text-cafe/50 mb-2"},"No hay bono activo",-1)),e("p",is,[t[32]||(t[32]=y(" Tipo de bono del paciente: ",-1)),e("strong",null,n(s(le)||"No definido"),1)]),e("button",{onClick:xe,class:"mt-2 text-sm text-purple-600 hover:text-cafe transition-colors font-medium"}," Gestionar bonos ‚Üí ")]))]),e("div",rs,[t[44]||(t[44]=e("h2",{class:"font-serif text-xl font-semibold text-cafe flex items-center gap-2 mb-4"},[e("span",{class:"text-2xl"},"üìã"),y(" Datos del Proceso ")],-1)),e("div",ds,[e("div",cs,[t[36]||(t[36]=e("div",{class:"text-xs text-cafe/60 mb-1"},"Primera sesi√≥n",-1)),e("div",ps,n(B(s(De))||"Sin registro"),1)]),e("div",us,[t[37]||(t[37]=e("div",{class:"text-xs text-cafe/60 mb-1"},"√öltima sesi√≥n",-1)),e("div",xs,n(B(s(Se))||"Sin registro"),1)]),s(C)?(i(),l("div",ms,[t[39]||(t[39]=e("div",{class:"text-xs font-medium text-purple-600 mb-2 flex items-center gap-1"},[e("span",null,"üìÖ"),e("span",null,"Pr√≥xima sesi√≥n agendada")],-1)),e("div",fs,n(ze(s(C).fecha_cita,s(C).hora_inicio)),1),e("div",gs,[e("span",bs,n(V(s(C).modalidad))+" "+n(s(C).modalidad),1),e("span",{class:h(["text-xs px-3 py-1.5 bg-white border border-purple-600/30 rounded-full capitalize font-medium",{"text-green-600 border-green-300":s(C).estado==="confirmada","text-yellow-600 border-yellow-300":s(C).estado==="pendiente","text-blue-600 border-blue-300":s(C).estado==="programada"}])},n(s(C).estado),3)]),s(C).notas?(i(),l("div",vs,[t[38]||(t[38]=e("div",{class:"text-xs text-cafe/70 mb-1"},"Notas:",-1)),e("div",_s,n(s(C).notas),1)])):b("",!0)])):(i(),l("div",hs,[e("div",{class:"text-center"},[t[40]||(t[40]=e("span",{class:"text-3xl mb-2 block"},"‚è∞",-1)),t[41]||(t[41]=e("div",{class:"text-sm font-medium text-yellow-800 mb-1"},"No hay sesi√≥n agendada",-1)),t[42]||(t[42]=e("div",{class:"text-xs text-yellow-700"},"Recuerda agendar la pr√≥xima sesi√≥n",-1)),e("button",{onClick:X,class:"mt-3 px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-600/90 transition-colors text-xs font-medium"}," Agendar ahora ")])])),e("div",ys,[t[43]||(t[43]=e("div",{class:"text-xs text-cafe/60 mb-1"},"En proceso desde",-1)),e("div",ws,n(je(s(d).created_at)),1)])])])]),e("div",ks,[e("div",Cs,[e("div",Ps,[t[45]||(t[45]=e("h2",{class:"font-serif text-xl font-semibold text-cafe flex items-center gap-2"},[e("span",{class:"text-2xl"},"üìä"),y(" Sesiones ")],-1)),G(e("select",{"onUpdate:modelValue":t[2]||(t[2]=a=>H(R)?R.value=a:null),class:"px-3 py-1.5 text-sm border border-purple-200 rounded-lg bg-white text-cafe focus:ring-2 focus:ring-purple-500 focus:border-purple-500"},[(i(!0),l($,null,A(s(pe),a=>(i(),l("option",{key:a,value:a},n(a),9,Ds))),128))],512),[[ve,s(R)]])]),e("div",Ss,[e("div",Es,[e("div",$s,n(s(W).total),1),t[46]||(t[46]=e("div",{class:"text-xs text-cafe/70"},"Total",-1))]),e("div",As,[e("div",Ts,n(s(W).canceladas),1),t[47]||(t[47]=e("div",{class:"text-xs text-cafe/70"},"Cancelaciones",-1))]),e("div",zs,[e("div",js,n(s(W).programadas),1),t[48]||(t[48]=e("div",{class:"text-xs text-cafe/70"},"Programadas",-1))]),e("div",Ns,[e("div",Bs,n(s(W).realizadas),1),t[49]||(t[49]=e("div",{class:"text-xs text-cafe/70"},"Realizadas",-1))])])]),e("div",Fs,[e("div",Ms,[t[50]||(t[50]=e("h2",{class:"font-serif text-xl font-semibold text-cafe flex items-center gap-2"},[e("span",{class:"text-2xl"},"üí≥"),y(" Deuda ")],-1)),G(e("select",{"onUpdate:modelValue":t[3]||(t[3]=a=>H(K)?K.value=a:null),class:"px-3 py-1.5 text-sm border border-purple-200 rounded-lg bg-white text-cafe focus:ring-2 focus:ring-purple-500 focus:border-purple-500"},[(i(!0),l($,null,A(s(pe),a=>(i(),l("option",{key:a,value:a},n(a),9,Rs))),128))],512),[[ve,s(K)]])]),e("div",{class:h(["p-6 rounded-xl text-center",s(Q).haDeuda?"bg-gradient-to-br from-red-50 to-orange-50 border-2 border-red-200":"bg-gradient-to-br from-green-50 to-emerald-50 border-2 border-green-200"])},[s(Q).haDeuda?(i(),l("div",Is,[e("div",qs,n(J(s(Q).totalPendiente)),1),t[51]||(t[51]=e("div",{class:"text-sm text-red-700"},"Pendiente de cobro",-1)),e("div",Vs,n(s(Q).cantidadPendientes)+" sesi√≥n(es) sin cobrar",1)])):(i(),l("div",Us,[...t[52]||(t[52]=[e("div",{class:"text-4xl mb-2"},"‚úÖ",-1),e("div",{class:"text-lg font-semibold text-green-700"},"Sin deuda",-1),e("div",{class:"text-sm text-green-600"},"Todos los pagos al d√≠a",-1)])]))],2)])]),e("div",Ls,[e("div",Os,[t[55]||(t[55]=e("h2",{class:"font-serif text-xl font-semibold text-cafe flex items-center gap-2"},[e("span",{class:"text-2xl"},"üìã"),y(" Historial de Sesiones ")],-1)),e("div",Gs,[e("div",Hs,[t[53]||(t[53]=e("label",{class:"text-sm text-cafe/70"},"Desde:",-1)),G(e("input",{"onUpdate:modelValue":t[4]||(t[4]=a=>H(z)?z.value=a:null),type:"date",class:"px-3 py-1.5 text-sm border border-purple-200 rounded-lg bg-white text-cafe focus:ring-2 focus:ring-purple-500"},null,512),[[ce,s(z)]])]),e("div",Ks,[t[54]||(t[54]=e("label",{class:"text-sm text-cafe/70"},"Hasta:",-1)),G(e("input",{"onUpdate:modelValue":t[5]||(t[5]=a=>H(j)?j.value=a:null),type:"date",class:"px-3 py-1.5 text-sm border border-purple-200 rounded-lg bg-white text-cafe focus:ring-2 focus:ring-purple-500"},null,512),[[ce,s(j)]])]),s(z)||s(j)?(i(),l("button",{key:0,onClick:t[6]||(t[6]=a=>{z.value="",j.value=""}),class:"px-3 py-1.5 text-sm text-purple-600 hover:text-purple-800 transition-colors"}," Limpiar filtros ")):b("",!0)])]),s(ne).length>0?(i(),l("div",Ys,[e("table",Ws,[t[56]||(t[56]=e("thead",null,[e("tr",{class:"bg-gradient-to-r from-purple-50 to-rosa/20 text-cafe"},[e("th",{class:"px-4 py-3 text-left font-semibold rounded-tl-lg"},"#"),e("th",{class:"px-4 py-3 text-left font-semibold"},"Fecha"),e("th",{class:"px-4 py-3 text-left font-semibold"},"Modalidad"),e("th",{class:"px-4 py-3 text-left font-semibold"},"Estado"),e("th",{class:"px-4 py-3 text-right font-semibold"},"Precio"),e("th",{class:"px-4 py-3 text-left font-semibold rounded-tr-lg"},"Pago")])],-1)),e("tbody",null,[(i(!0),l($,null,A(s(ne),(a,m)=>(i(),l("tr",{key:a.id,class:"border-b border-gray-100 hover:bg-rosa/10 transition-colors"},[e("td",Qs,n(s(ne).length-m),1),e("td",Js,[e("div",Xs,n(B(a.fecha_cita)),1),e("div",Zs,n(a.hora_inicio)+" - "+n(a.hora_fin),1)]),e("td",eo,[e("span",{class:h(["inline-flex items-center gap-1 px-2 py-1 text-xs rounded-full",O(a.modalidad)])},n(V(a.modalidad))+" "+n(a.modalidad),3)]),e("td",to,[e("span",{class:h(["px-2 py-1 text-xs rounded-full capitalize",ie(a.estado)])},n(a.estado),3)]),e("td",so,n(J(a.precio_sesion||0)),1),e("td",oo,[a.pagado?(i(),l("span",ao," ‚úì Pagado ")):a.estado==="realizada"?(i(),l("span",no," ‚è≥ Pendiente ")):(i(),l("span",lo," - "))])]))),128))])])])):(i(),l("div",io,[...t[57]||(t[57]=[e("span",{class:"text-5xl mb-3 block opacity-40"},"üìã",-1),e("p",{class:"text-cafe/60"},"No hay sesiones en el per√≠odo seleccionado",-1)])]))]),e("div",ro,[e("div",co,[e("nav",po,[(i(!0),l($,null,A(s(ye),a=>(i(),l("button",{key:a.id,onClick:m=>I.value=a.id,class:h(["whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm transition-colors",s(I)===a.id?"border-purple-600 text-purple-600":"border-transparent text-cafe/60 hover:text-cafe hover:border-gray-300"])},[e("span",xo,n(a.icono),1),e("span",null,n(a.nombre),1),a.badge?(i(),l("span",mo,n(a.badge),1)):b("",!0)],10,uo))),128))])])]),e("div",fo,[s(I)==="proximas"?(i(),l("div",go,[e("div",bo,[e("div",{class:"flex items-center justify-between mb-4"},[t[58]||(t[58]=e("h3",{class:"text-lg font-serif font-semibold text-cafe"},"Pr√≥ximas Sesiones Agendadas",-1)),e("button",{onClick:X,class:"text-sm text-purple-600 hover:text-cafe transition-colors"}," + Nueva sesi√≥n ")]),s(U).length>0?(i(),l("div",vo,[(i(!0),l($,null,A(s(U),a=>(i(),l("div",{key:a.id,class:"p-4 bg-base-bg rounded-lg hover:bg-rosa/20 transition-colors"},[e("div",_o,[e("div",ho,[e("div",yo,[e("span",wo,n(B(a.fecha_cita)),1),e("span",ko,n(a.hora_inicio)+" - "+n(a.hora_fin),1)]),e("div",Co,[e("span",{class:h(["px-2 py-0.5 text-xs rounded-full",O(a.modalidad)])},n(V(a.modalidad))+" "+n(a.modalidad),3),e("span",{class:h(["px-2 py-0.5 text-xs rounded-full capitalize",ie(a.estado)])},n(a.estado),3)]),a.observaciones?(i(),l("p",Po,n(a.observaciones),1)):b("",!0)]),e("button",{onClick:m=>me(a.id),class:"px-3 py-1.5 text-sm bg-white border border-purple-600/30 text-purple-600 hover:bg-purple-600 hover:text-white rounded-lg transition-colors"}," Ver detalles ",8,Do)])]))),128))])):(i(),l("div",So,[t[59]||(t[59]=e("span",{class:"text-6xl mb-3 block opacity-40"},"üìÖ",-1)),t[60]||(t[60]=e("p",{class:"text-cafe/60 mb-4"},"No hay sesiones pr√≥ximas agendadas",-1)),e("button",{onClick:X,class:"px-6 py-3 bg-purple-600 text-white rounded-lg hover:bg-purple-600/90 transition-colors"}," Agendar primera sesi√≥n ")]))])])):b("",!0),s(I)==="completadas"?(i(),l("div",Eo,[e("div",$o,[t[64]||(t[64]=e("h3",{class:"text-lg font-serif font-semibold text-cafe mb-4"},"Historial de Sesiones Completadas",-1)),s(L).length>0?(i(),l("div",Ao,[(i(!0),l($,null,A(s(L),a=>(i(),l("div",{key:a.id,class:"p-4 bg-base-bg rounded-lg hover:bg-rosa/20 transition-colors"},[e("div",To,[e("div",zo,[e("div",jo,[e("span",No,n(B(a.fecha_cita)),1),e("span",Bo,n(a.hora_inicio)+" - "+n(a.hora_fin),1),t[61]||(t[61]=e("span",{class:"px-2 py-0.5 text-xs rounded-full bg-blue-100 text-blue-700"}," ‚úì Realizada ",-1))]),e("div",Fo,[e("span",{class:h(["px-2 py-0.5 text-xs rounded-full",O(a.modalidad)])},n(V(a.modalidad))+" "+n(a.modalidad),3)]),a.notas_terapeuta?(i(),l("p",Mo,[t[62]||(t[62]=e("strong",{class:"text-cafe"},"Notas:",-1)),y(" "+n(a.notas_terapeuta),1)])):a.observaciones?(i(),l("p",Ro,n(a.observaciones),1)):b("",!0)])])]))),128))])):(i(),l("div",Io,[...t[63]||(t[63]=[e("span",{class:"text-6xl mb-3 block opacity-40"},"üìù",-1),e("p",{class:"text-cafe/60"},"A√∫n no hay sesiones completadas",-1)])]))])])):b("",!0),s(I)==="pendientes"?(i(),l("div",qo,[e("div",Vo,[t[68]||(t[68]=e("h3",{class:"text-lg font-serif font-semibold text-cafe mb-4"},"Sesiones Pendientes de Confirmaci√≥n",-1)),s(ae).length>0?(i(),l("div",Uo,[(i(!0),l($,null,A(s(ae),a=>(i(),l("div",{key:a.id,class:"p-4 bg-yellow-50 border border-yellow-200 rounded-lg"},[e("div",Lo,[e("div",Oo,[e("div",Go,[t[65]||(t[65]=e("span",{class:"text-lg"},"‚è≥",-1)),e("span",Ho,n(B(a.fecha_cita)),1),e("span",Ko,n(a.hora_inicio)+" - "+n(a.hora_fin),1)]),e("div",Yo,[e("span",{class:h(["px-2 py-0.5 text-xs rounded-full",O(a.modalidad)])},n(V(a.modalidad))+" "+n(a.modalidad),3),t[66]||(t[66]=e("span",{class:"px-2 py-0.5 text-xs rounded-full bg-yellow-100 text-yellow-700"}," Pendiente de confirmar ",-1))]),a.observaciones?(i(),l("p",Wo,n(a.observaciones),1)):b("",!0)]),e("div",Qo,[e("button",{onClick:m=>Re(a.id),class:"px-3 py-1.5 text-sm bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors"}," ‚úì Confirmar ",8,Jo),e("button",{onClick:m=>me(a.id),class:"px-3 py-1.5 text-sm bg-white border border-purple-600/30 text-purple-600 hover:bg-purple-600 hover:text-white rounded-lg transition-colors"}," Ver ",8,Xo)])])]))),128))])):(i(),l("div",Zo,[...t[67]||(t[67]=[e("span",{class:"text-6xl mb-3 block opacity-40"},"‚úÖ",-1),e("p",{class:"text-cafe/60"},"No hay sesiones pendientes de confirmaci√≥n",-1)])]))])])):b("",!0),s(I)==="anteriores"?(i(),l("div",ea,[e("div",ta,[t[70]||(t[70]=e("h3",{class:"text-lg font-serif font-semibold text-cafe mb-4"}," Historial Completo de Sesiones ",-1)),s(ue).length>0?(i(),l("div",sa,[(i(!0),l($,null,A(s(ue),a=>(i(),l("div",{key:a.id,class:"p-4 bg-base-bg rounded-lg hover:bg-rosa/20 transition-colors"},[e("div",oa,[e("div",aa,[e("div",na,[e("span",la,n(B(a.fecha_cita)),1),e("span",ia,n(a.hora_inicio)+" - "+n(a.hora_fin),1)]),e("div",ra,[e("span",{class:h(["px-2 py-0.5 text-xs rounded-full",O(a.modalidad)])},n(V(a.modalidad))+" "+n(a.modalidad),3),e("span",{class:h(["px-2 py-0.5 text-xs rounded-full capitalize",ie(a.estado)])},n(a.estado),3)])])])]))),128))])):(i(),l("div",da,[...t[69]||(t[69]=[e("span",{class:"text-6xl mb-3 block opacity-40"},"üìö",-1),e("p",{class:"text-cafe/60"},"No hay sesiones registradas",-1)])]))])])):b("",!0)]),e("div",ca,[e("div",pa,[t[71]||(t[71]=e("h2",{class:"font-serif text-xl font-semibold text-cafe flex items-center gap-2 mb-4"},[e("span",{class:"text-2xl"},"üìù"),y(" Notas Cl√≠nicas Privadas ")],-1)),re(r,{"paciente-id":s(f),contenido:s(T),"ultima-actualizacion":s(M)||void 0,onGuardar:Pe},null,8,["paciente-id","contenido","ultima-actualizacion"])])])])):b("",!0),re(c,{mostrar:s(ee),"paciente-preseleccionado":s(te),onCerrar:Be,onCitaCreada:Fe},null,8,["mostrar","paciente-preseleccionado"]),re(P,{"is-open":s(se),"cita-id":s(oe),onClose:Me},null,8,["is-open","cita-id"])])}}}),qa=he(ua,[["__scopeId","data-v-b6f0a7f2"]]);export{qa as default};
