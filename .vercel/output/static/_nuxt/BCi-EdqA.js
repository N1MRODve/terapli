import{e as Ee,r as g,q as P,f as le,C as Be,c as d,o as i,h as oe,g as f,a as e,t as n,F as z,s as F,y as j,d as S,x as De,j as q,V as Ae,H as Se,Z as ze,b as ae,k as r,v as Fe,l as M,z as H,w as ne,T as re,i as K,A as Ne,E as Ie,D as Te}from"#entry";import{u as ie}from"./Cy0_MzJF.js";import{_ as de}from"./DlAUqK2U.js";const Ve={class:"bg-gradient-to-br from-white to-cafe/5 rounded-2xl p-6 md:p-8 shadow-lg border border-cafe/10 space-y-6 transition-all duration-300"},Re={key:0,class:"text-center py-16"},qe={key:1,class:"space-y-4"},Le={class:"flex items-center justify-between mb-2"},Me={class:"px-3 py-1 bg-green-50 text-green-700 text-xs font-semibold rounded-full"},Oe={class:"grid grid-cols-1 gap-4"},Ue={class:"bg-gradient-to-r from-purple-600/5 via-white to-purple-600/5 px-6 py-4 border-b border-cafe/5"},He={class:"flex items-start justify-between gap-4"},Ke={class:"flex-1"},Ge={class:"flex items-center gap-3 mb-2"},We={class:"text-base font-bold text-cafe"},Qe={class:"text-xs text-cafe/60 flex items-center gap-1.5"},Ze={class:"flex flex-col items-end gap-2"},Je={key:0,class:"px-3 py-1.5 rounded-full text-xs font-bold uppercase tracking-wide shadow-sm bg-gradient-to-r from-yellow-100 to-orange-100 text-orange-700 border border-orange-200 animate-pulse",title:"Pendiente de confirmaciÃ³n de pago"},Xe=["title"],Ye={class:"px-6 py-5 space-y-5"},et={class:"bg-gradient-to-br from-cafe/5 to-transparent rounded-xl p-4 space-y-3 border border-cafe/5"},tt={class:"flex justify-between items-center"},st={class:"font-bold text-cafe text-lg"},ot={class:"flex justify-between items-center"},at={class:"font-bold text-purple-600 text-lg"},nt={class:"flex justify-between items-center"},rt={class:"font-bold text-green-700 text-lg"},lt={class:"pt-3 border-t border-cafe/10"},it={class:"flex justify-between items-center"},dt={class:"font-bold text-cafe text-lg"},ct={class:"flex justify-between items-center mt-2"},ut={class:"text-sm text-cafe/80 font-medium"},pt={class:"space-y-2"},ft={class:"flex justify-between items-center text-xs"},mt={class:"text-cafe font-bold"},xt={class:"relative h-3 bg-gray-100 rounded-full overflow-hidden shadow-inner"},gt={class:"space-y-3"},vt={key:0,class:"bg-gradient-to-r from-yellow-50 to-orange-50 border-l-4 border-yellow-500 rounded-r-xl p-4 flex items-start gap-3 shadow-sm"},bt={class:"flex-1"},_t={class:"text-xs text-yellow-800"},ht={class:"font-bold"},yt={key:1,class:"bg-gradient-to-r from-orange-50 to-red-50 border-l-4 border-orange-500 rounded-r-xl p-4 flex items-start gap-3 shadow-sm"},wt={class:"space-y-3 pt-2"},$t={key:0,class:"grid grid-cols-2 gap-3"},kt=["onClick"],Ct={key:1,class:"grid grid-cols-2 gap-3"},Pt=["onClick"],jt=["onClick"],Et={class:"grid grid-cols-1"},Bt=["onClick"],Dt={key:2,class:"text-center bg-gradient-to-br from-white to-gray-50 rounded-2xl py-16 px-6 border-2 border-dashed border-cafe/20"},At={key:3,class:"pt-8 border-t border-cafe/10"},St={class:"flex items-center gap-3"},zt={class:"ml-2 px-2 py-0.5 bg-gray-200 text-gray-700 rounded-full text-xs font-semibold"},Ft={class:"mt-4 space-y-3 animate-fadeIn"},Nt={class:"flex items-start justify-between gap-4"},It={class:"flex-1"},Tt={class:"flex items-center gap-2 mb-2"},Vt={class:"text-sm font-bold text-cafe"},Rt={class:"text-xs text-cafe/60 mb-1 flex items-center gap-1.5"},qt={class:"flex items-center gap-4 mt-3"},Lt={class:"flex items-center gap-1.5 text-xs"},Mt={class:"font-bold text-cafe"},Ot={class:"flex items-center gap-1.5 text-xs"},Ut={class:"font-bold text-cafe"},Ht=Ee({__name:"BonosPaciente",props:{pacienteId:{}},emits:["renovar-bono","ver-detalles","crear-bono","confirmar-pago","revertir-pago"],setup(W){const v=W,D=ie(),E=g([]),b=g(!0),y=g(!1),_=P(()=>E.value.filter(l=>(l.estado==="activo"||l.estado==="pendiente")&&l.sesiones_restantes>0)),w=P(()=>E.value.filter(l=>l.estado==="finalizado"||l.estado==="cancelado"||l.sesiones_restantes===0)),C=async()=>{b.value=!0;try{const{data:l,error:s}=await D.from("bonos").select("*").eq("paciente_id",v.pacienteId).order("created_at",{ascending:!1});if(s)throw s;E.value=l||[]}catch(l){console.error("Error al cargar bonos:",l)}finally{b.value=!1}};le(()=>{C()}),Be(()=>v.pacienteId,()=>{v.pacienteId&&C()},{immediate:!1});const $=l=>{const s=l.sesiones_totales||0;return s===1?"Bono de 1 sesiÃ³n":s<=4?`Bono de ${s} sesiones`:s<=8?`Bono Semanal (${s} sesiones)`:`Bono Quincenal (${s} sesiones)`},N=l=>l.sesiones_restantes||0,k=l=>{const s=l.sesiones_totales||0,c=l.sesiones_restantes||0,h=s-c;return s===0?0:Math.round(h/s*100)},u=l=>{const s=l.sesiones_restantes||0;return(l.estado==="activo"||l.estado==="pendiente")&&s>0&&s<=2},A=l=>l.estado==="finalizado"||l.estado==="cancelado"?"Finalizado":l.sesiones_restantes===0?"Agotado":u(l)?"Por agotar":l.estado==="pendiente"?"Pendiente":"Activo",I=l=>{const s=A(l);return s==="Activo"?"bg-green-100 text-green-700":s==="Por agotar"?"bg-yellow-100 text-yellow-700":s==="Pendiente"?"bg-blue-100 text-blue-700":s==="Agotado"||s==="Finalizado"?"bg-gray-100 text-gray-600":"bg-blue-100 text-blue-700"},L=l=>{const s=k(l);return s>=80?"bg-gradient-to-r from-red-400 to-red-600":s>=50?"bg-gradient-to-r from-yellow-400 to-yellow-600":"bg-gradient-to-r from-green-400 to-green-600"},T=l=>new Intl.NumberFormat("es-ES",{style:"currency",currency:"EUR"}).format(l||0),V=l=>l?new Date(l).toLocaleDateString("es-ES",{year:"numeric",month:"short",day:"numeric"}):"Sin fecha";return(l,s)=>(i(),d("div",Ve,[s[33]||(s[33]=oe('<div class="border-b border-cafe/10 pb-5" data-v-d1dd217d><div class="flex items-center gap-3 mb-2" data-v-d1dd217d><div class="w-10 h-10 rounded-xl bg-gradient-to-br from-purple-600/20 to-purple-600/10 flex items-center justify-center" data-v-d1dd217d><span class="text-xl" data-v-d1dd217d>ğŸ«</span></div><h3 class="font-serif text-2xl font-bold text-cafe" data-v-d1dd217d>Bonos del Paciente</h3></div><p class="text-sm text-cafe/60 ml-13" data-v-d1dd217d>GestiÃ³n y seguimiento de sesiones contratadas</p></div>',1)),b.value?(i(),d("div",Re,[...s[2]||(s[2]=[e("div",{class:"relative inline-block"},[e("div",{class:"w-12 h-12 border-4 border-purple-600/20 border-t-purple-600 rounded-full animate-spin"}),e("div",{class:"absolute inset-0 w-12 h-12 border-4 border-transparent border-b-cafe/20 rounded-full animate-spin",style:{"animation-duration":"1.5s","animation-direction":"reverse"}})],-1),e("p",{class:"mt-4 text-sm text-cafe/60 font-medium"},"Cargando informaciÃ³n de bonos...",-1)])])):_.value.length>0?(i(),d("div",qe,[e("div",Le,[s[3]||(s[3]=e("h4",{class:"text-sm font-semibold text-cafe/70 uppercase tracking-wider"},"Bonos Activos",-1)),e("span",Me,n(_.value.length)+" "+n(_.value.length===1?"bono":"bonos"),1)]),e("div",Oe,[(i(!0),d(z,null,F(_.value,c=>(i(),d("div",{key:c.id,class:"group bg-white rounded-2xl shadow-md hover:shadow-xl transition-all duration-300 hover:-translate-y-1 border border-cafe/10 overflow-hidden"},[e("div",Ue,[e("div",He,[e("div",Ke,[e("div",Ge,[s[5]||(s[5]=e("div",{class:"w-10 h-10 rounded-xl bg-gradient-to-br from-purple-600 to-purple-600/80 flex items-center justify-center shadow-sm"},[e("span",{class:"text-white text-lg"},"ğŸŸï¸")],-1)),e("div",null,[e("h5",We,n($(c)),1),e("p",Qe,[s[4]||(s[4]=e("span",null,"ğŸ“…",-1)),e("span",null,"Creado "+n(V(c.created_at)),1)])])])]),e("div",Ze,[e("span",{class:j(["px-3 py-1.5 rounded-full text-xs font-bold uppercase tracking-wide shadow-sm backdrop-blur-sm transition-all duration-200",I(c)])},n(A(c)),3),c.pagado?(i(),d("span",{key:1,class:"px-3 py-1.5 rounded-full text-xs font-bold uppercase tracking-wide shadow-sm bg-gradient-to-r from-green-100 to-emerald-100 text-green-700 border border-green-200",title:`Pagado el ${V(c.fecha_pago)}`}," âœ“ Pagado ",8,Xe)):(i(),d("span",Je," ğŸ’³ Sin pagar "))])])]),e("div",Ye,[e("div",et,[e("div",tt,[s[6]||(s[6]=e("span",{class:"text-sm text-cafe/70 flex items-center gap-2"},[e("span",{class:"w-6 h-6 rounded-lg bg-cafe/10 flex items-center justify-center text-xs"},"ğŸ“Š"),S(" Total de sesiones ")],-1)),e("span",st,n(c.sesiones_totales||0),1)]),e("div",ot,[s[7]||(s[7]=e("span",{class:"text-sm text-cafe/70 flex items-center gap-2"},[e("span",{class:"w-6 h-6 rounded-lg bg-purple-600/10 flex items-center justify-center text-xs"},"âœ“"),S(" Sesiones usadas ")],-1)),e("span",at,n((c.sesiones_totales||0)-(c.sesiones_restantes||0)),1)]),e("div",nt,[s[8]||(s[8]=e("span",{class:"text-sm text-cafe/70 flex items-center gap-2"},[e("span",{class:"w-6 h-6 rounded-lg bg-green-100 flex items-center justify-center text-xs"},"â³"),S(" Sesiones restantes ")],-1)),e("span",rt,n(c.sesiones_restantes||0),1)]),e("div",lt,[e("div",it,[s[9]||(s[9]=e("span",{class:"text-sm text-cafe/70 flex items-center gap-2"},[e("span",{class:"w-6 h-6 rounded-lg bg-cafe/10 flex items-center justify-center text-xs"},"ğŸ’°"),S(" Precio total ")],-1)),e("span",dt,n(T(c.monto_total)),1)]),e("div",ct,[s[10]||(s[10]=e("span",{class:"text-xs text-cafe/60 pl-8"},"Precio por sesiÃ³n",-1)),e("span",ut,n(T((c.monto_total||0)/(c.sesiones_totales||1))),1)])])]),e("div",pt,[e("div",ft,[s[11]||(s[11]=e("span",{class:"text-cafe/70 font-medium"},"Progreso de sesiones",-1)),e("span",mt,n(k(c))+"%",1)]),e("div",xt,[e("div",{class:j(["absolute inset-y-0 left-0 rounded-full transition-all duration-700 ease-out shadow-sm",L(c)]),style:De({width:`${k(c)}%`})},[...s[12]||(s[12]=[e("div",{class:"absolute inset-0 bg-gradient-to-r from-transparent via-white/20 to-transparent"},null,-1)])],6)])]),e("div",gt,[u(c)?(i(),d("div",vt,[s[16]||(s[16]=e("div",{class:"w-8 h-8 rounded-lg bg-yellow-500 flex items-center justify-center flex-shrink-0 shadow-sm"},[e("span",{class:"text-white text-lg"},"âš ï¸")],-1)),e("div",bt,[s[15]||(s[15]=e("p",{class:"text-sm font-bold text-yellow-900 mb-1"},"Bono prÃ³ximo a agotar",-1)),e("p",_t,[s[13]||(s[13]=S(" Quedan ",-1)),e("span",ht,n(N(c)),1),s[14]||(s[14]=S(" sesiones disponibles ",-1))])])])):f("",!0),!c.pagado&&(c.estado==="activo"||c.estado==="pendiente")?(i(),d("div",yt,[...s[17]||(s[17]=[oe('<div class="w-8 h-8 rounded-lg bg-orange-500 flex items-center justify-center flex-shrink-0 shadow-sm" data-v-d1dd217d><span class="text-white text-lg" data-v-d1dd217d>ğŸ’³</span></div><div class="flex-1" data-v-d1dd217d><p class="text-sm font-bold text-orange-900 mb-1" data-v-d1dd217d>Pendiente de pago</p><p class="text-xs text-orange-800" data-v-d1dd217d> Este bono aÃºn no ha sido pagado. El paciente puede usar las sesiones y pagar al final, o confirma el pago ahora. </p></div>',2)])])):f("",!0)]),e("div",wt,[c.pagado?(i(),d("div",Ct,[e("button",{onClick:h=>l.$emit("renovar-bono",c),class:"group bg-gradient-to-r from-purple-600 to-orange-500 text-white hover:from-purple-600/90 hover:to-orange-600 rounded-xl py-3 px-4 text-sm font-semibold transition-all duration-300 shadow-md hover:shadow-xl hover:-translate-y-0.5 flex items-center justify-center gap-2"},[...s[19]||(s[19]=[e("span",{class:"text-base group-hover:rotate-180 transition-transform duration-500"},"ğŸ”„",-1),e("span",null,"Renovar",-1)])],8,Pt),e("button",{onClick:h=>l.$emit("revertir-pago",c),class:"group bg-gradient-to-r from-red-500 to-red-600 text-white hover:from-red-600 hover:to-red-700 rounded-xl py-3 px-4 text-sm font-semibold transition-all duration-300 shadow-md hover:shadow-xl hover:-translate-y-0.5 flex items-center justify-center gap-2",title:"Desmarcar como pagado (en caso de error)"},[...s[20]||(s[20]=[e("span",{class:"text-base group-hover:scale-110 transition-transform duration-300"},"â†©ï¸",-1),e("span",null,"Revertir pago",-1)])],8,jt)])):(i(),d("div",$t,[e("button",{onClick:h=>l.$emit("confirmar-pago",c),class:"group bg-gradient-to-r from-green-600 to-emerald-600 text-white hover:from-green-700 hover:to-emerald-700 rounded-xl py-3 px-4 text-sm font-semibold transition-all duration-300 shadow-md hover:shadow-xl hover:-translate-y-0.5 flex items-center justify-center gap-2 col-span-2"},[...s[18]||(s[18]=[e("span",{class:"text-base group-hover:scale-110 transition-transform duration-300"},"ğŸ’³",-1),e("span",null,"Confirmar pago",-1)])],8,kt)])),e("div",Et,[e("button",{onClick:h=>l.$emit("ver-detalles",c),class:"group bg-cafe/10 text-cafe hover:bg-cafe/20 rounded-xl py-3 px-4 text-sm font-semibold transition-all duration-300 border border-cafe/20 hover:border-cafe/40 flex items-center justify-center gap-2"},[...s[21]||(s[21]=[e("span",{class:"text-base group-hover:scale-110 transition-transform duration-300"},"ğŸ‘ï¸",-1),e("span",null,"Ver detalles",-1)])],8,Bt)])])])]))),128))])])):(i(),d("div",Dt,[s[23]||(s[23]=e("div",{class:"w-20 h-20 mx-auto mb-6 rounded-2xl bg-gradient-to-br from-purple-600/10 to-purple-600/5 flex items-center justify-center"},[e("span",{class:"text-5xl"},"ğŸ«")],-1)),s[24]||(s[24]=e("h4",{class:"text-xl font-bold text-cafe mb-3"},"No hay bonos activos",-1)),s[25]||(s[25]=e("p",{class:"text-sm text-cafe/60 mb-6 max-w-sm mx-auto"}," Este paciente no tiene bonos registrados en este momento. Puedes crear uno nuevo para comenzar. ",-1)),e("button",{onClick:s[0]||(s[0]=c=>l.$emit("crear-bono")),class:"group inline-flex items-center gap-2 px-6 py-3 bg-gradient-to-r from-purple-600 to-orange-500 text-white rounded-xl hover:from-purple-600/90 hover:to-orange-600 transition-all duration-300 font-semibold text-sm shadow-lg hover:shadow-xl hover:-translate-y-1"},[...s[22]||(s[22]=[e("span",{class:"group-hover:rotate-90 transition-transform duration-300"},"â•",-1),e("span",null,"Crear Nuevo Bono",-1)])])])),!b.value&&w.value.length>0?(i(),d("div",At,[e("button",{onClick:s[1]||(s[1]=c=>y.value=!y.value),class:"group flex items-center justify-between w-full text-left bg-gradient-to-r from-cafe/5 to-transparent hover:from-cafe/10 rounded-xl px-5 py-4 transition-all duration-300"},[e("div",St,[s[27]||(s[27]=e("div",{class:"w-8 h-8 rounded-lg bg-cafe/10 flex items-center justify-center"},[e("span",{class:"text-sm"},"ğŸ“¦")],-1)),e("div",null,[s[26]||(s[26]=e("span",{class:"font-bold text-cafe text-sm"},"Historial de bonos finalizados",-1)),e("span",zt,n(w.value.length),1)])]),e("span",{class:j(["text-lg transition-transform duration-300 text-cafe/60 group-hover:text-cafe",{"rotate-180":y.value}])}," â–¼ ",2)]),q(e("div",Ft,[(i(!0),d(z,null,F(w.value,c=>(i(),d("div",{key:c.id,class:"group bg-white border border-gray-200 hover:border-cafe/30 rounded-xl p-5 transition-all duration-300 hover:shadow-md"},[e("div",Nt,[e("div",It,[e("div",Tt,[s[28]||(s[28]=e("div",{class:"w-8 h-8 rounded-lg bg-gray-100 flex items-center justify-center"},[e("span",{class:"text-sm"},"ğŸ")],-1)),e("p",Vt,n($(c)),1)]),e("p",Rt,[s[29]||(s[29]=e("span",null,"ğŸ“…",-1)),e("span",null,"Finalizado el "+n(V(c.updated_at)),1)]),e("div",qt,[e("div",Lt,[s[30]||(s[30]=e("span",{class:"text-cafe/60"},"Sesiones:",-1)),e("span",Mt,n((c.sesiones_totales||0)-(c.sesiones_restantes||0))+" / "+n(c.sesiones_totales||0),1)]),e("div",Ot,[s[31]||(s[31]=e("span",{class:"text-cafe/60"},"Monto:",-1)),e("span",Ut,n(T(c.monto_total)),1)])])]),s[32]||(s[32]=e("span",{class:"px-3 py-1.5 bg-gray-100 text-gray-600 rounded-full text-xs font-bold uppercase tracking-wide"}," Finalizado ",-1))])]))),128))],512),[[Ae,y.value]])])):f("",!0)]))}}),Kt=Object.assign(de(Ht,[["__scopeId","data-v-d1dd217d"]]),{__name:"BonosPaciente"}),Gt={class:"space-y-6"},Wt={class:"bg-white rounded-xl shadow-sm border border-gray-100 p-6"},Qt={class:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4"},Zt={class:"text-sm text-gray-600 mt-1"},Jt={class:"flex flex-wrap items-center gap-3"},Xt={class:"relative flex-1 min-w-[250px]"},Yt={class:"flex flex-wrap gap-3 mt-4 pt-4 border-t border-gray-100"},es=["value"],ts={class:"grid grid-cols-2 md:grid-cols-4 gap-4"},ss={class:"bg-purple-600/5 rounded-xl p-4 border border-purple-600/10 transition-all duration-300 hover:shadow-md"},os={class:"flex items-center gap-3"},as={class:"flex-1"},ns={class:"text-2xl font-bold text-cafe"},rs={class:"bg-green-50 rounded-xl p-4 border border-green-100 transition-all duration-300 hover:shadow-md"},ls={class:"flex items-center gap-3"},is={class:"flex-1"},ds={class:"text-2xl font-bold text-green-700"},cs={class:"bg-blue-50 rounded-xl p-4 border border-blue-100 transition-all duration-300 hover:shadow-md"},us={class:"flex items-center gap-3"},ps={class:"flex-1"},fs={class:"text-2xl font-bold text-blue-700"},ms={class:"bg-purple-50 rounded-xl p-4 border border-purple-100 transition-all duration-300 hover:shadow-md"},xs={class:"flex items-center gap-3"},gs={class:"flex-1"},vs={class:"text-2xl font-bold text-purple-700"},bs={key:0,class:"bg-white rounded-xl shadow-sm border border-gray-100 p-12"},_s={key:1,class:"bg-white rounded-xl shadow-sm border border-gray-100 p-12"},hs={class:"text-center text-gray-400"},ys={class:"text-gray-600 mb-4"},ws={key:2,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"},$s=["onClick"],ks={class:"flex items-start gap-4 mb-4"},Cs={class:"w-16 h-16 rounded-full bg-gradient-to-br from-purple-600 to-cafe flex items-center justify-center flex-shrink-0 shadow-md"},Ps={class:"text-white text-xl font-semibold"},js={class:"flex-1 min-w-0"},Es={class:"font-semibold text-cafe text-lg truncate"},Bs={class:"text-sm text-gray-600 truncate"},Ds={key:0,class:"text-sm text-gray-500 mt-1"},As={key:0,class:"mb-3 flex items-center gap-2 text-sm bg-cafe/5 px-3 py-2 rounded-lg"},Ss={class:"text-cafe font-medium"},zs={class:"space-y-2 mb-4"},Fs={key:0,class:"flex items-center gap-2 text-sm"},Ns={class:"text-gray-700 truncate"},Is={class:"flex items-center gap-2 text-sm"},Ts={class:"text-gray-700"},Vs={key:1,class:"flex items-center gap-2 text-sm"},Rs={class:"text-gray-700"},qs={key:2,class:"flex items-center gap-2 text-sm"},Ls={class:"text-gray-700"},Ms={class:"flex items-center justify-between pt-4 border-t border-gray-100"},Os={class:"flex gap-2"},Us=["onClick"],Hs=["onClick"],Ks=["onClick"],Gs={key:3,class:"flex justify-center gap-2"},Ws=["onClick"],Qs={class:"sticky top-0 bg-white/80 backdrop-blur-md pb-6 pt-8 px-8 md:px-10 border-b border-cafe/10 z-10"},Zs={class:"flex items-start justify-between gap-6"},Js={class:"flex items-center gap-5 flex-1"},Xs={class:"w-16 h-16 rounded-full bg-cafe text-white flex items-center justify-center text-xl font-bold shadow-sm flex-shrink-0"},Ys={class:"flex-1 min-w-0"},eo={id:"panel-title",class:"font-serif text-2xl font-bold text-cafe mb-2 truncate"},to={class:"flex items-center gap-3 flex-wrap"},so={key:0,class:"text-sm text-cafe/70"},oo={class:"p-8 md:p-10 space-y-8"},ao={class:"bg-white border border-cafe/10 rounded-xl p-5 shadow-sm hover:shadow-md transition-all duration-300 hover:-translate-y-1"},no={class:"space-y-3"},ro={class:"flex items-center gap-3 text-cafe/80"},lo={class:"text-sm"},io={key:0,class:"flex items-center gap-3 text-cafe/80"},co={class:"text-sm"},uo={key:0,class:"bg-blue-50/50 rounded-xl p-4 border border-blue-100 transition-all duration-300 hover:shadow-md"},po={class:"text-cafe text-sm leading-relaxed"},fo={class:"bg-green-50/50 rounded-xl p-5 border border-green-100 transition-all duration-300 hover:shadow-md"},mo={class:"space-y-4"},xo={class:"flex items-center justify-between"},go={class:"text-3xl font-bold text-cafe"},vo={class:"flex items-center justify-between"},bo={class:"text-lg font-semibold text-green-700"},_o={key:0,class:"flex items-center gap-2 pt-2 border-t border-green-200"},ho={class:"text-sm font-medium text-cafe"},yo={key:1,class:"bg-white border border-cafe/10 rounded-xl p-5 shadow-sm hover:shadow-md transition-all duration-300 hover:-translate-y-1"},wo={class:"space-y-3"},$o={class:"flex justify-between items-center p-4 bg-purple-50 rounded-lg"},ko={class:"text-2xl font-bold text-purple-700"},Co={class:"flex justify-between items-center text-sm text-cafe/70"},Po={class:"font-medium"},jo={class:"bg-white border border-cafe/10 rounded-xl p-5 shadow-sm hover:shadow-md transition-all duration-300"},Eo={key:0,class:"space-y-4"},Bo={class:"flex flex-col items-center"},Do={key:0,class:"w-px h-full bg-cafe/10 mt-1"},Ao={class:"flex-1 pb-6"},So={class:"flex items-start justify-between gap-3"},zo={class:"flex-1"},Fo={class:"text-sm font-medium text-cafe"},No={class:"text-xs text-cafe/60 mt-0.5"},Io={key:0,class:"text-xs text-cafe/70 mt-2 leading-relaxed"},To={key:1,class:"text-center py-8"},Vo={class:"grid grid-cols-1 md:grid-cols-3 gap-3 pt-4"},G=12,Ro={__name:"pacientes-old",setup(W){const v=ie(),D=Se(),E=g(!0),b=g([]),y=g([]),_=g(""),w=g(""),C=g(""),$=g("nombre"),N=g(1),k=g(!1),u=g(null);g(null);const A=g(0),I=P(()=>b.value.length),L=P(()=>b.value.filter(a=>a.estado==="activo"||a.activo).length),T=P(()=>y.value.length===0?0:Math.round(I.value/y.value.length)),V=P(()=>b.value.filter(a=>a.bono_activo&&a.bono_activo.sesiones_restantes>0).length),l=P(()=>{let a=[...b.value];if(_.value.trim()){const o=_.value.toLowerCase();a=a.filter(p=>p.nombre_completo?.toLowerCase().includes(o)||p.email?.toLowerCase().includes(o)||p.telefono?.includes(o)||p.terapeuta_nombre?.toLowerCase().includes(o))}w.value==="activo"?a=a.filter(o=>o.estado==="activo"||o.activo):w.value==="inactivo"?a=a.filter(o=>o.estado==="inactivo"||!o.activo):w.value==="pausa"&&(a=a.filter(o=>o.estado==="pausa")),C.value&&(a=a.filter(o=>o.terapeuta_id===C.value)),$.value==="nombre"?a.sort((o,p)=>(o.nombre_completo||"").localeCompare(p.nombre_completo||"")):$.value==="fecha"?a.sort((o,p)=>{const x=o.ultima_cita?new Date(o.ultima_cita):new Date(0);return(p.ultima_cita?new Date(p.ultima_cita):new Date(0))-x}):$.value==="citas"&&a.sort((o,p)=>(p.total_citas||0)-(o.total_citas||0));const t=(N.value-1)*G,m=t+G;return a.slice(t,m)}),s=P(()=>{const a=b.value.length;return Math.ceil(a/G)}),c=a=>a?a.split(" ").map(t=>t[0]).join("").toUpperCase().substring(0,2):"PA",h=a=>a?new Date(a).toLocaleDateString("es-ES",{day:"numeric",month:"short",year:"numeric"}):"Sin registro",Q=a=>{const t=a?.toLowerCase()||"inactivo";return t==="activo"?"bg-green-100 text-green-700":t==="pausa"||t==="en pausa"?"bg-yellow-100 text-yellow-700":"bg-gray-100 text-gray-700"},Z=a=>{const t=a?.toLowerCase()||"inactivo";return t==="activo"?"Activo":t==="pausa"||t==="en pausa"?"En pausa":"Inactivo"},ce=a=>{D.push(`/coordinadora/pacientes/${a.id}`)},J=()=>{D.push("/coordinadora/pacientes/nuevo")},ue=a=>{D.push(`/coordinadora/agenda?paciente=${a.id}`)},X=a=>{if(!a.telefono){alert("Este paciente no tiene telÃ©fono registrado");return}const t=a.telefono.replace(/\D/g,""),m=encodeURIComponent(`Hola ${a.nombre_completo}, te escribo desde el consultorio de PsicÃ³loga Karem.`);window.open(`https://wa.me/${t}?text=${m}`,"_blank")},pe=async a=>{u.value={...a},k.value=!0,await O(a.id),await Te();const t=document.querySelector('[role="dialog"] button');t&&t.focus()},R=()=>{k.value=!1,setTimeout(()=>{u.value=null},300)},fe=a=>{console.log("Enviar recordatorio a:",a.nombre_completo),alert(`Funcionalidad de recordatorios prÃ³ximamente disponible para ${a.nombre_completo}`)},me=a=>{R(),D.push(`/coordinadora/agenda?paciente=${a.id}`)},xe=a=>{console.log("Renovar bono:",a),alert("Funcionalidad de renovaciÃ³n de bono prÃ³ximamente disponible")},ge=a=>{console.log("Ver detalles de bono:",a),alert(`Detalles del bono: ${a.sesiones_totales} sesiones - ${a.sesiones_usadas} usadas`)},ve=()=>{console.log("Crear nuevo bono para:",u.value),alert("Funcionalidad de creaciÃ³n de bono prÃ³ximamente disponible")},be=async a=>{console.log("Confirmar pago de bono:",a);const t=prompt(`MÃ©todo de pago:
1. Transferencia
2. Tarjeta
3. Efectivo
4. Bizum
5. PayPal
6. Otro

Ingrese el nÃºmero del mÃ©todo:`,"1");if(!t)return;const o={1:"transferencia",2:"tarjeta",3:"efectivo",4:"bizum",5:"paypal",6:"otro"}[t]||"transferencia";try{const{data:p,error:x}=await v.rpc("confirmar_pago_bono",{p_bono_id:a.id,p_metodo_pago:o});if(x)throw x;p&&p.success?(alert(`âœ… Pago confirmado correctamente

MÃ©todo: ${o}
Fecha: ${new Date().toLocaleDateString("es-ES")}`),A.value++,u.value?.id&&await O(u.value)):alert(`âŒ Error: ${p?.error||"No se pudo confirmar el pago"}`)}catch(p){console.error("Error al confirmar pago:",p),alert(`âŒ Error al confirmar el pago: ${p.message}`)}},_e=async a=>{if(console.log("Revertir pago de bono:",a),!!confirm(`âš ï¸ Â¿EstÃ¡s seguro de que quieres revertir el pago de este bono?

Esta acciÃ³n marcarÃ¡ el bono como "NO PAGADO" y eliminarÃ¡:
- Fecha de pago
- MÃ©todo de pago
- Registro de quiÃ©n confirmÃ³ el pago

Esta acciÃ³n es Ãºtil si marcaste el pago por error.`))try{const{data:m,error:o}=await v.rpc("revertir_pago_bono",{p_bono_id:a.id});if(o)throw o;m&&m.success?(alert(`âœ… Pago revertido correctamente

El bono ahora estÃ¡ marcado como "NO PAGADO"`),A.value++,u.value?.id&&await O(u.value)):alert(`âŒ Error: ${m?.error||"No se pudo revertir el pago"}`)}catch(m){console.error("Error al revertir pago:",m),alert(`âŒ Error al revertir el pago: ${m.message}`)}},he=async()=>{try{console.log("[Pacientes] Cargando lista de terapeutas...");const{data:a,error:t}=await v.from("profiles").select("id, nombre").in("rol",["psicologa","admin","coordinadora"]).order("nombre",{ascending:!0});if(t)throw console.error("[Pacientes] Error al cargar terapeutas:",t),t;console.log("[Pacientes] Terapeutas cargados:",a?.length||0),y.value=a||[]}catch(a){console.error("[Pacientes] Error fatal al cargar terapeutas:",a),y.value=[]}},ye=async()=>{E.value=!0;try{console.log("[Pacientes] Iniciando carga de pacientes...");const{data:a,error:t}=await v.from("pacientes").select("*").order("nombre_completo",{ascending:!0});if(t)throw console.error("[Pacientes] Error al cargar pacientes:",t),t;if(console.log("[Pacientes] Pacientes cargados:",a?.length||0),!a||a.length===0){console.warn("[Pacientes] No hay pacientes en la base de datos"),b.value=[];return}const m=[...new Set(a.map(x=>x.terapeuta_id).filter(Boolean))],o=new Map;if(m.length>0){const{data:x}=await v.from("profiles").select("id, nombre").in("id",m);x?.forEach(B=>{o.set(B.id,B.nombre)})}const p=await Promise.all(a.map(async x=>{try{const{count:B,data:ee}=await v.from("sesiones").select("fecha, estado",{count:"exact"}).eq("paciente_id",x.id).order("fecha",{ascending:!1}).limit(10),te=new Date,we=ee?.filter(U=>new Date(U.fecha)<=te)||[],se=ee?.filter(U=>new Date(U.fecha)>te)||[],$e=we[0],ke=se[se.length-1],{count:Ce}=await v.from("sesiones").select("*",{count:"exact",head:!0}).eq("paciente_id",x.id).eq("estado","realizada"),{data:Pe,error:je}=await v.from("bonos").select("id, sesiones_restantes, created_at as fecha_compra").eq("paciente_id",x.id).eq("activo",!0).order("created_at",{ascending:!1}).limit(1).maybeSingle();return{...x,terapeuta_nombre:o.get(x.terapeuta_id)||null,estado:x.activo?"activo":"inactivo",total_citas:B||0,sesiones_completadas:Ce||0,ultima_cita:$e?.fecha||null,proxima_cita:ke?.fecha||null,bono_activo:je?null:Pe}}catch(B){return console.error(`[Pacientes] Error procesando paciente ${x.id}:`,B),{...x,terapeuta_nombre:o.get(x.terapeuta_id)||null,estado:x.activo?"activo":"inactivo",total_citas:0,sesiones_completadas:0,ultima_cita:null,proxima_cita:null,bono_activo:null}}}));console.log("[Pacientes] Datos procesados:",p.length),b.value=p}catch(a){console.error("[Pacientes] Error fatal al cargar pacientes:",a),b.value=[]}finally{E.value=!1}},O=async a=>{try{const{data:t,error:m}=await v.from("sesiones").select("id, fecha, hora_inicio, hora_fin, estado, notas_terapeuta").eq("paciente_id",a).order("fecha",{ascending:!1}).limit(5);if(m)throw m;u.value&&(u.value.ultimas_sesiones=t?.map(o=>({id:o.id,fecha_cita:o.fecha,hora_inicio:o.hora_inicio,hora_fin:o.hora_fin,estado:o.estado,notas:o.notas_terapeuta}))||[])}catch(t){console.error("Error al cargar detalles del paciente:",t)}};le(()=>{he(),ye(),window.addEventListener("keydown",Y)}),ze(()=>{window.removeEventListener("keydown",Y)});const Y=a=>{a.key==="Escape"&&k.value&&R()};return(a,t)=>{const m=Kt;return i(),d("div",Gt,[e("div",Wt,[e("div",Qt,[e("div",null,[t[7]||(t[7]=e("h1",{class:"text-2xl font-serif font-bold text-cafe"},"GestiÃ³n de Pacientes",-1)),e("p",Zt,n(r(I))+" pacientes registrados â€” "+n(r(L))+" activos ",1)]),e("div",Jt,[e("div",Xt,[q(e("input",{"onUpdate:modelValue":t[0]||(t[0]=o=>M(_)?_.value=o:null),type:"text",placeholder:"Buscar por nombre, email, terapeuta o telÃ©fono...",class:"w-full px-4 py-2 pl-10 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-300/20 transition-all duration-200"},null,512),[[Fe,r(_)]]),t[8]||(t[8]=e("span",{class:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"}," ğŸ” ",-1))]),e("button",{onClick:J,class:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-600/90 transition-all duration-200 text-sm font-medium whitespace-nowrap flex items-center gap-2"},[...t[9]||(t[9]=[e("span",null,"â•",-1),e("span",null,"Nuevo Paciente",-1)])])])]),e("div",Yt,[q(e("select",{"onUpdate:modelValue":t[1]||(t[1]=o=>M(w)?w.value=o:null),class:"px-3 py-2 border border-gray-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-purple-300/20 transition-all duration-200"},[...t[10]||(t[10]=[e("option",{value:""},"Todos los estados",-1),e("option",{value:"activo"},"âœ… Activos",-1),e("option",{value:"inactivo"},"â¸ï¸ Inactivos",-1),e("option",{value:"pausa"},"â¸ï¸ En pausa",-1)])],512),[[H,r(w)]]),q(e("select",{"onUpdate:modelValue":t[2]||(t[2]=o=>M(C)?C.value=o:null),class:"px-3 py-2 border border-gray-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-purple-300/20 transition-all duration-200"},[t[11]||(t[11]=e("option",{value:""},"Todos los terapeutas",-1)),(i(!0),d(z,null,F(r(y),o=>(i(),d("option",{key:o.id,value:o.id},n(o.nombre),9,es))),128))],512),[[H,r(C)]]),q(e("select",{"onUpdate:modelValue":t[3]||(t[3]=o=>M($)?$.value=o:null),class:"px-3 py-2 border border-gray-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-purple-300/20 transition-all duration-200"},[...t[12]||(t[12]=[e("option",{value:"nombre"},"Ordenar por nombre",-1),e("option",{value:"fecha"},"Fecha Ãºltima sesiÃ³n",-1),e("option",{value:"citas"},"MÃ¡s citas",-1)])],512),[[H,r($)]])])]),e("div",ts,[e("div",ss,[e("div",os,[t[14]||(t[14]=e("div",{class:"text-3xl"},"ğŸ‘¥",-1)),e("div",as,[e("div",ns,n(r(I)),1),t[13]||(t[13]=e("div",{class:"text-sm text-cafe/60"},"Total pacientes",-1))])])]),e("div",rs,[e("div",ls,[t[16]||(t[16]=e("div",{class:"text-3xl"},"ğŸŸ¢",-1)),e("div",is,[e("div",ds,n(r(L)),1),t[15]||(t[15]=e("div",{class:"text-sm text-green-600/80"},"Activos",-1))])])]),e("div",cs,[e("div",us,[t[18]||(t[18]=e("div",{class:"text-3xl"},"ğŸ§‘â€âš•ï¸",-1)),e("div",ps,[e("div",fs,n(r(T)),1),t[17]||(t[17]=e("div",{class:"text-sm text-blue-600/80"},"Prom. por terapeuta",-1))])])]),e("div",ms,[e("div",xs,[t[20]||(t[20]=e("div",{class:"text-3xl"},"ğŸ’³",-1)),e("div",gs,[e("div",vs,n(r(V)),1),t[19]||(t[19]=e("div",{class:"text-sm text-purple-600/80"},"Bonos activos",-1))])])])]),r(E)?(i(),d("div",bs,[...t[21]||(t[21]=[e("div",{class:"text-center text-gray-400 animate-pulse"},[e("span",{class:"text-4xl block mb-2"},"â³"),e("p",null,"Cargando pacientes...")],-1)])])):r(l).length===0?(i(),d("div",_s,[e("div",hs,[t[22]||(t[22]=e("span",{class:"text-6xl block mb-4"},"ğŸ‘¥",-1)),t[23]||(t[23]=e("h3",{class:"text-xl font-semibold text-cafe mb-2"}," No se encontraron pacientes ",-1)),e("p",ys,n(r(_)?"Intenta con otros tÃ©rminos de bÃºsqueda":"Comienza agregando tu primer paciente"),1),r(_)?f("",!0):(i(),d("button",{key:0,onClick:J,class:"inline-flex items-center px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-600/90 transition-all duration-200"}," + Crear Primer Paciente "))])])):(i(),d("div",ws,[(i(!0),d(z,null,F(r(l),o=>(i(),d("div",{key:o.id,class:"bg-white rounded-xl shadow-sm border border-gray-100 p-6 hover:shadow-lg transition-all duration-300 cursor-pointer transform hover:-translate-y-1",onClick:p=>ce(o)},[e("div",ks,[e("div",Cs,[e("span",Ps,n(c(o.nombre_completo)),1)]),e("div",js,[e("h3",Es,n(o.nombre_completo),1),e("p",Bs,n(o.email),1),o.telefono?(i(),d("p",Ds," ğŸ“± "+n(o.telefono),1)):f("",!0)])]),o.terapeuta_nombre?(i(),d("div",As,[t[24]||(t[24]=e("span",{class:"text-cafe/60"},"ğŸ§‘â€âš•ï¸",-1)),e("span",Ss,n(o.terapeuta_nombre),1)])):f("",!0),e("div",zs,[o.area_de_acompanamiento?(i(),d("div",Fs,[t[25]||(t[25]=e("span",{class:"text-gray-400"},"ğŸ¯",-1)),e("span",Ns,n(o.area_de_acompanamiento),1)])):f("",!0),e("div",Is,[t[26]||(t[26]=e("span",{class:"text-gray-400"},"ğŸ“…",-1)),e("span",Ts,n(o.total_citas||0)+" sesiones",1)]),o.ultima_cita?(i(),d("div",Vs,[t[27]||(t[27]=e("span",{class:"text-gray-400"},"ğŸ•",-1)),e("span",Rs,"Ãšltima: "+n(h(o.ultima_cita)),1)])):f("",!0),o.proxima_cita?(i(),d("div",qs,[t[28]||(t[28]=e("span",{class:"text-gray-400"},"ğŸ“†",-1)),e("span",Ls,"PrÃ³xima: "+n(h(o.proxima_cita)),1)])):f("",!0)]),e("div",Ms,[e("span",{class:j(["px-3 py-1 rounded-full text-xs font-medium transition-all duration-200",Q(o.estado)])},n(Z(o.estado)),3),e("div",Os,[e("button",{onClick:K(p=>ue(o),["stop"]),class:"p-2 text-purple-600 hover:bg-purple-600/10 rounded-lg transition-all duration-200",title:"Ver agenda"}," ï¿½ ",8,Us),e("button",{onClick:K(p=>X(o),["stop"]),class:"p-2 text-green-600 hover:bg-green-50 rounded-lg transition-all duration-200",title:"Abrir WhatsApp"}," ğŸ’¬ ",8,Hs),e("button",{onClick:K(p=>pe(o),["stop"]),class:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-all duration-200",title:"Ver detalles"}," ğŸ‘ï¸ ",8,Ks)])])],8,$s))),128))])),r(l).length>0&&r(s)>1?(i(),d("div",Gs,[(i(!0),d(z,null,F(r(s),o=>(i(),d("button",{key:o,onClick:p=>N.value=o,class:j(["px-4 py-2 rounded-lg transition-all duration-200",r(N)===o?"bg-purple-600 text-white shadow-md":"bg-white border border-gray-200 text-cafe hover:bg-gray-50"])},n(o),11,Ws))),128))])):f("",!0),ae(re,{"enter-active-class":"transition-all duration-500 ease-out","leave-active-class":"transition-all duration-500 ease-in","enter-from-class":"translate-x-full opacity-0","enter-to-class":"translate-x-0 opacity-100","leave-from-class":"translate-x-0 opacity-100","leave-to-class":"translate-x-full opacity-0"},{default:ne(()=>[r(k)&&r(u)?(i(),d("div",{key:0,class:"fixed right-0 top-0 h-screen w-full md:w-2/3 lg:w-1/2 bg-white rounded-l-3xl shadow-2xl shadow-black/5 z-50 overflow-y-auto scroll-smooth",role:"dialog","aria-modal":"true","aria-labelledby":"panel-title",tabindex:"0",onKeydown:Ne(R,["esc"])},[e("div",Qs,[e("div",Zs,[e("div",Js,[e("div",Xs,n(c(r(u).nombre_completo)),1),e("div",Ys,[e("h2",eo,n(r(u).nombre_completo),1),e("div",to,[e("span",{class:j(["inline-flex items-center px-3 py-1 rounded-full text-xs font-semibold",Q(r(u).estado)])},n(Z(r(u).estado)),3),r(u).terapeuta_nombre?(i(),d("span",so," ğŸ§‘â€âš•ï¸ "+n(r(u).terapeuta_nombre),1)):f("",!0)])])]),e("button",{onClick:R,class:"text-cafe/40 hover:text-cafe transition-all duration-200 text-2xl leading-none w-10 h-10 rounded-full flex items-center justify-center hover:bg-cafe/5 hover:rotate-90","aria-label":"Cerrar panel"}," âœ• ")])]),e("div",oo,[e("section",ao,[t[31]||(t[31]=e("h3",{class:"font-serif font-semibold text-cafe text-lg mb-4 flex items-center gap-2"},[e("span",{class:"text-xl"},"ğŸ“"),e("span",null,"InformaciÃ³n de Contacto")],-1)),e("div",no,[e("div",ro,[t[29]||(t[29]=e("span",{class:"w-6 text-lg"},"âœ‰ï¸",-1)),e("span",lo,n(r(u).email),1)]),r(u).telefono?(i(),d("div",io,[t[30]||(t[30]=e("span",{class:"w-6 text-lg"},"ğŸ“±",-1)),e("span",co,n(r(u).telefono),1)])):f("",!0)])]),r(u).area_de_acompanamiento?(i(),d("section",uo,[t[32]||(t[32]=e("h3",{class:"font-serif font-semibold text-cafe text-lg mb-3 flex items-center gap-2"},[e("span",{class:"text-xl"},"ğŸ¯"),e("span",null,"Ãrea de AcompaÃ±amiento")],-1)),e("p",po,n(r(u).area_de_acompanamiento),1)])):f("",!0),e("section",fo,[t[37]||(t[37]=e("h3",{class:"font-serif font-semibold text-cafe text-lg mb-4 flex items-center gap-2"},[e("span",{class:"text-xl"},"ï¿½"),e("span",null,"EstadÃ­sticas")],-1)),e("div",mo,[e("div",xo,[t[33]||(t[33]=e("span",{class:"text-sm text-cafe/70"},"Total de sesiones",-1)),e("span",go,n(r(u).total_citas||0),1)]),e("div",vo,[t[34]||(t[34]=e("span",{class:"text-sm text-cafe/70"},"Completadas",-1)),e("span",bo,n(r(u).sesiones_completadas||0),1)]),r(u).proxima_cita?(i(),d("div",_o,[t[36]||(t[36]=e("span",{class:"text-lg"},"ğŸ“…",-1)),e("div",null,[t[35]||(t[35]=e("p",{class:"text-xs text-cafe/60 uppercase tracking-wide"},"PrÃ³xima sesiÃ³n",-1)),e("p",ho,n(h(r(u).proxima_cita)),1)])])):f("",!0)])]),r(u).bono_activo?(i(),d("section",yo,[t[40]||(t[40]=e("h3",{class:"font-serif font-semibold text-cafe text-lg mb-4 flex items-center gap-2"},[e("span",{class:"text-xl"},"ï¿½"),e("span",null,"Bono Activo")],-1)),e("div",wo,[e("div",$o,[t[38]||(t[38]=e("span",{class:"text-sm text-cafe/70"},"Sesiones disponibles",-1)),e("span",ko,n(r(u).bono_activo.sesiones_restantes),1)]),e("div",Co,[t[39]||(t[39]=e("span",null,"Fecha de compra",-1)),e("span",Po,n(h(r(u).bono_activo.fecha_compra)),1)])])])):f("",!0),e("section",jo,[t[42]||(t[42]=e("h3",{class:"font-serif font-semibold text-cafe text-lg mb-5 flex items-center gap-2"},[e("span",{class:"text-xl"},"ğŸ•“"),e("span",null,"Historial de Sesiones")],-1)),r(u).ultimas_sesiones?.length?(i(),d("div",Eo,[(i(!0),d(z,null,F(r(u).ultimas_sesiones,(o,p)=>(i(),d("div",{key:o.id,class:"flex gap-4 group"},[e("div",Bo,[e("div",{class:j(["w-3 h-3 rounded-full mt-1.5 flex-shrink-0",{"bg-green-500":o.estado==="completada","bg-red-500":o.estado==="cancelada","bg-yellow-500":o.estado==="pendiente","bg-blue-500":o.estado==="confirmada"}])},null,2),p<r(u).ultimas_sesiones.length-1?(i(),d("div",Do)):f("",!0)]),e("div",Ao,[e("div",So,[e("div",zo,[e("p",Fo,n(h(o.fecha_cita)),1),e("p",No,n(o.hora_inicio)+" - "+n(o.hora_fin),1)]),e("span",{class:j(["text-xs font-semibold px-2 py-1 rounded-full whitespace-nowrap",{"text-green-700 bg-green-100":o.estado==="completada","text-red-700 bg-red-100":o.estado==="cancelada","text-yellow-700 bg-yellow-100":o.estado==="pendiente","text-blue-700 bg-blue-100":o.estado==="confirmada"}])},n(o.estado),3)]),o.notas?(i(),d("p",Io,n(o.notas),1)):f("",!0)])]))),128))])):(i(),d("div",To,[...t[41]||(t[41]=[e("span",{class:"text-4xl block mb-3 opacity-50"},"ğŸ“…",-1),e("p",{class:"text-sm text-cafe/60"},"No hay sesiones registradas aÃºn",-1)])]))]),r(u).id?(i(),Ie(m,{key:`bonos-${r(u).id}-${r(A)}`,"paciente-id":r(u).id,onRenovarBono:xe,onVerDetalles:ge,onCrearBono:ve,onConfirmarPago:be,onRevertirPago:_e},null,8,["paciente-id"])):f("",!0),e("section",Vo,[e("button",{onClick:t[4]||(t[4]=o=>fe(r(u))),class:"px-4 py-3 bg-yellow-500 hover:bg-yellow-600 text-white rounded-xl font-medium flex items-center justify-center gap-2 shadow-sm transition-all duration-200 hover:shadow-md hover:-translate-y-0.5"},[...t[43]||(t[43]=[e("span",{class:"text-lg"},"ğŸ””",-1),e("span",{class:"text-sm"},"Recordatorio",-1)])]),e("button",{onClick:t[5]||(t[5]=o=>me(r(u))),class:"px-4 py-3 bg-purple-600 hover:bg-purple-600/90 text-white rounded-xl font-medium flex items-center justify-center gap-2 shadow-sm transition-all duration-200 hover:shadow-md hover:-translate-y-0.5"},[...t[44]||(t[44]=[e("span",{class:"text-lg"},"ğŸ“…",-1),e("span",{class:"text-sm"},"Ver Agenda",-1)])]),e("button",{onClick:t[6]||(t[6]=o=>X(r(u))),class:"px-4 py-3 bg-green-500 hover:bg-green-600 text-white rounded-xl font-medium flex items-center justify-center gap-2 shadow-sm transition-all duration-200 hover:shadow-md hover:-translate-y-0.5"},[...t[45]||(t[45]=[e("span",{class:"text-lg"},"ğŸ’¬",-1),e("span",{class:"text-sm"},"WhatsApp",-1)])])])])],32)):f("",!0)]),_:1}),ae(re,{"enter-active-class":"transition-opacity duration-300","leave-active-class":"transition-opacity duration-300","enter-from-class":"opacity-0","enter-to-class":"opacity-100","leave-from-class":"opacity-100","leave-to-class":"opacity-0"},{default:ne(()=>[r(k)?(i(),d("div",{key:0,class:"fixed inset-0 bg-black/30 backdrop-blur-sm z-40",onClick:R})):f("",!0)]),_:1})])}}},Oo=de(Ro,[["__scopeId","data-v-9904d24a"]]);export{Oo as default};
