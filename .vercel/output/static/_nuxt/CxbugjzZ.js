import{e as N,r as E,f as A,H as M,G as H,B as z,c as s,o,a as t,b as T,g as i,y as m,k as n,t as h,T as L,w as $,F as S,s as R}from"#entry";import{u as G}from"./o2OI1TfI.js";import{_ as I}from"./DlAUqK2U.js";const O={class:"relative"},U={key:0,class:"absolute top-0 right-0 inline-flex items-center justify-center w-5 h-5 text-xs font-bold text-white bg-[#D8AFA0] rounded-full border-2 border-[#F9F7F3]"},q={key:0,class:"absolute right-0 mt-2 w-80 max-w-[90vw] bg-white rounded-lg shadow-xl border border-[#EAD5D3]/40 z-50 overflow-hidden"},J={class:"px-4 py-3 border-b border-[#EAD5D3]/30 flex items-center justify-between bg-[#F9F7F3]"},K={class:"max-h-[400px] overflow-y-auto"},P={key:0,class:"p-8 text-center"},Q={key:1,class:"p-8 text-center text-[#5D4A44]/60 font-lato text-sm"},W={key:2},X=["onClick"],Y={class:"flex items-start gap-3"},Z={key:0,class:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20"},tt={key:1,class:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20"},et={class:"flex-1 min-w-0"},st={key:0,class:"text-xs text-[#5D4A44]/70 font-lato mt-1 line-clamp-2"},ot={class:"text-xs text-[#5D4A44]/50 font-lato mt-1"},at={key:0,class:"flex-shrink-0 w-2 h-2 bg-[#D8AFA0] rounded-full mt-2"},nt={key:0,class:"px-4 py-2 border-t border-[#EAD5D3]/30 bg-[#F9F7F3] text-center"},rt=N({__name:"NotificacionesBell",setup(it){const{notificaciones:c,totalNoVistas:v,loading:D,listar:x,marcarVista:g,marcarTodasVistas:w,suscribirse:y,desuscribirse:k}=G();let d=null,u=null;const r=E(!1);A(()=>{d=M(),u=H()}),A(async()=>{await x(10),y()}),z(()=>{k()});const F=async()=>{r.value=!r.value,r.value&&await x(10)},C=async()=>{await w()},B=async l=>{await g(l.id),r.value=!1,l.tipo==="mensaje"&&d&&u&&(u.path.includes("/paciente")?d.push("/paciente/mensajes"):u.path.includes("/terapeuta")&&d.push("/terapeuta/mensajes"))},j=()=>{r.value=!1},V=l=>{const e=new Date(l),f=new Date().getTime()-e.getTime(),p=Math.floor(f/6e4),b=Math.floor(f/36e5),_=Math.floor(f/864e5);return p<1?"Ahora":p<60?`Hace ${p}m`:b<24?`Hace ${b}h`:_<7?`Hace ${_}d`:e.toLocaleDateString("es-ES",{day:"2-digit",month:"short"})};return(l,e)=>(o(),s("div",O,[t("button",{onClick:F,class:m(["relative p-2 rounded-full hover:bg-[#EAD5D3]/20 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-[#D8AFA0]/50",{"bg-[#EAD5D3]/20":n(r)}]),"aria-label":"Notificaciones"},[e[1]||(e[1]=t("svg",{class:"w-6 h-6 text-[#5D4A44]",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"})],-1)),n(v)>0?(o(),s("span",U,h(n(v)>9?"9+":n(v)),1)):i("",!0)],2),T(L,{"enter-active-class":"transition ease-out duration-200","enter-from-class":"opacity-0 translate-y-1","enter-to-class":"opacity-100 translate-y-0","leave-active-class":"transition ease-in duration-150","leave-from-class":"opacity-100 translate-y-0","leave-to-class":"opacity-0 translate-y-1"},{default:$(()=>[n(r)?(o(),s("div",q,[t("div",J,[e[2]||(e[2]=t("h3",{class:"text-sm font-semibold text-[#5D4A44] font-lora"}," Notificaciones ",-1)),n(c).length>0?(o(),s("button",{key:0,onClick:C,class:"text-xs text-[#D8AFA0] hover:text-[#C89B8A] font-lato transition-colors"}," Marcar todas como leÃ­das ")):i("",!0)]),t("div",K,[n(D)?(o(),s("div",P,[...e[3]||(e[3]=[t("div",{class:"inline-block w-8 h-8 border-4 border-[#EAD5D3] border-t-[#D8AFA0] rounded-full animate-spin"},null,-1)])])):n(c).length===0?(o(),s("div",Q,[...e[4]||(e[4]=[t("svg",{class:"w-12 h-12 mx-auto mb-3 text-[#EAD5D3]",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4"})],-1),t("p",null,"No tienes notificaciones",-1)])])):(o(),s("div",W,[(o(!0),s(S,null,R(n(c),a=>(o(),s("button",{key:a.id,onClick:f=>B(a),class:m(["w-full px-4 py-3 hover:bg-[#F9F7F3] transition-colors border-b border-[#EAD5D3]/20 text-left group",{"bg-[#EAD5D3]/10":!a.visto}])},[t("div",Y,[t("div",{class:m(["flex-shrink-0 w-8 h-8 rounded-full flex items-center justify-center",a.tipo==="mensaje"?"bg-[#D8AFA0]/20 text-[#D8AFA0]":"bg-[#8A9A5B]/20 text-[#8A9A5B]"])},[a.tipo==="mensaje"?(o(),s("svg",Z,[...e[5]||(e[5]=[t("path",{d:"M2 5a2 2 0 012-2h12a2 2 0 012 2v10a2 2 0 01-2 2H4a2 2 0 01-2-2V5zm3.293 1.293a1 1 0 011.414 0l3.293 3.293 3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z"},null,-1)])])):(o(),s("svg",tt,[...e[6]||(e[6]=[t("path",{d:"M10 2a6 6 0 00-6 6v3.586l-.707.707A1 1 0 004 14h12a1 1 0 00.707-1.707L16 11.586V8a6 6 0 00-6-6zM10 18a3 3 0 01-3-3h6a3 3 0 01-3 3z"},null,-1)])]))],2),t("div",et,[t("p",{class:m(["text-sm font-medium text-[#5D4A44] font-lato",{"font-semibold":!a.visto}])},h(a.titulo),3),a.mensaje?(o(),s("p",st,h(a.mensaje),1)):i("",!0),t("p",ot,h(V(a.created_at)),1)]),a.visto?i("",!0):(o(),s("div",at))])],10,X))),128))]))]),n(c).length>0?(o(),s("div",nt,[t("button",{onClick:j,class:"text-xs text-[#D8AFA0] hover:text-[#C89B8A] font-lato font-medium transition-colors"}," Ver todas las notificaciones ")])):i("",!0)])):i("",!0)]),_:1}),n(r)?(o(),s("div",{key:0,onClick:e[0]||(e[0]=a=>r.value=!1),class:"fixed inset-0 z-40"})):i("",!0)]))}}),ut=Object.assign(I(rt,[["__scopeId","data-v-6aeea26d"]]),{__name:"NotificacionesBell"});export{ut as _};
