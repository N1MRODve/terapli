import{u as Ne,_ as Fe}from"./ModalNuevaCitaEnhanced-ClfMSGs5.js";import{M as Pe}from"./ModalDetallesCita-CZ6Vzvt2.js";import{e as Re,p as Ke,r as i,x as C,g as Ue,E as Oe,c as n,o as l,a as t,b as we,D as F,t as d,F as j,y as $,A as p,d as E,k as P,v as de,i as qe,l as G,z as ue,h as f,C as B,j as _,K as J,B as ke,w as Ye,T as Ze}from"#entry";import{s as Ge}from"./interval-BzLCLO6P.js";import{_ as Je}from"./_plugin-vue_export-helper-DlAUqK2U.js";const Qe={class:"agenda-calendario min-h-screen bg-gray-50/50"},We={class:"bg-white border-b border-gray-100 px-6 py-4"},Xe={class:"flex items-center justify-between gap-4"},et={class:"flex items-center gap-3"},tt={class:"text-xl font-bold text-gray-800 tracking-tight"},ot={class:"flex items-center gap-4"},at={class:"flex items-center bg-gray-100 rounded-full p-1"},rt=["onClick"],lt={class:"bg-white border-b border-gray-100 px-6 py-3"},st={class:"flex items-center gap-4"},nt={class:"flex-1 relative"},it={class:"bg-white border-b border-gray-100 px-6 py-4"},dt={class:"flex flex-wrap items-center gap-3 mb-4"},ut={class:"text-sm"},ct={class:"text-sm"},vt={class:"text-sm"},pt={class:"text-sm"},mt={class:"flex-1 overflow-auto",style:{height:"calc(100vh - 320px)"}},ft={key:0,class:"flex items-center justify-center h-full"},gt={key:1,class:"min-w-max"},bt={class:"text-xs font-medium text-gray-400 uppercase tracking-wider"},xt={key:0,class:"w-6 h-0.5 bg-violet-500 mx-auto mt-1 rounded-full"},yt={class:"relative"},ht={class:"flex items-center"},wt={class:"px-1.5 py-0.5 bg-red-500 text-white text-xs font-bold rounded"},kt={class:"px-3 py-2 text-xs font-medium text-gray-400 text-right border-r border-gray-100 h-11"},Ct=["onClick"],_t={key:0,class:"absolute inset-0 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity"},Dt=["onClick","onKeydown","aria-label"],St={class:"absolute top-0.5 right-0.5 flex items-center gap-0.5 opacity-0 group-hover/card:opacity-100 focus-within:opacity-100 transition-opacity z-20"},Mt=["onClick","onKeydown","disabled","title","aria-label"],zt={key:0,class:"w-2.5 h-2.5 animate-spin",fill:"none",viewBox:"0 0 24 24"},jt={key:1,class:"w-2.5 h-2.5",fill:"currentColor",viewBox:"0 0 20 20"},$t=["onClick","onKeydown","aria-label"],Bt=["onClick","onKeydown","aria-label"],Lt={class:"pr-16"},At={class:"text-xs text-gray-500 font-medium"},Et={class:"text-sm font-semibold text-gray-800 truncate mt-0.5"},Vt={class:"bg-white rounded-2xl shadow-2xl max-w-md w-full overflow-hidden animate-modal-enter"},Ht={class:"p-6 space-y-5"},Tt={class:"bg-gray-50 rounded-xl p-4"},It={class:"space-y-3"},Nt={class:"flex items-center gap-3"},Ft={class:"font-medium text-gray-900"},Pt={class:"flex items-center gap-3"},Rt={class:"font-medium text-gray-900"},Kt={class:"text-sm text-gray-500"},Ut={class:"px-6 py-4 border-t border-gray-100 bg-gray-50 flex items-center justify-end gap-3"},Ot=["disabled"],qt={key:0,class:"w-4 h-4 animate-spin",fill:"none",viewBox:"0 0 24 24"},Yt={class:"bg-white rounded-2xl shadow-2xl max-w-md w-full overflow-hidden animate-modal-enter"},Zt={class:"px-6 py-4 border-b border-gray-100 bg-gradient-to-r from-blue-50 to-indigo-50"},Gt={class:"flex items-center justify-between"},Jt={class:"text-sm text-gray-500 mt-0.5"},Qt={class:"p-6 space-y-5"},Wt={class:"bg-gray-50 rounded-xl p-4"},Xt={class:"flex items-center gap-3"},eo={class:"font-medium text-gray-900"},to={class:"text-sm text-gray-500"},oo=["min"],ao={class:"grid grid-cols-2 gap-4"},ro=["value"],lo=["value"],so={class:"px-6 py-4 border-t border-gray-100 bg-gray-50 flex items-center justify-end gap-3"},no=["disabled"],io={key:0,class:"w-4 h-4 animate-spin",fill:"none",viewBox:"0 0 24 24"},uo={key:0,class:"fixed bottom-6 right-6 z-[100] max-w-sm",role:"alert","aria-live":"polite"},co={key:0,class:"w-5 h-5 text-emerald-600",fill:"currentColor",viewBox:"0 0 20 20"},vo={key:1,class:"w-5 h-5 text-red-600",fill:"currentColor",viewBox:"0 0 20 20"},po={key:2,class:"w-5 h-5 text-blue-600",fill:"currentColor",viewBox:"0 0 20 20"},mo={class:"text-sm font-medium flex-1"},fo=Re({__name:"AgendaCalendario",props:{modoCoordinadora:{type:Boolean,default:!1}},emits:["nueva-cita","ver-cita"],setup(Ce,{emit:go}){const Q=Ce,{citas:D,loading:_e,loadAllAppointments:De,loadTerapeutaAppointments:Se,changeAppointmentStatus:ce,moveAppointment:Me,refreshAppointments:W}=Ne(),ze=Ke(),S=i("semana"),V=i(new Date),R=i(""),X=i(!1),x=i(["pendiente","confirmada","realizada","cancelada"]),je=i([]),ve=i(null),H=i(!1),ee=i(null),te=i(null),oe=i(!1),K=i(null),M=i(null),L=i(null),A=i(null),ae=i(!1),g=i(null),U=i(""),re=i(!1),b=i(null),k=i(""),y=i(""),z=i(""),pe=i(""),w=i("info"),O=i(!1),m=(o,e="info")=>{pe.value=o,w.value=e,O.value=!0,setTimeout(()=>{O.value=!1},4e3)},$e=C(()=>{const o=[];for(let e=9;e<=21;e++)o.push(`${String(e).padStart(2,"0")}:00`),e<21&&o.push(`${String(e).padStart(2,"0")}:30`);return o}),q=C(()=>{const o=new Date(V.value),e=[],s=new Date().toISOString().split("T")[0];if(S.value==="dia"){const u=o.toISOString().split("T")[0];e.push({fecha:u,diaSemana:o.toLocaleDateString("es-ES",{weekday:"long"}).toUpperCase(),numeroDia:o.getDate(),mes:o.toLocaleDateString("es-ES",{month:"short"}),esHoy:u===s})}else if(S.value==="5dias")for(let u=0;u<5;u++){const a=new Date(o);a.setDate(o.getDate()+u);const c=a.toISOString().split("T")[0];e.push({fecha:c,diaSemana:a.toLocaleDateString("es-ES",{weekday:"long"}).toUpperCase(),numeroDia:a.getDate(),mes:a.toLocaleDateString("es-ES",{month:"short"}),esHoy:c===s})}else if(S.value==="semana"){const u=o.getDay(),a=new Date(o);a.setDate(o.getDate()-(u===6?0:u+1));for(let c=0;c<7;c++){const r=new Date(a);r.setDate(a.getDate()+c);const v=r.toISOString().split("T")[0];e.push({fecha:v,diaSemana:r.toLocaleDateString("es-ES",{weekday:"long"}).toUpperCase(),numeroDia:r.getDate(),mes:r.toLocaleDateString("es-ES",{month:"short"}),esHoy:v===s})}}return e}),Be=C(()=>{const o=V.value,e=o.toLocaleDateString("es-ES",{month:"long"}),s=o.getFullYear(),u=new Date(o.getFullYear(),0,1),a=Math.floor((o.getTime()-u.getTime())/(1440*60*1e3)),c=Math.ceil((a+u.getDay()+1)/7);return`${e.charAt(0).toUpperCase()+e.slice(1)} De ${s} — Semana ${c}`}),Le=C(()=>{let o=D.value;if(Q.modoCoordinadora&&ve.value&&(o=o.filter(e=>e.terapeuta_id===ve.value)),x.value.length>0&&x.value.length<4&&(o=o.filter(e=>x.value.includes(e.estado))),R.value.trim()){const e=R.value.toLowerCase();o=o.filter(s=>{const u=(s.paciente_nombre||s.paciente?.nombre_completo||"").toLowerCase(),a=(s.terapeuta_nombre||s.terapeuta?.nombre_completo||"").toLowerCase(),c=(s.observaciones||"").toLowerCase();return u.includes(e)||a.includes(e)||c.includes(e)})}return o}),Y=C(()=>({pendiente:D.value.filter(o=>o.estado==="pendiente").length,confirmada:D.value.filter(o=>o.estado==="confirmada").length,realizada:D.value.filter(o=>o.estado==="realizada"||o.estado==="completada").length,cancelada:D.value.filter(o=>o.estado==="cancelada").length})),le=(o,e)=>Le.value.filter(s=>s.fecha_cita!==o?!1:s.hora_inicio?.substring(0,5)===e),se=i(new Date),me=C(()=>{const o=se.value,e=o.getHours(),s=o.getMinutes();return e<9||e>=21?null:((e-9)*60+s)/30*44});let ne=null;const fe=o=>{const e=new Date(V.value);S.value==="dia"?e.setDate(e.getDate()+o):S.value==="5dias"?e.setDate(e.getDate()+o*5):e.setDate(e.getDate()+o*7),V.value=e},Ae=()=>{V.value=new Date},Z=o=>{const e=x.value.indexOf(o);e>-1?x.value.splice(e,1):x.value.push(o)},ge=o=>{const e={pendiente:{bg:"bg-amber-50",border:"border-l-amber-400",text:"text-amber-700",dot:"bg-amber-400"},confirmada:{bg:"bg-emerald-50",border:"border-l-emerald-400",text:"text-emerald-700",dot:"bg-emerald-400"},realizada:{bg:"bg-blue-50",border:"border-l-blue-400",text:"text-blue-700",dot:"bg-blue-400"},completada:{bg:"bg-blue-50",border:"border-l-blue-400",text:"text-blue-700",dot:"bg-blue-400"},cancelada:{bg:"bg-red-50",border:"border-l-red-400",text:"text-red-700",dot:"bg-red-400"}};return e[o]||e.pendiente},Ee=(o,e)=>{ee.value=o,te.value=e,H.value=!0},ie=o=>{K.value=o,oe.value=!0},Ve=async()=>{if(!Q.modoCoordinadora)return;const{data:o}=await ze.from("terapeutas").select("id, nombre_completo").eq("activo",!0).order("nombre_completo");je.value=(o||[]).map(e=>({id:e.id,nombre:e.nombre_completo}))},h=o=>o?.substring(0,5)||"",be=o=>o?new Date(o+"T00:00:00").toLocaleDateString("es-ES",{weekday:"long",day:"numeric",month:"long",year:"numeric"}):"",T=C(()=>{const o=[];for(let e=9;e<=21;e++)o.push(`${String(e).padStart(2,"0")}:00`),e<21&&o.push(`${String(e).padStart(2,"0")}:30`);return o}),He=C(()=>{if(!y.value)return T.value;const o=T.value.indexOf(y.value);return o===-1?T.value:[...T.value.slice(o+1),"22:00"]}),xe=async(o,e)=>{if(e.stopPropagation(),!M.value){M.value=o;try{const s=await ce(o,"confirmada");s.success?m("Cita confirmada correctamente","success"):m(s.error||"Error al confirmar la cita","error")}catch(s){m(s.message||"Error al confirmar la cita","error")}finally{M.value=null}}},ye=(o,e)=>{e.stopPropagation();const s=D.value.find(u=>u.id===o);if(!s){m("Cita no encontrada","error");return}g.value=s,U.value="",ae.value=!0},Te=async()=>{if(!(!g.value||L.value)){L.value=g.value.id;try{const o=await ce(g.value.id,"cancelada");o.success?(m("Cita cancelada correctamente","success"),I()):m(o.error||"Error al cancelar la cita","error")}catch(o){m(o.message||"Error al cancelar la cita","error")}finally{L.value=null}}},I=()=>{ae.value=!1,g.value=null,U.value=""},he=(o,e)=>{e.stopPropagation();const s=D.value.find(u=>u.id===o);if(!s){m("Cita no encontrada","error");return}b.value=s,k.value=s.fecha_cita,y.value=h(s.hora_inicio),z.value=h(s.hora_fin),re.value=!0},Ie=async()=>{if(!(!b.value||A.value)){if(!k.value||!y.value||!z.value){m("Por favor completa todos los campos","error");return}A.value=b.value.id;try{const o=await Me(b.value.id,k.value,y.value,z.value);if(o.success){const e=new Date(k.value+"T00:00:00").toLocaleDateString("es-ES",{day:"numeric",month:"short"});m(`Cita reprogramada a ${e} ${y.value}`,"success"),N()}else m(o.error||"Error al reprogramar la cita","error")}catch(o){m(o.message||"Error al reprogramar la cita","error")}finally{A.value=null}}},N=()=>{re.value=!1,b.value=null,k.value="",y.value="",z.value=""};return Ue(async()=>{Q.modoCoordinadora?(await De(),await Ve()):await Se(),ne=Ge(()=>{se.value=new Date},6e4)}),Oe(()=>{ne&&clearInterval(ne)}),(o,e)=>{const s=Fe,u=Pe;return l(),n("div",Qe,[t("div",We,[t("div",Xe,[t("div",et,[t("button",{onClick:e[0]||(e[0]=a=>fe(-1)),class:"w-9 h-9 rounded-full border border-gray-200 flex items-center justify-center text-gray-500 hover:bg-gray-50 hover:border-gray-300 transition-all"},[...e[19]||(e[19]=[t("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1)])]),t("button",{onClick:Ae,class:"px-4 py-2 rounded-full border-2 border-violet-500 text-violet-600 font-semibold text-sm hover:bg-violet-50 transition-all"}," Hoy "),t("button",{onClick:e[1]||(e[1]=a=>fe(1)),class:"w-9 h-9 rounded-full border border-gray-200 flex items-center justify-center text-gray-500 hover:bg-gray-50 hover:border-gray-300 transition-all"},[...e[20]||(e[20]=[t("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1)])])]),t("h1",tt,d(Be.value),1),t("div",ot,[t("div",at,[(l(),n(j,null,$([{key:"dia",label:"Día"},{key:"5dias",label:"5 Días"},{key:"semana",label:"Semana"},{key:"mes",label:"Mes"}],a=>t("button",{key:a.key,onClick:c=>S.value=a.key,class:p(["px-4 py-1.5 rounded-full text-sm font-medium transition-all",S.value===a.key?"bg-violet-500 text-white shadow-sm":"text-gray-600 hover:text-gray-900"])},d(a.label),11,rt)),64))]),e[22]||(e[22]=t("button",{class:"w-9 h-9 rounded-full border border-gray-200 flex items-center justify-center text-gray-400 hover:bg-gray-50 transition-all"},[t("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"})])],-1)),t("button",{onClick:e[2]||(e[2]=a=>H.value=!0),class:"flex items-center gap-2 px-5 py-2.5 bg-violet-500 text-white font-semibold rounded-full hover:bg-violet-600 shadow-sm hover:shadow transition-all"},[...e[21]||(e[21]=[t("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),E(" Nueva Cita ",-1)])])])])]),t("div",lt,[t("div",st,[t("div",nt,[e[23]||(e[23]=t("div",{class:"absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none"},[t("svg",{class:"w-5 h-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})])],-1)),P(t("input",{"onUpdate:modelValue":e[3]||(e[3]=a=>R.value=a),type:"text",placeholder:"Buscar por paciente, terapeuta, notas...",class:"w-full pl-12 pr-4 py-3 bg-gray-50 border border-gray-200 rounded-xl text-gray-700 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-violet-500/20 focus:border-violet-400 transition-all"},null,512),[[de,R.value]])]),t("button",{onClick:e[4]||(e[4]=a=>X.value=!X.value),class:p(["flex items-center gap-2 px-5 py-3 border border-gray-200 rounded-xl text-gray-600 font-medium hover:bg-gray-50 hover:border-gray-300 transition-all",{"bg-violet-50 border-violet-300 text-violet-600":X.value}])},[...e[24]||(e[24]=[t("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"})],-1),E(" Filtros ",-1)])],2)])]),t("div",it,[e[33]||(e[33]=t("p",{class:"text-xs font-semibold text-gray-400 uppercase tracking-wider mb-3"},"Estado",-1)),t("div",dt,[t("button",{onClick:e[5]||(e[5]=a=>Z("pendiente")),class:p(["flex items-center gap-2 px-4 py-2 rounded-full border transition-all",x.value.includes("pendiente")?"bg-amber-50 border-amber-200 text-amber-700":"bg-gray-50 border-gray-200 text-gray-400"])},[e[25]||(e[25]=t("span",{class:"w-2 h-2 rounded-full bg-amber-400"},null,-1)),e[26]||(e[26]=t("span",{class:"font-medium"},"Pendientes",-1)),t("span",ut,d(Y.value.pendiente),1)],2),t("button",{onClick:e[6]||(e[6]=a=>Z("confirmada")),class:p(["flex items-center gap-2 px-4 py-2 rounded-full border transition-all",x.value.includes("confirmada")?"bg-emerald-50 border-emerald-200 text-emerald-700":"bg-gray-50 border-gray-200 text-gray-400"])},[e[27]||(e[27]=t("span",{class:"w-2 h-2 rounded-full bg-emerald-400"},null,-1)),e[28]||(e[28]=t("span",{class:"font-medium"},"Confirmadas",-1)),t("span",ct,d(Y.value.confirmada),1)],2),t("button",{onClick:e[7]||(e[7]=a=>Z("realizada")),class:p(["flex items-center gap-2 px-4 py-2 rounded-full border transition-all",x.value.includes("realizada")?"bg-blue-50 border-blue-200 text-blue-700":"bg-gray-50 border-gray-200 text-gray-400"])},[e[29]||(e[29]=t("span",{class:"w-2 h-2 rounded-full bg-blue-400"},null,-1)),e[30]||(e[30]=t("span",{class:"font-medium"},"Realizadas",-1)),t("span",vt,d(Y.value.realizada),1)],2),t("button",{onClick:e[8]||(e[8]=a=>Z("cancelada")),class:p(["flex items-center gap-2 px-4 py-2 rounded-full border transition-all",x.value.includes("cancelada")?"bg-red-50 border-red-200 text-red-700":"bg-gray-50 border-gray-200 text-gray-400"])},[e[31]||(e[31]=t("span",{class:"w-2 h-2 rounded-full bg-red-400"},null,-1)),e[32]||(e[32]=t("span",{class:"font-medium"},"Canceladas",-1)),t("span",pt,d(Y.value.cancelada),1)],2)]),e[34]||(e[34]=qe('<div class="flex items-center gap-6 text-xs font-medium text-gray-500" data-v-1a7e683c><div class="flex items-center gap-1.5" data-v-1a7e683c><span class="w-2 h-2 rounded-full bg-amber-400" data-v-1a7e683c></span> PENDIENTE </div><div class="flex items-center gap-1.5" data-v-1a7e683c><span class="w-2 h-2 rounded-full bg-emerald-400" data-v-1a7e683c></span> CONFIRMADA </div><div class="flex items-center gap-1.5" data-v-1a7e683c><span class="w-2 h-2 rounded-full bg-blue-400" data-v-1a7e683c></span> REALIZADA </div><div class="flex items-center gap-1.5" data-v-1a7e683c><span class="w-2 h-2 rounded-full bg-red-400" data-v-1a7e683c></span> CANCELADA </div></div>',1))]),t("div",mt,[G(_e)?(l(),n("div",ft,[...e[35]||(e[35]=[t("div",{class:"flex items-center gap-3 text-gray-500"},[t("svg",{class:"w-6 h-6 animate-spin",fill:"none",viewBox:"0 0 24 24"},[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]),E(" Cargando agenda... ")],-1)])])):(l(),n("div",gt,[t("div",{class:"sticky top-0 z-20 bg-white border-b border-gray-200 grid",style:ue({gridTemplateColumns:`70px repeat(${q.value.length}, 1fr)`})},[e[36]||(e[36]=t("div",{class:"border-r border-gray-100"},null,-1)),(l(!0),n(j,null,$(q.value,a=>(l(),n("div",{key:a.fecha,class:p(["px-4 py-3 text-center border-r border-gray-100 last:border-r-0",{"bg-violet-50/50":a.esHoy}])},[t("p",bt,d(a.diaSemana),1),t("p",{class:p(["text-2xl font-bold mt-1",a.esHoy?"text-violet-600":"text-gray-800"])},d(a.numeroDia),3),a.esHoy?(l(),n("div",xt)):f("",!0)],2))),128))],4),t("div",yt,[me.value!==null?(l(),n("div",{key:0,class:"absolute left-0 right-0 z-10 flex items-center pointer-events-none",style:ue({top:`${me.value}px`})},[t("div",ht,[t("span",wt,d(se.value.toLocaleTimeString("es-ES",{hour:"2-digit",minute:"2-digit"})),1)]),e[37]||(e[37]=t("div",{class:"flex-1 h-0.5 bg-red-500"},null,-1))],4)):f("",!0),(l(!0),n(j,null,$($e.value,a=>(l(),n("div",{key:a,class:"grid border-b border-gray-100",style:ue({gridTemplateColumns:`70px repeat(${q.value.length}, 1fr)`})},[t("div",kt,d(a),1),(l(!0),n(j,null,$(q.value,c=>(l(),n("div",{key:`${c.fecha}-${a}`,class:p(["relative border-r border-gray-100 last:border-r-0 h-11 hover:bg-violet-50/30 transition-colors cursor-pointer group",{"bg-violet-50/20":c.esHoy}]),onClick:r=>le(c.fecha,a).length===0?Ee(c.fecha,a):null},[le(c.fecha,a).length===0?(l(),n("div",_t,[...e[38]||(e[38]=[t("div",{class:"w-6 h-6 rounded-full bg-violet-500/80 text-white flex items-center justify-center"},[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})])],-1)])])):f("",!0),(l(!0),n(j,null,$(le(c.fecha,a),r=>(l(),n("div",{key:r.id,onClick:_(v=>ie(r.id),["stop"]),onKeydown:[B(_(v=>ie(r.id),["stop"]),["enter"]),B(_(v=>ie(r.id),["prevent","stop"]),["space"])],role:"button",tabindex:"0","aria-label":`Cita ${r.estado} de ${r.paciente_nombre||r.paciente?.nombre_completo||"paciente"}, ${h(r.hora_inicio)} a ${h(r.hora_fin)}`,class:p(["absolute inset-x-1 top-0.5 p-2 rounded-lg border-l-4 cursor-pointer hover:shadow-md transition-all z-10 group/card",[ge(r.estado).bg,ge(r.estado).border]]),style:{minHeight:"40px"}},[t("div",St,[r.estado==="pendiente"?(l(),n("button",{key:0,onClick:v=>xe(r.id,v),onKeydown:B(_(v=>xe(r.id,v),["stop"]),["enter"]),class:p(["w-5 h-5 rounded-full bg-emerald-500 text-white flex items-center justify-center hover:bg-emerald-600 hover:scale-110 shadow-sm transition-all focus:outline-none focus:ring-2 focus:ring-emerald-400 focus:ring-offset-1",{"animate-pulse":M.value===r.id}]),disabled:M.value===r.id,title:M.value===r.id?"Confirmando...":"Confirmar cita","aria-label":`Confirmar cita de ${r.paciente_nombre||"paciente"}`,type:"button"},[M.value===r.id?(l(),n("svg",zt,[...e[39]||(e[39]=[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"},null,-1)])])):(l(),n("svg",jt,[...e[40]||(e[40]=[t("path",{"fill-rule":"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z","clip-rule":"evenodd"},null,-1)])]))],42,Mt)):f("",!0),r.estado!=="cancelada"&&r.estado!=="realizada"&&r.estado!=="completada"?(l(),n("button",{key:1,onClick:v=>he(r.id,v),onKeydown:B(_(v=>he(r.id,v),["stop"]),["enter"]),class:"w-5 h-5 rounded-full bg-blue-500 text-white flex items-center justify-center hover:bg-blue-600 hover:scale-110 shadow-sm transition-all focus:outline-none focus:ring-2 focus:ring-blue-400 focus:ring-offset-1",title:"Reprogramar cita","aria-label":`Reprogramar cita de ${r.paciente_nombre||"paciente"}`,type:"button"},[...e[41]||(e[41]=[t("svg",{class:"w-2.5 h-2.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1)])],40,$t)):f("",!0),r.estado!=="cancelada"&&r.estado!=="realizada"&&r.estado!=="completada"?(l(),n("button",{key:2,onClick:v=>ye(r.id,v),onKeydown:B(_(v=>ye(r.id,v),["stop"]),["enter"]),class:"w-5 h-5 rounded-full bg-red-500 text-white flex items-center justify-center hover:bg-red-600 hover:scale-110 shadow-sm transition-all focus:outline-none focus:ring-2 focus:ring-red-400 focus:ring-offset-1",title:"Cancelar cita","aria-label":`Cancelar cita de ${r.paciente_nombre||"paciente"}`,type:"button"},[...e[42]||(e[42]=[t("svg",{class:"w-2.5 h-2.5",fill:"currentColor",viewBox:"0 0 20 20"},[t("path",{"fill-rule":"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z","clip-rule":"evenodd"})],-1)])],40,Bt)):f("",!0)]),t("div",Lt,[t("p",At,d(h(r.hora_inicio))+" - "+d(h(r.hora_fin)),1),t("p",Et,d(r.paciente_nombre||r.paciente?.nombre_completo||"Sin paciente"),1)])],42,Dt))),128))],10,Ct))),128))],4))),128))])]))]),we(s,{"is-open":H.value,"fecha-inicial":ee.value||void 0,"hora-inicial":te.value||void 0,onCreated:e[9]||(e[9]=a=>{H.value=!1,G(W)()}),onClose:e[10]||(e[10]=a=>{H.value=!1,ee.value=null,te.value=null})},null,8,["is-open","fecha-inicial","hora-inicial"]),(l(),F(J,{to:"body"},[oe.value&&K.value?(l(),F(u,{key:0,"cita-id":K.value,onClose:e[11]||(e[11]=a=>{oe.value=!1,K.value=null}),onCitaActualizada:e[12]||(e[12]=a=>G(W)()),onActualizado:e[13]||(e[13]=a=>G(W)())},null,8,["cita-id"])):f("",!0)])),(l(),F(J,{to:"body"},[ae.value&&g.value?(l(),n("div",{key:0,class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",onClick:_(I,["self"]),onKeydown:B(I,["escape"]),role:"dialog","aria-modal":"true","aria-labelledby":"modal-cancelar-titulo"},[t("div",Vt,[t("div",{class:"px-6 py-4 border-b border-gray-100 bg-gradient-to-r from-red-50 to-rose-50"},[t("div",{class:"flex items-center justify-between"},[e[44]||(e[44]=t("div",null,[t("h2",{id:"modal-cancelar-titulo",class:"text-lg font-semibold text-gray-900"},"Cancelar Cita"),t("p",{class:"text-sm text-gray-500 mt-0.5"},"Esta acción no se puede deshacer")],-1)),t("button",{onClick:I,class:"w-8 h-8 rounded-full bg-white/80 flex items-center justify-center text-gray-400 hover:text-gray-600 hover:bg-white transition-all focus:outline-none focus:ring-2 focus:ring-red-400","aria-label":"Cerrar modal"},[...e[43]||(e[43]=[t("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])])]),t("div",Ht,[t("div",Tt,[e[48]||(e[48]=t("p",{class:"text-xs font-medium text-gray-500 uppercase tracking-wider mb-3"},"Resumen de la cita",-1)),t("div",It,[t("div",Nt,[e[46]||(e[46]=t("div",{class:"w-10 h-10 rounded-lg bg-violet-100 flex items-center justify-center"},[t("svg",{class:"w-5 h-5 text-violet-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})])],-1)),t("div",null,[t("p",Ft,d(g.value.paciente_nombre||g.value.paciente?.nombre_completo||"Paciente"),1),e[45]||(e[45]=t("p",{class:"text-sm text-gray-500"},"Paciente",-1))])]),t("div",Pt,[e[47]||(e[47]=t("div",{class:"w-10 h-10 rounded-lg bg-blue-100 flex items-center justify-center"},[t("svg",{class:"w-5 h-5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})])],-1)),t("div",null,[t("p",Rt,d(be(g.value.fecha_cita)),1),t("p",Kt,d(h(g.value.hora_inicio))+" - "+d(h(g.value.hora_fin)),1)])])])]),t("div",null,[e[49]||(e[49]=t("label",{for:"motivo-cancelacion",class:"block text-sm font-medium text-gray-700 mb-2"},[E(" Motivo de cancelación "),t("span",{class:"text-gray-400"},"(opcional)")],-1)),P(t("textarea",{id:"motivo-cancelacion","onUpdate:modelValue":e[14]||(e[14]=a=>U.value=a),rows:"3",placeholder:"Ej: Solicitud del paciente, reagendamiento...",class:"w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-red-500/30 focus:border-red-400 transition-all resize-none"},null,512),[[de,U.value]])]),e[50]||(e[50]=t("div",{class:"flex items-start gap-3 p-4 bg-amber-50 rounded-xl border border-amber-200"},[t("svg",{class:"w-5 h-5 text-amber-500 flex-shrink-0 mt-0.5",fill:"currentColor",viewBox:"0 0 20 20"},[t("path",{"fill-rule":"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z","clip-rule":"evenodd"})]),t("p",{class:"text-sm text-amber-800"}," Al cancelar esta cita, el paciente podría recibir una notificación y se actualizará el estado en el sistema. ")],-1))]),t("div",Ut,[t("button",{onClick:I,class:"px-5 py-2.5 text-gray-700 font-medium rounded-xl hover:bg-gray-100 transition-colors focus:outline-none focus:ring-2 focus:ring-gray-300"}," Volver "),t("button",{onClick:Te,disabled:L.value!==null,class:"px-5 py-2.5 bg-red-600 text-white font-medium rounded-xl hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center gap-2 focus:outline-none focus:ring-2 focus:ring-red-400"},[L.value?(l(),n("svg",qt,[...e[51]||(e[51]=[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"},null,-1)])])):f("",!0),E(" "+d(L.value?"Cancelando...":"Cancelar cita"),1)],8,Ot)])])],32)):f("",!0)])),(l(),F(J,{to:"body"},[re.value&&b.value?(l(),n("div",{key:0,class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",onClick:_(N,["self"]),onKeydown:B(N,["escape"]),role:"dialog","aria-modal":"true","aria-labelledby":"modal-reprogramar-titulo"},[t("div",Yt,[t("div",Zt,[t("div",Gt,[t("div",null,[e[52]||(e[52]=t("h2",{id:"modal-reprogramar-titulo",class:"text-lg font-semibold text-gray-900"},"Reprogramar Cita",-1)),t("p",Jt,d(b.value.paciente_nombre||b.value.paciente?.nombre_completo||"Paciente"),1)]),t("button",{onClick:N,class:"w-8 h-8 rounded-full bg-white/80 flex items-center justify-center text-gray-400 hover:text-gray-600 hover:bg-white transition-all focus:outline-none focus:ring-2 focus:ring-blue-400","aria-label":"Cerrar modal"},[...e[53]||(e[53]=[t("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])])]),t("div",Qt,[t("div",Wt,[e[55]||(e[55]=t("p",{class:"text-xs font-medium text-gray-500 uppercase tracking-wider mb-2"},"Cita actual",-1)),t("div",Xt,[e[54]||(e[54]=t("div",{class:"w-10 h-10 rounded-lg bg-gray-200 flex items-center justify-center"},[t("svg",{class:"w-5 h-5 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})])],-1)),t("div",null,[t("p",eo,d(be(b.value.fecha_cita)),1),t("p",to,d(h(b.value.hora_inicio))+" - "+d(h(b.value.hora_fin)),1)])])]),e[59]||(e[59]=t("div",{class:"flex justify-center"},[t("div",{class:"w-10 h-10 rounded-full bg-blue-100 flex items-center justify-center"},[t("svg",{class:"w-5 h-5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 14l-7 7m0 0l-7-7m7 7V3"})])])],-1)),t("div",null,[e[56]||(e[56]=t("label",{for:"nueva-fecha",class:"block text-sm font-medium text-gray-700 mb-2"},"Nueva fecha",-1)),P(t("input",{id:"nueva-fecha",type:"date","onUpdate:modelValue":e[15]||(e[15]=a=>k.value=a),min:new Date().toISOString().split("T")[0],class:"w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500/30 focus:border-blue-500 transition-all"},null,8,oo),[[de,k.value]])]),t("div",ao,[t("div",null,[e[57]||(e[57]=t("label",{for:"nueva-hora-inicio",class:"block text-sm font-medium text-gray-700 mb-2"},"Hora inicio",-1)),P(t("select",{id:"nueva-hora-inicio","onUpdate:modelValue":e[16]||(e[16]=a=>y.value=a),class:"w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500/30 focus:border-blue-500 transition-all"},[(l(!0),n(j,null,$(T.value,a=>(l(),n("option",{key:a,value:a},d(a),9,ro))),128))],512),[[ke,y.value]])]),t("div",null,[e[58]||(e[58]=t("label",{for:"nueva-hora-fin",class:"block text-sm font-medium text-gray-700 mb-2"},"Hora fin",-1)),P(t("select",{id:"nueva-hora-fin","onUpdate:modelValue":e[17]||(e[17]=a=>z.value=a),class:"w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500/30 focus:border-blue-500 transition-all"},[(l(!0),n(j,null,$(He.value,a=>(l(),n("option",{key:a,value:a},d(a),9,lo))),128))],512),[[ke,z.value]])])])]),t("div",so,[t("button",{onClick:N,class:"px-5 py-2.5 text-gray-700 font-medium rounded-xl hover:bg-gray-100 transition-colors focus:outline-none focus:ring-2 focus:ring-gray-300"}," Cancelar "),t("button",{onClick:Ie,disabled:!k.value||!y.value||!z.value||A.value!==null,class:"px-5 py-2.5 bg-blue-600 text-white font-medium rounded-xl hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center gap-2 focus:outline-none focus:ring-2 focus:ring-blue-400"},[A.value?(l(),n("svg",io,[...e[60]||(e[60]=[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"},null,-1)])])):f("",!0),E(" "+d(A.value?"Reprogramando...":"Confirmar"),1)],8,no)])])],32)):f("",!0)])),(l(),F(J,{to:"body"},[we(Ze,{"enter-active-class":"transition ease-out duration-300","enter-from-class":"transform translate-y-4 opacity-0","enter-to-class":"transform translate-y-0 opacity-100","leave-active-class":"transition ease-in duration-200","leave-from-class":"transform translate-y-0 opacity-100","leave-to-class":"transform translate-y-4 opacity-0"},{default:Ye(()=>[O.value?(l(),n("div",uo,[t("div",{class:p(["flex items-center gap-3 px-4 py-3 rounded-xl shadow-lg border",{"bg-emerald-50 border-emerald-200 text-emerald-800":w.value==="success","bg-red-50 border-red-200 text-red-800":w.value==="error","bg-blue-50 border-blue-200 text-blue-800":w.value==="info"}])},[t("div",{class:p(["w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0",{"bg-emerald-100":w.value==="success","bg-red-100":w.value==="error","bg-blue-100":w.value==="info"}])},[w.value==="success"?(l(),n("svg",co,[...e[61]||(e[61]=[t("path",{"fill-rule":"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z","clip-rule":"evenodd"},null,-1)])])):w.value==="error"?(l(),n("svg",vo,[...e[62]||(e[62]=[t("path",{"fill-rule":"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z","clip-rule":"evenodd"},null,-1)])])):(l(),n("svg",po,[...e[63]||(e[63]=[t("path",{"fill-rule":"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z","clip-rule":"evenodd"},null,-1)])]))],2),t("p",mo,d(pe.value),1),t("button",{onClick:e[18]||(e[18]=a=>O.value=!1),class:"w-6 h-6 rounded-full flex items-center justify-center hover:bg-black/5 transition-colors","aria-label":"Cerrar notificación"},[...e[64]||(e[64]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])],2)])):f("",!0)]),_:1})]))])}}}),ko=Object.assign(Je(fo,[["__scopeId","data-v-1a7e683c"]]),{__name:"AgendaCalendario"});export{ko as _};
