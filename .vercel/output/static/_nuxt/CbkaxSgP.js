import{e as A,u as D,L,m as _,M as C,f as E,r as n,g as P,c,a,i as k,h as w,j as g,v as h,t as p,o as f}from"#entry";import{_ as F}from"./DlAUqK2U.js";const M={class:"min-h-screen flex flex-col items-center justify-center bg-[#F9F7F3] px-6"},B={class:"max-w-md w-full bg-white p-8 rounded-xl shadow-sm border border-[#EAD5D3]/40"},I=["disabled"],z=["disabled"],S={key:0,class:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg text-sm font-['Lato'] flex items-start gap-2"},V=["disabled"],q={key:0,class:"animate-spin h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},j={class:"mt-8 text-center"},N={class:"text-sm text-[#5D4A44]/50 font-['Lato']"},R=A({__name:"login",setup(T){D({title:"Login Terapeutas | Karem Peña",meta:[{name:"description",content:"Acceso exclusivo para terapeutas de la plataforma de gestión clínica"},{name:"robots",content:"noindex, nofollow"}]});const m=L(),i=_(),v=C(),{signOut:l}=E(),d=n(""),u=n(""),r=n(null),o=n(!1);P(async()=>{if(v.value)try{const{data:t}=await i.from("profiles").select("rol").eq("id",v.value.id).single(),e=t?.rol;e&&["psicologa","admin","coordinadora"].includes(e)?await m.push("/terapeuta/dashboard"):await l()}catch(t){console.error("Error al verificar sesión:",t),await l()}});const y=async()=>{r.value=null,o.value=!0;try{const{data:t,error:e}=await i.auth.signInWithPassword({email:d.value.trim(),password:u.value});if(e){console.error("Error de autenticación:",e),r.value="Correo o contraseña incorrectos. Por favor, verifica tus credenciales.",o.value=!1;return}if(!t.user){r.value="No se pudo iniciar sesión. Intenta nuevamente.",o.value=!1;return}const{data:s,error:b}=await i.from("profiles").select("rol, nombre").eq("id",t.user.id).single();if(b){console.error("Error al verificar perfil:",b),r.value="Error al validar tu perfil. Contacta a soporte.",await l(),o.value=!1;return}const x=s?.rol;if(!x||!["psicologa","admin","coordinadora"].includes(x)){r.value="Acceso no autorizado. Esta área es exclusiva para terapeutas.",await l(),o.value=!1;return}await m.push("/terapeuta/dashboard")}catch(t){console.error("Error inesperado durante el login:",t),r.value="Ocurrió un error inesperado. Por favor, intenta nuevamente.",o.value=!1}};return(t,e)=>(f(),c("div",M,[a("div",B,[e[6]||(e[6]=a("div",{class:"text-center mb-8"},[a("h1",{class:"text-3xl font-['Lora'] text-[#5D4A44] mb-2"},"Área de Terapeutas"),a("p",{class:"text-sm text-[#5D4A44]/70 font-['Lato']"},"Acceso exclusivo para profesionales")],-1)),a("form",{onSubmit:k(y,["prevent"]),class:"space-y-5"},[a("div",null,[e[2]||(e[2]=a("label",{for:"email",class:"block text-sm font-medium text-[#5D4A44] font-['Lato'] mb-1"}," Correo electrónico ",-1)),g(a("input",{id:"email","onUpdate:modelValue":e[0]||(e[0]=s=>d.value=s),type:"email",placeholder:"tu@email.com",class:"w-full px-4 py-3 border border-[#EAD5D3] rounded-lg focus:ring-2 focus:ring-[#D8AFA0] focus:border-transparent transition-all outline-none font-['Lato']",required:"",disabled:o.value},null,8,I),[[h,d.value]])]),a("div",null,[e[3]||(e[3]=a("label",{for:"password",class:"block text-sm font-medium text-[#5D4A44] font-['Lato'] mb-1"}," Contraseña ",-1)),g(a("input",{id:"password","onUpdate:modelValue":e[1]||(e[1]=s=>u.value=s),type:"password",placeholder:"••••••••",class:"w-full px-4 py-3 border border-[#EAD5D3] rounded-lg focus:ring-2 focus:ring-[#D8AFA0] focus:border-transparent transition-all outline-none font-['Lato']",required:"",disabled:o.value},null,8,z),[[h,u.value]])]),r.value?(f(),c("div",S,[e[4]||(e[4]=a("svg",{class:"w-5 h-5 flex-shrink-0 mt-0.5",fill:"currentColor",viewBox:"0 0 20 20"},[a("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z","clip-rule":"evenodd"})],-1)),a("span",null,p(r.value),1)])):w("",!0),a("button",{type:"submit",class:"w-full py-3 bg-[#D8AFA0] hover:bg-[#C89B8A] text-white font-['Lato'] font-semibold rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",disabled:o.value},[o.value?(f(),c("svg",q,[...e[5]||(e[5]=[a("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),a("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)])])):w("",!0),a("span",null,p(o.value?"Iniciando sesión...":"Iniciar sesión"),1)],8,V)],32),e[7]||(e[7]=a("div",{class:"mt-6 text-center"},[a("p",{class:"text-xs text-[#5D4A44]/60 font-['Lato']"}," ¿Problemas para acceder? Contacta a soporte ")],-1))]),a("div",j,[a("p",N," © "+p(new Date().getFullYear())+" Karem Peña | Gestión Clínica ",1)])]))}}),O=F(R,[["__scopeId","data-v-bf719394"]]);export{O as default};
