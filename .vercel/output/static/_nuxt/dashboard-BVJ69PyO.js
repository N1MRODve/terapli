import{_ as I}from"./nuxt-link-C2FRAMUz.js";import{e as P,x as g,Q as L,J as z,o as i,w,a as e,c,h as C,b as a,A as f,l as o,t as r,d as $,p as W,B as J,r as v,g as Q,D as G,_ as K,F as B,y as N}from"#entry";import{s as X}from"./interval-BzLCLO6P.js";import{_ as Y}from"./_plugin-vue_export-helper-DlAUqK2U.js";const Z={class:"flex items-start justify-between"},ee={class:"flex-1"},te={class:"flex items-center space-x-3 mb-3"},se={class:"text-sm font-medium text-[#8B7470]"},oe={class:"text-3xl font-bold font-lora text-[#2D3748] mt-1"},ne={key:0,class:"text-sm text-[#8B7470] mt-2"},ae={key:0,class:"mt-4 pt-4 border-t border-[#E8DFD8]"},re=P({__name:"DashboardCard",props:{title:{},count:{},icon:{},to:{},subtitle:{},badge:{},variant:{default:"default"}},setup(u){const p=u,k=g(()=>({default:"border-[#E8DFD8]",warning:"border-yellow-200",success:"border-green-200",danger:"border-red-200"})[p.variant]),l=g(()=>({default:"bg-gradient-to-br from-[#5550F2] to-[#C49484]",warning:"bg-gradient-to-br from-yellow-400 to-yellow-500",success:"bg-gradient-to-br from-green-400 to-green-500",danger:"bg-gradient-to-br from-red-400 to-red-500"})[p.variant]),b=g(()=>"text-white"),y=g(()=>({default:"bg-blue-50 text-blue-700",warning:"bg-yellow-50 text-yellow-700",success:"bg-green-50 text-green-700",danger:"bg-red-50 text-red-700"})[p.variant]),_=g(()=>({default:"bg-blue-500",warning:"bg-yellow-500",success:"bg-green-500",danger:"bg-red-500"})[p.variant]);return(x,S)=>{const D=L("Icon"),A=I;return i(),z(A,{to:u.to,class:f(["group block bg-white rounded-xl shadow-md border border-[#E8DFD8] p-6 hover:shadow-xl hover:-translate-y-1 transition-all duration-200",o(k)])},{default:w(()=>[e("div",Z,[e("div",ee,[e("div",te,[e("div",{class:f(["w-12 h-12 rounded-lg flex items-center justify-center",o(l)])},[a(D,{name:u.icon,class:f(["w-6 h-6",o(b)])},null,8,["name","class"])],2),e("div",null,[e("h3",se,r(u.title),1),e("p",oe,r(u.count),1)])]),u.subtitle?(i(),c("p",ne,r(u.subtitle),1)):C("",!0)]),a(D,{name:"heroicons:arrow-right",class:"w-5 h-5 text-[#A89B97] opacity-0 group-hover:opacity-100 transition-opacity"})]),u.badge?(i(),c("div",ae,[e("span",{class:f(["inline-flex items-center px-3 py-1 rounded-full text-xs font-medium",o(y)])},[e("span",{class:f(["w-2 h-2 rounded-full mr-2",o(_)])},null,2),$(" "+r(u.badge),1)],2)])):C("",!0)]),_:1},8,["to","class"])}}}),F=Object.assign(re,{__name:"CoordinacionDashboardCard"}),ie={class:"mb-8"},le={class:"text-[#8B7470]"},ce={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8"},de={class:"bg-white rounded-xl shadow-md border border-[#E8DFD8] p-6 mb-8"},ue={class:"flex items-center justify-between mb-6"},me={key:0,class:"space-y-3"},ge={class:"flex items-center space-x-4 flex-1"},be={class:"text-center min-w-[60px]"},pe={class:"text-sm font-medium text-[#5D4A44]"},xe={class:"text-xs text-[#8B7470]"},he={class:"w-10 h-10 rounded-full bg-gradient-to-br from-[#D8AFA0] to-[#C49484] flex items-center justify-center flex-shrink-0"},fe={class:"text-white text-sm font-semibold"},_e={class:"flex-1"},ve={class:"font-medium text-[#5D4A44]"},we={class:"text-sm text-[#8B7470]"},ye={class:"flex items-center space-x-2"},De=["onClick"],Ae={key:0,class:"text-center pt-3"},Fe={key:1,class:"text-center py-12"},Ce={class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},ke={class:"bg-white rounded-xl shadow-md border border-[#E8DFD8] p-6"},Se={class:"flex items-center justify-between mb-6"},$e={key:0,class:"space-y-3"},Ee={class:"flex-1"},je={class:"font-medium text-[#5D4A44] text-sm"},Be={class:"text-xs text-[#8B7470]"},Ne={class:"text-right"},Ie={class:"font-semibold text-[#5D4A44]"},Pe={key:1,class:"text-center py-8 text-[#8B7470]"},Le={class:"bg-white rounded-xl shadow-md border border-[#E8DFD8] p-6"},Ve={class:"space-y-3"},Re=P({__name:"dashboard",setup(u){const p=W(),k=J(),l=v([]),b=v([]),y=v([]),_=v(0),x=v(0),S=v(!0),D=g(()=>new Date().toLocaleDateString("es-ES",{weekday:"long",year:"numeric",month:"long",day:"numeric"})),A=g(()=>l.value.filter(s=>s.estado==="confirmada").length),V=g(()=>{if(l.value.length===0)return"---";const s=l.value[0];return E(s.fecha)}),R=g(()=>b.value.reduce((s,t)=>s+parseFloat(t.monto),0)),E=s=>new Date(s).toLocaleTimeString("es-ES",{hour:"2-digit",minute:"2-digit"}),M=s=>new Date(s).toLocaleDateString("es-ES",{day:"numeric",month:"short"}),U=s=>s.split(" ").map(t=>t[0]).join("").toUpperCase().substring(0,2),H=s=>s.toLocaleString("es-ES",{style:"currency",currency:"EUR",minimumFractionDigits:2,maximumFractionDigits:2}),O=s=>({confirmada:"bg-green-100 text-green-700",pendiente:"bg-yellow-100 text-yellow-700",cancelada:"bg-red-100 text-red-700",completada:"bg-blue-100 text-blue-700"})[s]||"bg-gray-100 text-gray-700",T=s=>({pendiente:"bg-yellow-100 text-yellow-700",confirmado_paciente:"bg-blue-100 text-blue-700",confirmado_admin:"bg-green-100 text-green-700",rechazado:"bg-red-100 text-red-700"})[s]||"bg-gray-100 text-gray-700",q=s=>{const t=s.replace(/\D/g,"");window.open(`https://wa.me/${t}`,"_blank")},j=async()=>{if(k.value){S.value=!0;try{const s=new Date;s.setHours(0,0,0,0);const t=new Date(s);t.setDate(t.getDate()+1);const{data:d}=await p.from("sesiones").select(`
        *,
        terapeuta:terapeuta_id(nombre),
        paciente:paciente_id(nombre, telefono)
      `).gte("fecha",s.toISOString()).lt("fecha",t.toISOString()).neq("estado","cancelada").order("fecha",{ascending:!0});d&&(l.value=d.map(m=>({...m,terapeuta_nombre:m.terapeuta?.nombre||"Sin terapeuta",paciente_nombre:m.paciente?.nombre||"Sin paciente",paciente_telefono:m.paciente?.telefono})));const{data:h}=await p.from("pagos").select(`
        *,
        paciente:paciente_id(nombre),
        terapeuta:terapeuta_id(nombre)
      `).in("estado",["pendiente","confirmado_paciente"]).order("created_at",{ascending:!1});h&&(b.value=h.map(m=>({...m,paciente_nombre:m.paciente?.nombre||"Sin paciente",terapeuta_nombre:m.terapeuta?.nombre||"Sin terapeuta"})),y.value=b.value.slice(0,4)),_.value=Math.floor(Math.random()*10),x.value=A.value*2}catch(s){console.error("Error al cargar datos:",s)}finally{S.value=!1}}};return Q(()=>{j();const s=X(j,12e4);G(()=>{clearInterval(s)})}),(s,t)=>{const d=L("Icon"),h=I,m=K;return i(),c("div",null,[a(m,{name:"coordinacion"},{default:w(()=>[e("div",ie,[t[3]||(t[3]=e("h1",{class:"text-3xl font-lora font-bold text-[#5D4A44] mb-2"}," Dashboard de Coordinación ",-1)),e("p",le,r(o(D))+" · Resumen general del día ",1)]),e("div",ce,[a(F,{title:"Sesiones de hoy",count:o(l).length,icon:"heroicons:calendar",to:"/coordinacion/agenda",subtitle:`${o(A)} confirmadas`,badge:o(l).length>0?`Próxima: ${o(V)}`:"Sin sesiones",variant:o(l).length>0?"success":"default"},null,8,["count","subtitle","badge","variant"]),a(F,{title:"Pagos pendientes",count:o(b).length,icon:"heroicons:credit-card",to:"/coordinacion/pagos",subtitle:`$${o(R).toFixed(2)} en total`,badge:o(b).length>0?"Requiere atención":"Todo al día",variant:o(b).length>0?"warning":"success"},null,8,["count","subtitle","badge","variant"]),a(F,{title:"Mensajes nuevos",count:o(_),icon:"heroicons:chat-bubble-left-right",to:"/coordinacion/mensajes",subtitle:"De pacientes",badge:o(_)>0?"Responder pronto":"Sin pendientes",variant:o(_)>5?"danger":"default"},null,8,["count","badge","variant"]),a(F,{title:"Recordatorios",count:o(x),icon:"heroicons:bell-alert",to:"/coordinacion/agenda",subtitle:"Programados para hoy",badge:"Automáticos",variant:"default"},null,8,["count"])]),e("div",de,[e("div",ue,[t[5]||(t[5]=e("h2",{class:"text-xl font-lora font-semibold text-[#5D4A44]"}," Sesiones de hoy ",-1)),a(h,{to:"/coordinacion/agenda",class:"text-sm text-[#D8AFA0] hover:text-[#C49484] font-medium flex items-center space-x-1"},{default:w(()=>[t[4]||(t[4]=e("span",null,"Ver calendario completo",-1)),a(d,{name:"heroicons:arrow-right",class:"w-4 h-4"})]),_:1})]),o(l).length>0?(i(),c("div",me,[(i(!0),c(B,null,N(o(l).slice(0,5),n=>(i(),c("div",{key:n.id,class:"flex items-center justify-between p-4 bg-[#F9F7F3] rounded-lg hover:bg-[#E8DFD8] transition-colors"},[e("div",ge,[e("div",be,[e("p",pe,r(E(n.fecha)),1),e("p",xe,r(n.modalidad),1)]),e("div",he,[e("span",fe,r(U(n.paciente_nombre)),1)]),e("div",_e,[e("p",ve,r(n.paciente_nombre),1),e("p",we,"Con "+r(n.terapeuta_nombre),1)]),e("div",ye,[e("span",{class:f(["px-3 py-1 rounded-full text-xs font-medium",O(n.estado)])},r(n.estado),3),n.paciente_telefono?(i(),c("button",{key:0,onClick:Me=>q(n.paciente_telefono),class:"p-2 rounded-lg hover:bg-green-50 transition-colors group",title:"Enviar WhatsApp"},[a(d,{name:"heroicons:chat-bubble-oval-left-ellipsis",class:"w-5 h-5 text-green-600 group-hover:scale-110 transition-transform"})],8,De)):C("",!0)])])]))),128)),o(l).length>5?(i(),c("div",Ae,[a(h,{to:"/coordinacion/agenda",class:"text-sm text-[#D8AFA0] hover:text-[#C49484] font-medium"},{default:w(()=>[$(" Ver todas las "+r(o(l).length)+" sesiones → ",1)]),_:1})])):C("",!0)])):(i(),c("div",Fe,[a(d,{name:"heroicons:calendar-days",class:"w-16 h-16 text-[#D8AFA0] mx-auto mb-4 opacity-30"}),t[7]||(t[7]=e("p",{class:"text-[#8B7470] mb-4"},"No hay sesiones programadas para hoy",-1)),a(h,{to:"/coordinacion/agenda",class:"inline-flex items-center px-4 py-2 bg-[#D8AFA0] text-white rounded-lg hover:bg-[#C49484] transition-colors"},{default:w(()=>[a(d,{name:"heroicons:plus",class:"w-4 h-4 mr-2"}),t[6]||(t[6]=$(" Programar sesión ",-1))]),_:1})]))]),e("div",Ce,[e("div",ke,[e("div",Se,[t[9]||(t[9]=e("h2",{class:"text-xl font-lora font-semibold text-[#5D4A44]"}," Pagos recientes ",-1)),a(h,{to:"/coordinacion/pagos",class:"text-sm text-[#D8AFA0] hover:text-[#C49484] font-medium flex items-center space-x-1"},{default:w(()=>[t[8]||(t[8]=e("span",null,"Ver todos",-1)),a(d,{name:"heroicons:arrow-right",class:"w-4 h-4"})]),_:1})]),o(y).length>0?(i(),c("div",$e,[(i(!0),c(B,null,N(o(y).slice(0,4),n=>(i(),c("div",{key:n.id,class:"flex items-center justify-between p-3 bg-[#F9F7F3] rounded-lg"},[e("div",Ee,[e("p",je,r(n.paciente_nombre),1),e("p",Be,r(M(n.created_at)),1)]),e("div",Ne,[e("p",Ie,r(H(parseFloat(n.monto))),1),e("span",{class:f(["text-xs px-2 py-1 rounded-full",T(n.estado)])},r(n.estado),3)])]))),128))])):(i(),c("div",Pe,[a(d,{name:"heroicons:credit-card",class:"w-12 h-12 mx-auto mb-2 opacity-30"}),t[10]||(t[10]=e("p",{class:"text-sm"},"No hay pagos recientes",-1))]))]),e("div",Le,[t[14]||(t[14]=e("h2",{class:"text-xl font-lora font-semibold text-[#5D4A44] mb-6"}," Acciones rápidas ",-1)),e("div",Ve,[e("button",{onClick:t[0]||(t[0]=n=>s.$router.push("/coordinacion/agenda?action=nueva-sesion")),class:"w-full flex items-center space-x-3 p-4 bg-gradient-to-r from-[#D8AFA0] to-[#C49484] text-white rounded-lg hover:shadow-lg transition-all"},[a(d,{name:"heroicons:plus-circle",class:"w-6 h-6"}),t[11]||(t[11]=e("span",{class:"font-medium"},"Programar nueva sesión",-1))]),e("button",{onClick:t[1]||(t[1]=n=>s.$router.push("/coordinacion/mensajes?action=nuevo-mensaje")),class:"w-full flex items-center space-x-3 p-4 bg-white border-2 border-[#D8AFA0] text-[#5D4A44] rounded-lg hover:bg-[#F9F7F3] transition-all"},[a(d,{name:"heroicons:chat-bubble-left",class:"w-6 h-6 text-[#D8AFA0]"}),t[12]||(t[12]=e("span",{class:"font-medium"},"Enviar mensaje",-1))]),e("button",{onClick:t[2]||(t[2]=n=>s.$router.push("/coordinacion/pagos?action=registrar-pago")),class:"w-full flex items-center space-x-3 p-4 bg-white border-2 border-[#D8AFA0] text-[#5D4A44] rounded-lg hover:bg-[#F9F7F3] transition-all"},[a(d,{name:"heroicons:banknotes",class:"w-6 h-6 text-[#D8AFA0]"}),t[13]||(t[13]=e("span",{class:"font-medium"},"Registrar pago",-1))])])])])]),_:1})])}}}),qe=Y(Re,[["__scopeId","data-v-833d468f"]]);export{qe as default};
