import{_ as K}from"./ModalNuevaCita-BCs1rH3G.js";import{e as Q,p as W,r as d,G as X,g as Z,E as ee,c as l,b as M,w as te,_ as oe,o as i,a as t,k as A,m as S,F as h,y,l as s,t as n,B as ae,A as w,d as C,v as se,h as ne}from"#entry";import{u as re}from"./useCitas-9Z4e1_ch.js";import"./CheckCircleIcon-Bi0YyG7H.js";import"./CalendarIcon-mZ3toP8Y.js";import"./TicketIcon-DRclOuRO.js";import"./MagnifyingGlassIcon-B5My0XuL.js";import"./PhoneIcon-Bz5mGjHP.js";import"./UserIcon-G1mM6o1b.js";import"./ExclamationTriangleIcon-BreoAuwB.js";import"./UserGroupIcon-Byc3y-S3.js";import"./ClockIcon-CQZt9cKZ.js";import"./XCircleIcon-BaRJRhc1.js";import"./CheckBadgeIcon-CuVUaEjS.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const le={class:"mb-6 flex flex-wrap gap-3"},ie=["value"],de=["onClick"],ce={class:"mr-2"},ue={key:0,class:"bg-white rounded-xl shadow-sm border border-[#EAD5D3]/40 p-6"},pe={class:"mb-6 flex items-center gap-4"},me={class:"mb-6"},be={class:"text-2xl font-serif font-semibold text-cafe mb-1"},fe={class:"text-cafe/60"},ge={key:0,class:"text-center py-12"},ve={key:1,class:"text-center py-12"},xe={class:"text-cafe/60"},_e={key:2,class:"space-y-4"},he={class:"flex items-start justify-between"},ye={class:"flex-1"},we={class:"flex items-center gap-3 mb-2"},Ce={class:"text-3xl"},De={class:"text-lg font-semibold text-cafe"},ke={class:"text-sm text-cafe/60"},Ne={key:0,class:"mt-3 p-3 bg-white/50 rounded-lg"},Ee={class:"text-sm text-cafe/70"},Me={class:"flex flex-col gap-2"},Ae={key:1,class:"bg-white rounded-xl shadow-sm border border-[#EAD5D3]/40 p-6"},Se={class:"text-center py-12"},Te={class:"text-cafe/60"},Ke=Q({__name:"agenda",setup(Ve){const{getCitasPorDia:T,getTerapeutas:V,listenRealtimeCitasGlobal:F}=re(),$=W(),u=d("dia"),r=d(x(new Date)),p=d(""),f=d(!1),c=d([]),D=d([]),b=d(null),g=d(!1),v=d(""),R=d(""),z=[{id:"dia",nombre:"D√≠a",icono:"üìÖ"},{id:"semana",nombre:"Semana",icono:"üìÜ"},{id:"mes",nombre:"Mes",icono:"üóìÔ∏è"}];async function B(){const a=await V();D.value=a}async function m(){f.value=!0;try{if(p.value)c.value=await T(r.value,p.value);else{const{data:a,error:e}=await $.from("vista_agenda_terapeutas").select("*").eq("fecha_cita",r.value).neq("estado","cancelada").order("hora_inicio",{ascending:!0});e?(console.error("Error al cargar citas:",e),c.value=[]):c.value=a||[]}}finally{f.value=!1}}function k(){u.value==="dia"&&m()}function N(a){const e=new Date(r.value);e.setDate(e.getDate()+a),r.value=x(e),m()}function G(){r.value=x(new Date),m()}function L(a){v.value=r.value,g.value=!0}function U(){g.value=!1,v.value=""}function j(){m()}function x(a){return a.toISOString().split("T")[0]||""}function E(a){const e=new Date(a+"T00:00:00"),_=["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"];return`${e.getDate()} de ${_[e.getMonth()]} de ${e.getFullYear()}`}function q(a){return{presencial:"üè•",online:"üíª",telefonica:"üìû"}[a]||"üìÖ"}function H(a){return{confirmada:"border-green-400",pendiente:"border-yellow-400",cancelada:"border-red-400",realizada:"border-blue-400"}[a]||"border-gray-400"}function I(a){return{confirmada:"bg-green-100 text-green-700",pendiente:"bg-yellow-100 text-yellow-700",cancelada:"bg-red-100 text-red-700",realizada:"bg-blue-100 text-blue-700"}[a]||"bg-gray-100 text-gray-700"}function J(){b.value=F(O)}function O(a,e){console.log("üì° Evento Realtime global recibido:",a,e),m()}function P(){b.value&&(b.value.unsubscribe(),b.value=null)}return X([u,r,p],()=>{k()}),Z(async()=>{await B(),await m(),J()}),ee(()=>{P()}),(a,e)=>{const _=K,Y=oe;return i(),l("div",null,[M(Y,{name:"coordinacion"},{default:te(()=>[e[13]||(e[13]=t("div",{class:"mb-8"},[t("h1",{class:"text-4xl font-serif font-bold text-cafe mb-2"}," Agenda Global "),t("p",{class:"text-lg text-cafe/70"}," Gesti√≥n y coordinaci√≥n de todas las sesiones de terapeutas ")],-1)),t("div",le,[A(t("select",{"onUpdate:modelValue":e[0]||(e[0]=o=>S(p)?p.value=o:null),class:"px-4 py-2 rounded-lg border border-[#EAD5D3]/40 bg-white text-cafe focus:ring-2 focus:ring-purple-300 focus:border-transparent",onChange:k},[e[5]||(e[5]=t("option",{value:""},"Todos los terapeutas",-1)),(i(!0),l(h,null,y(s(D),o=>(i(),l("option",{key:o.id,value:o.id},n(o.nombre_completo),9,ie))),128))],544),[[ae,s(p)]]),(i(),l(h,null,y(z,o=>t("button",{key:o.id,onClick:Fe=>u.value=o.id,class:w(["px-5 py-2.5 rounded-lg font-medium transition-all",s(u)===o.id?"bg-purple-600 text-white shadow-md":"bg-white text-cafe hover:bg-purple-600/10 border border-[#EAD5D3]/40"])},[t("span",ce,n(o.icono),1),C(" "+n(o.nombre),1)],10,de)),64)),t("button",{onClick:e[1]||(e[1]=o=>L()),class:"ml-auto px-5 py-2.5 rounded-lg font-medium bg-gradient-to-r from-purple-600 to-rosa text-white hover:from-purple-600/90 hover:to-rosa/90 shadow-md transition-all"},[...e[6]||(e[6]=[t("span",{class:"mr-2"},"+",-1),C(" Nueva Cita ",-1)])])]),s(u)==="dia"?(i(),l("div",ue,[t("div",pe,[t("button",{onClick:e[2]||(e[2]=o=>N(-1)),class:"p-2 hover:bg-purple-600/10 rounded-lg transition-colors"}," ‚Üê Anterior "),A(t("input",{"onUpdate:modelValue":e[3]||(e[3]=o=>S(r)?r.value=o:null),type:"date",class:"flex-1 px-4 py-2 bg-base-bg rounded-lg border border-transparent focus:border-purple-600 focus:outline-none focus:ring-2 focus:ring-purple-300/20"},null,512),[[se,s(r)]]),t("button",{onClick:G,class:"px-4 py-2 bg-purple-600/10 text-purple-600 rounded-lg hover:bg-purple-600/20 transition-colors font-medium"}," Hoy "),t("button",{onClick:e[4]||(e[4]=o=>N(1)),class:"p-2 hover:bg-purple-600/10 rounded-lg transition-colors"}," Siguiente ‚Üí ")]),t("div",me,[t("h2",be,n(E(s(r))),1),t("p",fe,n(s(c).length)+" cita"+n(s(c).length!==1?"s":"")+" programada"+n(s(c).length!==1?"s":""),1)]),s(f)?(i(),l("div",ge,[...e[7]||(e[7]=[t("div",{class:"inline-block animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-purple-600"},null,-1)])])):s(c).length===0?(i(),l("div",ve,[e[8]||(e[8]=t("span",{class:"text-6xl mb-4 block"},"üìÖ",-1)),e[9]||(e[9]=t("p",{class:"text-lg text-cafe font-medium mb-2"},"Sin citas programadas",-1)),t("p",xe,"No hay citas para "+n(E(s(r))),1)])):(i(),l("div",_e,[(i(!0),l(h,null,y(s(c),o=>(i(),l("div",{key:o.cita_id,class:w(["bg-gradient-to-r from-base-bg to-white rounded-lg p-5 border-l-4 hover:shadow-md transition-all",H(o.estado)])},[t("div",he,[t("div",ye,[t("div",we,[t("span",Ce,n(q(o.modalidad)),1),t("div",null,[t("h3",De,n(o.paciente_nombre),1),t("p",ke,n(o.hora_inicio)+" - "+n(o.hora_fin)+" ¬∑ "+n(o.terapeuta_nombre),1)])]),o.observaciones?(i(),l("div",Ne,[t("p",Ee,[e[10]||(e[10]=t("span",{class:"font-medium"},"Notas:",-1)),C(" "+n(o.observaciones),1)])])):ne("",!0)]),t("div",Me,[t("span",{class:w(["px-3 py-1 rounded-full text-xs font-medium",I(o.estado)])},n(o.estado),3)])])],2))),128))]))])):(i(),l("div",Ae,[t("div",Se,[e[11]||(e[11]=t("span",{class:"text-6xl mb-4 block"},"üóìÔ∏è",-1)),e[12]||(e[12]=t("p",{class:"text-lg text-cafe font-medium mb-2"},"Vista en desarrollo",-1)),t("p",Te,"La vista "+n(s(u))+" estar√° disponible pronto",1)])])),M(_,{mostrar:s(g),"fecha-preseleccionada":s(v),"hora-preseleccionada":s(R),onCerrar:U,onCitaCreada:j},null,8,["mostrar","fecha-preseleccionada","hora-preseleccionada"])]),_:1})])}}});export{Ke as default};
