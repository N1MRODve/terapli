import{c as d,o as r,a as o,e as H,r as C,G as To,b as m,l as s,k,h as y,v as B,m as Z,t as i,A as T,x as q,F as U,y as R,d as _,g as vo,E as Io,i as Uo,j as I,z as so,p as Vo,J as jo,D as z,B as O,Y as eo,K as co}from"#entry";import{r as Do}from"./MagnifyingGlassIcon-B5My0XuL.js";import{r as K}from"./XMarkIcon-DWNj0d99.js";import{r as No,a as Lo}from"./ArrowUpTrayIcon-B3QIYE34.js";import{r as Fo}from"./PlusIcon-UqRq4KLf.js";import{_ as G}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{r as zo}from"./UserGroupIcon-Byc3y-S3.js";import{r as bo}from"./CheckCircleIcon-Bi0YyG7H.js";import{r as Q}from"./TicketIcon-DRclOuRO.js";import{r as Y}from"./ExclamationTriangleIcon-BreoAuwB.js";import{a as Oo,r as uo}from"./FunnelIcon-BLGTimpY.js";import{a as Zo,r as Ro}from"./XCircleIcon-BaRJRhc1.js";import{r as Ho}from"./EnvelopeIcon-CVHiCNXI.js";import{a as Go,r as mo}from"./PhoneIcon-Bz5mGjHP.js";import{r as Wo}from"./EyeIcon-BKE9UY2T.js";import{r as po}from"./UserIcon-G1mM6o1b.js";import{r as Jo}from"./ChartBarIcon-Cii-u9ml.js";import{r as Ko}from"./CalendarIcon-mZ3toP8Y.js";import{r as Qo}from"./ChevronRightIcon-Ck2OajRo.js";function Yo(c,h){return r(),d("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m4.5 12.75 6 6 9-13.5"})])}function Xo(c,h){return r(),d("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 6.75a.75.75 0 1 1 0-1.5.75.75 0 0 1 0 1.5ZM12 12.75a.75.75 0 1 1 0-1.5.75.75 0 0 1 0 1.5ZM12 18.75a.75.75 0 1 1 0-1.5.75.75 0 0 1 0 1.5Z"})])}function fo(c,h){return r(),d("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L6.832 19.82a4.5 4.5 0 0 1-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 0 1 1.13-1.897L16.863 4.487Zm0 0L19.5 7.125"})])}function oe(c,h){return r(),d("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"})])}function ee(c,h){return r(),d("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[o("path",{"fill-rule":"evenodd",d:"M8.25 6.75a3.75 3.75 0 1 1 7.5 0 3.75 3.75 0 0 1-7.5 0ZM15.75 9.75a3 3 0 1 1 6 0 3 3 0 0 1-6 0ZM2.25 9.75a3 3 0 1 1 6 0 3 3 0 0 1-6 0ZM6.31 15.117A6.745 6.745 0 0 1 12 12a6.745 6.745 0 0 1 6.709 7.498.75.75 0 0 1-.372.568A12.696 12.696 0 0 1 12 21.75c-2.305 0-4.47-.612-6.337-1.684a.75.75 0 0 1-.372-.568 6.787 6.787 0 0 1 1.019-4.38Z","clip-rule":"evenodd"}),o("path",{d:"M5.082 14.254a8.287 8.287 0 0 0-1.308 5.135 9.687 9.687 0 0 1-1.764-.44l-.115-.04a.563.563 0 0 1-.373-.487l-.01-.121a3.75 3.75 0 0 1 3.57-4.047ZM20.226 19.389a8.287 8.287 0 0 0-1.308-5.135 3.75 3.75 0 0 1 3.57 4.047l-.01.121a.563.563 0 0 1-.373.486l-.115.04c-.567.2-1.156.349-1.764.441Z"})])}const se={class:"pacientes-header"},te={class:"header-left"},ae={class:"header-icon"},ne={class:"header-center"},ie={class:"search-container"},le={class:"header-right"},re={class:"header-stats"},de={class:"stat-item"},ce={class:"stat-value"},ue={class:"stat-item activos"},me={class:"stat-value"},pe=H({__name:"PacientesHeader",props:{busqueda:{default:""},totalPacientes:{default:0},pacientesActivos:{default:0}},emits:["update:busqueda","nuevo-paciente","importar","exportar"],setup(c,{emit:h}){const b=c,g=h,$=C(b.busqueda);To(()=>b.busqueda,p=>{$.value=p});const P=()=>{g("update:busqueda",$.value)},M=()=>{$.value="",g("update:busqueda","")};return(p,v)=>(r(),d("header",se,[o("div",te,[o("div",ae,[m(s(ee),{class:"w-6 h-6 text-white"})]),v[4]||(v[4]=o("div",{class:"header-text"},[o("h1",{class:"header-title"},"Pacientes"),o("p",{class:"header-subtitle"},"Gesti√≥n y seguimiento de todos los pacientes de la cl√≠nica")],-1))]),o("div",ne,[o("div",ie,[m(s(Do),{class:"search-icon"}),k(o("input",{"onUpdate:modelValue":v[0]||(v[0]=A=>Z($)?$.value=A:null),onInput:P,type:"search",placeholder:"Buscar por nombre, email o tel√©fono...",class:"search-input","aria-label":"Buscar pacientes"},null,544),[[B,s($)]]),s($)?(r(),d("button",{key:0,onClick:M,class:"search-clear","aria-label":"Limpiar b√∫squeda"},[m(s(K),{class:"w-4 h-4"})])):y("",!0)])]),o("div",le,[o("div",re,[o("div",de,[o("span",ce,i(c.totalPacientes),1),v[5]||(v[5]=o("span",{class:"stat-label"},"Total",-1))]),v[7]||(v[7]=o("div",{class:"stat-divider"},null,-1)),o("div",ue,[o("span",me,i(c.pacientesActivos),1),v[6]||(v[6]=o("span",{class:"stat-label"},"Activos",-1))])]),o("button",{onClick:v[1]||(v[1]=A=>g("importar")),class:"action-btn action-btn-tertiary","aria-label":"Importar pacientes",title:"Importar"},[m(s(No),{class:"w-4 h-4"})]),o("button",{onClick:v[2]||(v[2]=A=>g("exportar")),class:"action-btn action-btn-tertiary","aria-label":"Exportar pacientes",title:"Exportar"},[m(s(Lo),{class:"w-4 h-4"})]),o("button",{onClick:v[3]||(v[3]=A=>g("nuevo-paciente")),class:"action-btn action-btn-primary","aria-label":"Crear nuevo paciente"},[m(s(Fo),{class:"w-4 h-4"}),v[8]||(v[8]=o("span",null,"Nuevo Paciente",-1))])])]))}}),ve=Object.assign(G(pe,[["__scopeId","data-v-500e1e84"]]),{__name:"PacientesHeader"}),be={class:"metricas-grid"},fe={class:"metrica-card"},_e={class:"metrica-icon icon-total"},ge={class:"metrica-content"},he={class:"metrica-valor"},$e={class:"metrica-card"},we={class:"metrica-icon icon-activos"},ke={class:"metrica-content"},ye={class:"metrica-valor activos"},Ce={class:"metrica-card"},xe={class:"metrica-icon icon-bonos"},Pe={class:"metrica-content"},Ae={class:"metrica-valor bonos"},Ee={class:"metrica-icon icon-alerta"},Be={class:"metrica-content"},Me={class:"metrica-valor alerta"},Se=H({__name:"PacientesMetricas",props:{totalPacientes:{},pacientesActivos:{},bonosActivos:{},bonosPorAgotar:{}},setup(c){return(h,b)=>(r(),d("div",be,[o("div",fe,[o("div",_e,[m(s(zo),{class:"w-6 h-6"})]),o("div",ge,[o("span",he,i(c.totalPacientes),1),b[0]||(b[0]=o("span",{class:"metrica-label"},"Total Pacientes",-1))])]),o("div",$e,[o("div",we,[m(s(bo),{class:"w-6 h-6"})]),o("div",ke,[o("span",ye,i(c.pacientesActivos),1),b[1]||(b[1]=o("span",{class:"metrica-label"},"Activos",-1))])]),o("div",Ce,[o("div",xe,[m(s(Q),{class:"w-6 h-6"})]),o("div",Pe,[o("span",Ae,i(c.bonosActivos),1),b[2]||(b[2]=o("span",{class:"metrica-label"},"Bonos Activos",-1))])]),o("div",{class:T(["metrica-card",{alerta:c.bonosPorAgotar>0}])},[o("div",Ee,[m(s(Y),{class:"w-6 h-6"})]),o("div",Be,[o("span",Me,i(c.bonosPorAgotar),1),b[3]||(b[3]=o("span",{class:"metrica-label"},"Por Agotar",-1))])],2)]))}}),qe=Object.assign(G(Se,[["__scopeId","data-v-51297926"]]),{__name:"PacientesMetricas"}),Te={class:"filtros-bar"},Ie={class:"filtros-row"},Ue={class:"filtros-icon"},Ve={class:"filtro-select-wrapper"},je=["value"],De={class:"filtro-select-wrapper"},Ne=["value"],Le=["value"],Fe={class:"chips-container"},ze={key:0,class:"resultados-badge"},Oe=H({__name:"PacientesFiltros",props:{filtroEstado:{default:""},filtroTerapeuta:{default:""},filtroBono:{default:""},terapeutas:{default:()=>[]},totalResultados:{default:0},totalPacientes:{default:0}},emits:["update:filtroEstado","update:filtroTerapeuta","update:filtroBono","limpiar-filtros"],setup(c,{emit:h}){const b=c,g=h,$=q(()=>b.filtroEstado||b.filtroTerapeuta||b.filtroBono),P=q(()=>$.value&&b.totalResultados!==b.totalPacientes);return(M,p)=>(r(),d("div",Te,[o("div",Ie,[o("div",Ue,[m(s(Oo),{class:"w-4 h-4"})]),o("div",Ve,[o("select",{value:c.filtroEstado,onChange:p[0]||(p[0]=v=>g("update:filtroEstado",v.target.value)),class:"filtro-select","aria-label":"Filtrar por estado"},[...p[6]||(p[6]=[o("option",{value:""},"Todos los estados",-1),o("option",{value:"activo"},"Activos",-1),o("option",{value:"inactivo"},"Inactivos",-1)])],40,je)]),o("div",De,[o("select",{value:c.filtroTerapeuta,onChange:p[1]||(p[1]=v=>g("update:filtroTerapeuta",v.target.value)),class:"filtro-select","aria-label":"Filtrar por terapeuta"},[p[7]||(p[7]=o("option",{value:""},"Todos los terapeutas",-1)),(r(!0),d(U,null,R(c.terapeutas,v=>(r(),d("option",{key:v.id,value:v.id},i(v.nombre),9,Le))),128))],40,Ne)]),p[12]||(p[12]=o("div",{class:"filtros-divider"},null,-1)),o("div",Fe,[o("button",{onClick:p[2]||(p[2]=v=>g("update:filtroBono",c.filtroBono==="con-bono"?"":"con-bono")),class:T(["filter-chip",{active:c.filtroBono==="con-bono"}])},[m(s(Q),{class:"w-3.5 h-3.5"}),p[8]||(p[8]=_(" Con bono ",-1))],2),o("button",{onClick:p[3]||(p[3]=v=>g("update:filtroBono",c.filtroBono==="sin-bono"?"":"sin-bono")),class:T(["filter-chip",{active:c.filtroBono==="sin-bono"}])},[m(s(Zo),{class:"w-3.5 h-3.5"}),p[9]||(p[9]=_(" Sin bono ",-1))],2),o("button",{onClick:p[4]||(p[4]=v=>g("update:filtroBono",c.filtroBono==="por-agotar"?"":"por-agotar")),class:T(["filter-chip chip-alerta",{active:c.filtroBono==="por-agotar"}])},[m(s(Y),{class:"w-3.5 h-3.5"}),p[10]||(p[10]=_(" Por agotar ",-1))],2)]),p[13]||(p[13]=o("div",{class:"flex-1"},null,-1)),s(P)?(r(),d("div",ze,i(c.totalResultados)+" de "+i(c.totalPacientes),1)):y("",!0),s($)?(r(),d("button",{key:1,onClick:p[5]||(p[5]=v=>g("limpiar-filtros")),class:"limpiar-btn"},[m(s(K),{class:"w-4 h-4"}),p[11]||(p[11]=_(" Limpiar ",-1))])):y("",!0)])]))}}),Ze=Object.assign(G(Oe,[["__scopeId","data-v-87eef75a"]]),{__name:"PacientesFiltros"}),Re={class:"tabla-container"},He={key:0,class:"loading-state"},Ge={key:1,class:"empty-state"},We={class:"table-wrapper"},Je={class:"pacientes-table"},Ke=["onClick"],Qe={class:"td-paciente"},Ye={class:"paciente-info"},Xe={class:"avatar"},os={class:"paciente-texto"},es={class:"paciente-nombre"},ss={class:"paciente-area"},ts={class:"td-contacto"},as={class:"contacto-info"},ns=["href","title"],is={class:"contacto-texto"},ls=["href"],rs={class:"td-terapeuta"},ds={key:0,class:"terapeuta-nombre"},cs={key:1,class:"sin-asignar"},us={class:"td-bono"},ms={class:"bono-info"},ps={class:"bono-sesiones"},vs={class:"sesiones-valor"},bs={class:"sesiones-total"},fs={class:"bono-progreso"},_s={key:0,class:"bono-alerta"},gs={key:1,class:"sin-bono"},hs={class:"td-sesiones"},$s={class:"sesiones-info"},ws={class:"sesiones-total-num"},ks={class:"sesiones-label"},ys={class:"td-estado"},Cs={class:"td-acciones"},xs=["onClick"],Ps=["onClick"],As={class:"menu-wrapper"},Es=["onClick"],Bs=["onClick"],Ms=["onClick"],Ss={key:0,class:"paginacion"},qs={class:"paginacion-info"},Ts={class:"paginacion-controles"},Is=["disabled"],Us=["onClick"],Vs={key:1,class:"pag-dots"},js=["disabled"],Ds=H({__name:"PacientesTabla",props:{pacientes:{},cargando:{type:Boolean,default:!1},paginaActual:{default:1},porPagina:{default:15}},emits:["ver-detalle","editar","eliminar","whatsapp","cambiar-pagina"],setup(c,{emit:h}){const b=c,g=h,$=C(null),P=q(()=>Math.ceil(b.pacientes.length/b.porPagina)),M=q(()=>{const w=(b.paginaActual-1)*b.porPagina,u=w+b.porPagina;return b.pacientes.slice(w,u)}),p=w=>w?w.split(" ").map(u=>u[0]).join("").toUpperCase().substring(0,2):"??",v=(w,u)=>{const t=w==="activo"||u;return{label:t?"Activo":"Inactivo",class:t?"estado-activo":"estado-inactivo"}},A=w=>w?w.sesiones_restantes===0?{label:"Agotado",class:"bono-agotado",icon:"warning"}:w.sesiones_restantes===1?{label:"√öltima sesi√≥n",class:"bono-ultimo",icon:"warning"}:w.sesiones_restantes===2?{label:"Por agotar",class:"bono-bajo",icon:"warning"}:{label:"Activo",class:"bono-activo",icon:"check"}:{label:"Sin bono",class:"bono-sin",icon:"none"},L=w=>{$.value=$.value===w?null:w},V=()=>{$.value=null};return vo(()=>{document.addEventListener("click",V)}),Io(()=>{document.removeEventListener("click",V)}),(w,u)=>(r(),d("div",Re,[c.cargando?(r(),d("div",He,[...u[6]||(u[6]=[o("div",{class:"loading-spinner"},null,-1),o("p",null,"Cargando pacientes...",-1)])])):c.pacientes.length===0?(r(),d("div",Ge,[...u[7]||(u[7]=[Uo('<div class="empty-icon" data-v-fbffeefb><svg class="w-16 h-16" fill="none" viewBox="0 0 24 24" stroke="currentColor" data-v-fbffeefb><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z" data-v-fbffeefb></path></svg></div><h3 class="empty-title" data-v-fbffeefb>No se encontraron pacientes</h3><p class="empty-description" data-v-fbffeefb>Intenta con otros t√©rminos de b√∫squeda o ajusta los filtros</p>',3)])])):(r(),d(U,{key:2},[o("div",We,[o("table",Je,[u[12]||(u[12]=o("thead",null,[o("tr",null,[o("th",{class:"th-paciente"},"Paciente"),o("th",{class:"th-contacto"},"Contacto"),o("th",{class:"th-terapeuta"},"Terapeuta"),o("th",{class:"th-bono"},"Estado Bono"),o("th",{class:"th-sesiones"},"Sesiones"),o("th",{class:"th-estado"},"Estado"),o("th",{class:"th-acciones"},"Acciones")])],-1)),o("tbody",null,[(r(!0),d(U,null,R(s(M),t=>(r(),d("tr",{key:t.id,class:"fila-paciente",onClick:l=>g("ver-detalle",t)},[o("td",Qe,[o("div",Ye,[o("div",Xe,[o("span",null,i(p(t.nombre_completo)),1)]),o("div",os,[o("span",es,i(t.nombre_completo),1),o("span",ss,i(t.area_de_acompanamiento||"Sin √°rea asignada"),1)])])]),o("td",ts,[o("div",as,[o("a",{href:`mailto:${t.email}`,class:"contacto-item",onClick:u[0]||(u[0]=I(()=>{},["stop"])),title:t.email},[m(s(Ho),{class:"w-4 h-4"}),o("span",is,i(t.email),1)],8,ns),t.telefono?(r(),d("a",{key:0,href:`tel:${t.telefono}`,class:"contacto-item",onClick:u[1]||(u[1]=I(()=>{},["stop"]))},[m(s(Go),{class:"w-4 h-4"}),o("span",null,i(t.telefono),1)],8,ls)):y("",!0)])]),o("td",rs,[t.terapeuta_nombre?(r(),d("span",ds,i(t.terapeuta_nombre),1)):(r(),d("span",cs,"Sin asignar"))]),o("td",us,[o("div",ms,[t.bono_activo?(r(),d("div",{key:0,class:T(["bono-detalle",A(t.bono_activo).class])},[o("div",ps,[o("span",vs,i(t.bono_activo.sesiones_restantes),1),o("span",bs,"/"+i(t.bono_activo.sesiones_totales),1)]),o("div",fs,[o("div",{class:"bono-progreso-fill",style:so({width:`${t.bono_activo.sesiones_restantes/t.bono_activo.sesiones_totales*100}%`})},null,4)]),t.bono_activo.sesiones_restantes<=2?(r(),d("div",_s,[m(s(Y),{class:"w-3 h-3"}),o("span",null,i(t.bono_activo.sesiones_restantes===0?"Agotado":"Renovar"),1)])):y("",!0)],2)):(r(),d("span",gs,"Sin bono"))])]),o("td",hs,[o("div",$s,[o("span",ws,i(t.total_citas||0),1),o("span",ks,i(t.sesiones_completadas||0)+" completadas",1)])]),o("td",ys,[o("span",{class:T(["estado-badge",v(t.estado,t.activo).class])},[u[8]||(u[8]=o("span",{class:"estado-dot"},null,-1)),_(" "+i(v(t.estado,t.activo).label),1)],2)]),o("td",Cs,[o("div",{class:"acciones-group",onClick:u[3]||(u[3]=I(()=>{},["stop"]))},[t.telefono?(r(),d("button",{key:0,onClick:l=>g("whatsapp",t),class:"btn-accion btn-whatsapp",title:"WhatsApp"},[...u[9]||(u[9]=[o("svg",{class:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24"},[o("path",{d:"M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.890-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413Z"})],-1)])],8,xs)):y("",!0),o("button",{onClick:l=>g("ver-detalle",t),class:"btn-accion btn-ver",title:"Ver detalles"},[m(s(Wo),{class:"w-5 h-5"})],8,Ps),o("div",As,[o("button",{onClick:I(l=>L(t.id),["stop"]),class:"btn-accion btn-menu",title:"M√°s opciones"},[m(s(Xo),{class:"w-5 h-5"})],8,Es),s($)===t.id?(r(),d("div",{key:0,class:"menu-dropdown",onClick:u[2]||(u[2]=I(()=>{},["stop"]))},[o("button",{onClick:l=>{g("editar",t),V()},class:"menu-item"},[m(s(fo),{class:"w-4 h-4"}),u[10]||(u[10]=_(" Editar paciente ",-1))],8,Bs),o("button",{onClick:l=>{g("eliminar",t),V()},class:"menu-item menu-item-danger"},[m(s(oe),{class:"w-4 h-4"}),u[11]||(u[11]=_(" Eliminar paciente ",-1))],8,Ms)])):y("",!0)])])])],8,Ke))),128))])])]),s(P)>1?(r(),d("div",Ss,[o("div",qs," Mostrando "+i((c.paginaActual-1)*c.porPagina+1)+" - "+i(Math.min(c.paginaActual*c.porPagina,c.pacientes.length))+" de "+i(c.pacientes.length),1),o("div",Ts,[o("button",{onClick:u[4]||(u[4]=t=>g("cambiar-pagina",c.paginaActual-1)),disabled:c.paginaActual===1,class:"pag-btn"},[...u[13]||(u[13]=[o("svg",{class:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1)])],8,Is),(r(!0),d(U,null,R(s(P),t=>(r(),d(U,{key:t},[t===1||t===s(P)||t>=c.paginaActual-1&&t<=c.paginaActual+1?(r(),d("button",{key:0,onClick:l=>g("cambiar-pagina",t),class:T(["pag-btn pag-num",{active:t===c.paginaActual}])},i(t),11,Us)):t===c.paginaActual-2||t===c.paginaActual+2?(r(),d("span",Vs," ... ")):y("",!0)],64))),128)),o("button",{onClick:u[5]||(u[5]=t=>g("cambiar-pagina",c.paginaActual+1)),disabled:c.paginaActual===s(P),class:"pag-btn"},[...u[14]||(u[14]=[o("svg",{class:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1)])],8,js)])])):y("",!0)],64))]))}}),Ns=Object.assign(G(Ds,[["__scopeId","data-v-fbffeefb"]]),{__name:"PacientesTabla"}),Ls={class:"pacientes-page"},Fs={class:"modal-container"},zs={class:"modal-header"},Os={class:"modal-header-left"},Zs={class:"modal-avatar"},Rs={class:"modal-title-group"},Hs={class:"modal-title"},Gs={class:"modal-subtitle"},Ws={class:"modal-header-actions"},Js={class:"modal-body"},Ks={key:0,class:"edit-form"},Qs={class:"edit-alert"},Ys={class:"form-section"},Xs={class:"form-section-title"},ot={class:"form-grid"},et={class:"form-field"},st={class:"form-field"},tt={class:"form-field"},at={class:"form-field"},nt=["value"],it={class:"form-field"},lt={class:"form-field"},rt={class:"form-section"},dt={class:"form-section-title"},ct={class:"toggle-field"},ut={class:"toggle-status"},mt={class:"form-actions"},pt=["disabled"],vt=["disabled"],bt={key:1,class:"detail-view"},ft={class:"detail-header"},_t={class:"detail-badges"},gt={key:0,class:"badge badge-purple"},ht={class:"detail-actions"},$t={class:"detail-section"},wt={class:"detail-section-title"},kt={class:"info-grid"},yt={class:"info-card"},Ct={class:"info-value"},xt={class:"info-card"},Pt={class:"info-value"},At={class:"info-card"},Et={class:"info-value"},Bt={class:"info-card"},Mt={class:"info-value"},St={class:"info-card"},qt={class:"info-value"},Tt={class:"info-card"},It={class:"info-value capitalize"},Ut={class:"detail-section"},Vt={class:"detail-section-title"},jt={class:"stats-grid"},Dt={class:"stat-card stat-blue"},Nt={class:"stat-value"},Lt={class:"stat-card stat-green"},Ft={class:"stat-value"},zt={class:"stat-card stat-purple"},Ot={class:"stat-value"},Zt={class:"stat-card stat-orange"},Rt={class:"stat-value"},Ht={key:0,class:"detail-section"},Gt={class:"detail-section-title"},Wt={class:"bono-card"},Jt={class:"bono-header"},Kt={class:"bono-value"},Qt={class:"bono-percent"},Yt={class:"percent-value"},Xt={class:"bono-progress"},oa={key:0,class:"bono-alert"},ea={class:"bono-alert-title"},sa={class:"detail-section"},ta={class:"detail-section-title"},aa={class:"info-grid cols-2"},na={class:"info-card"},ia={class:"info-value"},la={key:0,class:"info-card"},ra={class:"info-value"},da={class:"modal-footer"},ca={class:"modal-container modal-lg"},ua={class:"modal-header"},ma={class:"form-section"},pa={class:"form-grid"},va={class:"form-field"},ba={class:"form-field"},fa={class:"form-field"},_a={class:"form-section"},ga={class:"form-field"},ha=["value"],$a={class:"form-section bono-migration"},wa={class:"bono-migration-header"},ka={key:0,class:"bono-migration-form"},ya={class:"form-grid"},Ca={class:"form-field"},xa={class:"form-field"},Pa=["value"],Aa={class:"form-field"},Ea=["max","disabled"],Ba={class:"form-field"},Ma={class:"form-field"},Sa={class:"form-field"},qa={class:"bono-summary"},Ta={class:"bono-summary-content"},Ia={class:"bono-summary-progress"},Ua={class:"bono-summary-labels"},Va={class:"bono-summary-bar"},ja={class:"bono-summary-count"},Da={class:"count-value"},Na={class:"count-total"},La={class:"form-section"},Fa={class:"form-field"},za={class:"toggle-field"},Oa={class:"form-actions"},Za=["disabled"],Ra=H({__name:"pacientes",setup(c){const h=Vo(),b=jo(),g=C(!0),$=C([]),P=C([]),M=C(""),p=C(""),v=C(""),A=C(""),L=C(1),V=C(15),w=C(!1),u=C(!1),t=C({nombre_completo:"",email:"",telefono:"+34 ",terapeuta_id:null,notas:"",activo:!0,tiene_bono_existente:!1,bono:{tipo:"",sesiones_totales:0,sesiones_consumidas:0,fecha_compra:null,monto_total:0,estado_pago:"pagado"}}),l=C(null),X=C(!1),S=C(!1),f=C({}),j=C(!1),oo=q(()=>$.value.length),to=q(()=>$.value.filter(a=>a.estado==="activo"||a.activo).length),_o=q(()=>$.value.filter(a=>a.bono_activo&&a.bono_activo.sesiones_restantes>0).length),go=q(()=>$.value.filter(a=>a.bono_activo&&a.bono_activo.sesiones_restantes<=1).length),ao=q(()=>{let a=[...$.value];if(M.value.trim()){const e=M.value.toLowerCase();a=a.filter(x=>x.nombre_completo?.toLowerCase().includes(e)||x.email?.toLowerCase().includes(e)||x.telefono?.includes(e))}return p.value==="activo"?a=a.filter(e=>e.estado==="activo"||e.activo):p.value==="inactivo"&&(a=a.filter(e=>e.estado==="inactivo"||!e.activo)),v.value&&(a=a.filter(e=>e.terapeuta_id===v.value)),A.value==="con-bono"?a=a.filter(e=>e.bono_activo&&e.bono_activo.sesiones_restantes>0):A.value==="sin-bono"?a=a.filter(e=>!e.bono_activo):A.value==="por-agotar"&&(a=a.filter(e=>e.bono_activo&&e.bono_activo.sesiones_restantes<=2)),a}),ho=a=>a?a.split(" ").map(e=>e[0]).join("").toUpperCase().substring(0,2):"PA",no=a=>a?new Date(a).toLocaleDateString("es-ES",{day:"2-digit",month:"short",year:"numeric"}):"No especificada",$o=a=>a===0?"bg-red":a===1?"bg-orange":a===2?"bg-amber":"bg-green",wo=()=>{M.value="",p.value="",v.value="",A.value="",L.value=1},ko=()=>{alert("Funcionalidad de importaci√≥n pr√≥ximamente")},yo=()=>{alert("Funcionalidad de exportaci√≥n pr√≥ximamente")},io=a=>{l.value=a,X.value=!0,S.value=!1},F=()=>{X.value=!1,S.value=!1,setTimeout(()=>{l.value=null},300)},lo=()=>{f.value={nombre_completo:l.value.nombre_completo||"",email:l.value.email||"",telefono:l.value.telefono||"",terapeuta_id:l.value.terapeuta_id||null,area_de_acompanamiento:l.value.area_de_acompanamiento||"",frecuencia:l.value.frecuencia||"",activo:l.value.activo??!0},S.value=!0},Co=()=>{S.value=!1,f.value={}},xo=async()=>{if(!f.value.nombre_completo||!f.value.email){alert("El nombre y el email son obligatorios");return}j.value=!0;try{const{error:a}=await h.from("pacientes").update({nombre_completo:f.value.nombre_completo.trim(),email:f.value.email.trim().toLowerCase(),telefono:f.value.telefono?.trim()||null,terapeuta_id:f.value.terapeuta_id||null,area_de_acompanamiento:f.value.area_de_acompanamiento||null,frecuencia:f.value.frecuencia||null,activo:f.value.activo,updated_at:new Date().toISOString()}).eq("id",l.value.id);if(a)throw a;alert("‚úÖ Paciente actualizado correctamente"),Object.assign(l.value,f.value),await J(),S.value=!1}catch(a){console.error("Error al actualizar paciente:",a),alert(`‚ùå Error al actualizar: ${a.message}`)}finally{j.value=!1}},W=()=>{w.value=!1,t.value={nombre_completo:"",email:"",telefono:"+34 ",terapeuta_id:null,notas:"",activo:!0,tiene_bono_existente:!1,bono:{tipo:"",sesiones_totales:0,sesiones_consumidas:0,fecha_compra:null,monto_total:0,estado_pago:"pagado"}}},Po=()=>{switch(t.value.bono.tipo){case"semanal":t.value.bono.sesiones_totales=4;break;case"quincenal":t.value.bono.sesiones_totales=2;break;case"mensual":t.value.bono.sesiones_totales=1;break;default:t.value.bono.sesiones_totales=0}t.value.bono.sesiones_consumidas>t.value.bono.sesiones_totales&&(t.value.bono.sesiones_consumidas=0)},Ao=async()=>{u.value=!0;try{if(t.value.tiene_bono_existente){if(t.value.bono.sesiones_consumidas>t.value.bono.sesiones_totales){alert("‚ùå Las sesiones consumidas no pueden ser mayores a las sesiones totales"),u.value=!1;return}if(!t.value.bono.tipo){alert("‚ùå Debe seleccionar el tipo de bono"),u.value=!1;return}}const a={nombre_completo:t.value.nombre_completo.trim(),email:t.value.email.trim().toLowerCase(),telefono:t.value.telefono.trim(),terapeuta_id:t.value.terapeuta_id||null,notas:t.value.notas.trim()||null,activo:t.value.activo,created_at:new Date().toISOString()},{data:e,error:x}=await h.from("pacientes").insert([a]).select().single();if(x)throw x;if(t.value.tiene_bono_existente){const N=t.value.bono.sesiones_totales-t.value.bono.sesiones_consumidas,E={paciente_id:e.id,tipo_bono:t.value.bono.tipo,sesiones_totales:t.value.bono.sesiones_totales,sesiones_restantes:N,estado:N>0?"activo":"agotado",monto_total:t.value.bono.monto_total||0,estado_pago:t.value.bono.estado_pago,fecha_pago:t.value.bono.fecha_compra||new Date().toISOString(),created_at:new Date().toISOString(),updated_at:new Date().toISOString()},{error:n}=await h.from("bonos").insert([E]);n&&(console.error("Error al crear bono:",n),alert(`‚ö†Ô∏è Paciente creado, pero hubo un error al crear el bono: ${n.message}`))}const D=t.value.tiene_bono_existente?`‚úÖ Paciente y bono creados exitosamente: ${e.nombre_completo}
üé´ Bono: ${t.value.bono.sesiones_totales-t.value.bono.sesiones_consumidas} sesiones restantes`:`‚úÖ Paciente creado exitosamente: ${e.nombre_completo}`;alert(D),W(),await J()}catch(a){console.error("Error al crear paciente:",a),alert(`‚ùå Error al crear el paciente: ${a.message}`)}finally{u.value=!1}},ro=a=>{if(!a.telefono){alert("Este paciente no tiene tel√©fono registrado");return}const e=a.telefono.replace(/\D/g,""),x=encodeURIComponent(`Hola ${a.nombre_completo}, te escribo desde el consultorio de Psic√≥loga Karem.`);window.open(`https://wa.me/${e}?text=${x}`,"_blank")},Eo=a=>{confirm(`‚ö†Ô∏è ¬øEst√°s seguro de que deseas eliminar a ${a.nombre_completo}?

Esta acci√≥n eliminar√°:
‚Ä¢ El paciente
‚Ä¢ Todos sus bonos
‚Ä¢ Todas sus citas
‚Ä¢ Todo su historial

Esta acci√≥n NO se puede deshacer.`)&&Bo(a)},Bo=async a=>{try{await h.from("bonos").delete().eq("paciente_id",a.id),await h.from("citas").delete().eq("paciente_id",a.id);const{error:e}=await h.from("pacientes").delete().eq("id",a.id);if(e)throw e;alert(`‚úÖ Paciente ${a.nombre_completo} eliminado exitosamente`),await J()}catch(e){console.error("Error al eliminar paciente:",e),alert(`‚ùå Error al eliminar el paciente: ${e.message}`)}},Mo=async()=>{try{const{data:a,error:e}=await h.from("terapeutas").select("id, nombre_completo").order("nombre_completo",{ascending:!0});if(e)throw e;P.value=a?.map(x=>({id:x.id,nombre:x.nombre_completo}))||[]}catch(a){console.error("Error al cargar terapeutas:",a),P.value=[]}},J=async()=>{g.value=!0;try{const{data:a,error:e}=await h.from("pacientes").select("*").order("nombre_completo",{ascending:!0});if(e)throw e;if(!a){$.value=[];return}const x=[...new Set(a.map(E=>E.terapeuta_id).filter(Boolean))],D=new Map;if(x.length>0){const{data:E}=await h.from("terapeutas").select("id, nombre_completo").in("id",x);E?.forEach(n=>D.set(n.id,n.nombre_completo))}const N=await Promise.all(a.map(async E=>{const{data:n}=await h.from("bonos").select("id, sesiones_totales, sesiones_restantes, created_at, estado").eq("paciente_id",E.id).in("estado",["activo","pendiente"]).gt("sesiones_restantes",0).order("created_at",{ascending:!1}).limit(1).maybeSingle(),{count:So}=await h.from("citas").select("*",{count:"exact",head:!0}).eq("paciente_id",E.id),{count:qo}=await h.from("citas").select("*",{count:"exact",head:!0}).eq("paciente_id",E.id).eq("estado","realizada");return{...E,terapeuta_nombre:D.get(E.terapeuta_id)||null,estado:E.activo?"activo":"inactivo",total_citas:So||0,sesiones_completadas:qo||0,bono_activo:n?{...n,fecha_compra:n.created_at}:null}}));$.value=N}catch(a){console.error("Error al cargar pacientes:",a),$.value=[]}finally{g.value=!1}};return vo(()=>{Mo(),J()}),(a,e)=>{const x=ve,D=qe,N=Ze,E=Ns;return r(),d("div",Ls,[m(x,{busqueda:s(M),"onUpdate:busqueda":e[0]||(e[0]=n=>Z(M)?M.value=n:null),"total-pacientes":s(oo),"pacientes-activos":s(to),onNuevoPaciente:e[1]||(e[1]=n=>w.value=!0),onImportar:ko,onExportar:yo},null,8,["busqueda","total-pacientes","pacientes-activos"]),m(D,{"total-pacientes":s(oo),"pacientes-activos":s(to),"bonos-activos":s(_o),"bonos-por-agotar":s(go)},null,8,["total-pacientes","pacientes-activos","bonos-activos","bonos-por-agotar"]),m(N,{"filtro-estado":s(p),"onUpdate:filtroEstado":e[2]||(e[2]=n=>Z(p)?p.value=n:null),"filtro-terapeuta":s(v),"onUpdate:filtroTerapeuta":e[3]||(e[3]=n=>Z(v)?v.value=n:null),"filtro-bono":s(A),"onUpdate:filtroBono":e[4]||(e[4]=n=>Z(A)?A.value=n:null),terapeutas:s(P),"total-resultados":s(ao).length,"total-pacientes":s(oo),onLimpiarFiltros:wo},null,8,["filtro-estado","filtro-terapeuta","filtro-bono","terapeutas","total-resultados","total-pacientes"]),m(E,{pacientes:s(ao),cargando:s(g),"pagina-actual":s(L),"por-pagina":s(V),onVerDetalle:io,onEditar:e[5]||(e[5]=n=>{io(n),lo()}),onEliminar:Eo,onWhatsapp:ro,onCambiarPagina:e[6]||(e[6]=n=>L.value=n)},null,8,["pacientes","cargando","pagina-actual","por-pagina"]),(r(),z(co,{to:"body"},[s(X)&&s(l)?(r(),d("div",{key:0,class:"modal-overlay",onClick:I(F,["self"])},[o("div",Fs,[o("div",zs,[o("div",Os,[o("div",Zs,i(ho(s(l).nombre_completo)),1),o("div",Rs,[o("h2",Hs,i(s(l).nombre_completo),1),o("p",Gs,i(s(S)?"Editando informaci√≥n del paciente":"Informaci√≥n del paciente"),1)])]),o("div",Ws,[s(S)?y("",!0):(r(),d("button",{key:0,onClick:lo,class:"modal-btn-icon",title:"Editar paciente"},[m(s(fo),{class:"w-5 h-5"})])),o("button",{onClick:F,class:"modal-btn-icon"},[m(s(K),{class:"w-6 h-6"})])])]),o("div",Js,[s(S)?(r(),d("div",Ks,[o("div",Qs,[m(s(mo),{class:"w-5 h-5"}),e[29]||(e[29]=o("div",null,[o("p",{class:"edit-alert-title"},"Modo de edici√≥n activado"),o("p",{class:"edit-alert-text"},"Modifica los campos necesarios y guarda los cambios")],-1))]),o("div",Ys,[o("h3",Xs,[m(s(po),{class:"w-5 h-5"}),e[30]||(e[30]=_(" Informaci√≥n Personal ",-1))]),o("div",ot,[o("div",et,[e[31]||(e[31]=o("label",{class:"form-label"},[_("Nombre Completo "),o("span",{class:"required"},"*")],-1)),k(o("input",{"onUpdate:modelValue":e[7]||(e[7]=n=>s(f).nombre_completo=n),type:"text",class:"form-input",placeholder:"Nombre completo"},null,512),[[B,s(f).nombre_completo]])]),o("div",st,[e[32]||(e[32]=o("label",{class:"form-label"},[_("Email "),o("span",{class:"required"},"*")],-1)),k(o("input",{"onUpdate:modelValue":e[8]||(e[8]=n=>s(f).email=n),type:"email",class:"form-input",placeholder:"correo@ejemplo.com"},null,512),[[B,s(f).email]])]),o("div",tt,[e[33]||(e[33]=o("label",{class:"form-label"},"Tel√©fono",-1)),k(o("input",{"onUpdate:modelValue":e[9]||(e[9]=n=>s(f).telefono=n),type:"tel",class:"form-input",placeholder:"+34 600 000 000"},null,512),[[B,s(f).telefono]])]),o("div",at,[e[35]||(e[35]=o("label",{class:"form-label"},"Terapeuta Asignado",-1)),k(o("select",{"onUpdate:modelValue":e[10]||(e[10]=n=>s(f).terapeuta_id=n),class:"form-select"},[e[34]||(e[34]=o("option",{value:null},"Sin asignar",-1)),(r(!0),d(U,null,R(s(P),n=>(r(),d("option",{key:n.id,value:n.id},i(n.nombre),9,nt))),128))],512),[[O,s(f).terapeuta_id]])]),o("div",it,[e[36]||(e[36]=o("label",{class:"form-label"},"√Årea de Acompa√±amiento",-1)),k(o("input",{"onUpdate:modelValue":e[11]||(e[11]=n=>s(f).area_de_acompanamiento=n),type:"text",class:"form-input",placeholder:"Ej: Ansiedad, Depresi√≥n"},null,512),[[B,s(f).area_de_acompanamiento]])]),o("div",lt,[e[38]||(e[38]=o("label",{class:"form-label"},"Frecuencia",-1)),k(o("select",{"onUpdate:modelValue":e[12]||(e[12]=n=>s(f).frecuencia=n),class:"form-select"},[...e[37]||(e[37]=[o("option",{value:""},"Seleccionar...",-1),o("option",{value:"semanal"},"Semanal",-1),o("option",{value:"quincenal"},"Quincenal",-1),o("option",{value:"mensual"},"Mensual",-1),o("option",{value:"ocasional"},"Ocasional",-1)])],512),[[O,s(f).frecuencia]])])])]),o("div",rt,[o("h3",dt,[m(s(bo),{class:"w-5 h-5"}),e[39]||(e[39]=_(" Estado del Paciente ",-1))]),o("div",ct,[k(o("input",{"onUpdate:modelValue":e[13]||(e[13]=n=>s(f).activo=n),type:"checkbox",id:"activo-edicion",class:"toggle-input"},null,512),[[eo,s(f).activo]]),e[40]||(e[40]=o("label",{for:"activo-edicion",class:"toggle-label"}," Paciente activo ",-1)),o("span",ut,i(s(f).activo?"Activo":"Inactivo"),1)])]),o("div",mt,[o("button",{onClick:Co,disabled:s(j),class:"btn btn-secondary"}," Cancelar ",8,pt),o("button",{onClick:xo,disabled:s(j),class:"btn btn-primary"},[s(j)?(r(),z(s(uo),{key:0,class:"w-4 h-4 animate-spin"})):(r(),z(s(Yo),{key:1,class:"w-4 h-4"})),_(" "+i(s(j)?"Guardando...":"Guardar Cambios"),1)],8,vt)])])):(r(),d("div",bt,[o("div",ft,[o("div",_t,[o("span",{class:T(["badge",s(l).activo?"badge-success":"badge-gray"])},[e[41]||(e[41]=o("span",{class:"badge-dot"},null,-1)),_(" "+i(s(l).activo?"Activo":"Inactivo"),1)],2),s(l).bono_activo?(r(),d("span",gt,[m(s(Q),{class:"w-4 h-4"}),_(" Bono: "+i(s(l).bono_activo.sesiones_restantes)+"/"+i(s(l).bono_activo.sesiones_totales),1)])):y("",!0)]),o("div",ht,[s(l).telefono?(r(),d("button",{key:0,onClick:e[14]||(e[14]=n=>ro(s(l))),class:"btn btn-whatsapp"},[...e[42]||(e[42]=[o("svg",{class:"w-4 h-4",fill:"currentColor",viewBox:"0 0 24 24"},[o("path",{d:"M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.890-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413Z"})],-1),_(" WhatsApp ",-1)])])):y("",!0),o("button",{onClick:e[15]||(e[15]=()=>{F(),s(b).push(`/coordinadora/pacientes/${s(l).id}`)}),class:"btn btn-primary"},[m(s(Ro),{class:"w-4 h-4"}),e[43]||(e[43]=_(" Historial Completo ",-1))])])]),o("div",$t,[o("h3",wt,[m(s(po),{class:"w-5 h-5"}),e[44]||(e[44]=_(" Informaci√≥n Personal ",-1))]),o("div",kt,[o("div",yt,[e[45]||(e[45]=o("span",{class:"info-label"},"Nombre Completo",-1)),o("span",Ct,i(s(l).nombre_completo||"No especificado"),1)]),o("div",xt,[e[46]||(e[46]=o("span",{class:"info-label"},"Email",-1)),o("span",Pt,i(s(l).email||"No especificado"),1)]),o("div",At,[e[47]||(e[47]=o("span",{class:"info-label"},"Tel√©fono",-1)),o("span",Et,i(s(l).telefono||"No especificado"),1)]),o("div",Bt,[e[48]||(e[48]=o("span",{class:"info-label"},"Terapeuta Asignado",-1)),o("span",Mt,i(s(l).terapeuta_nombre||"Sin asignar"),1)]),o("div",St,[e[49]||(e[49]=o("span",{class:"info-label"},"√Årea de Acompa√±amiento",-1)),o("span",qt,i(s(l).area_de_acompanamiento||"No especificado"),1)]),o("div",Tt,[e[50]||(e[50]=o("span",{class:"info-label"},"Frecuencia",-1)),o("span",It,i(s(l).frecuencia||"No especificada"),1)])])]),o("div",Ut,[o("h3",Vt,[m(s(Jo),{class:"w-5 h-5"}),e[51]||(e[51]=_(" Estad√≠sticas de Sesiones ",-1))]),o("div",jt,[o("div",Dt,[o("span",Nt,i(s(l).total_citas||0),1),e[52]||(e[52]=o("span",{class:"stat-label"},"Total Citas",-1))]),o("div",Lt,[o("span",Ft,i(s(l).sesiones_completadas||0),1),e[53]||(e[53]=o("span",{class:"stat-label"},"Completadas",-1))]),o("div",zt,[o("span",Ot,i(s(l).bono_activo?.sesiones_restantes||0),1),e[54]||(e[54]=o("span",{class:"stat-label"},"Restantes",-1))]),o("div",Zt,[o("span",Rt,i(s(l).bono_activo?.sesiones_totales||0),1),e[55]||(e[55]=o("span",{class:"stat-label"},"Total Bono",-1))])])]),s(l).bono_activo?(r(),d("div",Ht,[o("h3",Gt,[m(s(Q),{class:"w-5 h-5"}),e[56]||(e[56]=_(" Bono Activo ",-1))]),o("div",Wt,[o("div",Jt,[o("div",null,[e[57]||(e[57]=o("p",{class:"bono-label"},"Progreso del Bono",-1)),o("p",Kt,i(s(l).bono_activo.sesiones_restantes)+" / "+i(s(l).bono_activo.sesiones_totales),1),e[58]||(e[58]=o("p",{class:"bono-subtext"},"sesiones disponibles",-1))]),o("div",Qt,[o("span",Yt,i(Math.round((s(l).bono_activo.sesiones_totales-s(l).bono_activo.sesiones_restantes)/s(l).bono_activo.sesiones_totales*100))+"%",1),e[59]||(e[59]=o("span",{class:"percent-label"},"consumido",-1))])]),o("div",Xt,[o("div",{class:T(["bono-progress-bar",$o(s(l).bono_activo.sesiones_restantes)]),style:so({width:`${(s(l).bono_activo.sesiones_totales-s(l).bono_activo.sesiones_restantes)/s(l).bono_activo.sesiones_totales*100}%`})},null,6)]),s(l).bono_activo.sesiones_restantes<=1?(r(),d("div",oa,[m(s(Y),{class:"w-5 h-5"}),o("div",null,[o("p",ea,i(s(l).bono_activo.sesiones_restantes===0?"Bono agotado":"Solo queda 1 sesi√≥n"),1),e[60]||(e[60]=o("p",{class:"bono-alert-text"},"Se recomienda renovar el bono para continuar las sesiones",-1))])])):y("",!0)])])):y("",!0),o("div",sa,[o("h3",ta,[m(s(Ko),{class:"w-5 h-5"}),e[61]||(e[61]=_(" Fechas del Sistema ",-1))]),o("div",aa,[o("div",na,[e[62]||(e[62]=o("span",{class:"info-label"},"Fecha de Registro",-1)),o("span",ia,i(no(s(l).created_at)),1)]),s(l).updated_at?(r(),d("div",la,[e[63]||(e[63]=o("span",{class:"info-label"},"√öltima Actualizaci√≥n",-1)),o("span",ra,i(no(s(l).updated_at)),1)])):y("",!0)])])]))]),o("div",da,[o("button",{onClick:F,class:"btn btn-secondary"}," Cerrar "),s(S)?y("",!0):(r(),d("button",{key:0,onClick:e[16]||(e[16]=()=>{F(),s(b).push(`/coordinadora/pacientes/${s(l).id}`)}),class:"btn btn-primary"},[e[64]||(e[64]=_(" Ver Historial Completo ",-1)),m(s(Qo),{class:"w-4 h-4"})]))])])])):y("",!0)])),(r(),z(co,{to:"body"},[s(w)?(r(),d("div",{key:0,class:"modal-overlay",onClick:I(W,["self"])},[o("div",ca,[o("div",ua,[e[65]||(e[65]=o("h2",{class:"modal-title"},"Crear Nuevo Paciente",-1)),o("button",{onClick:W,class:"modal-btn-icon"},[m(s(K),{class:"w-5 h-5"})])]),o("form",{onSubmit:I(Ao,["prevent"]),class:"modal-body"},[o("div",ma,[e[69]||(e[69]=o("h3",{class:"form-section-title"},"Informaci√≥n Personal",-1)),o("div",pa,[o("div",va,[e[66]||(e[66]=o("label",{class:"form-label"},[_("Nombre Completo "),o("span",{class:"required"},"*")],-1)),k(o("input",{"onUpdate:modelValue":e[17]||(e[17]=n=>s(t).nombre_completo=n),type:"text",required:"",class:"form-input",placeholder:"Ej: Juan P√©rez Garc√≠a"},null,512),[[B,s(t).nombre_completo]])]),o("div",ba,[e[67]||(e[67]=o("label",{class:"form-label"},[_("Email "),o("span",{class:"required"},"*")],-1)),k(o("input",{"onUpdate:modelValue":e[18]||(e[18]=n=>s(t).email=n),type:"email",required:"",class:"form-input",placeholder:"correo@ejemplo.com"},null,512),[[B,s(t).email]])]),o("div",fa,[e[68]||(e[68]=o("label",{class:"form-label"},[_("Tel√©fono "),o("span",{class:"required"},"*")],-1)),k(o("input",{"onUpdate:modelValue":e[19]||(e[19]=n=>s(t).telefono=n),type:"tel",required:"",class:"form-input",placeholder:"+34 612 345 678"},null,512),[[B,s(t).telefono]])])])]),o("div",_a,[e[72]||(e[72]=o("h3",{class:"form-section-title"},"Asignaci√≥n",-1)),o("div",ga,[e[71]||(e[71]=o("label",{class:"form-label"},"Terapeuta Asignado",-1)),k(o("select",{"onUpdate:modelValue":e[20]||(e[20]=n=>s(t).terapeuta_id=n),class:"form-select"},[e[70]||(e[70]=o("option",{value:null},"Sin asignar",-1)),(r(!0),d(U,null,R(s(P),n=>(r(),d("option",{key:n.id,value:n.id},i(n.nombre),9,ha))),128))],512),[[O,s(t).terapeuta_id]])])]),o("div",$a,[o("div",wa,[m(s(mo),{class:"w-5 h-5"}),e[73]||(e[73]=o("div",null,[o("h3",{class:"form-section-title mb-0"},"Migraci√≥n de Datos (Opcional)"),o("p",{class:"form-section-hint"},"Si el paciente viene con un bono existente, completa esta informaci√≥n")],-1)),k(o("input",{"onUpdate:modelValue":e[21]||(e[21]=n=>s(t).tiene_bono_existente=n),type:"checkbox",class:"toggle-checkbox"},null,512),[[eo,s(t).tiene_bono_existente]])]),s(t).tiene_bono_existente?(r(),d("div",ka,[o("div",ya,[o("div",Ca,[e[75]||(e[75]=o("label",{class:"form-label"},[_("Tipo de Bono "),o("span",{class:"required"},"*")],-1)),k(o("select",{"onUpdate:modelValue":e[22]||(e[22]=n=>s(t).bono.tipo=n),onChange:Po,required:"",class:"form-select"},[...e[74]||(e[74]=[o("option",{value:""},"Seleccionar...",-1),o("option",{value:"semanal"},"Semanal (4 sesiones/mes)",-1),o("option",{value:"quincenal"},"Quincenal (2 sesiones/mes)",-1),o("option",{value:"mensual"},"Mensual (1 sesi√≥n/mes)",-1)])],544),[[O,s(t).bono.tipo]])]),o("div",xa,[e[76]||(e[76]=o("label",{class:"form-label"},"Sesiones Totales",-1)),o("input",{value:s(t).bono.sesiones_totales,type:"number",disabled:"",class:"form-input disabled"},null,8,Pa)]),o("div",Aa,[e[77]||(e[77]=o("label",{class:"form-label"},[_("Sesiones Consumidas "),o("span",{class:"required"},"*")],-1)),k(o("input",{"onUpdate:modelValue":e[23]||(e[23]=n=>s(t).bono.sesiones_consumidas=n),type:"number",min:"0",max:s(t).bono.sesiones_totales||0,required:"",disabled:!s(t).bono.tipo,class:"form-input"},null,8,Ea),[[B,s(t).bono.sesiones_consumidas,void 0,{number:!0}]])]),o("div",Ba,[e[78]||(e[78]=o("label",{class:"form-label"},"Fecha del √öltimo Pago",-1)),k(o("input",{"onUpdate:modelValue":e[24]||(e[24]=n=>s(t).bono.fecha_compra=n),type:"date",class:"form-input"},null,512),[[B,s(t).bono.fecha_compra]])]),o("div",Ma,[e[79]||(e[79]=o("label",{class:"form-label"},"Monto Pagado (‚Ç¨)",-1)),k(o("input",{"onUpdate:modelValue":e[25]||(e[25]=n=>s(t).bono.monto_total=n),type:"number",min:"0",step:"0.01",class:"form-input",placeholder:"0.00"},null,512),[[B,s(t).bono.monto_total,void 0,{number:!0}]])]),o("div",Sa,[e[81]||(e[81]=o("label",{class:"form-label"},"Estado del Pago",-1)),k(o("select",{"onUpdate:modelValue":e[26]||(e[26]=n=>s(t).bono.estado_pago=n),class:"form-select"},[...e[80]||(e[80]=[o("option",{value:"pagado"},"Pagado",-1),o("option",{value:"pendiente"},"Pendiente",-1),o("option",{value:"parcial"},"Pago Parcial",-1)])],512),[[O,s(t).bono.estado_pago]])])]),o("div",qa,[e[82]||(e[82]=o("p",{class:"bono-summary-title"},"Resumen del Bono:",-1)),o("div",Ta,[o("div",Ia,[o("div",Ua,[o("span",null,i(s(t).bono.sesiones_consumidas||0)+" consumidas",1),o("span",null,i((s(t).bono.sesiones_totales||0)-(s(t).bono.sesiones_consumidas||0))+" restantes",1)]),o("div",Va,[o("div",{class:"bono-summary-fill",style:so({width:`${s(t).bono.sesiones_totales>0?s(t).bono.sesiones_consumidas/s(t).bono.sesiones_totales*100:0}%`})},null,4)])]),o("div",ja,[o("span",Da,i((s(t).bono.sesiones_totales||0)-(s(t).bono.sesiones_consumidas||0)),1),o("span",Na,"de "+i(s(t).bono.sesiones_totales||0),1)])])])])):y("",!0)]),o("div",La,[e[85]||(e[85]=o("h3",{class:"form-section-title"},"Informaci√≥n Adicional",-1)),o("div",Fa,[e[83]||(e[83]=o("label",{class:"form-label"},"Notas",-1)),k(o("textarea",{"onUpdate:modelValue":e[27]||(e[27]=n=>s(t).notas=n),rows:"3",class:"form-textarea",placeholder:"Notas adicionales sobre el paciente..."},null,512),[[B,s(t).notas]])]),o("div",za,[k(o("input",{"onUpdate:modelValue":e[28]||(e[28]=n=>s(t).activo=n),type:"checkbox",id:"activo-nuevo",class:"toggle-input"},null,512),[[eo,s(t).activo]]),e[84]||(e[84]=o("label",{for:"activo-nuevo",class:"toggle-label"},"Paciente Activo",-1))])]),o("div",Oa,[o("button",{type:"button",onClick:W,class:"btn btn-secondary"}," Cancelar "),o("button",{type:"submit",disabled:s(u),class:"btn btn-primary"},[s(u)?(r(),z(s(uo),{key:0,class:"w-4 h-4 animate-spin"})):y("",!0),_(" "+i(s(u)?"Creando...":"Crear Paciente"),1)],8,Za)])],32)])])):y("",!0)]))])}}}),mn=G(Ra,[["__scopeId","data-v-56b06e95"]]);export{mn as default};
