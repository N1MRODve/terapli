import{Z as pa,$ as oe,C as ue,z as w,r as S,S as ma,U as Z,F as ie,e as le,W as pe,s as ee,D as de,I as se,R as ha,T as ba,a0 as ga,V as xa,O as _a,n as te,g as ya,B as wa,J as ka,o as g,w as $e,b as Le,k as W,a as n,d as X,l as Ea,c as x,j as B,m as ne,p as Sa,v as ge,i as xe,t as $,K as Qe}from"#entry";import{a as N,u as Ca}from"./usePacientes-CaQyEVfZ.js";import{_ as Ta}from"./_plugin-vue_export-helper-DlAUqK2U.js";function ct(e){typeof queueMicrotask=="function"?queueMicrotask(e):Promise.resolve().then(e).catch(t=>setTimeout(()=>{throw t}))}function He(){let e=[],t={addEventListener(a,l,r,i){return a.addEventListener(l,r,i),t.add(()=>a.removeEventListener(l,r,i))},requestAnimationFrame(...a){let l=requestAnimationFrame(...a);t.add(()=>cancelAnimationFrame(l))},nextFrame(...a){t.requestAnimationFrame(()=>{t.requestAnimationFrame(...a)})},setTimeout(...a){let l=setTimeout(...a);t.add(()=>clearTimeout(l))},microTask(...a){let l={current:!0};return ct(()=>{l.current&&a[0]()}),t.add(()=>{l.current=!1})},style(a,l,r){let i=a.style.getPropertyValue(l);return Object.assign(a.style,{[l]:r}),this.add(()=>{Object.assign(a.style,{[l]:i})})},group(a){let l=He();return a(l),this.add(()=>l.dispose())},add(a){return e.push(a),()=>{let l=e.indexOf(a);if(l>=0)for(let r of e.splice(l,1))r()}},dispose(){for(let a of e.splice(0))a()}};return t}var yt;let Ma=Symbol("headlessui.useid"),$a=0;const Ge=(yt=pa)!=null?yt:function(){return oe(Ma,()=>`${++$a}`)()};function z(e){var t;if(e==null||e.value==null)return null;let a=(t=e.value.$el)!=null?t:e.value;return a instanceof Node?a:null}function me(e,t,...a){if(e in t){let r=t[e];return typeof r=="function"?r(...a):r}let l=new Error(`Tried to handle "${e}" but there is no handler defined. Only defined handlers are: ${Object.keys(t).map(r=>`"${r}"`).join(", ")}.`);throw Error.captureStackTrace&&Error.captureStackTrace(l,me),l}var Aa=Object.defineProperty,Da=(e,t,a)=>t in e?Aa(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a,wt=(e,t,a)=>(Da(e,typeof t!="symbol"?t+"":t,a),a);let Pa=class{constructor(){wt(this,"current",this.detect()),wt(this,"currentId",0)}set(t){this.current!==t&&(this.currentId=0,this.current=t)}reset(){this.set(this.detect())}nextId(){return++this.currentId}get isServer(){return this.current==="server"}get isClient(){return this.current==="client"}detect(){return typeof window>"u"||typeof document>"u"?"server":"client"}},Ie=new Pa;function Ae(e){if(Ie.isServer)return null;if(e instanceof Node)return e.ownerDocument;if(e!=null&&e.hasOwnProperty("value")){let t=z(e);if(t)return t.ownerDocument}return document}let nt=["[contentEditable=true]","[tabindex]","a[href]","area[href]","button:not([disabled])","iframe","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].map(e=>`${e}:not([tabindex='-1'])`).join(",");var ye=(e=>(e[e.First=1]="First",e[e.Previous=2]="Previous",e[e.Next=4]="Next",e[e.Last=8]="Last",e[e.WrapAround=16]="WrapAround",e[e.NoScroll=32]="NoScroll",e))(ye||{}),Pt=(e=>(e[e.Error=0]="Error",e[e.Overflow=1]="Overflow",e[e.Success=2]="Success",e[e.Underflow=3]="Underflow",e))(Pt||{}),Oa=(e=>(e[e.Previous=-1]="Previous",e[e.Next=1]="Next",e))(Oa||{});function La(e=document.body){return e==null?[]:Array.from(e.querySelectorAll(nt)).sort((t,a)=>Math.sign((t.tabIndex||Number.MAX_SAFE_INTEGER)-(a.tabIndex||Number.MAX_SAFE_INTEGER)))}var Ot=(e=>(e[e.Strict=0]="Strict",e[e.Loose=1]="Loose",e))(Ot||{});function Fa(e,t=0){var a;return e===((a=Ae(e))==null?void 0:a.body)?!1:me(t,{0(){return e.matches(nt)},1(){let l=e;for(;l!==null;){if(l.matches(nt))return!0;l=l.parentElement}return!1}})}var ja=(e=>(e[e.Keyboard=0]="Keyboard",e[e.Mouse=1]="Mouse",e))(ja||{});typeof window<"u"&&typeof document<"u"&&(document.addEventListener("keydown",e=>{e.metaKey||e.altKey||e.ctrlKey||(document.documentElement.dataset.headlessuiFocusVisible="")},!0),document.addEventListener("click",e=>{e.detail===1?delete document.documentElement.dataset.headlessuiFocusVisible:e.detail===0&&(document.documentElement.dataset.headlessuiFocusVisible="")},!0));function Me(e){e?.focus({preventScroll:!0})}let Na=["textarea","input"].join(",");function Ha(e){var t,a;return(a=(t=e?.matches)==null?void 0:t.call(e,Na))!=null?a:!1}function Ia(e,t=a=>a){return e.slice().sort((a,l)=>{let r=t(a),i=t(l);if(r===null||i===null)return 0;let f=r.compareDocumentPosition(i);return f&Node.DOCUMENT_POSITION_FOLLOWING?-1:f&Node.DOCUMENT_POSITION_PRECEDING?1:0})}function We(e,t,{sorted:a=!0,relativeTo:l=null,skipElements:r=[]}={}){var i;let f=(i=Array.isArray(e)?e.length>0?e[0].ownerDocument:document:e?.ownerDocument)!=null?i:document,c=Array.isArray(e)?a?Ia(e):e:La(e);r.length>0&&c.length>1&&(c=c.filter(k=>!r.includes(k))),l=l??f.activeElement;let p=(()=>{if(t&5)return 1;if(t&10)return-1;throw new Error("Missing Focus.First, Focus.Previous, Focus.Next or Focus.Last")})(),h=(()=>{if(t&1)return 0;if(t&2)return Math.max(0,c.indexOf(l))-1;if(t&4)return Math.max(0,c.indexOf(l))+1;if(t&8)return c.length-1;throw new Error("Missing Focus.First, Focus.Previous, Focus.Next or Focus.Last")})(),b=t&32?{preventScroll:!0}:{},O=0,E=c.length,M;do{if(O>=E||O+E<=0)return 0;let k=h+O;if(t&16)k=(k+E)%E;else{if(k<0)return 3;if(k>=E)return 1}M=c[k],M?.focus(b),O+=p}while(M!==f.activeElement);return t&6&&Ha(M)&&M.select(),2}function Lt(){return/iPhone/gi.test(window.navigator.platform)||/Mac/gi.test(window.navigator.platform)&&window.navigator.maxTouchPoints>0}function Ba(){return/Android/gi.test(window.navigator.userAgent)}function Ra(){return Lt()||Ba()}function ze(e,t,a){Ie.isServer||ue(l=>{document.addEventListener(e,t,a),l(()=>document.removeEventListener(e,t,a))})}function Ft(e,t,a){Ie.isServer||ue(l=>{window.addEventListener(e,t,a),l(()=>window.removeEventListener(e,t,a))})}function za(e,t,a=w(()=>!0)){function l(i,f){if(!a.value||i.defaultPrevented)return;let c=f(i);if(c===null||!c.getRootNode().contains(c))return;let p=(function h(b){return typeof b=="function"?h(b()):Array.isArray(b)||b instanceof Set?b:[b]})(e);for(let h of p){if(h===null)continue;let b=h instanceof HTMLElement?h:z(h);if(b!=null&&b.contains(c)||i.composed&&i.composedPath().includes(b))return}return!Fa(c,Ot.Loose)&&c.tabIndex!==-1&&i.preventDefault(),t(i,c)}let r=S(null);ze("pointerdown",i=>{var f,c;a.value&&(r.value=((c=(f=i.composedPath)==null?void 0:f.call(i))==null?void 0:c[0])||i.target)},!0),ze("mousedown",i=>{var f,c;a.value&&(r.value=((c=(f=i.composedPath)==null?void 0:f.call(i))==null?void 0:c[0])||i.target)},!0),ze("click",i=>{Ra()||r.value&&(l(i,()=>r.value),r.value=null)},!0),ze("touchend",i=>l(i,()=>i.target instanceof HTMLElement?i.target:null),!0),Ft("blur",i=>l(i,()=>window.document.activeElement instanceof HTMLIFrameElement?window.document.activeElement:null),!0)}var qe=(e=>(e[e.None=0]="None",e[e.RenderStrategy=1]="RenderStrategy",e[e.Static=2]="Static",e))(qe||{}),we=(e=>(e[e.Unmount=0]="Unmount",e[e.Hidden=1]="Hidden",e))(we||{});function he({visible:e=!0,features:t=0,ourProps:a,theirProps:l,...r}){var i;let f=Nt(l,a),c=Object.assign(r,{props:f});if(e||t&2&&f.static)return Xe(c);if(t&1){let p=(i=f.unmount)==null||i?0:1;return me(p,{0(){return null},1(){return Xe({...r,props:{...f,hidden:!0,style:{display:"none"}}})}})}return Xe(c)}function Xe({props:e,attrs:t,slots:a,slot:l,name:r}){var i,f;let{as:c,...p}=Ht(e,["unmount","static"]),h=(i=a.default)==null?void 0:i.call(a,l),b={};if(l){let O=!1,E=[];for(let[M,k]of Object.entries(l))typeof k=="boolean"&&(O=!0),k===!0&&E.push(M);O&&(b["data-headlessui-state"]=E.join(" "))}if(c==="template"){if(h=jt(h??[]),Object.keys(p).length>0||Object.keys(t).length>0){let[O,...E]=h??[];if(!Va(O)||E.length>0)throw new Error(['Passing props on "template"!',"",`The current component <${r} /> is rendering a "template".`,"However we need to passthrough the following props:",Object.keys(p).concat(Object.keys(t)).map(A=>A.trim()).filter((A,L,y)=>y.indexOf(A)===L).sort((A,L)=>A.localeCompare(L)).map(A=>`  - ${A}`).join(`
`),"","You can apply a few solutions:",['Add an `as="..."` prop, to ensure that we render an actual element instead of a "template".',"Render a single element as the child so that we can forward the props onto that element."].map(A=>`  - ${A}`).join(`
`)].join(`
`));let M=Nt((f=O.props)!=null?f:{},p,b),k=ma(O,M,!0);for(let A in M)A.startsWith("on")&&(k.props||(k.props={}),k.props[A]=M[A]);return k}return Array.isArray(h)&&h.length===1?h[0]:h}return Z(c,Object.assign({},p,b),{default:()=>h})}function jt(e){return e.flatMap(t=>t.type===ie?jt(t.children):[t])}function Nt(...e){if(e.length===0)return{};if(e.length===1)return e[0];let t={},a={};for(let l of e)for(let r in l)r.startsWith("on")&&typeof l[r]=="function"?(a[r]!=null||(a[r]=[]),a[r].push(l[r])):t[r]=l[r];if(t.disabled||t["aria-disabled"])return Object.assign(t,Object.fromEntries(Object.keys(a).map(l=>[l,void 0])));for(let l in a)Object.assign(t,{[l](r,...i){let f=a[l];for(let c of f){if(r instanceof Event&&r.defaultPrevented)return;c(r,...i)}}});return t}function Ht(e,t=[]){let a=Object.assign({},e);for(let l of t)l in a&&delete a[l];return a}function Va(e){return e==null?!1:typeof e.type=="string"||typeof e.type=="object"||typeof e.type=="function"}var Ke=(e=>(e[e.None=1]="None",e[e.Focusable=2]="Focusable",e[e.Hidden=4]="Hidden",e))(Ke||{});let ot=le({name:"Hidden",props:{as:{type:[Object,String],default:"div"},features:{type:Number,default:1}},setup(e,{slots:t,attrs:a}){return()=>{var l;let{features:r,...i}=e,f={"aria-hidden":(r&2)===2?!0:(l=i["aria-hidden"])!=null?l:void 0,hidden:(r&4)===4?!0:void 0,style:{position:"fixed",top:1,left:1,width:1,height:0,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0",...(r&4)===4&&(r&2)!==2&&{display:"none"}}};return he({ourProps:f,theirProps:i,slot:{},attrs:a,slots:t,name:"Hidden"})}}}),It=Symbol("Context");var ae=(e=>(e[e.Open=1]="Open",e[e.Closed=2]="Closed",e[e.Closing=4]="Closing",e[e.Opening=8]="Opening",e))(ae||{});function Ua(){return ft()!==null}function ft(){return oe(It,null)}function Wa(e){pe(It,e)}var Bt=(e=>(e.Space=" ",e.Enter="Enter",e.Escape="Escape",e.Backspace="Backspace",e.Delete="Delete",e.ArrowLeft="ArrowLeft",e.ArrowUp="ArrowUp",e.ArrowRight="ArrowRight",e.ArrowDown="ArrowDown",e.Home="Home",e.End="End",e.PageUp="PageUp",e.PageDown="PageDown",e.Tab="Tab",e))(Bt||{});function qa(e){function t(){document.readyState!=="loading"&&(e(),document.removeEventListener("DOMContentLoaded",t))}typeof window<"u"&&typeof document<"u"&&(document.addEventListener("DOMContentLoaded",t),t())}let Ce=[];qa(()=>{function e(t){t.target instanceof HTMLElement&&t.target!==document.body&&Ce[0]!==t.target&&(Ce.unshift(t.target),Ce=Ce.filter(a=>a!=null&&a.isConnected),Ce.splice(10))}window.addEventListener("click",e,{capture:!0}),window.addEventListener("mousedown",e,{capture:!0}),window.addEventListener("focus",e,{capture:!0}),document.body.addEventListener("click",e,{capture:!0}),document.body.addEventListener("mousedown",e,{capture:!0}),document.body.addEventListener("focus",e,{capture:!0})});function Rt(e,t,a,l){Ie.isServer||ue(r=>{e=e??window,e.addEventListener(t,a,l),r(()=>e.removeEventListener(t,a,l))})}var Ne=(e=>(e[e.Forwards=0]="Forwards",e[e.Backwards=1]="Backwards",e))(Ne||{});function Ka(){let e=S(0);return Ft("keydown",t=>{t.key==="Tab"&&(e.value=t.shiftKey?1:0)}),e}function zt(e){if(!e)return new Set;if(typeof e=="function")return new Set(e());let t=new Set;for(let a of e.value){let l=z(a);l instanceof HTMLElement&&t.add(l)}return t}var Vt=(e=>(e[e.None=1]="None",e[e.InitialFocus=2]="InitialFocus",e[e.TabLock=4]="TabLock",e[e.FocusLock=8]="FocusLock",e[e.RestoreFocus=16]="RestoreFocus",e[e.All=30]="All",e))(Vt||{});let Fe=Object.assign(le({name:"FocusTrap",props:{as:{type:[Object,String],default:"div"},initialFocus:{type:Object,default:null},features:{type:Number,default:30},containers:{type:[Object,Function],default:S(new Set)}},inheritAttrs:!1,setup(e,{attrs:t,slots:a,expose:l}){let r=S(null);l({el:r,$el:r});let i=w(()=>Ae(r)),f=S(!1);ee(()=>f.value=!0),de(()=>f.value=!1),Ya({ownerDocument:i},w(()=>f.value&&!!(e.features&16)));let c=Ja({ownerDocument:i,container:r,initialFocus:w(()=>e.initialFocus)},w(()=>f.value&&!!(e.features&2)));Za({ownerDocument:i,container:r,containers:e.containers,previousActiveElement:c},w(()=>f.value&&!!(e.features&8)));let p=Ka();function h(M){let k=z(r);k&&(A=>A())(()=>{me(p.value,{[Ne.Forwards]:()=>{We(k,ye.First,{skipElements:[M.relatedTarget]})},[Ne.Backwards]:()=>{We(k,ye.Last,{skipElements:[M.relatedTarget]})}})})}let b=S(!1);function O(M){M.key==="Tab"&&(b.value=!0,requestAnimationFrame(()=>{b.value=!1}))}function E(M){if(!f.value)return;let k=zt(e.containers);z(r)instanceof HTMLElement&&k.add(z(r));let A=M.relatedTarget;A instanceof HTMLElement&&A.dataset.headlessuiFocusGuard!=="true"&&(Ut(k,A)||(b.value?We(z(r),me(p.value,{[Ne.Forwards]:()=>ye.Next,[Ne.Backwards]:()=>ye.Previous})|ye.WrapAround,{relativeTo:M.target}):M.target instanceof HTMLElement&&Me(M.target)))}return()=>{let M={},k={ref:r,onKeydown:O,onFocusout:E},{features:A,initialFocus:L,containers:y,...C}=e;return Z(ie,[!!(A&4)&&Z(ot,{as:"button",type:"button","data-headlessui-focus-guard":!0,onFocus:h,features:Ke.Focusable}),he({ourProps:k,theirProps:{...t,...C},slot:M,attrs:t,slots:a,name:"FocusTrap"}),!!(A&4)&&Z(ot,{as:"button",type:"button","data-headlessui-focus-guard":!0,onFocus:h,features:Ke.Focusable})])}}}),{features:Vt});function Ga(e){let t=S(Ce.slice());return se([e],([a],[l])=>{l===!0&&a===!1?ct(()=>{t.value.splice(0)}):l===!1&&a===!0&&(t.value=Ce.slice())},{flush:"post"}),()=>{var a;return(a=t.value.find(l=>l!=null&&l.isConnected))!=null?a:null}}function Ya({ownerDocument:e},t){let a=Ga(t);ee(()=>{ue(()=>{var l,r;t.value||((l=e.value)==null?void 0:l.activeElement)===((r=e.value)==null?void 0:r.body)&&Me(a())},{flush:"post"})}),de(()=>{t.value&&Me(a())})}function Ja({ownerDocument:e,container:t,initialFocus:a},l){let r=S(null),i=S(!1);return ee(()=>i.value=!0),de(()=>i.value=!1),ee(()=>{se([t,a,l],(f,c)=>{if(f.every((h,b)=>c?.[b]===h)||!l.value)return;let p=z(t);p&&ct(()=>{var h,b;if(!i.value)return;let O=z(a),E=(h=e.value)==null?void 0:h.activeElement;if(O){if(O===E){r.value=E;return}}else if(p.contains(E)){r.value=E;return}O?Me(O):We(p,ye.First|ye.NoScroll)===Pt.Error&&console.warn("There are no focusable elements inside the <FocusTrap />"),r.value=(b=e.value)==null?void 0:b.activeElement})},{immediate:!0,flush:"post"})}),r}function Za({ownerDocument:e,container:t,containers:a,previousActiveElement:l},r){var i;Rt((i=e.value)==null?void 0:i.defaultView,"focus",f=>{if(!r.value)return;let c=zt(a);z(t)instanceof HTMLElement&&c.add(z(t));let p=l.value;if(!p)return;let h=f.target;h&&h instanceof HTMLElement?Ut(c,h)?(l.value=h,Me(h)):(f.preventDefault(),f.stopPropagation(),Me(p)):Me(l.value)},!0)}function Ut(e,t){for(let a of e)if(a.contains(t))return!0;return!1}function Qa(e){let t=ha(e.getSnapshot());return de(e.subscribe(()=>{t.value=e.getSnapshot()})),t}function Xa(e,t){let a=e(),l=new Set;return{getSnapshot(){return a},subscribe(r){return l.add(r),()=>l.delete(r)},dispatch(r,...i){let f=t[r].call(a,...i);f&&(a=f,l.forEach(c=>c()))}}}function en(){let e;return{before({doc:t}){var a;let l=t.documentElement;e=((a=t.defaultView)!=null?a:window).innerWidth-l.clientWidth},after({doc:t,d:a}){let l=t.documentElement,r=l.clientWidth-l.offsetWidth,i=e-r;a.style(l,"paddingRight",`${i}px`)}}}function tn(){return Lt()?{before({doc:e,d:t,meta:a}){function l(r){return a.containers.flatMap(i=>i()).some(i=>i.contains(r))}t.microTask(()=>{var r;if(window.getComputedStyle(e.documentElement).scrollBehavior!=="auto"){let c=He();c.style(e.documentElement,"scrollBehavior","auto"),t.add(()=>t.microTask(()=>c.dispose()))}let i=(r=window.scrollY)!=null?r:window.pageYOffset,f=null;t.addEventListener(e,"click",c=>{if(c.target instanceof HTMLElement)try{let p=c.target.closest("a");if(!p)return;let{hash:h}=new URL(p.href),b=e.querySelector(h);b&&!l(b)&&(f=b)}catch{}},!0),t.addEventListener(e,"touchstart",c=>{if(c.target instanceof HTMLElement)if(l(c.target)){let p=c.target;for(;p.parentElement&&l(p.parentElement);)p=p.parentElement;t.style(p,"overscrollBehavior","contain")}else t.style(c.target,"touchAction","none")}),t.addEventListener(e,"touchmove",c=>{if(c.target instanceof HTMLElement){if(c.target.tagName==="INPUT")return;if(l(c.target)){let p=c.target;for(;p.parentElement&&p.dataset.headlessuiPortal!==""&&!(p.scrollHeight>p.clientHeight||p.scrollWidth>p.clientWidth);)p=p.parentElement;p.dataset.headlessuiPortal===""&&c.preventDefault()}else c.preventDefault()}},{passive:!1}),t.add(()=>{var c;let p=(c=window.scrollY)!=null?c:window.pageYOffset;i!==p&&window.scrollTo(0,i),f&&f.isConnected&&(f.scrollIntoView({block:"nearest"}),f=null)})})}}:{}}function an(){return{before({doc:e,d:t}){t.style(e.documentElement,"overflow","hidden")}}}function nn(e){let t={};for(let a of e)Object.assign(t,a(t));return t}let Te=Xa(()=>new Map,{PUSH(e,t){var a;let l=(a=this.get(e))!=null?a:{doc:e,count:0,d:He(),meta:new Set};return l.count++,l.meta.add(t),this.set(e,l),this},POP(e,t){let a=this.get(e);return a&&(a.count--,a.meta.delete(t)),this},SCROLL_PREVENT({doc:e,d:t,meta:a}){let l={doc:e,d:t,meta:nn(a)},r=[tn(),en(),an()];r.forEach(({before:i})=>i?.(l)),r.forEach(({after:i})=>i?.(l))},SCROLL_ALLOW({d:e}){e.dispose()},TEARDOWN({doc:e}){this.delete(e)}});Te.subscribe(()=>{let e=Te.getSnapshot(),t=new Map;for(let[a]of e)t.set(a,a.documentElement.style.overflow);for(let a of e.values()){let l=t.get(a.doc)==="hidden",r=a.count!==0;(r&&!l||!r&&l)&&Te.dispatch(a.count>0?"SCROLL_PREVENT":"SCROLL_ALLOW",a),a.count===0&&Te.dispatch("TEARDOWN",a)}});function on(e,t,a){let l=Qa(Te),r=w(()=>{let i=e.value?l.value.get(e.value):void 0;return i?i.count>0:!1});return se([e,t],([i,f],[c],p)=>{if(!i||!f)return;Te.dispatch("PUSH",i,a);let h=!1;p(()=>{h||(Te.dispatch("POP",c??i,a),h=!0)})},{immediate:!0}),r}let et=new Map,je=new Map;function kt(e,t=S(!0)){ue(a=>{var l;if(!t.value)return;let r=z(e);if(!r)return;a(function(){var f;if(!r)return;let c=(f=je.get(r))!=null?f:1;if(c===1?je.delete(r):je.set(r,c-1),c!==1)return;let p=et.get(r);p&&(p["aria-hidden"]===null?r.removeAttribute("aria-hidden"):r.setAttribute("aria-hidden",p["aria-hidden"]),r.inert=p.inert,et.delete(r))});let i=(l=je.get(r))!=null?l:0;je.set(r,i+1),i===0&&(et.set(r,{"aria-hidden":r.getAttribute("aria-hidden"),inert:r.inert}),r.setAttribute("aria-hidden","true"),r.inert=!0)})}function ln({defaultContainers:e=[],portals:t,mainTreeNodeRef:a}={}){let l=S(null),r=Ae(l);function i(){var f,c,p;let h=[];for(let b of e)b!==null&&(b instanceof HTMLElement?h.push(b):"value"in b&&b.value instanceof HTMLElement&&h.push(b.value));if(t!=null&&t.value)for(let b of t.value)h.push(b);for(let b of(f=r?.querySelectorAll("html > *, body > *"))!=null?f:[])b!==document.body&&b!==document.head&&b instanceof HTMLElement&&b.id!=="headlessui-portal-root"&&(b.contains(z(l))||b.contains((p=(c=z(l))==null?void 0:c.getRootNode())==null?void 0:p.host)||h.some(O=>b.contains(O))||h.push(b));return h}return{resolveContainers:i,contains(f){return i().some(c=>c.contains(f))},mainTreeNodeRef:l,MainTreeNode(){return a!=null?null:Z(ot,{features:Ke.Hidden,ref:l})}}}let Wt=Symbol("ForcePortalRootContext");function rn(){return oe(Wt,!1)}let Et=le({name:"ForcePortalRoot",props:{as:{type:[Object,String],default:"template"},force:{type:Boolean,default:!1}},setup(e,{slots:t,attrs:a}){return pe(Wt,e.force),()=>{let{force:l,...r}=e;return he({theirProps:r,ourProps:{},slot:{},slots:t,attrs:a,name:"ForcePortalRoot"})}}}),qt=Symbol("StackContext");var lt=(e=>(e[e.Add=0]="Add",e[e.Remove=1]="Remove",e))(lt||{});function sn(){return oe(qt,()=>{})}function un({type:e,enabled:t,element:a,onUpdate:l}){let r=sn();function i(...f){l?.(...f),r(...f)}ee(()=>{se(t,(f,c)=>{f?i(0,e,a):c===!0&&i(1,e,a)},{immediate:!0,flush:"sync"})}),de(()=>{t.value&&i(1,e,a)}),pe(qt,i)}let dn=Symbol("DescriptionContext");function cn({slot:e=S({}),name:t="Description",props:a={}}={}){let l=S([]);function r(i){return l.value.push(i),()=>{let f=l.value.indexOf(i);f!==-1&&l.value.splice(f,1)}}return pe(dn,{register:r,slot:e,name:t,props:a}),w(()=>l.value.length>0?l.value.join(" "):void 0)}function fn(e){let t=Ae(e);if(!t){if(e===null)return null;throw new Error(`[Headless UI]: Cannot find ownerDocument for contextElement: ${e}`)}let a=t.getElementById("headlessui-portal-root");if(a)return a;let l=t.createElement("div");return l.setAttribute("id","headlessui-portal-root"),t.body.appendChild(l)}const rt=new WeakMap;function vn(e){var t;return(t=rt.get(e))!=null?t:0}function St(e,t){let a=t(vn(e));return a<=0?rt.delete(e):rt.set(e,a),a}let pn=le({name:"Portal",props:{as:{type:[Object,String],default:"div"}},setup(e,{slots:t,attrs:a}){let l=S(null),r=w(()=>Ae(l)),i=rn(),f=oe(Kt,null),c=S(i===!0||f==null?fn(l.value):f.resolveTarget());c.value&&St(c.value,E=>E+1);let p=S(!1);ee(()=>{p.value=!0}),ue(()=>{i||f!=null&&(c.value=f.resolveTarget())});let h=oe(it,null),b=!1,O=xa();return se(l,()=>{if(b||!h)return;let E=z(l);E&&(de(h.register(E),O),b=!0)}),de(()=>{var E,M;let k=(E=r.value)==null?void 0:E.getElementById("headlessui-portal-root");!k||c.value!==k||St(c.value,A=>A-1)||c.value.children.length>0||(M=c.value.parentElement)==null||M.removeChild(c.value)}),()=>{if(!p.value||c.value===null)return null;let E={ref:l,"data-headlessui-portal":""};return Z(ba,{to:c.value},he({ourProps:E,theirProps:e,slot:{},attrs:a,slots:t,name:"Portal"}))}}}),it=Symbol("PortalParentContext");function mn(){let e=oe(it,null),t=S([]);function a(i){return t.value.push(i),e&&e.register(i),()=>l(i)}function l(i){let f=t.value.indexOf(i);f!==-1&&t.value.splice(f,1),e&&e.unregister(i)}let r={register:a,unregister:l,portals:t};return[t,le({name:"PortalWrapper",setup(i,{slots:f}){return pe(it,r),()=>{var c;return(c=f.default)==null?void 0:c.call(f)}}})]}let Kt=Symbol("PortalGroupContext"),hn=le({name:"PortalGroup",props:{as:{type:[Object,String],default:"template"},target:{type:Object,default:null}},setup(e,{attrs:t,slots:a}){let l=ga({resolveTarget(){return e.target}});return pe(Kt,l),()=>{let{target:r,...i}=e;return he({theirProps:i,ourProps:{},slot:{},attrs:t,slots:a,name:"PortalGroup"})}}});var bn=(e=>(e[e.Open=0]="Open",e[e.Closed=1]="Closed",e))(bn||{});let st=Symbol("DialogContext");function vt(e){let t=oe(st,null);if(t===null){let a=new Error(`<${e} /> is missing a parent <Dialog /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(a,vt),a}return t}let Ve="DC8F892D-2EBD-447C-A4C8-A03058436FF4",gn=le({name:"Dialog",inheritAttrs:!1,props:{as:{type:[Object,String],default:"div"},static:{type:Boolean,default:!1},unmount:{type:Boolean,default:!0},open:{type:[Boolean,String],default:Ve},initialFocus:{type:Object,default:null},id:{type:String,default:null},role:{type:String,default:"dialog"}},emits:{close:e=>!0},setup(e,{emit:t,attrs:a,slots:l,expose:r}){var i,f;let c=(i=e.id)!=null?i:`headlessui-dialog-${Ge()}`,p=S(!1);ee(()=>{p.value=!0});let h=!1,b=w(()=>e.role==="dialog"||e.role==="alertdialog"?e.role:(h||(h=!0,console.warn(`Invalid role [${b}] passed to <Dialog />. Only \`dialog\` and and \`alertdialog\` are supported. Using \`dialog\` instead.`)),"dialog")),O=S(0),E=ft(),M=w(()=>e.open===Ve&&E!==null?(E.value&ae.Open)===ae.Open:e.open),k=S(null),A=w(()=>Ae(k));if(r({el:k,$el:k}),!(e.open!==Ve||E!==null))throw new Error("You forgot to provide an `open` prop to the `Dialog`.");if(typeof M.value!="boolean")throw new Error(`You provided an \`open\` prop to the \`Dialog\`, but the value is not a boolean. Received: ${M.value===Ve?void 0:e.open}`);let L=w(()=>p.value&&M.value?0:1),y=w(()=>L.value===0),C=w(()=>O.value>1),J=oe(st,null)!==null,[d,R]=mn(),{resolveContainers:re,mainTreeNodeRef:ce,MainTreeNode:v}=ln({portals:d,defaultContainers:[w(()=>{var H;return(H=Q.panelRef.value)!=null?H:k.value})]}),m=w(()=>C.value?"parent":"leaf"),_=w(()=>E!==null?(E.value&ae.Closing)===ae.Closing:!1),T=w(()=>J||_.value?!1:y.value),D=w(()=>{var H,F,K;return(K=Array.from((F=(H=A.value)==null?void 0:H.querySelectorAll("body > *"))!=null?F:[]).find(G=>G.id==="headlessui-portal-root"?!1:G.contains(z(ce))&&G instanceof HTMLElement))!=null?K:null});kt(D,T);let I=w(()=>C.value?!0:y.value),V=w(()=>{var H,F,K;return(K=Array.from((F=(H=A.value)==null?void 0:H.querySelectorAll("[data-headlessui-portal]"))!=null?F:[]).find(G=>G.contains(z(ce))&&G instanceof HTMLElement))!=null?K:null});kt(V,I),un({type:"Dialog",enabled:w(()=>L.value===0),element:k,onUpdate:(H,F)=>{if(F==="Dialog")return me(H,{[lt.Add]:()=>O.value+=1,[lt.Remove]:()=>O.value-=1})}});let U=cn({name:"DialogDescription",slot:w(()=>({open:M.value}))}),q=S(null),Q={titleId:q,panelRef:S(null),dialogState:L,setTitleId(H){q.value!==H&&(q.value=H)},close(){t("close",!1)}};pe(st,Q);let fe=w(()=>!(!y.value||C.value));za(re,(H,F)=>{H.preventDefault(),Q.close(),_a(()=>F?.focus())},fe);let ve=w(()=>!(C.value||L.value!==0));Rt((f=A.value)==null?void 0:f.defaultView,"keydown",H=>{ve.value&&(H.defaultPrevented||H.key===Bt.Escape&&(H.preventDefault(),H.stopPropagation(),Q.close()))});let ke=w(()=>!(_.value||L.value!==0||J));return on(A,ke,H=>{var F;return{containers:[...(F=H.containers)!=null?F:[],re]}}),ue(H=>{if(L.value!==0)return;let F=z(k);if(!F)return;let K=new ResizeObserver(G=>{for(let De of G){let _e=De.target.getBoundingClientRect();_e.x===0&&_e.y===0&&_e.width===0&&_e.height===0&&Q.close()}});K.observe(F),H(()=>K.disconnect())}),()=>{let{open:H,initialFocus:F,...K}=e,G={...a,ref:k,id:c,role:b.value,"aria-modal":L.value===0?!0:void 0,"aria-labelledby":q.value,"aria-describedby":U.value},De={open:L.value===0};return Z(Et,{force:!0},()=>[Z(pn,()=>Z(hn,{target:k.value},()=>Z(Et,{force:!1},()=>Z(Fe,{initialFocus:F,containers:re,features:y.value?me(m.value,{parent:Fe.features.RestoreFocus,leaf:Fe.features.All&~Fe.features.FocusLock}):Fe.features.None},()=>Z(R,{},()=>he({ourProps:G,theirProps:{...K,...a},slot:De,attrs:a,slots:l,visible:L.value===0,features:qe.RenderStrategy|qe.Static,name:"Dialog"})))))),Z(v)])}}}),xn=le({name:"DialogPanel",props:{as:{type:[Object,String],default:"div"},id:{type:String,default:null}},setup(e,{attrs:t,slots:a,expose:l}){var r;let i=(r=e.id)!=null?r:`headlessui-dialog-panel-${Ge()}`,f=vt("DialogPanel");l({el:f.panelRef,$el:f.panelRef});function c(p){p.stopPropagation()}return()=>{let{...p}=e,h={id:i,ref:f.panelRef,onClick:c};return he({ourProps:h,theirProps:p,slot:{open:f.dialogState.value===0},attrs:t,slots:a,name:"DialogPanel"})}}}),_n=le({name:"DialogTitle",props:{as:{type:[Object,String],default:"h2"},id:{type:String,default:null}},setup(e,{attrs:t,slots:a}){var l;let r=(l=e.id)!=null?l:`headlessui-dialog-title-${Ge()}`,i=vt("DialogTitle");return ee(()=>{i.setTitleId(r),de(()=>i.setTitleId(null))}),()=>{let{...f}=e;return he({ourProps:{id:r},theirProps:f,slot:{open:i.dialogState.value===0},attrs:t,slots:a,name:"DialogTitle"})}}});function yn(e){let t={called:!1};return(...a)=>{if(!t.called)return t.called=!0,e(...a)}}function tt(e,...t){e&&t.length>0&&e.classList.add(...t)}function Ue(e,...t){e&&t.length>0&&e.classList.remove(...t)}var ut=(e=>(e.Finished="finished",e.Cancelled="cancelled",e))(ut||{});function wn(e,t){let a=He();if(!e)return a.dispose;let{transitionDuration:l,transitionDelay:r}=getComputedStyle(e),[i,f]=[l,r].map(c=>{let[p=0]=c.split(",").filter(Boolean).map(h=>h.includes("ms")?parseFloat(h):parseFloat(h)*1e3).sort((h,b)=>b-h);return p});return i!==0?a.setTimeout(()=>t("finished"),i+f):t("finished"),a.add(()=>t("cancelled")),a.dispose}function Ct(e,t,a,l,r,i){let f=He(),c=i!==void 0?yn(i):()=>{};return Ue(e,...r),tt(e,...t,...a),f.nextFrame(()=>{Ue(e,...a),tt(e,...l),f.add(wn(e,p=>(Ue(e,...l,...t),tt(e,...r),c(p))))}),f.add(()=>Ue(e,...t,...a,...l,...r)),f.add(()=>c("cancelled")),f.dispose}function Se(e=""){return e.split(/\s+/).filter(t=>t.length>1)}let pt=Symbol("TransitionContext");var kn=(e=>(e.Visible="visible",e.Hidden="hidden",e))(kn||{});function En(){return oe(pt,null)!==null}function Sn(){let e=oe(pt,null);if(e===null)throw new Error("A <TransitionChild /> is used but it is missing a parent <TransitionRoot />.");return e}function Cn(){let e=oe(mt,null);if(e===null)throw new Error("A <TransitionChild /> is used but it is missing a parent <TransitionRoot />.");return e}let mt=Symbol("NestingContext");function Ye(e){return"children"in e?Ye(e.children):e.value.filter(({state:t})=>t==="visible").length>0}function Gt(e){let t=S([]),a=S(!1);ee(()=>a.value=!0),de(()=>a.value=!1);function l(i,f=we.Hidden){let c=t.value.findIndex(({id:p})=>p===i);c!==-1&&(me(f,{[we.Unmount](){t.value.splice(c,1)},[we.Hidden](){t.value[c].state="hidden"}}),!Ye(t)&&a.value&&e?.())}function r(i){let f=t.value.find(({id:c})=>c===i);return f?f.state!=="visible"&&(f.state="visible"):t.value.push({id:i,state:"visible"}),()=>l(i,we.Unmount)}return{children:t,register:r,unregister:l}}let Yt=qe.RenderStrategy,dt=le({props:{as:{type:[Object,String],default:"div"},show:{type:[Boolean],default:null},unmount:{type:[Boolean],default:!0},appear:{type:[Boolean],default:!1},enter:{type:[String],default:""},enterFrom:{type:[String],default:""},enterTo:{type:[String],default:""},entered:{type:[String],default:""},leave:{type:[String],default:""},leaveFrom:{type:[String],default:""},leaveTo:{type:[String],default:""}},emits:{beforeEnter:()=>!0,afterEnter:()=>!0,beforeLeave:()=>!0,afterLeave:()=>!0},setup(e,{emit:t,attrs:a,slots:l,expose:r}){let i=S(0);function f(){i.value|=ae.Opening,t("beforeEnter")}function c(){i.value&=~ae.Opening,t("afterEnter")}function p(){i.value|=ae.Closing,t("beforeLeave")}function h(){i.value&=~ae.Closing,t("afterLeave")}if(!En()&&Ua())return()=>Z(Jt,{...e,onBeforeEnter:f,onAfterEnter:c,onBeforeLeave:p,onAfterLeave:h},l);let b=S(null),O=w(()=>e.unmount?we.Unmount:we.Hidden);r({el:b,$el:b});let{show:E,appear:M}=Sn(),{register:k,unregister:A}=Cn(),L=S(E.value?"visible":"hidden"),y={value:!0},C=Ge(),J={value:!1},d=Gt(()=>{!J.value&&L.value!=="hidden"&&(L.value="hidden",A(C),h())});ee(()=>{let I=k(C);de(I)}),ue(()=>{if(O.value===we.Hidden&&C){if(E.value&&L.value!=="visible"){L.value="visible";return}me(L.value,{hidden:()=>A(C),visible:()=>k(C)})}});let R=Se(e.enter),re=Se(e.enterFrom),ce=Se(e.enterTo),v=Se(e.entered),m=Se(e.leave),_=Se(e.leaveFrom),T=Se(e.leaveTo);ee(()=>{ue(()=>{if(L.value==="visible"){let I=z(b);if(I instanceof Comment&&I.data==="")throw new Error("Did you forget to passthrough the `ref` to the actual DOM node?")}})});function D(I){let V=y.value&&!M.value,U=z(b);!U||!(U instanceof HTMLElement)||V||(J.value=!0,E.value&&f(),E.value||p(),I(E.value?Ct(U,R,re,ce,v,q=>{J.value=!1,q===ut.Finished&&c()}):Ct(U,m,_,T,v,q=>{J.value=!1,q===ut.Finished&&(Ye(d)||(L.value="hidden",A(C),h()))})))}return ee(()=>{se([E],(I,V,U)=>{D(U),y.value=!1},{immediate:!0})}),pe(mt,d),Wa(w(()=>me(L.value,{visible:ae.Open,hidden:ae.Closed})|i.value)),()=>{let{appear:I,show:V,enter:U,enterFrom:q,enterTo:Q,entered:fe,leave:ve,leaveFrom:ke,leaveTo:H,...F}=e,K={ref:b},G={...F,...M.value&&E.value&&Ie.isServer?{class:te([a.class,F.class,...R,...re])}:{}};return he({theirProps:G,ourProps:K,slot:{},slots:l,attrs:a,features:Yt,visible:L.value==="visible",name:"TransitionChild"})}}}),Tn=dt,Jt=le({inheritAttrs:!1,props:{as:{type:[Object,String],default:"div"},show:{type:[Boolean],default:null},unmount:{type:[Boolean],default:!0},appear:{type:[Boolean],default:!1},enter:{type:[String],default:""},enterFrom:{type:[String],default:""},enterTo:{type:[String],default:""},entered:{type:[String],default:""},leave:{type:[String],default:""},leaveFrom:{type:[String],default:""},leaveTo:{type:[String],default:""}},emits:{beforeEnter:()=>!0,afterEnter:()=>!0,beforeLeave:()=>!0,afterLeave:()=>!0},setup(e,{emit:t,attrs:a,slots:l}){let r=ft(),i=w(()=>e.show===null&&r!==null?(r.value&ae.Open)===ae.Open:e.show);ue(()=>{if(![!0,!1].includes(i.value))throw new Error('A <Transition /> is used but it is missing a `:show="true | false"` prop.')});let f=S(i.value?"visible":"hidden"),c=Gt(()=>{f.value="hidden"}),p=S(!0),h={show:i,appear:w(()=>e.appear||!p.value)};return ee(()=>{ue(()=>{p.value=!1,i.value?f.value="visible":Ye(c)||(f.value="hidden")})}),pe(mt,c),pe(pt,h),()=>{let b=Ht(e,["show","appear","unmount","onBeforeEnter","onBeforeLeave","onAfterEnter","onAfterLeave"]),O={unmount:e.unmount};return he({ourProps:{...O,as:"template"},theirProps:{},slot:{},slots:{...l,default:()=>[Z(Tn,{onBeforeEnter:()=>t("beforeEnter"),onAfterEnter:()=>t("afterEnter"),onBeforeLeave:()=>t("beforeLeave"),onAfterLeave:()=>t("afterLeave"),...a,...O,...b},l.default)]},attrs:{},features:Yt,visible:f.value==="visible",name:"Transition"})}}});const Mn={pending:["confirmed","canceled"],confirmed:["completed","canceled"],completed:[],canceled:[]},Tt={pendiente:"pending",confirmada:"confirmed",realizada:"completed",completada:"completed",cancelada:"canceled"},$n={pending:"pendiente",confirmed:"confirmada",completed:"realizada",canceled:"cancelada"};function An(e,t){const a=Tt[e]||e,l=Tt[t]||t,r=Mn[a];if(!r)return{valid:!1,error:`Estado inicial inv谩lido: ${e}`,errorCode:"INVALID_INITIAL_STATE"};if(!r.includes(l)){const i=r.map(f=>$n[f]).join(", ");return{valid:!1,error:`No se puede cambiar de "${e}" a "${t}". Transiciones permitidas: ${i}`,errorCode:"INVALID_STATE_TRANSITION",details:{from:e,to:t,allowedTransitions:r}}}return{valid:!0}}function Mt(e){if(e.valid)return"";let t=e.error||"Error de validaci贸n desconocido";if(e.details){const a=e.details;if(a.conflictingAppointment){const l=a.conflictingAppointment;t+=`

Cita existente:
- Hora: ${l.hora_inicio} - ${l.hora_fin}`}a.duration&&(t+=`

Duraci贸n: ${a.duration} minutos`)}return t}function Dn(){const e=ya();wa();const t=S([]),a=S(!1),l=S(null),r=S(null),i=S(new Map);async function f(v){try{N.debug("api_error","Validando cita",v);const m=await $fetch("/api/appointments/validate-conflict",{method:"POST",body:v});return m.valid?(N.info("api_error","Validaci贸n exitosa"),{valid:!0}):(N.warn("conflict","Validaci贸n fallida",m),m)}catch(m){return N.error("api_error","Error validando cita",m),{valid:!1,error:m.data?.message||m.message||"Error al validar cita",errorCode:"VALIDATION_ERROR"}}}async function c(v){try{a.value=!0,l.value=null,N.clickCreate(v.fecha_cita,v.hora_inicio);const m=await f(v);if(!m.valid){const D=Mt(m);return l.value=D,{success:!1,error:D}}const _=await $fetch("/api/appointments/create",{method:"POST",body:v});if(!_.success)throw new Error(_.message||"Error al crear cita");const T=_.data;return t.value.push(T),N.create(T.id,v.fecha_cita,v.hora_inicio),r.value=new Date,{success:!0,data:T}}catch(m){const _=m.data?.message||m.message||"Error al crear la cita";return l.value=_,N.error("api_error",_,m),{success:!1,error:_}}finally{a.value=!1}}async function p(v){try{a.value=!0,l.value=null;const m=v.id,_=t.value.findIndex(q=>q.id===m);if(_===-1)throw new Error("Cita no encontrada");const T={...t.value[_]};i.value.set(m,T);const D={};if(v.fecha_cita&&(D.fecha_cita=v.fecha_cita),v.hora_inicio&&(D.hora_inicio=v.hora_inicio),v.hora_fin&&(D.hora_fin=v.hora_fin),v.estado&&(D.estado=v.estado),v.modalidad&&(D.modalidad=v.modalidad),t.value[_]={...t.value[_],...D},N.optimisticUpdate(m,"update"),v.fecha_cita||v.hora_inicio||v.hora_fin){const q={id:m,fecha_cita:v.fecha_cita||T.fecha_cita,hora_inicio:v.hora_inicio||T.hora_inicio,hora_fin:v.hora_fin||T.hora_fin,terapeuta_id:T.terapeuta_id,estado:v.estado||T.estado,previous_estado:T.estado},Q=await f(q);if(!Q.valid){t.value[_]=T,i.value.delete(m);const fe=Mt(Q);return l.value=fe,N.rollback(m,fe),{success:!1,error:fe}}}const V=await $fetch(`/api/appointments/${m}/update`,{method:"PATCH",body:v});if(!V.success)throw t.value[_]=T,i.value.delete(m),N.rollback(m,V.message||"Error desconocido"),new Error(V.message||"Error al actualizar cita");const U=V.data;return t.value[_]=U,i.value.delete(m),N.update(m,v),r.value=new Date,{success:!0,data:U}}catch(m){const _=m.data?.message||m.message||"Error al actualizar la cita";l.value=_,N.error("api_error",_,m);const T=v.id,D=i.value.get(T);if(D){const I=t.value.findIndex(V=>V.id===T);I!==-1&&(t.value[I]=D),i.value.delete(T),N.rollback(T,_)}return{success:!1,error:_}}finally{a.value=!1}}async function h(v,m,_,T){const D=t.value.find(U=>U.id===v);if(!D)return{success:!1,error:"Cita no encontrada"};let I=T;if(!I){const[U,q]=D.hora_inicio.split(":").map(Number),[Q,fe]=D.hora_fin.split(":").map(Number),ve=Q*60+fe-(U*60+q),[ke,H]=_.split(":").map(Number),F=ke*60+H+ve,K=Math.floor(F/60),G=F%60;I=`${String(K).padStart(2,"0")}:${String(G).padStart(2,"0")}`}N.dragStart(v,{date:D.fecha_cita,time:D.hora_inicio});const V=await p({id:v,fecha_cita:m,hora_inicio:_,hora_fin:I});return N.dragEnd(v,{date:m,time:_},V.success),V.success&&N.move(v,{date:D.fecha_cita,time:D.hora_inicio},{date:m,time:_}),V}async function b(v,m){const _=t.value.find(D=>D.id===v);if(!_)return{success:!1,error:"Cita no encontrada"};const T=An(_.estado,m);if(!T.valid){const D=T.error||"Transici贸n de estado inv谩lida";return l.value=D,{success:!1,error:D}}return N.statusChange(v,_.estado,m),await p({id:v,estado:m})}function O(v){return{id:v.cita_id,fecha_cita:v.fecha_cita,hora_inicio:v.hora_inicio,hora_fin:v.hora_fin,duracion_minutos:v.duracion_minutos||60,estado:v.estado,modalidad:v.modalidad,observaciones:v.observaciones,notas_terapeuta:v.notas_terapeuta,enlace_videollamada:v.enlace_videollamada,paciente_id:v.paciente_id,terapeuta_id:v.terapeuta_id,bono_id:v.bono_id,sesion_descontada:v.sesion_descontada||!1,consumo_registrado:v.consumo_registrado||!1,ubicacion:v.ubicacion,descontar_de_bono:v.descontar_de_bono,paciente:{id:v.paciente_id,nombre_completo:v.paciente_nombre||"Sin nombre",telefono:v.paciente_telefono,email:v.paciente_email},bono:v.bono_id?{id:v.bono_id,sesiones_restantes:v.bono_sesiones_restantes||0,sesiones_totales:v.bono_sesiones_totales||0,estado:v.bono_estado||"activo"}:void 0}}async function E(v,m){try{a.value=!0,l.value=null;const{data:_,error:T}=await e.from("vista_agenda_terapeutas").select("*").gte("fecha_cita",v).lte("fecha_cita",m).order("fecha_cita",{ascending:!0}).order("hora_inicio",{ascending:!0});if(T)throw T;t.value=(_||[]).map(O),N.loadRange(v,m,t.value.length),r.value=new Date}catch(_){const T=_.message||"Error al cargar citas";l.value=T,N.error("api_error",T,_)}finally{a.value=!1}}async function M(v){try{a.value=!0,l.value=null,N.info("delete",`Eliminando cita ${v}`);const m=t.value.findIndex(D=>D.id===v);if(m===-1)throw new Error("Cita no encontrada");const _=t.value[m];if(_.bono_id&&_.sesion_descontada){const{error:D}=await e.rpc("reintegrar_sesion_bono",{p_cita_id:v});D&&N.warn("delete",`No se pudo reintegrar sesi贸n del bono: ${D.message}`)}const{error:T}=await e.from("citas").delete().eq("id",v);if(T)throw T;return t.value.splice(m,1),N.info("delete",`Cita ${v} eliminada correctamente`),r.value=new Date,{success:!0}}catch(m){const _=m.message||"Error al eliminar la cita";return l.value=_,N.error("api_error",_,m),{success:!1,error:_}}finally{a.value=!1}}async function k(){if(t.value.length===0)return;const v=t.value.map(I=>I.fecha_cita),m=Math.min(...v.map(I=>new Date(I).getTime())),_=Math.max(...v.map(I=>new Date(I).getTime())),T=new Date(m).toISOString().split("T")[0],D=new Date(_).toISOString().split("T")[0];await E(T,D)}async function A(){try{a.value=!0,l.value=null;const{data:v,error:m}=await e.from("vista_agenda_terapeutas").select("*").order("fecha_cita",{ascending:!0}).order("hora_inicio",{ascending:!0});if(m)throw m;t.value=(v||[]).map(O),N.info("load_range",`Citas del terapeuta cargadas: ${t.value.length}`),r.value=new Date}catch(v){const m=v.message||"Error al cargar citas";l.value=m,N.error("api_error",m,v)}finally{a.value=!1}}async function L(){try{a.value=!0,l.value=null;const{data:v,error:m}=await e.from("vista_agenda_terapeutas").select("*").order("fecha_cita",{ascending:!0}).order("hora_inicio",{ascending:!0});if(m)throw m;t.value=(v||[]).map(O),N.info("load_range",`Todas las citas cargadas (coordinadora): ${t.value.length}`),r.value=new Date}catch(v){const m=v.message||"Error al cargar citas";l.value=m,N.error("api_error",m,v)}finally{a.value=!1}}const y=w(()=>l.value!==null),C=w(()=>a.value),J=w(()=>{if(!r.value)return null;const m=new Date().getTime()-r.value.getTime(),_=Math.floor(m/1e3);if(_<60)return`Actualizado hace ${_}s`;const T=Math.floor(_/60);return T<60?`Actualizado hace ${T}m`:`Actualizado hace ${Math.floor(T/60)}h`}),d=w(()=>{const v=new Date().toISOString().split("T")[0];return t.value.filter(m=>m.fecha_cita===v)}),R=w(()=>t.value.filter(v=>v.estado==="pendiente")),re=w(()=>t.value.filter(v=>v.estado==="completada"||v.estado==="realizada")),ce=w(()=>t.value.filter(v=>{if(!v.bono)return!1;const m=v.bono.sesiones_restantes||0;return m>0&&m<=2}));return{citas:t,loading:C,error:y,lastUpdateTime:J,citasDelDia:d,citasPendientes:R,citasCompletadas:re,citasConBonoProximoAgotar:ce,validateAppointment:f,createAppointment:c,updateAppointment:p,deleteAppointment:M,moveAppointment:h,changeAppointmentStatus:b,loadAppointmentsInRange:E,loadTerapeutaAppointments:A,loadAllAppointments:L,refreshAppointments:k,clearError:()=>{l.value=null}}}const Pn={class:"fixed inset-0 overflow-y-auto"},On={class:"flex min-h-full items-center justify-center p-4 text-center"},Ln={class:"space-y-3"},Fn={class:"relative"},jn={key:0,class:"space-y-2"},Nn={class:"relative"},Hn={class:"absolute right-3 top-1/2 -translate-y-1/2"},In={key:0,class:"animate-spin h-5 w-5 text-[#027368]",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},Bn={key:1,class:"h-5 w-5 text-neutral-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Rn={key:0,class:"absolute z-10 w-full mt-1 bg-white border-2 border-neutral-200 rounded-xl shadow-xl max-h-80 overflow-y-auto",role:"listbox","aria-label":"Resultados de b煤squeda de pacientes"},zn={key:0,class:"px-3 py-1.5 bg-neutral-50 border-b border-neutral-100"},Vn=["onClick"],Un={class:"flex items-center gap-3"},Wn={class:"w-9 h-9 rounded-full bg-gradient-to-br from-[#027368] to-[#025951] text-white flex items-center justify-center font-bold text-sm flex-shrink-0"},qn={class:"flex-1 min-w-0"},Kn={class:"flex items-center gap-2"},Gn={class:"font-semibold text-neutral-900 truncate"},Yn={key:0,class:"flex-shrink-0 w-2 h-2 rounded-full bg-emerald-500",title:"Cita reciente"},Jn={class:"flex items-center gap-2 text-xs text-neutral-500"},Zn={key:0},Qn={key:1,class:"text-neutral-400"},Xn={key:2,class:"text-neutral-400"},eo={key:0,class:"flex-shrink-0 px-2.5 py-1 bg-emerald-100 text-emerald-700 rounded-full text-xs font-bold"},to={key:1,class:"flex-shrink-0 px-2 py-1 bg-neutral-100 text-neutral-500 rounded-full text-xs"},ao={key:0,class:"text-xs text-neutral-500"},no={key:1,class:"px-4 py-6 text-center text-neutral-500"},oo={class:"font-medium text-sm"},lo={key:1,class:"space-y-3"},ro={class:"bg-gradient-to-r from-emerald-50 to-teal-50 border-2 border-emerald-200 rounded-xl overflow-hidden"},io={class:"w-3.5 h-3.5",fill:"currentColor",viewBox:"0 0 20 20"},so={key:0,"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm1-11a1 1 0 10-2 0v2H7a1 1 0 100 2h2v2a1 1 0 102 0v-2h2a1 1 0 100-2h-2V7z","clip-rule":"evenodd"},uo={key:1,"fill-rule":"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z","clip-rule":"evenodd"},co={class:"px-4 py-3"},fo={class:"flex items-center justify-between"},vo={class:"flex items-center gap-3"},po={class:"w-11 h-11 rounded-full bg-gradient-to-br from-emerald-500 to-teal-600 text-white flex items-center justify-center font-bold text-lg shadow-sm"},mo={class:"font-semibold text-neutral-900"},ho={class:"text-xs text-neutral-500"},bo={class:"flex items-center gap-2"},go=["href"],xo={class:"mt-3 grid grid-cols-3 gap-2 text-center"},_o={class:"bg-white/60 rounded-lg px-2 py-1.5"},yo={class:"text-sm font-semibold text-neutral-700"},wo={class:"bg-white/60 rounded-lg px-2 py-1.5"},ko={class:"text-sm font-semibold text-neutral-700"},Eo={class:"bg-white/60 rounded-lg px-2 py-1.5"},So={key:0,class:"px-4 py-3 bg-violet-50 border-2 border-violet-200 rounded-xl"},Co={class:"flex items-start justify-between"},To={class:"flex items-center gap-2"},Mo={class:"font-semibold text-violet-900"},$o={class:"text-sm text-violet-700"},Ao={class:"flex items-center gap-1"},Do=["title"],Po={key:0,class:"text-xs text-violet-500 ml-1"},Oo={class:"mt-3 p-2 bg-amber-50 border border-amber-200 rounded-lg"},Lo={class:"text-xs text-amber-800 flex items-start gap-2"},Fo={key:0,class:"mt-2 text-xs text-violet-600"},jo={key:1,class:"px-4 py-3 bg-amber-50 border-2 border-amber-200 rounded-xl"},No={key:2,class:"mt-2"},Ho=["value"],Io={key:1,class:"space-y-4 p-4 bg-blue-50 border-2 border-blue-200 rounded-xl"},Bo={class:"grid grid-cols-2 gap-3"},Ro={class:"col-span-2"},zo={class:"col-span-2"},Vo=["disabled"],Uo={key:0,class:"animate-spin h-5 w-5",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},Wo={class:"space-y-4 pt-2"},qo={class:"flex flex-wrap gap-2 mb-2",role:"group","aria-label":"Fechas r谩pidas"},Ko=["onClick","aria-pressed"],Go=["min"],Yo={key:0,class:"mt-1 text-xs text-neutral-500"},Jo={key:0,class:"px-3 py-2 bg-violet-50 border border-violet-200 rounded-lg flex items-center justify-between"},Zo={class:"flex items-center gap-2 text-violet-700 text-sm"},Qo={class:"grid grid-cols-2 gap-4"},Xo=["value"],el={class:"block text-sm font-semibold text-neutral-700 mb-2"},tl={class:"font-normal text-neutral-400"},al=["value"],nl={class:"flex items-center gap-2"},ol=["onClick"],ll={key:0,"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z","clip-rule":"evenodd"},rl={key:1,"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z","clip-rule":"evenodd"},il={key:2,"fill-rule":"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z","clip-rule":"evenodd"},sl={class:"space-y-4 pt-2"},ul={class:"flex items-center gap-2 pb-2 border-b border-neutral-100"},dl=["title"],cl={class:"grid grid-cols-3 gap-3"},fl=["onClick"],vl={key:0,class:"absolute top-2 right-2 w-5 h-5 bg-[#027368] rounded-full flex items-center justify-center"},pl={class:"text-2xl"},ml={class:"text-sm font-semibold"},hl={class:"text-[10px] text-neutral-400 group-hover:text-neutral-500"},bl={key:0,class:"space-y-2"},gl={class:"relative"},xl={key:1,class:"space-y-2"},_l={class:"relative"},yl={class:"absolute left-3 top-1/2 -translate-y-1/2"},wl={key:0,src:"https://www.gstatic.com/meet/google_meet_horizontal_wordmark_2020q4_1x_icon_124_40_2373e79660dabbf194273d27aa7ee1f5.png",alt:"Google Meet",class:"w-5 h-5 object-contain"},kl={key:1,src:"https://st1.zoom.us/zoom.ico",alt:"Zoom",class:"w-5 h-5 object-contain"},El={key:2,src:"https://cdn-icons-png.flaticon.com/512/906/906349.png",alt:"Teams",class:"w-5 h-5 object-contain"},Sl={key:3,class:"w-5 h-5 text-neutral-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true"},Cl=["aria-invalid"],Tl={key:0,class:"absolute right-3 top-1/2 -translate-y-1/2 px-2 py-0.5 bg-emerald-100 text-emerald-700 rounded text-xs font-medium"},Ml={key:0,class:"text-xs text-red-600",role:"alert"},$l={key:1,class:"text-xs text-neutral-400"},Al={key:2,class:"px-4 py-3 bg-blue-50 border border-blue-200 rounded-xl",role:"note"},Dl={class:"space-y-3 pt-2"},Pl={class:"flex items-center gap-2 pb-2 border-b border-neutral-100"},Ol={class:"flex flex-wrap gap-1.5",role:"group","aria-label":"Plantillas r谩pidas de observaci贸n"},Ll=["onClick","aria-pressed"],Fl={"aria-hidden":"true"},jl={class:"relative"},Nl=["rows"],Hl={class:"space-y-3 pt-6 border-t border-neutral-100"},Il={class:"flex flex-col sm:flex-row gap-3"},Bl=["disabled"],Rl=["disabled"],zl={key:0,class:"animate-spin h-5 w-5",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","aria-hidden":"true"},Vl={key:1,class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true"},$t="terapli-ultima-modalidad",At="terapli-modalidad-por-dia",at="terapli-borrador-cita",Dt="terapli-patrones-paciente",Ul=le({__name:"ModalNuevaCitaEnhanced",props:{isOpen:{type:Boolean},fechaInicial:{},horaInicial:{},horaFinal:{}},emits:["close","created"],setup(e,{emit:t}){const a=e,l=t,{pacientes:r,loading:i,hasPacientes:f,searchQuery:c,createPaciente:p,loadAllPacientes:h,clearSearch:b}=Ca(),{createAppointment:O,validateAppointment:E}=Dn(),M=S(!1),k=S(!1),A=S(!1),L=S(!1),y=S(null),C=S(null),J=S(null),d=S({paciente_id:"",fecha_cita:a.fechaInicial||"",hora_inicio:a.horaInicial||"",hora_fin:"",modalidad:"online",estado:"pendiente"}),R=S({nombre_completo:"",email:"",telefono:"",fecha_nacimiento:""}),re=[{value:"presencial",label:"Presencial",icon:"",descripcion:"En consultorio"},{value:"online",label:"Online",icon:"",descripcion:"Videollamada"},{value:"telefonica",label:"Tel茅fono",icon:"",descripcion:"Llamada de voz"}],ce=S(!1),v=S(null);function m(){if(!d.value.paciente_id&&!d.value.fecha_cita)return;const s={paciente_id:d.value.paciente_id,paciente_nombre:y.value?.nombre_completo,fecha_cita:d.value.fecha_cita,hora_inicio:d.value.hora_inicio,hora_fin:d.value.hora_fin,modalidad:d.value.modalidad,observaciones:d.value.observaciones,timestamp:Date.now()};localStorage.setItem(at,JSON.stringify(s))}function _(){const s=localStorage.getItem(at);if(!s)return null;try{const o=JSON.parse(s),u=3600*1e3;return Date.now()-o.timestamp>u?(T(),null):o}catch{return null}}function T(){localStorage.removeItem(at),ce.value=!1}function D(s){d.value.paciente_id=s.paciente_id,d.value.fecha_cita=s.fecha_cita,d.value.hora_inicio=s.hora_inicio,d.value.hora_fin=s.hora_fin,d.value.modalidad=s.modalidad,d.value.observaciones=s.observaciones||"",ce.value=!0,C.value={type:"success",text:"Borrador restaurado. Puedes continuar donde lo dejaste."},setTimeout(()=>{C.value?.type==="success"&&(C.value=null)},4e3)}function I(s,o){const u=new Date(s).getDay(),P=V();P[u]||(P[u]={}),P[u][o]=(P[u][o]||0)+1,localStorage.setItem(At,JSON.stringify(P))}function V(){try{const s=localStorage.getItem(At);return s?JSON.parse(s):{}}catch{return{}}}function U(s){if(!s)return null;const o=new Date(s).getDay(),u=V();if(!u[o])return null;let P=0,j=null;for(const[Y,be]of Object.entries(u[o]))be>P&&(P=be,j=Y);return P>=3?j:null}function q(s,o){if(!s||!o)return;const u=Q();u[s]||(u[s]={horasFrecuentes:{},preferenciaTurno:null}),u[s].horasFrecuentes[o]=(u[s].horasFrecuentes[o]||0)+1,parseInt(o.split(":")[0]);let P=0,j=0;for(const[Y,be]of Object.entries(u[s].horasFrecuentes))parseInt(Y.split(":")[0])<14?P+=be:j+=be;u[s].preferenciaTurno=P>j?"ma帽ana":j>P?"tarde":null,localStorage.setItem(Dt,JSON.stringify(u))}function Q(){try{const s=localStorage.getItem(Dt);return s?JSON.parse(s):{}}catch{return{}}}function fe(s){if(!s)return null;const u=Q()[s];if(!u)return null;let P=0,j=null;for(const[Y,be]of Object.entries(u.horasFrecuentes))be>P&&(P=be,j=Y);if(P>=2&&j){const Y=u.preferenciaTurno;return{hora:j,razon:Y?`Horario habitual (prefiere ${Y==="ma帽ana"?"ma帽anas":"tardes"})`:"Horario habitual del paciente"}}return null}const ve=w(()=>d.value.fecha_cita?U(d.value.fecha_cita):null),ke=w(()=>{if(!d.value.fecha_cita)return"";const s=["domingo","lunes","martes","mi茅rcoles","jueves","viernes","s谩bado"],o=new Date(d.value.fecha_cita).getDay();return s[o]}),H=[{emoji:"",label:"Primera sesi贸n",texto:"Primera sesi贸n de evaluaci贸n"},{emoji:"",label:"Seguimiento",texto:"Sesi贸n de seguimiento"},{emoji:"",label:"Objetivos",texto:"Revisi贸n de objetivos terap茅uticos"},{emoji:"锔",label:"Urgente",texto:"Sesi贸n de urgencia/crisis"},{emoji:"ㄢ┾",label:"Familiar",texto:"Sesi贸n familiar"},{emoji:"",label:"Evaluaci贸n",texto:"Aplicaci贸n de pruebas/evaluaci贸n"}],F=S(!1),K=[{minutos:30,label:"30 min"},{minutos:45,label:"45 min"},{minutos:60,label:"1 hora"},{minutos:90,label:"1:30 h"}],G=w(()=>new Date().toISOString().split("T")[0]),De=w(()=>{const s=new Date,o=new Date(s);o.setDate(s.getDate()+1);const u=new Date(s),P=(8-s.getDay())%7||7;u.setDate(s.getDate()+P);const j=new Date(s),Y=(10-s.getDay())%7||7;return j.setDate(s.getDate()+Y),[{label:"Hoy",fecha:s.toISOString().split("T")[0]},{label:"Ma帽ana",fecha:o.toISOString().split("T")[0]},{label:"Pr贸x. lunes",fecha:u.toISOString().split("T")[0]},{label:"Pr贸x. mi茅rcoles",fecha:j.toISOString().split("T")[0]}]}),_e=w(()=>{const s=[];for(let o=9;o<=20;o++)for(let u=0;u<60;u+=30){const P=`${o.toString().padStart(2,"0")}:${u.toString().padStart(2,"0")}`,j=`${o}:${u.toString().padStart(2,"0")}`;s.push({value:P,label:j})}return s}),Zt=w(()=>{if(!d.value.hora_inicio)return _e.value;const[s,o]=d.value.hora_inicio.split(":").map(Number),u=s*60+o;return _e.value.filter(P=>{const[j,Y]=P.value.split(":").map(Number);return j*60+Y>u})}),Qt=w(()=>{if(!d.value.hora_inicio||!d.value.hora_fin)return"";const s=ht();if(s<=0)return"";if(s<60)return`${s} min`;const o=Math.floor(s/60),u=s%60;return u>0?`${o}h ${u}m`:`${o}h`});function ht(){if(!d.value.hora_inicio||!d.value.hora_fin)return 0;const[s,o]=d.value.hora_inicio.split(":").map(Number),[u,P]=d.value.hora_fin.split(":").map(Number);return u*60+P-(s*60+o)}const Ee=w(()=>{const s=d.value.enlace_videollamada?.toLowerCase()||"";return s?s.includes("meet.google.com")||s.includes("meet.google")?"meet":s.includes("zoom.us")||s.includes("zoom.com")?"zoom":s.includes("teams.microsoft.com")||s.includes("teams.live.com")?"teams":null:null}),Xt=w(()=>{const s={meet:"Google Meet",zoom:"Zoom",teams:"Microsoft Teams"};return Ee.value?s[Ee.value]:""}),Pe=w(()=>{const s=d.value.enlace_videollamada?.trim()||"";if(!s)return null;try{new URL(s)}catch{return!1}return Ee.value!==null});function bt(s){d.value.modalidad=s,localStorage.setItem($t,s),s!=="online"&&(d.value.enlace_videollamada=""),s!=="presencial"&&(d.value.ubicacion="")}function Be(){{const s=localStorage.getItem($t);if(s&&["presencial","online","telefonica"].includes(s))return s}return"online"}function ea(s){const o=d.value.observaciones||"";o.includes(s)?d.value.observaciones=o.replace(s,"").replace(/\s*[,.]\s*[,.]/g,",").replace(/^[,.\s]+|[,.\s]+$/g,"").trim():o.trim().length>0?d.value.observaciones=`${o.trim()}. ${s}`:d.value.observaciones=s,d.value.observaciones&&d.value.observaciones.length>0&&(F.value=!0)}function ta(s){d.value.fecha_cita=s.fecha,Oe()}function aa(){if(d.value.hora_inicio){const[s,o]=d.value.hora_inicio.split(":").map(Number),u=s+1;u<=21&&(d.value.hora_fin=`${u.toString().padStart(2,"0")}:${o.toString().padStart(2,"0")}`)}Oe()}function na(s){if(!d.value.hora_inicio)return;const[o,u]=d.value.hora_inicio.split(":").map(Number),P=o*60+u+s,j=Math.floor(P/60),Y=P%60;j<=21&&(d.value.hora_fin=`${j.toString().padStart(2,"0")}:${Y.toString().padStart(2,"0")}`,Oe())}function oa(s){return s?new Date(s+"T00:00:00").toLocaleDateString("es-ES",{weekday:"long",day:"numeric",month:"long",year:"numeric"}):""}const Re=w(()=>d.value.paciente_id&&d.value.fecha_cita&&d.value.hora_inicio&&d.value.hora_fin&&d.value.modalidad&&!L.value);function Je(){la(),l("close")}function la(){d.value={paciente_id:"",fecha_cita:a.fechaInicial||"",hora_inicio:a.horaInicial||"",hora_fin:"",modalidad:Be(),estado:"pendiente"},y.value=null,b(),M.value=!1,k.value=!1,C.value=null,F.value=!1}function gt(s){y.value=s,d.value.paciente_id=s.id,c.value=s.nombre_completo,M.value=!1,s.bono_activo?(d.value.bono_id=s.bono_activo.id,d.value.descontar_de_bono=!0):(d.value.bono_id=void 0,d.value.descontar_de_bono=!1),N.debug("patient_select",`Paciente seleccionado: ${s.nombre_completo}`,{tiene_bono:!!s.bono_activo,bono_id:s.bono_activo?.id})}function ra(s){return s?new Date(s).toLocaleDateString("es-ES",{day:"numeric",month:"long",year:"numeric"}):""}function xt(s){if(!s)return"";const o=new Date(s),P=new Date().getTime()-o.getTime(),j=Math.floor(P/(1e3*60*60*24));return j===0?"hoy":j===1?"ayer":j<7?`hace ${j} d铆as`:j<14?"hace 1 sem.":j<30?`hace ${Math.floor(j/7)} sem.`:j<60?"hace 1 mes":`hace ${Math.floor(j/30)} meses`}function ia(){y.value=null,d.value.paciente_id="",d.value.bono_id=void 0,d.value.descontar_de_bono=!1,c.value=""}function sa(){setTimeout(()=>{M.value=!1},200)}function ua(){k.value=!0,M.value=!1,c.value.trim().length>0&&!c.value.includes("@")&&(R.value.nombre_completo=c.value.trim())}function da(){k.value=!1,R.value={nombre_completo:"",email:"",telefono:"",fecha_nacimiento:""}}async function ca(){A.value=!0;try{const s=await p(R.value);s.success&&s.data?(gt(s.data),k.value=!1,R.value={nombre_completo:"",email:"",telefono:"",fecha_nacimiento:""},C.value={type:"success",text:`Paciente "${s.data.nombre_completo}" creado exitosamente`},setTimeout(()=>{C.value=null},3e3)):C.value={type:"error",text:s.error||"Error al crear paciente"}}catch(s){C.value={type:"error",text:s.message||"Error inesperado al crear paciente"}}finally{A.value=!1}}async function Oe(){if(J.value&&clearTimeout(J.value),!d.value.fecha_cita||!d.value.hora_inicio||!d.value.hora_fin){C.value=null;return}J.value=setTimeout(async()=>{try{const s=await E({paciente_id:d.value.paciente_id||"temp",fecha_cita:d.value.fecha_cita,hora_inicio:d.value.hora_inicio,hora_fin:d.value.hora_fin});s.valid?C.value={type:"success",text:"Horario disponible "}:C.value={type:"error",text:s.error||"Conflicto detectado"}}catch(s){N.error("validation","Error en validaci贸n en tiempo real",s)}},500)}async function Ze(s=!1){if(Re.value){L.value=!0,C.value=null;try{N.clickCreate(d.value.fecha_cita,d.value.hora_inicio);const o=await O(d.value);o.success&&o.data?(N.create(o.data.id,d.value.fecha_cita,d.value.hora_inicio),I(d.value.fecha_cita,d.value.modalidad),d.value.paciente_id&&d.value.hora_inicio&&q(d.value.paciente_id,d.value.hora_inicio),T(),l("created",o.data),s?(va(),C.value={type:"success",text:`Cita creada para ${y.value?.nombre_completo||"paciente"}. Puedes crear otra.`},setTimeout(()=>{C.value=null},4e3)):Je()):C.value={type:"error",text:o.error||"Error al crear la cita"}}catch(o){C.value={type:"error",text:o.message||"Error inesperado"},N.error("api_error","Error en handleSubmit",o)}finally{L.value=!1}}}async function fa(){await Ze(!0)}function va(){const s=y.value,o=d.value.bono_id;d.value={paciente_id:s?.id||"",fecha_cita:"",hora_inicio:"",hora_fin:"",modalidad:Be(),estado:"pendiente",bono_id:o,descontar_de_bono:!!o},F.value=!1}function _t(s){(s.ctrlKey||s.metaKey)&&s.key==="Enter"&&(s.preventDefault(),Re.value&&!L.value&&Ze())}return se(()=>d.value.hora_inicio,s=>{if(s){const[o,u]=s.split(":").map(Number),P=o*60+u+60,j=Math.floor(P/60),Y=P%60;d.value.hora_fin=`${String(j).padStart(2,"0")}:${String(Y).padStart(2,"0")}`}}),se(()=>a.isOpen,s=>{if(s){h();const o=a.fechaInicial||a.horaInicial;if(a.fechaInicial&&(d.value.fecha_cita=a.fechaInicial),a.horaInicial&&(d.value.hora_inicio=a.horaInicial),a.horaFinal&&(d.value.hora_fin=a.horaFinal),!o){const u=_();u&&D(u)}}}),se(()=>[d.value.paciente_id,d.value.fecha_cita,d.value.hora_inicio,d.value.modalidad,d.value.observaciones],()=>{m()},{deep:!0}),se(()=>d.value.paciente_id,s=>{s?v.value=fe(s):v.value=null}),se(()=>d.value.fecha_cita,s=>{s&&!ce.value&&U(s)&&(d.value.modalidad,Be())}),ee(()=>{if(d.value.modalidad=Be(),a.isOpen&&(h(),!a.fechaInicial&&!a.horaInicial)){const s=_();s&&D(s)}window.addEventListener("keydown",_t)}),de(()=>{window.removeEventListener("keydown",_t),J.value&&clearTimeout(J.value)}),(s,o)=>(g(),ka(W(Jt),{appear:"",show:e.isOpen,as:"template"},{default:$e(()=>[Le(W(gn),{as:"div",class:"relative z-50",onClose:Je},{default:$e(()=>[Le(W(dt),{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0","enter-to":"opacity-100",leave:"duration-200 ease-in","leave-from":"opacity-100","leave-to":"opacity-0"},{default:$e(()=>[...o[18]||(o[18]=[n("div",{class:"fixed inset-0 bg-black/30 backdrop-blur-sm"},null,-1)])]),_:1}),n("div",Pn,[n("div",On,[Le(W(dt),{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0 scale-95","enter-to":"opacity-100 scale-100",leave:"duration-200 ease-in","leave-from":"opacity-100 scale-100","leave-to":"opacity-0 scale-95"},{default:$e(()=>[Le(W(xn),{class:"w-full max-w-2xl transform overflow-hidden rounded-3xl bg-white p-6 sm:p-8 text-left align-middle shadow-2xl transition-all max-h-[90vh] overflow-y-auto",role:"dialog","aria-modal":"true","aria-labelledby":"modal-title"},{default:$e(()=>[Le(W(_n),{as:"h3",id:"modal-title",class:"text-xl sm:text-2xl font-bold text-neutral-900 mb-4 sm:mb-6 flex items-center gap-3"},{default:$e(()=>[...o[19]||(o[19]=[n("div",{class:"w-9 h-9 sm:w-10 sm:h-10 rounded-xl bg-gradient-to-br from-[#027368] to-[#025951] flex items-center justify-center text-white flex-shrink-0"},[n("svg",{class:"w-4 h-4 sm:w-5 sm:h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true"},[n("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})])],-1),X(" Nueva Cita ",-1)])]),_:1}),n("form",{onSubmit:Ea(Ze,["prevent"]),class:"space-y-6"},[n("section",Ln,[o[45]||(o[45]=n("div",{class:"flex items-center gap-2 pb-2 border-b border-neutral-100"},[n("div",{class:"w-6 h-6 rounded-lg bg-emerald-100 flex items-center justify-center"},[n("svg",{class:"w-3.5 h-3.5 text-emerald-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[n("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})])]),n("h4",{class:"text-sm font-semibold text-neutral-700"},"Paciente"),n("span",{class:"text-xs text-red-500"},"*")],-1)),n("div",Fn,[k.value?(g(),x("div",Io,[n("div",{class:"flex items-center justify-between mb-3"},[o[43]||(o[43]=n("h4",{class:"font-semibold text-neutral-900 flex items-center gap-2"},[n("svg",{class:"w-5 h-5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[n("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M18 9v3m0 0v3m0-3h3m-3 0h-3m-2-5a4 4 0 11-8 0 4 4 0 018 0zM3 20a6 6 0 0112 0v1H3v-1z"})]),X(" Crear Nuevo Paciente ")],-1)),n("button",{type:"button",onClick:da,class:"text-sm text-neutral-600 hover:text-neutral-900"}," Cancelar ")]),n("div",Bo,[n("div",Ro,[ne(n("input",{"onUpdate:modelValue":o[3]||(o[3]=u=>R.value.nombre_completo=u),type:"text",placeholder:"Nombre completo *",class:"w-full px-3 py-2 border-2 border-neutral-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"},null,512),[[ge,R.value.nombre_completo]])]),n("div",zo,[ne(n("input",{"onUpdate:modelValue":o[4]||(o[4]=u=>R.value.email=u),type:"email",placeholder:"Email *",class:"w-full px-3 py-2 border-2 border-neutral-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"},null,512),[[ge,R.value.email]])]),n("div",null,[ne(n("input",{"onUpdate:modelValue":o[5]||(o[5]=u=>R.value.telefono=u),type:"tel",placeholder:"Tel茅fono",class:"w-full px-3 py-2 border-2 border-neutral-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"},null,512),[[ge,R.value.telefono]])]),n("div",null,[ne(n("input",{"onUpdate:modelValue":o[6]||(o[6]=u=>R.value.fecha_nacimiento=u),type:"date",placeholder:"Fecha de nacimiento",class:"w-full px-3 py-2 border-2 border-neutral-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"},null,512),[[ge,R.value.fecha_nacimiento]])])]),n("button",{type:"button",onClick:ca,disabled:!R.value.nombre_completo||!R.value.email||A.value,class:"w-full px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed font-medium flex items-center justify-center gap-2"},[A.value?(g(),x("svg",Uo,[...o[44]||(o[44]=[n("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),n("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)])])):B("",!0),X(" "+$(A.value?"Creando...":"Crear Paciente"),1)],8,Vo)])):(g(),x("div",jn,[n("div",Nn,[o[22]||(o[22]=n("label",{for:"patient-search",class:"sr-only"},"Buscar paciente",-1)),ne(n("input",{id:"patient-search","onUpdate:modelValue":o[0]||(o[0]=u=>Sa(c)?c.value=u:null),type:"text",placeholder:"Buscar por nombre, email o tel茅fono...",autocomplete:"off","aria-describedby":"patient-search-hint","aria-expanded":"showDropdown","aria-haspopup":"listbox",class:"w-full px-4 py-3 pr-10 border-2 border-neutral-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-[#027368] focus:border-transparent transition-all",onFocus:o[1]||(o[1]=u=>M.value=!0),onBlur:sa},null,544),[[ge,W(c)]]),o[23]||(o[23]=n("span",{id:"patient-search-hint",class:"sr-only"},"Escribe para buscar pacientes existentes o crear uno nuevo",-1)),n("div",Hn,[W(i)?(g(),x("svg",In,[...o[20]||(o[20]=[n("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),n("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)])])):(g(),x("svg",Bn,[...o[21]||(o[21]=[n("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"},null,-1)])]))])]),M.value&&(W(f)||W(c).trim().length>0)?(g(),x("div",Rn,[W(f)?(g(),x("div",zn,[...o[24]||(o[24]=[n("span",{class:"text-[10px] text-neutral-400 uppercase tracking-wider"},"Pacientes frecuentes",-1)])])):B("",!0),(g(!0),x(ie,null,xe(W(r),u=>(g(),x("button",{key:u.id,type:"button",class:"w-full px-3 py-2.5 text-left hover:bg-[#027368]/5 transition-colors border-b border-neutral-100 last:border-0 group",onClick:P=>gt(u)},[n("div",Un,[n("div",Wn,$(u.nombre_completo.charAt(0).toUpperCase()),1),n("div",qn,[n("div",Kn,[n("p",Gn,$(u.nombre_completo),1),u.prioridad_score>=100?(g(),x("span",Yn)):B("",!0)]),n("div",Jn,[u.total_citas>0?(g(),x("span",Zn,$(u.total_citas)+" citas",1)):B("",!0),u.ultima_cita?(g(),x("span",Qn,"路")):B("",!0),u.ultima_cita?(g(),x("span",Xn," ltima: "+$(xt(u.ultima_cita)),1)):B("",!0)])]),u.sesiones_restantes_total>0?(g(),x("div",eo,[X($(u.sesiones_restantes_total)+" ",1),o[25]||(o[25]=n("span",{class:"font-medium"},"ses.",-1))])):(g(),x("div",to," Sin bono "))])],8,Vn))),128)),n("button",{type:"button",class:"w-full px-3 py-3 text-left bg-gradient-to-r from-[#027368]/5 to-transparent hover:from-[#027368]/10 transition-colors border-t-2 border-[#027368]/20 font-medium text-[#027368] flex items-center gap-2",onClick:ua},[o[27]||(o[27]=n("div",{class:"w-9 h-9 rounded-full bg-[#027368]/10 flex items-center justify-center"},[n("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[n("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})])],-1)),n("div",null,[o[26]||(o[26]=n("p",{class:"font-semibold"},"Crear nuevo paciente",-1)),W(c).trim().length>0?(g(),x("p",ao,' "'+$(W(c).trim())+'" ',1)):B("",!0)])]),!W(f)&&!W(i)&&W(c).trim().length>0?(g(),x("div",no,[o[28]||(o[28]=n("svg",{class:"w-10 h-10 mx-auto mb-2 text-neutral-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[n("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})],-1)),n("p",oo,'No se encontr贸 "'+$(W(c))+'"',1),o[29]||(o[29]=n("p",{class:"text-xs mt-1"},"Prueba con otro nombre o crea un nuevo paciente",-1))])):B("",!0)])):B("",!0),d.value.paciente_id&&y.value?(g(),x("div",lo,[n("div",ro,[y.value.total_citas===0||!y.value.bono_activo?(g(),x("div",{key:0,class:te(["px-3 py-1.5 text-xs font-medium flex items-center gap-2",y.value.total_citas===0?"bg-blue-100 text-blue-700":"bg-amber-100 text-amber-700"])},[(g(),x("svg",io,[y.value.total_citas===0?(g(),x("path",so)):(g(),x("path",uo))])),X(" "+$(y.value.total_citas===0?"Paciente nuevo - Primera cita":"Sin bono activo"),1)],2)):B("",!0),n("div",co,[n("div",fo,[n("div",vo,[n("div",po,$(y.value.nombre_completo.charAt(0).toUpperCase()),1),n("div",null,[n("p",mo,$(y.value.nombre_completo),1),n("p",ho,$(y.value.email),1)])]),n("div",bo,[n("a",{href:`/terapeuta/pacientes/${y.value.id}`,target:"_blank",class:"p-2 text-neutral-400 hover:text-[#027368] hover:bg-white rounded-lg transition-colors",title:"Ver perfil completo"},[...o[30]||(o[30]=[n("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[n("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})],-1)])],8,go),n("button",{type:"button",onClick:ia,class:"p-2 hover:bg-white rounded-lg transition-colors text-neutral-400 hover:text-red-500",title:"Cambiar paciente"},[...o[31]||(o[31]=[n("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[n("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])])]),n("div",xo,[n("div",_o,[o[32]||(o[32]=n("p",{class:"text-xs text-neutral-500"},"ltima cita",-1)),n("p",yo,$(y.value.ultima_cita?xt(y.value.ultima_cita):"Nunca"),1)]),n("div",wo,[o[33]||(o[33]=n("p",{class:"text-xs text-neutral-500"},"Total citas",-1)),n("p",ko,$(y.value.total_citas||0),1)]),n("div",Eo,[o[34]||(o[34]=n("p",{class:"text-xs text-neutral-500"},"Sesiones",-1)),n("p",{class:te(["text-sm font-semibold",y.value.sesiones_restantes_total>0?"text-emerald-600":"text-neutral-400"])},$(y.value.sesiones_restantes_total||0)+" disp. ",3)])])])]),y.value.bono_activo?(g(),x("div",So,[n("div",Co,[n("div",To,[o[35]||(o[35]=n("div",{class:"w-8 h-8 rounded-lg bg-violet-600 text-white flex items-center justify-center"},[n("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[n("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 5v2m0 4v2m0 4v2M5 5a2 2 0 00-2 2v3a2 2 0 110 4v3a2 2 0 002 2h14a2 2 0 002-2v-3a2 2 0 110-4V7a2 2 0 00-2-2H5z"})])],-1)),n("div",null,[n("p",Mo,$(y.value.bono_activo.tipo),1),n("p",$o,$(y.value.bono_activo.sesiones_restantes)+" de "+$(y.value.bono_activo.sesiones_totales)+" sesiones disponibles ",1)])]),n("div",Ao,[(g(!0),x(ie,null,xe(Math.min(y.value.bono_activo.sesiones_totales,10),u=>(g(),x("div",{key:u,class:te(["w-3 h-3 rounded-full",u<=y.value.bono_activo.sesiones_usadas?"bg-violet-600":"bg-violet-200"]),title:u<=y.value.bono_activo.sesiones_usadas?"Sesi贸n usada":"Sesi贸n disponible"},null,10,Do))),128)),y.value.bono_activo.sesiones_totales>10?(g(),x("span",Po," +"+$(y.value.bono_activo.sesiones_totales-10),1)):B("",!0)])]),n("div",Oo,[n("p",Lo,[o[40]||(o[40]=n("svg",{class:"w-4 h-4 flex-shrink-0 mt-0.5",fill:"currentColor",viewBox:"0 0 20 20"},[n("path",{"fill-rule":"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z","clip-rule":"evenodd"})],-1)),n("span",null,[o[36]||(o[36]=X(" Esta ser谩 la sesi贸n ",-1)),n("strong",null,$(y.value.bono_activo.sesiones_usadas+1)+"/"+$(y.value.bono_activo.sesiones_totales),1),o[37]||(o[37]=X(" del bono. Se descontar谩 autom谩ticamente cuando la cita sea ",-1)),o[38]||(o[38]=n("strong",null,"confirmada",-1)),o[39]||(o[39]=X(". ",-1))])])]),y.value.bono_activo.fecha_fin?(g(),x("p",Fo," Vence: "+$(ra(y.value.bono_activo.fecha_fin)),1)):B("",!0)])):(g(),x("div",jo,[...o[41]||(o[41]=[n("div",{class:"flex items-start gap-3"},[n("div",{class:"w-8 h-8 rounded-lg bg-amber-200 text-amber-700 flex items-center justify-center flex-shrink-0"},[n("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[n("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})])]),n("div",null,[n("p",{class:"font-medium text-amber-800 text-sm"},"Sin bono activo"),n("p",{class:"text-xs text-amber-600 mt-0.5"},"Esta sesi贸n se facturar谩 de forma individual.")])],-1)])])),y.value.bonos&&y.value.bonos.length>1?(g(),x("div",No,[o[42]||(o[42]=n("label",{class:"block text-sm font-medium text-neutral-700 mb-1"}," Seleccionar bono a usar ",-1)),ne(n("select",{"onUpdate:modelValue":o[2]||(o[2]=u=>d.value.bono_id=u),class:"w-full px-3 py-2 border-2 border-neutral-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-violet-500 focus:border-transparent text-sm"},[(g(!0),x(ie,null,xe(y.value.bonos,u=>(g(),x("option",{key:u.id,value:u.id},$(u.tipo)+" - "+$(u.sesiones_restantes)+"/"+$(u.sesiones_totales)+" sesiones ",9,Ho))),128))],512),[[Qe,d.value.bono_id]])])):B("",!0)])):B("",!0)]))])]),n("section",Wo,[o[53]||(o[53]=n("div",{class:"flex items-center gap-2 pb-2 border-b border-neutral-100"},[n("div",{class:"w-6 h-6 rounded-lg bg-blue-100 flex items-center justify-center"},[n("svg",{class:"w-3.5 h-3.5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[n("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})])]),n("h4",{class:"text-sm font-semibold text-neutral-700"},"Fecha y Hora"),n("span",{class:"text-xs text-red-500"},"*")],-1)),n("div",null,[o[46]||(o[46]=n("label",{for:"fecha-cita",class:"sr-only"},"Fecha de la cita",-1)),n("div",qo,[(g(!0),x(ie,null,xe(De.value,u=>(g(),x("button",{key:u.label,type:"button",onClick:P=>ta(u),class:te(["px-3 py-1.5 text-xs font-medium rounded-lg transition-all focus:outline-none focus:ring-2 focus:ring-[#027368] focus:ring-offset-1",d.value.fecha_cita===u.fecha?"bg-[#027368] text-white":"bg-neutral-100 text-neutral-600 hover:bg-neutral-200"]),"aria-pressed":d.value.fecha_cita===u.fecha},$(u.label),11,Ko))),128))]),ne(n("input",{id:"fecha-cita","onUpdate:modelValue":o[7]||(o[7]=u=>d.value.fecha_cita=u),type:"date",required:"",min:G.value,"aria-required":"true",class:"w-full px-4 py-3 border-2 border-neutral-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-[#027368] focus:border-transparent transition-all",onChange:Oe},null,40,Go),[[ge,d.value.fecha_cita]]),d.value.fecha_cita?(g(),x("p",Yo,$(oa(d.value.fecha_cita)),1)):B("",!0)]),v.value&&!d.value.hora_inicio?(g(),x("div",Jo,[n("div",Zo,[o[47]||(o[47]=n("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true"},[n("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})],-1)),n("span",null,$(v.value.razon),1)]),n("button",{type:"button",onClick:o[8]||(o[8]=u=>d.value.hora_inicio=v.value.hora),class:"px-2 py-1 bg-violet-600 text-white text-xs font-medium rounded hover:bg-violet-700 transition-colors"}," Usar "+$(v.value.hora),1)])):B("",!0),n("div",Qo,[n("div",null,[o[49]||(o[49]=n("label",{class:"block text-sm font-semibold text-neutral-700 mb-2"}," Hora inicio * ",-1)),ne(n("select",{"onUpdate:modelValue":o[9]||(o[9]=u=>d.value.hora_inicio=u),required:"",class:"w-full px-4 py-3 border-2 border-neutral-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-[#027368] focus:border-transparent transition-all bg-white appearance-none cursor-pointer",onChange:aa},[o[48]||(o[48]=n("option",{value:"",disabled:""},"Seleccionar hora",-1)),(g(!0),x(ie,null,xe(_e.value,u=>(g(),x("option",{key:u.value,value:u.value},$(u.label),9,Xo))),128))],544),[[Qe,d.value.hora_inicio]])]),n("div",null,[n("label",el,[o[50]||(o[50]=X(" Hora fin * ",-1)),n("span",tl,"("+$(Qt.value)+")",1)]),ne(n("select",{"onUpdate:modelValue":o[10]||(o[10]=u=>d.value.hora_fin=u),required:"",class:"w-full px-4 py-3 border-2 border-neutral-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-[#027368] focus:border-transparent transition-all bg-white appearance-none cursor-pointer",onChange:Oe},[o[51]||(o[51]=n("option",{value:"",disabled:""},"Seleccionar hora",-1)),(g(!0),x(ie,null,xe(Zt.value,u=>(g(),x("option",{key:u.value,value:u.value},$(u.label),9,al))),128))],544),[[Qe,d.value.hora_fin]])])]),n("div",nl,[o[52]||(o[52]=n("span",{class:"text-xs text-neutral-500"},"Duraci贸n r谩pida:",-1)),(g(),x(ie,null,xe(K,u=>n("button",{key:u.minutos,type:"button",onClick:P=>na(u.minutos),class:te(["px-2 py-1 text-xs rounded-md transition-all",ht()===u.minutos?"bg-[#027368]/10 text-[#027368] font-medium":"bg-neutral-100 text-neutral-500 hover:bg-neutral-200"])},$(u.label),11,ol)),64))]),C.value?(g(),x("div",{key:1,class:te(["px-4 py-3 rounded-xl flex items-start gap-3",{"bg-red-50 border-2 border-red-200":C.value.type==="error","bg-yellow-50 border-2 border-yellow-200":C.value.type==="warning","bg-emerald-50 border-2 border-emerald-200":C.value.type==="success"}])},[(g(),x("svg",{class:te(["w-5 h-5 mt-0.5 flex-shrink-0",{"text-red-600":C.value.type==="error","text-yellow-600":C.value.type==="warning","text-emerald-600":C.value.type==="success"}]),fill:"currentColor",viewBox:"0 0 20 20"},[C.value.type==="error"?(g(),x("path",ll)):C.value.type==="success"?(g(),x("path",rl)):(g(),x("path",il))],2)),n("p",{class:te(["text-sm font-medium flex-1",{"text-red-800":C.value.type==="error","text-yellow-800":C.value.type==="warning","text-emerald-800":C.value.type==="success"}])},$(C.value.text),3)],2)):B("",!0)]),n("section",sl,[n("div",ul,[o[55]||(o[55]=n("div",{class:"w-6 h-6 rounded-lg bg-violet-100 flex items-center justify-center"},[n("svg",{class:"w-3.5 h-3.5 text-violet-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[n("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"})])],-1)),o[56]||(o[56]=n("h4",{class:"text-sm font-semibold text-neutral-700"},"Modalidad",-1)),o[57]||(o[57]=n("span",{class:"text-xs text-red-500"},"*",-1)),ve.value&&d.value.modalidad!==ve.value?(g(),x("span",{key:0,class:"ml-auto text-[10px] px-2 py-0.5 bg-amber-100 text-amber-700 rounded-full flex items-center gap-1 cursor-pointer hover:bg-amber-200 transition-colors",onClick:o[11]||(o[11]=u=>bt(ve.value)),title:`Normalmente usas ${ve.value} los ${ke.value}`},[o[54]||(o[54]=n("svg",{class:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true"},[n("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})],-1)),X(" "+$(re.find(u=>u.value===ve.value)?.label)+" los "+$(ke.value),1)],8,dl)):B("",!0)]),n("div",cl,[(g(),x(ie,null,xe(re,u=>n("button",{key:u.value,type:"button",onClick:P=>bt(u.value),class:te(["relative px-4 py-4 rounded-xl border-2 transition-all font-medium flex flex-col items-center gap-2 group",d.value.modalidad===u.value?"border-[#027368] bg-gradient-to-br from-[#027368]/10 to-[#027368]/5 text-[#027368] shadow-md":"border-neutral-200 text-neutral-600 hover:border-neutral-300 hover:bg-neutral-50"])},[d.value.modalidad===u.value?(g(),x("div",vl,[...o[58]||(o[58]=[n("svg",{class:"w-3 h-3 text-white",fill:"currentColor",viewBox:"0 0 20 20"},[n("path",{"fill-rule":"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z","clip-rule":"evenodd"})],-1)])])):B("",!0),n("span",pl,$(u.icon),1),n("span",ml,$(u.label),1),n("span",hl,$(u.descripcion),1)],10,fl)),64))]),d.value.modalidad==="presencial"?(g(),x("div",bl,[o[60]||(o[60]=n("label",{id:"ubicacion-label",class:"block text-sm font-semibold text-neutral-700"},[X(" Sala / Consultorio "),n("span",{class:"font-normal text-neutral-400"},"(opcional)")],-1)),n("div",gl,[o[59]||(o[59]=n("div",{class:"absolute left-3 top-1/2 -translate-y-1/2 text-neutral-400"},[n("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true"},[n("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})])],-1)),ne(n("input",{"onUpdate:modelValue":o[12]||(o[12]=u=>d.value.ubicacion=u),type:"text","aria-labelledby":"ubicacion-label",placeholder:"Ej: Consultorio 3, Sala de terapia...",class:"w-full pl-10 pr-4 py-3 border-2 border-neutral-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-[#027368] focus:border-transparent transition-all"},null,512),[[ge,d.value.ubicacion]])])])):B("",!0),d.value.modalidad==="online"?(g(),x("div",xl,[o[62]||(o[62]=n("label",{id:"enlace-label",class:"block text-sm font-semibold text-neutral-700"},[X(" Enlace de videollamada "),n("span",{class:"font-normal text-neutral-400"},"(opcional)")],-1)),n("div",_l,[n("div",yl,[Ee.value==="meet"?(g(),x("img",wl)):Ee.value==="zoom"?(g(),x("img",kl)):Ee.value==="teams"?(g(),x("img",El)):(g(),x("svg",Sl,[...o[61]||(o[61]=[n("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"},null,-1)])]))]),ne(n("input",{"onUpdate:modelValue":o[13]||(o[13]=u=>d.value.enlace_videollamada=u),type:"url","aria-labelledby":"enlace-label","aria-invalid":Pe.value===!1,placeholder:"Pega el enlace de Meet, Zoom o Teams...",class:te(["w-full pl-10 pr-4 py-3 border-2 rounded-xl focus:outline-none focus:ring-2 focus:ring-[#027368] focus:border-transparent transition-all",Pe.value===!1?"border-red-300 bg-red-50":Pe.value===!0?"border-emerald-300 bg-emerald-50":"border-neutral-200"])},null,10,Cl),[[ge,d.value.enlace_videollamada]]),Ee.value&&Pe.value?(g(),x("div",Tl,$(Xt.value),1)):B("",!0)]),d.value.enlace_videollamada&&Pe.value===!1?(g(),x("p",Ml," Enlace no reconocido. Usa Google Meet, Zoom o Microsoft Teams. ")):d.value.enlace_videollamada?B("",!0):(g(),x("p",$l," Compatible con Google Meet, Zoom y Microsoft Teams "))])):B("",!0),d.value.modalidad==="telefonica"?(g(),x("div",Al,[...o[63]||(o[63]=[n("div",{class:"flex items-start gap-2 text-blue-700"},[n("svg",{class:"w-5 h-5 mt-0.5 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true"},[n("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})]),n("div",{class:"text-sm"},[n("p",{class:"font-medium"},"Sesi贸n por tel茅fono"),n("p",{class:"text-blue-600 text-xs mt-0.5"},"Se utilizar谩 el n煤mero de contacto del paciente para la llamada.")])],-1)])])):B("",!0)]),n("section",Dl,[n("div",Pl,[o[64]||(o[64]=n("div",{class:"w-6 h-6 rounded-lg bg-amber-100 flex items-center justify-center"},[n("svg",{class:"w-3.5 h-3.5 text-amber-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[n("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})])],-1)),o[65]||(o[65]=n("h4",{class:"text-sm font-semibold text-neutral-700"},"Observaciones",-1)),o[66]||(o[66]=n("span",{class:"text-xs text-neutral-400"},"(opcional)",-1)),d.value.observaciones?(g(),x("span",{key:0,class:te(["ml-auto text-xs",(d.value.observaciones?.length||0)>450?"text-amber-600":"text-neutral-400"])},$(d.value.observaciones?.length||0)+"/500 ",3)):B("",!0)]),n("div",Ol,[(g(),x(ie,null,xe(H,u=>n("button",{key:u.texto,type:"button",onClick:P=>ea(u.texto),class:te(["px-2.5 py-1 text-xs rounded-lg transition-all flex items-center gap-1 focus:outline-none focus:ring-2 focus:ring-[#027368] focus:ring-offset-1",d.value.observaciones?.includes(u.texto)?"bg-[#027368]/10 text-[#027368] font-medium":"bg-neutral-100 text-neutral-600 hover:bg-neutral-200"]),"aria-pressed":d.value.observaciones?.includes(u.texto)},[n("span",Fl,$(u.emoji),1),n("span",null,$(u.label),1)],10,Ll)),64))]),n("div",jl,[ne(n("textarea",{id:"observaciones-textarea","onUpdate:modelValue":o[14]||(o[14]=u=>d.value.observaciones=u),rows:F.value?5:2,maxlength:"500","aria-label":"Observaciones","aria-describedby":"observaciones-hint",placeholder:"Ej: Primera sesi贸n de evaluaci贸n, seguimiento ansiedad, revisi贸n de objetivos terap茅uticos...",class:"w-full px-4 py-3 border-2 border-neutral-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-[#027368] focus:border-transparent transition-all resize-none",onFocus:o[15]||(o[15]=u=>F.value=!0),onBlur:o[16]||(o[16]=u=>F.value=d.value.observaciones?.length>0)},null,40,Nl),[[ge,d.value.observaciones]]),o[68]||(o[68]=n("span",{id:"observaciones-hint",class:"sr-only"},"M谩ximo 500 caracteres. Usa las plantillas r谩pidas para a帽adir texto predefinido.",-1)),!F.value&&!d.value.observaciones?(g(),x("button",{key:0,type:"button",onClick:o[17]||(o[17]=u=>F.value=!0),class:"absolute bottom-2 right-2 text-xs text-neutral-400 hover:text-neutral-600 flex items-center gap-1 focus:outline-none focus:text-[#027368]","aria-label":"Expandir campo de observaciones"},[...o[67]||(o[67]=[n("svg",{class:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true"},[n("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"})],-1),X(" Expandir ",-1)])])):B("",!0)])]),n("div",Hl,[n("div",Il,[n("button",{type:"button",onClick:Je,class:"order-3 sm:order-1 px-6 py-3 bg-neutral-100 text-neutral-700 rounded-xl hover:bg-neutral-200 transition-all font-semibold focus:outline-none focus:ring-2 focus:ring-neutral-400 focus:ring-offset-2"}," Cancelar "),n("button",{type:"button",onClick:fa,disabled:L.value||!Re.value,class:"order-2 flex-1 px-4 py-3 border-2 border-[#027368] text-[#027368] rounded-xl hover:bg-[#027368]/5 transition-all font-semibold disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2 focus:outline-none focus:ring-2 focus:ring-[#027368] focus:ring-offset-2"},[...o[69]||(o[69]=[n("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true"},[n("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),n("span",{class:"hidden sm:inline"},"Crear y agendar otra",-1),n("span",{class:"sm:hidden"},"+ Otra",-1)])],8,Bl),n("button",{type:"submit",disabled:L.value||!Re.value,class:"order-1 sm:order-3 flex-1 px-6 py-3 bg-gradient-to-r from-[#027368] to-[#025951] text-white rounded-xl hover:shadow-lg hover:shadow-[#027368]/25 transition-all font-semibold disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2 focus:outline-none focus:ring-2 focus:ring-[#027368] focus:ring-offset-2"},[L.value?(g(),x("svg",zl,[...o[70]||(o[70]=[n("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),n("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)])])):(g(),x("svg",Vl,[...o[71]||(o[71]=[n("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"},null,-1)])])),X(" "+$(L.value?"Creando...":"Crear Cita"),1)],8,Rl)]),o[72]||(o[72]=n("div",{class:"hidden md:flex items-center justify-end gap-4 text-xs text-neutral-400"},[n("span",{class:"flex items-center gap-1"},[n("kbd",{class:"px-1.5 py-0.5 bg-neutral-100 rounded text-neutral-500 font-mono"},"Esc"),n("span",null,"Cancelar")]),n("span",{class:"flex items-center gap-1"},[n("kbd",{class:"px-1.5 py-0.5 bg-neutral-100 rounded text-neutral-500 font-mono"},"Ctrl"),n("span",null,"+"),n("kbd",{class:"px-1.5 py-0.5 bg-neutral-100 rounded text-neutral-500 font-mono"},"Enter"),n("span",null,"Crear")])],-1))])],32)]),_:1})]),_:1})])])]),_:1})]),_:1},8,["show"]))}}),Jl=Object.assign(Ta(Ul,[["__scopeId","data-v-97295d59"]]),{__name:"ModalNuevaCitaEnhanced"});export{Jl as _,Dn as u};
