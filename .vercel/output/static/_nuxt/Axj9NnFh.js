import{e as U,m as L,M as j,f as q,r as i,s as y,g as H,c as d,b as c,H as I,w as Y,h as w,k as r,a as t,i as G,J,_ as Q,Q as K,o as l,j as h,l as D,A as O,v as _,F as W,x as X,t as a,z as Z}from"#entry";const ee={class:"mb-8 flex items-center justify-between"},te={class:"bg-white rounded-xl shadow-md border border-[#E8DFD8] p-6 mb-6"},oe={class:"grid grid-cols-1 md:grid-cols-4 gap-4"},se={class:"bg-white rounded-xl shadow-md border border-[#E8DFD8] overflow-hidden"},ne={class:"overflow-x-auto"},ae={class:"w-full"},re={class:"divide-y divide-[#E8DFD8]"},le={class:"px-6 py-4 whitespace-nowrap text-sm text-[#5D4A44]"},ie={class:"px-6 py-4 whitespace-nowrap"},de={class:"flex items-center space-x-3"},ce={class:"w-8 h-8 rounded-full bg-gradient-to-br from-[#D8AFA0] to-[#C49484] flex items-center justify-center flex-shrink-0"},ue={class:"text-white text-xs font-semibold"},pe={class:"text-sm font-medium text-[#5D4A44]"},me={class:"px-6 py-4 whitespace-nowrap text-sm text-[#8B7470]"},xe={class:"px-6 py-4 whitespace-nowrap text-sm font-semibold text-[#5D4A44]"},fe={class:"px-6 py-4 whitespace-nowrap"},be={class:"px-6 py-4 whitespace-nowrap text-sm text-[#8B7470]"},ge={class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium space-x-2"},ve=["onClick"],we=["onClick"],he=["onClick"],De={key:0,class:"text-center py-12"},ye={class:"mt-6 grid grid-cols-1 md:grid-cols-3 gap-6"},_e={class:"bg-gradient-to-br from-blue-50 to-blue-100 rounded-xl p-6 border border-blue-200"},Fe={class:"text-3xl font-bold font-lora text-blue-900"},Ae={class:"bg-gradient-to-br from-green-50 to-green-100 rounded-xl p-6 border border-green-200"},ke={class:"text-3xl font-bold font-lora text-green-900"},Ce={class:"bg-gradient-to-br from-purple-50 to-purple-100 rounded-xl p-6 border border-purple-200"},Ee={class:"text-3xl font-bold font-lora text-purple-900"},Be=U({__name:"pagos",setup(Me){const C=L(),E=j();q();const u=i([]),p=i(""),m=i(""),x=i(""),f=i(""),v=i(!1),F=i(!0),A=y(()=>{let o=[...u.value];if(p.value&&(o=o.filter(e=>e.estado===p.value)),m.value){const e=m.value.toLowerCase();o=o.filter(n=>n.paciente_nombre.toLowerCase().includes(e))}return x.value&&(o=o.filter(e=>new Date(e.created_at)>=new Date(x.value))),f.value&&(o=o.filter(e=>new Date(e.created_at)<=new Date(f.value))),o}),M=y(()=>{const o=new Date().toDateString();return u.value.filter(e=>new Date(e.created_at).toDateString()===o&&e.estado==="confirmado_admin").reduce((e,n)=>e+parseFloat(n.monto),0)}),S=y(()=>{const o=new Date,e=o.getMonth(),n=o.getFullYear();return u.value.filter(g=>{const s=new Date(g.created_at);return s.getMonth()===e&&s.getFullYear()===n}).reduce((g,s)=>g+parseFloat(s.monto),0)}),B=o=>new Date(o).toLocaleDateString("es-ES",{day:"2-digit",month:"short",year:"numeric"}),P=o=>o.split(" ").map(e=>e[0]).join("").toUpperCase().substring(0,2),b=o=>o.toLocaleString("es-ES",{style:"currency",currency:"EUR",minimumFractionDigits:2,maximumFractionDigits:2}),N=o=>({pendiente:"bg-yellow-100 text-yellow-700",confirmado_paciente:"bg-blue-100 text-blue-700",confirmado_admin:"bg-green-100 text-green-700",rechazado:"bg-red-100 text-red-700"})[o]||"bg-gray-100 text-gray-700",V=o=>({pendiente:"Pendiente",confirmado_paciente:"Confirmado",confirmado_admin:"Verificado",rechazado:"Rechazado"})[o]||o,$=o=>u.value.filter(e=>e.estado===o).reduce((e,n)=>e+parseFloat(n.monto),0),z=async o=>{alert("Esta funcionalidad requiere configurar notificaciones a administración")},R=o=>{alert(`Detalles del pago:

Paciente: ${o.paciente_nombre}
Monto: ${b(parseFloat(o.monto))}
Estado: ${o.estado}

(Modal de detalles en desarrollo)`)},T=async()=>{if(E.value){F.value=!0;try{const{data:o,error:e}=await C.from("pagos").select(`
        *,
        paciente:paciente_id(nombre),
        terapeuta:terapeuta_id(nombre)
      `).order("created_at",{ascending:!1});if(e)throw e;o&&(u.value=o.map(n=>({...n,paciente_nombre:n.paciente?.nombre||"Sin paciente",terapeuta_nombre:n.terapeuta?.nombre||"Sin terapeuta"})))}catch(o){console.error("Error al cargar pagos:",o)}finally{F.value=!1}}};return H(()=>{T()}),(o,e)=>{const n=K("Icon"),g=Q;return l(),d("div",null,[c(g,{name:"coordinacion"},{default:Y(()=>[t("div",ee,[e[9]||(e[9]=t("div",null,[t("h1",{class:"text-3xl font-lora font-bold text-[#5D4A44] mb-2"}," Gestión de Pagos "),t("p",{class:"text-[#8B7470]"}," Registro y confirmación de pagos de sesiones ")],-1)),t("button",{onClick:e[0]||(e[0]=s=>v.value=!0),class:"px-6 py-3 bg-gradient-to-r from-[#D8AFA0] to-[#C49484] text-white rounded-lg hover:shadow-lg transition-all flex items-center space-x-2"},[c(n,{name:"heroicons:plus",class:"w-5 h-5"}),e[8]||(e[8]=t("span",null,"Registrar pago",-1))])]),t("div",te,[t("div",oe,[t("div",null,[e[11]||(e[11]=t("label",{class:"block text-sm font-medium text-[#5D4A44] mb-2"},"Estado",-1)),h(t("select",{"onUpdate:modelValue":e[1]||(e[1]=s=>D(p)?p.value=s:null),class:"w-full px-4 py-2 border border-[#E8DFD8] rounded-lg focus:ring-2 focus:ring-[#D8AFA0] focus:border-transparent"},[...e[10]||(e[10]=[t("option",{value:""},"Todos",-1),t("option",{value:"pendiente"},"Pendiente",-1),t("option",{value:"confirmado_paciente"},"Confirmado por paciente",-1),t("option",{value:"confirmado_admin"},"Confirmado",-1),t("option",{value:"rechazado"},"Rechazado",-1)])],512),[[O,r(p)]])]),t("div",null,[e[12]||(e[12]=t("label",{class:"block text-sm font-medium text-[#5D4A44] mb-2"},"Búsqueda",-1)),h(t("input",{"onUpdate:modelValue":e[2]||(e[2]=s=>D(m)?m.value=s:null),type:"text",placeholder:"Nombre del paciente...",class:"w-full px-4 py-2 border border-[#E8DFD8] rounded-lg focus:ring-2 focus:ring-[#D8AFA0] focus:border-transparent"},null,512),[[_,r(m)]])]),t("div",null,[e[13]||(e[13]=t("label",{class:"block text-sm font-medium text-[#5D4A44] mb-2"},"Fecha desde",-1)),h(t("input",{"onUpdate:modelValue":e[3]||(e[3]=s=>D(x)?x.value=s:null),type:"date",class:"w-full px-4 py-2 border border-[#E8DFD8] rounded-lg focus:ring-2 focus:ring-[#D8AFA0] focus:border-transparent"},null,512),[[_,r(x)]])]),t("div",null,[e[14]||(e[14]=t("label",{class:"block text-sm font-medium text-[#5D4A44] mb-2"},"Fecha hasta",-1)),h(t("input",{"onUpdate:modelValue":e[4]||(e[4]=s=>D(f)?f.value=s:null),type:"date",class:"w-full px-4 py-2 border border-[#E8DFD8] rounded-lg focus:ring-2 focus:ring-[#D8AFA0] focus:border-transparent"},null,512),[[_,r(f)]])])])]),t("div",se,[t("div",ne,[t("table",ae,[e[15]||(e[15]=t("thead",{class:"bg-[#F9F7F3] border-b border-[#E8DFD8]"},[t("tr",null,[t("th",{class:"px-6 py-4 text-left text-xs font-medium text-[#5D4A44] uppercase tracking-wider"}," Fecha "),t("th",{class:"px-6 py-4 text-left text-xs font-medium text-[#5D4A44] uppercase tracking-wider"}," Paciente "),t("th",{class:"px-6 py-4 text-left text-xs font-medium text-[#5D4A44] uppercase tracking-wider"}," Terapeuta "),t("th",{class:"px-6 py-4 text-left text-xs font-medium text-[#5D4A44] uppercase tracking-wider"}," Monto "),t("th",{class:"px-6 py-4 text-left text-xs font-medium text-[#5D4A44] uppercase tracking-wider"}," Estado "),t("th",{class:"px-6 py-4 text-left text-xs font-medium text-[#5D4A44] uppercase tracking-wider"}," Método "),t("th",{class:"px-6 py-4 text-right text-xs font-medium text-[#5D4A44] uppercase tracking-wider"}," Acciones ")])],-1)),t("tbody",re,[(l(!0),d(W,null,X(r(A),s=>(l(),d("tr",{key:s.id,class:"hover:bg-[#F9F7F3] transition-colors"},[t("td",le,a(B(s.created_at)),1),t("td",ie,[t("div",de,[t("div",ce,[t("span",ue,a(P(s.paciente_nombre)),1)]),t("div",null,[t("p",pe,a(s.paciente_nombre),1)])])]),t("td",me,a(s.terapeuta_nombre),1),t("td",xe,a(b(parseFloat(s.monto))),1),t("td",fe,[t("span",{class:Z(["px-3 py-1 rounded-full text-xs font-medium",N(s.estado)])},a(V(s.estado)),3)]),t("td",be,a(s.metodo_pago||"No especificado"),1),t("td",ge,[s.estado==="pendiente"?(l(),d("button",{key:0,onClick:k=>o.confirmarPagoPaciente(s),class:"px-3 py-1 bg-blue-50 text-blue-600 rounded-lg hover:bg-blue-100 transition-colors",title:"Confirmar pago de paciente"},[c(n,{name:"heroicons:check-circle",class:"w-4 h-4 inline"})],8,ve)):w("",!0),s.estado==="confirmado_paciente"?(l(),d("button",{key:1,onClick:k=>z(s),class:"px-3 py-1 bg-green-50 text-green-600 rounded-lg hover:bg-green-100 transition-colors",title:"Enviar a administración"},[c(n,{name:"heroicons:arrow-right-circle",class:"w-4 h-4 inline"})],8,we)):w("",!0),t("button",{onClick:k=>R(s),class:"px-3 py-1 bg-[#F9F7F3] text-[#5D4A44] rounded-lg hover:bg-[#E8DFD8] transition-colors",title:"Ver detalles"},[c(n,{name:"heroicons:eye",class:"w-4 h-4 inline"})],8,he)])]))),128))])])]),r(A).length===0?(l(),d("div",De,[c(n,{name:"heroicons:credit-card",class:"w-16 h-16 text-[#D8AFA0] mx-auto mb-4 opacity-30"}),e[16]||(e[16]=t("p",{class:"text-[#8B7470] mb-4"},"No se encontraron pagos",-1))])):w("",!0)]),t("div",ye,[t("div",_e,[e[17]||(e[17]=t("p",{class:"text-sm text-blue-700 mb-1"},"Total pendiente",-1)),t("p",Fe,a(b($("pendiente"))),1)]),t("div",Ae,[e[18]||(e[18]=t("p",{class:"text-sm text-green-700 mb-1"},"Confirmados hoy",-1)),t("p",ke,a(b(r(M))),1)]),t("div",Ce,[e[19]||(e[19]=t("p",{class:"text-sm text-purple-700 mb-1"},"Total del mes",-1)),t("p",Ee,a(b(r(S))),1)])])]),_:1}),(l(),I(J,{to:"body"},[r(v)?(l(),d("div",{key:0,class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",onClick:e[7]||(e[7]=s=>v.value=!1)},[t("div",{class:"bg-white rounded-xl max-w-md w-full p-6",onClick:e[6]||(e[6]=G(()=>{},["stop"]))},[e[20]||(e[20]=t("h3",{class:"text-xl font-lora font-semibold text-[#5D4A44] mb-4"}," Registrar nuevo pago ",-1)),e[21]||(e[21]=t("p",{class:"text-sm text-[#8B7470]"},"Funcionalidad en desarrollo...",-1)),t("button",{onClick:e[5]||(e[5]=s=>v.value=!1),class:"mt-4 w-full px-4 py-2 bg-[#D8AFA0] text-white rounded-lg hover:bg-[#C49484] transition-colors"}," Cerrar ")])])):w("",!0)]))])}}});export{Be as default};
