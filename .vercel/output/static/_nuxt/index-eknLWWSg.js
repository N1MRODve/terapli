import{e as oe,p as ae,L as ne,r as f,x as E,g as le,c as r,a as e,b as p,l as m,t as a,i as L,A as w,w as $,T as A,k as y,v as re,B as I,d as M,F as Y,y as O,o as i,aj as H,h as ie}from"#entry";import{M as de}from"./ModalDetallesCita-CZ6Vzvt2.js";import{r as G}from"./ClockIcon-CQZt9cKZ.js";import{r as k}from"./CheckCircleIcon-Bi0YyG7H.js";import{r as ce}from"./MagnifyingGlassIcon-B5My0XuL.js";import{r as pe}from"./ExclamationTriangleIcon-BreoAuwB.js";import{r as ue}from"./CalendarDaysIcon-C0vq0F4x.js";import{r as me}from"./EyeIcon-BKE9UY2T.js";import"./CalendarIcon-mZ3toP8Y.js";import"./XMarkIcon-DWNj0d99.js";import"./UserIcon-G1mM6o1b.js";import"./TicketIcon-DRclOuRO.js";import"./XCircleIcon-BaRJRhc1.js";import"./ExclamationCircleIcon-Dyh9f5zH.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const fe={class:"min-h-screen bg-base-bg"},xe={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8"},_e={class:"bg-white rounded-xl shadow-sm border border-gray-100 p-6"},be={class:"flex items-center justify-between mb-4"},ge={class:"w-12 h-12 bg-yellow-100 rounded-lg flex items-center justify-center"},ve={class:"text-3xl font-bold text-cafe mb-2"},he={class:"pt-3 border-t border-gray-100"},we={class:"text-xl font-semibold text-yellow-600"},ye={class:"bg-white rounded-xl shadow-sm border border-gray-100 p-6"},ke={class:"flex items-center justify-between mb-4"},Ce={class:"w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center"},je={class:"text-3xl font-bold text-cafe mb-2"},Se={class:"pt-3 border-t border-gray-100"},De={class:"text-xl font-semibold text-green-600"},Ee={class:"bg-white rounded-xl shadow-sm border border-gray-100 p-6"},Me={class:"flex items-center justify-between mb-4"},Te={class:"w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center"},Pe={class:"text-3xl font-bold text-cafe mb-2"},Ne={class:"pt-3 border-t border-gray-100"},Be={class:"text-xl font-semibold text-blue-600"},qe={class:"bg-white rounded-xl shadow-sm border border-gray-100 p-6"},Fe={class:"text-3xl font-bold text-cafe mb-2"},ze={class:"pt-3 border-t border-gray-100"},Ue={class:"text-xl font-semibold text-red-600"},Ve={class:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden mb-6"},Le={class:"bg-gradient-to-r from-green-50 to-emerald-50 border-b border-green-100 px-6 py-5"},$e={class:"flex items-center justify-between"},Ae={class:"flex items-center gap-4"},Ie={class:"w-12 h-12 rounded-xl bg-green-600 flex items-center justify-center"},Ye={class:"flex items-center gap-6"},Oe={class:"text-right"},He={class:"text-3xl font-bold text-green-700"},Ge={class:"text-xs text-cafe/60 mt-0.5"},Re={key:0,class:"text-center py-12 px-6"},Je={key:1,class:"divide-y divide-gray-100"},Ke=["onClick"],Qe={class:"flex-shrink-0 w-10 h-10 rounded-full bg-gradient-to-br from-green-600 to-emerald-600 flex items-center justify-center text-white font-bold text-sm shadow-sm"},We={class:"flex-1 min-w-0 grid grid-cols-5 gap-4 items-center"},Xe={class:"col-span-2"},Ze={class:"font-semibold text-cafe truncate"},et={class:"text-xs text-cafe/50 truncate"},tt={class:"text-center"},st={class:"text-sm font-semibold text-cafe"},ot={class:"text-right"},at={class:"text-lg font-bold text-green-700"},nt={class:"text-right"},lt={class:"text-sm font-medium text-cafe flex items-center justify-end gap-1.5"},rt={class:"text-xs text-cafe/50 capitalize flex items-center justify-end gap-1.5 mt-0.5"},it={class:"flex-shrink-0 ml-2"},dt={class:"bg-gradient-to-b from-green-50/50 to-transparent"},ct={class:"px-6 pb-6 pt-2 ml-16"},pt={class:"bg-white rounded-xl border border-green-100 p-5 shadow-sm"},ut={class:"grid grid-cols-3 gap-6"},mt={class:"space-y-3"},ft={class:"space-y-2"},xt={class:"flex justify-between text-sm"},_t={class:"font-medium text-cafe"},bt={class:"flex justify-between text-sm"},gt=["title"],vt={class:"space-y-3"},ht={class:"space-y-2"},wt={class:"flex justify-between text-sm"},yt={class:"font-medium text-cafe"},kt={class:"flex justify-between text-sm"},Ct={class:"font-medium text-cafe"},jt={class:"flex justify-between text-sm"},St={class:"font-medium text-cafe"},Dt={class:"flex justify-between text-sm"},Et={class:"font-semibold text-green-700"},Mt={class:"space-y-3"},Tt={class:"space-y-2"},Pt={class:"flex justify-between text-sm"},Nt={class:"font-bold text-cafe"},Bt={class:"flex justify-between text-sm bg-green-50 px-2 py-1.5 rounded-lg"},qt={class:"font-bold text-green-700"},Ft={class:"flex justify-between text-sm"},zt={class:"font-medium text-cafe/80"},Ut={class:"pt-2 border-t border-green-100 mt-3"},Vt={class:"flex justify-between text-xs text-cafe/50 mb-1"},Lt={class:"font-medium capitalize"},$t={class:"flex justify-between text-xs text-cafe/50"},At={class:"font-medium"},It={class:"bg-white rounded-xl shadow-sm border border-gray-100 p-6 mb-6"},Yt={class:"grid grid-cols-1 md:grid-cols-4 gap-4"},Ot={class:"md:col-span-2"},Ht={class:"relative"},Gt={key:0,class:"flex items-center justify-center py-12"},Rt={key:1,class:"bg-red-50 border border-red-200 rounded-xl p-6"},Jt={class:"flex items-start gap-3"},Kt={class:"text-sm text-red-600"},Qt={key:2,class:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden"},Wt={class:"bg-gray-50 border-b border-gray-100 px-6 py-4"},Xt={class:"font-semibold text-cafe"},Zt={class:"text-sm font-normal text-cafe/60 ml-2"},es={key:0,class:"p-12 text-center"},ts={class:"w-16 h-16 bg-cafe-claro/20 rounded-full flex items-center justify-center mx-auto mb-4"},ss={class:"text-cafe/60 mb-6"},os={key:1,class:"overflow-x-auto"},as={class:"w-full"},ns={class:"bg-white divide-y divide-gray-100"},ls={class:"px-6 py-4 whitespace-nowrap"},rs={class:"text-sm font-medium text-cafe"},is={class:"text-xs text-cafe/50"},ds={class:"px-6 py-4 whitespace-nowrap"},cs={class:"text-sm text-cafe"},ps={class:"text-xs text-cafe/50"},us={class:"px-6 py-4"},ms={class:"flex items-center gap-3"},fs={class:"w-10 h-10 rounded-full bg-purple-600/20 text-purple-600 flex items-center justify-center font-semibold text-sm flex-shrink-0"},xs={class:"text-sm font-medium text-cafe"},_s={key:0,class:"text-xs text-cafe/50"},bs={class:"px-6 py-4 whitespace-nowrap"},gs={class:"px-6 py-4 whitespace-nowrap"},vs={class:"px-6 py-4 whitespace-nowrap"},hs={key:0,class:"text-xs space-y-1"},ws={class:"flex items-center gap-1 text-green-600"},ys={class:"text-cafe/50"},ks={key:0,class:"flex items-center gap-1 text-green-700 bg-green-50 px-2 py-0.5 rounded-full"},Cs={key:1,class:"flex items-center gap-1 text-orange-600 bg-orange-50 px-2 py-0.5 rounded-full animate-pulse"},js={key:1,class:"text-xs text-cafe/50"},Ss={class:"px-6 py-4 whitespace-nowrap text-right"},Ds={class:"text-sm font-semibold text-cafe"},Es={class:"text-xs text-cafe/50"},Ms={class:"px-6 py-4 whitespace-nowrap text-center"},Ts=["onClick"],T=50,Rs=oe({__name:"index",setup(Ps){const b=ae(),_=ne(),P=f(!0),C=f(null),N=f([]),j=f([]),d=f({busqueda:"",estado:"",periodo:"todos"}),B=f(!1),q=f(null),S=f(!0),g=f(null),D=E(()=>{let o=[...N.value];if(d.value.busqueda){const s=d.value.busqueda.toLowerCase();o=o.filter(l=>l.paciente?.nombre_completo?.toLowerCase().includes(s))}d.value.estado&&(o=o.filter(s=>s.estado===d.value.estado));const t=new Date;if(d.value.periodo==="mes-actual"){const s=new Date(t.getFullYear(),t.getMonth(),1),l=new Date(t.getFullYear(),t.getMonth()+1,0);o=o.filter(c=>{const n=new Date(c.fecha_cita);return n>=s&&n<=l})}else if(d.value.periodo==="mes-anterior"){const s=new Date(t.getFullYear(),t.getMonth()-1,1),l=new Date(t.getFullYear(),t.getMonth(),0);o=o.filter(c=>{const n=new Date(c.fecha_cita);return n>=s&&n<=l})}else if(d.value.periodo==="trimestre"){const s=new Date(t);s.setMonth(t.getMonth()-3),o=o.filter(l=>new Date(l.fecha_cita)>=s)}return o.sort((s,l)=>{const c=new Date(s.fecha_cita+"T"+s.hora_inicio);return new Date(l.fecha_cita+"T"+l.hora_inicio).getTime()-c.getTime()}),o}),x=E(()=>{const o={pendientes:0,confirmadas:0,completadas:0,canceladas:0,montoPendiente:0,montoConfirmado:0,montoCompletado:0,montoCancelado:0};return D.value.forEach(t=>{const s=t.monto_terapeuta||(t.precio_estimado||T)*.7;switch(t.estado){case"pendiente":o.pendientes++,t.esta_pagado||t.bono?.pagado?o.montoConfirmado+=s:o.montoPendiente+=s;break;case"confirmada":o.confirmadas++,t.esta_pagado||t.bono?.pagado?o.montoConfirmado+=s:o.montoPendiente+=s;break;case"realizada":case"completada":o.completadas++,t.esta_pagado||t.bono?.pagado?o.montoConfirmado+=s:o.montoCompletado+=s;break;case"cancelada":o.canceladas++,o.montoCancelado+=s;break}}),o}),v=E(()=>j.value.map(o=>{const t=(o.sesiones_totales||0)-(o.sesiones_restantes||0),s=o.sesiones_totales>0?o.monto_total/o.sesiones_totales:0,l=o.monto_total*.7;return{bono_id:o.id,paciente_id:o.paciente_id,paciente_nombre:o.paciente_nombre,paciente_email:o.paciente_email,bono_sesiones_totales:o.sesiones_totales,bono_sesiones_restantes:o.sesiones_restantes,bono_monto_total:o.monto_total,bono_fecha_pago:o.fecha_pago,bono_metodo_pago:o.metodo_pago,tipo_bono:o.tipo_bono||"Est√°ndar",sesiones_usadas:t,precio_por_sesion:s,monto_total_terapeuta:l}}).sort((o,t)=>{const s=new Date(o.bono_fecha_pago||0);return new Date(t.bono_fecha_pago||0).getTime()-s.getTime()})),R=E(()=>v.value.reduce((o,t)=>o+(t.monto_total_terapeuta||0),0)),F=async()=>{try{P.value=!0,C.value=null;let o=0;for(;!_.value&&o<50;)await new Promise(n=>setTimeout(n,100)),o++;if(!_.value)throw new Error("Usuario no autenticado");console.log("üë§ Usuario verificado:",_.value.id);const{data:t,error:s}=await b.from("terapeutas").select("id").eq("email",_.value.email).single();if(s)throw console.error("Error al buscar terapeuta:",s),s;if(!t)throw new Error("No se encontr√≥ el terapeuta asociado a este usuario");console.log("Terapeuta encontrado:",t);const{data:l,error:c}=await b.from("vista_sesiones_psicologa").select("*").eq("terapeuta_id",t.id).order("fecha",{ascending:!1});if(c)throw console.error("Error al cargar sesiones:",c),c;console.log("Sesiones cargadas:",l?.length||0,l),N.value=(l||[]).map(n=>(console.log("Sesi√≥n individual:",{id:n.id,bono_id:n.bono_id,bono_pagado:n.bono_pagado,esta_pagado:n.esta_pagado,categoria_financiera:n.categoria_financiera,precio_sesion:n.precio_sesion,monto_terapeuta:n.monto_terapeuta,paciente:n.paciente_nombre}),{...n,precio_estimado:n.precio_sesion||T,paciente:{id:n.paciente_id,nombre_completo:n.paciente_nombre,email:n.paciente_email,telefono:n.paciente_telefono},bono:n.bono_id?{id:n.bono_id,sesiones_totales:n.bono_sesiones_totales,sesiones_restantes:n.bono_sesiones_restantes,monto_total:n.bono_monto_total,pagado:n.bono_pagado,fecha_pago:n.bono_fecha_pago,metodo_pago:n.bono_metodo_pago}:null})),console.log("Sesiones procesadas:",N.value.length)}catch(o){console.error("Error al cargar sesiones:",o),C.value=o.message||"Error desconocido al cargar las sesiones"}finally{P.value=!1}},J=async()=>{try{if(!_.value){console.log("Usuario no disponible a√∫n para cargar bonos");return}console.log("Cargando bonos pagados...");const{data:o,error:t}=await b.from("terapeutas").select("id").eq("email",_.value.email).single();if(t||!o){console.error("Error al buscar terapeuta:",t);return}console.log("Terapeuta encontrado:",o.id);const{data:s,error:l}=await b.from("pacientes").select("id").eq("terapeuta_id",o.id);if(l||!s||s.length===0){console.log("No hay pacientes asignados a este terapeuta"),j.value=[];return}const c=s.map(h=>h.id);console.log("üìã Pacientes encontrados:",c.length);const{data:n,error:V}=await b.from("bonos").select(`
        id,
        paciente_id,
        sesiones_totales,
        sesiones_restantes,
        monto_total,
        tipo_bono,
        fecha_pago,
        metodo_pago,
        pagado,
        paciente:pacientes!bonos_paciente_id_fkey (
          nombre_completo,
          email
        )
      `).eq("pagado",!0).in("paciente_id",c).order("fecha_pago",{ascending:!1});if(V){console.error("Error al cargar bonos pagados:",V);return}console.log("Bonos pagados encontrados:",n?.length||0),j.value=(n||[]).map(h=>({...h,paciente_nombre:h.paciente?.nombre_completo,paciente_email:h.paciente?.email})),console.log("Bonos pagados cargados:",j.value.length)}catch(o){console.error("Error al cargar bonos pagados:",o)}},K=o=>{q.value=o.id,B.value=!0},Q=()=>{B.value=!1,q.value=null},W=o=>{g.value===o?g.value=null:g.value=o},u=o=>o.toFixed(2),z=o=>{if(!o)return"-";const t=new Date(o);return isNaN(t.getTime())?"-":t.toLocaleDateString("es-ES",{day:"2-digit",month:"2-digit",year:"numeric"})},X=o=>new Date(o+"T00:00:00").toLocaleDateString("es-ES",{weekday:"long"}),Z=o=>o?o.substring(0,5):"-",U=o=>o.split(" ").map(t=>t[0]).join("").toUpperCase().substring(0,2),ee=o=>({pendiente:"bg-yellow-50 text-yellow-700",confirmada:"bg-green-50 text-green-700",realizada:"bg-blue-50 text-blue-700",completada:"bg-blue-50 text-blue-700",cancelada:"bg-red-50 text-red-700"})[o]||"bg-gray-50 text-gray-700",te=o=>({pendiente:"bg-yellow-500",confirmada:"bg-green-500",realizada:"bg-blue-500",completada:"bg-blue-500",cancelada:"bg-red-500"})[o]||"bg-gray-500",se=o=>({pendiente:"Pendiente",confirmada:"Confirmada",realizada:"Completada",completada:"Completada",cancelada:"Cancelada"})[o]||o;return le(()=>{F(),J()}),(o,t)=>(i(),r("div",fe,[t[50]||(t[50]=e("div",{class:"mb-8"},[e("h1",{class:"text-3xl font-serif font-bold text-cafe mb-2"}," Gesti√≥n de Sesiones "),e("p",{class:"text-purple-600"}," Visualiza y gestiona todas tus sesiones con informaci√≥n financiera ")],-1)),e("div",xe,[e("div",_e,[e("div",be,[e("div",ge,[p(m(G),{class:"w-6 h-6 text-yellow-600"})]),t[4]||(t[4]=e("span",{class:"text-sm font-medium text-yellow-600 bg-yellow-50 px-3 py-1 rounded-full"}," Pendientes ",-1))]),t[6]||(t[6]=e("p",{class:"text-sm text-cafe/60 mb-1"},"Sesiones pendientes",-1)),e("p",ve,a(x.value.pendientes),1),e("div",he,[t[5]||(t[5]=e("p",{class:"text-xs text-cafe/50 mb-1"},"Monto estimado",-1)),e("p",we,a(u(x.value.montoPendiente))+"‚Ç¨ ",1)])]),e("div",ye,[e("div",ke,[e("div",Ce,[p(m(k),{class:"w-6 h-6 text-green-600"})]),t[7]||(t[7]=e("span",{class:"text-sm font-medium text-green-600 bg-green-50 px-3 py-1 rounded-full"}," Confirmadas ",-1))]),t[9]||(t[9]=e("p",{class:"text-sm text-cafe/60 mb-1"},"Sesiones confirmadas",-1)),e("p",je,a(x.value.confirmadas),1),e("div",Se,[t[8]||(t[8]=e("p",{class:"text-xs text-cafe/50 mb-1"},"Monto asegurado",-1)),e("p",De,a(u(x.value.montoConfirmado))+"‚Ç¨ ",1)])]),e("div",Ee,[e("div",Me,[e("div",Te,[p(m(k),{class:"w-6 h-6 text-blue-600"})]),t[10]||(t[10]=e("span",{class:"text-sm font-medium text-blue-600 bg-blue-50 px-3 py-1 rounded-full"}," Completadas ",-1))]),t[12]||(t[12]=e("p",{class:"text-sm text-cafe/60 mb-1"},"Sesiones realizadas",-1)),e("p",Pe,a(x.value.completadas),1),e("div",Ne,[t[11]||(t[11]=e("p",{class:"text-xs text-cafe/50 mb-1"},"Monto por cobrar",-1)),e("p",Be,a(u(x.value.montoCompletado))+"‚Ç¨ ",1)])]),e("div",qe,[t[14]||(t[14]=L('<div class="flex items-center justify-between mb-4"><div class="w-12 h-12 bg-red-100 rounded-lg flex items-center justify-center"><span class="text-2xl">‚úï</span></div><span class="text-sm font-medium text-red-600 bg-red-50 px-3 py-1 rounded-full"> Canceladas </span></div><p class="text-sm text-cafe/60 mb-1">Sesiones canceladas</p>',2)),e("p",Fe,a(x.value.canceladas),1),e("div",ze,[t[13]||(t[13]=e("p",{class:"text-xs text-cafe/50 mb-1"},"Monto perdido",-1)),e("p",Ue,a(u(x.value.montoCancelado))+"‚Ç¨ ",1)])])]),e("div",Ve,[e("div",Le,[e("div",$e,[e("div",Ae,[e("div",Ie,[p(m(k),{class:"w-6 h-6 text-white"})]),t[15]||(t[15]=e("div",null,[e("h2",{class:"text-xl font-bold text-cafe"},"Pagos Confirmados"),e("p",{class:"text-sm text-cafe/60 mt-0.5"},"Bonos procesados por coordinaci√≥n")],-1))]),e("div",Ye,[e("div",Oe,[t[16]||(t[16]=e("p",{class:"text-xs text-cafe/50 uppercase font-semibold tracking-wide"},"Total Confirmado",-1)),e("p",He,a(u(R.value))+"‚Ç¨",1),e("p",Ge,a(v.value.length)+" "+a(v.value.length===1?"bono":"bonos"),1)]),e("button",{onClick:t[0]||(t[0]=s=>S.value=!S.value),class:w(["w-10 h-10 rounded-lg bg-white/80 hover:bg-white border border-green-200 flex items-center justify-center text-green-700 hover:text-green-800 transition-all duration-200",{"rotate-180":S.value}])},[...t[17]||(t[17]=[e("span",{class:"text-lg"},"‚ñº",-1)])],2)])])]),p(A,{"enter-active-class":"transition-all duration-300 ease-out","leave-active-class":"transition-all duration-200 ease-in","enter-from-class":"opacity-0 max-h-0","enter-to-class":"opacity-100 max-h-[2000px]","leave-from-class":"opacity-100 max-h-[2000px]","leave-to-class":"opacity-0 max-h-0"},{default:$(()=>[y(e("div",null,[v.value.length===0?(i(),r("div",Re,[...t[18]||(t[18]=[e("div",{class:"w-20 h-20 mx-auto mb-4 rounded-full bg-cafe/5 flex items-center justify-center"},[e("span",{class:"text-4xl"},"üì≠")],-1),e("p",{class:"text-cafe/60 font-medium"},"No hay pagos confirmados a√∫n",-1),e("p",{class:"text-sm text-cafe/40 mt-1"},"Los bonos pagados aparecer√°n aqu√≠",-1)])])):(i(),r("div",Je,[(i(!0),r(Y,null,O(v.value,(s,l)=>(i(),r("div",{key:s.bono_id,class:"group hover:bg-green-50/30 transition-colors duration-150"},[e("div",{onClick:c=>W(s.bono_id),class:"px-6 py-4 cursor-pointer flex items-center gap-4"},[t[21]||(t[21]=e("div",{class:"flex-shrink-0 w-1 h-12 rounded-full bg-green-500"},null,-1)),e("div",Qe,a(U(s.paciente_nombre)),1),e("div",We,[e("div",Xe,[e("p",Ze,a(s.paciente_nombre),1),e("p",et,a(s.tipo_bono||"Bono Est√°ndar"),1)]),e("div",tt,[e("p",st,a(s.sesiones_usadas)+"/"+a(s.bono_sesiones_totales),1),t[19]||(t[19]=e("p",{class:"text-xs text-cafe/50"},"sesiones",-1))]),e("div",ot,[e("p",at,a(u(s.monto_total_terapeuta))+"‚Ç¨",1),t[20]||(t[20]=e("p",{class:"text-xs text-cafe/50"},"tu parte (70%)",-1))]),e("div",nt,[e("p",lt,a(z(s.bono_fecha_pago)),1),e("p",rt,a(s.bono_metodo_pago||"No especificado"),1)])]),e("div",it,[e("span",{class:w(["block w-6 h-6 rounded-full bg-cafe/5 group-hover:bg-cafe/10 flex items-center justify-center text-cafe/40 text-xs transition-all duration-200",{"rotate-180":g.value===s.bono_id}])}," ‚ñº ",2)])],8,Ke),p(A,{"enter-active-class":"transition-all duration-300 ease-out","leave-active-class":"transition-all duration-200 ease-in","enter-from-class":"opacity-0 max-h-0","enter-to-class":"opacity-100 max-h-96","leave-from-class":"opacity-100 max-h-96","leave-to-class":"opacity-0 max-h-0"},{default:$(()=>[y(e("div",dt,[e("div",ct,[e("div",pt,[e("div",ut,[e("div",mt,[t[24]||(t[24]=e("p",{class:"text-xs text-cafe/40 uppercase font-bold tracking-wider mb-3"},"üìã Paciente",-1)),e("div",ft,[e("div",xt,[t[22]||(t[22]=e("span",{class:"text-cafe/60"},"Nombre:",-1)),e("span",_t,a(s.paciente_nombre),1)]),e("div",bt,[t[23]||(t[23]=e("span",{class:"text-cafe/60"},"Email:",-1)),e("span",{class:"font-medium text-cafe text-xs truncate max-w-[150px]",title:s.paciente_email},a(s.paciente_email),9,gt)])])]),e("div",vt,[t[29]||(t[29]=e("p",{class:"text-xs text-cafe/40 uppercase font-bold tracking-wider mb-3"},"üßæ Detalles del Bono",-1)),e("div",ht,[e("div",wt,[t[25]||(t[25]=e("span",{class:"text-cafe/60"},"Tipo:",-1)),e("span",yt,a(s.tipo_bono||"Est√°ndar"),1)]),e("div",kt,[t[26]||(t[26]=e("span",{class:"text-cafe/60"},"Sesiones totales:",-1)),e("span",Ct,a(s.bono_sesiones_totales),1)]),e("div",jt,[t[27]||(t[27]=e("span",{class:"text-cafe/60"},"Sesiones usadas:",-1)),e("span",St,a(s.sesiones_usadas),1)]),e("div",Dt,[t[28]||(t[28]=e("span",{class:"text-cafe/60"},"Sesiones restantes:",-1)),e("span",Et,a(s.bono_sesiones_restantes),1)])])]),e("div",Mt,[t[35]||(t[35]=e("p",{class:"text-xs text-cafe/40 uppercase font-bold tracking-wider mb-3"},"Financiero",-1)),e("div",Tt,[e("div",Pt,[t[30]||(t[30]=e("span",{class:"text-cafe/60"},"Monto total:",-1)),e("span",Nt,a(u(s.bono_monto_total))+"‚Ç¨",1)]),e("div",Bt,[t[31]||(t[31]=e("span",{class:"text-cafe/60 font-medium"},"Tu parte (70%):",-1)),e("span",qt,a(u(s.monto_total_terapeuta))+"‚Ç¨",1)]),e("div",Ft,[t[32]||(t[32]=e("span",{class:"text-cafe/60"},"Por sesi√≥n:",-1)),e("span",zt,a(u(s.precio_por_sesion))+"‚Ç¨",1)]),e("div",Ut,[e("div",Vt,[t[33]||(t[33]=e("span",null,"M√©todo de pago:",-1)),e("span",Lt,a(s.bono_metodo_pago||"No especificado"),1)]),e("div",$t,[t[34]||(t[34]=e("span",null,"Fecha de pago:",-1)),e("span",At,a(z(s.bono_fecha_pago)),1)])])])])])])])],512),[[H,g.value===s.bono_id]])]),_:2},1024)]))),128))]))],512),[[H,S.value]])]),_:1})]),e("div",It,[e("div",Yt,[e("div",Ot,[t[36]||(t[36]=e("label",{class:"block text-sm font-medium text-cafe mb-2"}," Buscar paciente ",-1)),e("div",Ht,[y(e("input",{"onUpdate:modelValue":t[1]||(t[1]=s=>d.value.busqueda=s),type:"text",placeholder:"Nombre del paciente...",class:"w-full px-4 py-2 pl-10 bg-base-bg rounded-lg border border-transparent focus:border-purple-600 focus:outline-none focus:ring-2 focus:ring-purple-300/20"},null,512),[[re,d.value.busqueda]]),p(m(ce),{class:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-cafe/50"})])]),e("div",null,[t[38]||(t[38]=e("label",{class:"block text-sm font-medium text-cafe mb-2"}," Estado ",-1)),y(e("select",{"onUpdate:modelValue":t[2]||(t[2]=s=>d.value.estado=s),class:"w-full px-4 py-2 bg-base-bg rounded-lg border border-transparent focus:border-purple-600 focus:outline-none focus:ring-2 focus:ring-purple-300/20 text-cafe"},[...t[37]||(t[37]=[L('<option value="">Todos los estados</option><option value="pendiente">Pendiente</option><option value="confirmada">Confirmada</option><option value="realizada">Completada</option><option value="cancelada">Cancelada</option>',5)])],512),[[I,d.value.estado]])]),e("div",null,[t[40]||(t[40]=e("label",{class:"block text-sm font-medium text-cafe mb-2"}," Per√≠odo ",-1)),y(e("select",{"onUpdate:modelValue":t[3]||(t[3]=s=>d.value.periodo=s),class:"w-full px-4 py-2 bg-base-bg rounded-lg border border-transparent focus:border-purple-600 focus:outline-none focus:ring-2 focus:ring-purple-300/20 text-cafe"},[...t[39]||(t[39]=[e("option",{value:"mes-actual"},"Mes actual",-1),e("option",{value:"mes-anterior"},"Mes anterior",-1),e("option",{value:"trimestre"},"√öltimo trimestre",-1),e("option",{value:"todos"},"Todos",-1)])],512),[[I,d.value.periodo]])])])]),P.value?(i(),r("div",Gt,[...t[41]||(t[41]=[e("div",{class:"text-center"},[e("div",{class:"inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-purple-600 mb-4"}),e("p",{class:"text-cafe/60"},"Cargando sesiones...")],-1)])])):C.value?(i(),r("div",Rt,[e("div",Jt,[p(m(pe),{class:"w-6 h-6 text-red-600"}),e("div",null,[t[42]||(t[42]=e("h3",{class:"font-semibold text-red-800 mb-1"},"Error al cargar sesiones",-1)),e("p",Kt,a(C.value),1)])])])):(i(),r("div",Qt,[e("div",Wt,[e("h3",Xt,[t[43]||(t[43]=M(" Listado de Sesiones ",-1)),e("span",Zt," ("+a(D.value.length)+" sesiones) ",1)])]),D.value.length===0?(i(),r("div",es,[e("div",ts,[p(m(ue),{class:"w-8 h-8 text-cafe/40"})]),t[44]||(t[44]=e("h3",{class:"text-lg font-semibold text-cafe mb-2"}," No hay sesiones para mostrar ",-1)),e("p",ss,a(d.value.busqueda||d.value.estado?"Intenta ajustar los filtros de b√∫squeda":"No tienes sesiones programadas a√∫n"),1)])):(i(),r("div",os,[e("table",as,[t[49]||(t[49]=e("thead",{class:"bg-gray-50 border-b border-gray-200"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-semibold text-cafe/70 uppercase tracking-wider"}," Fecha "),e("th",{class:"px-6 py-3 text-left text-xs font-semibold text-cafe/70 uppercase tracking-wider"}," Hora "),e("th",{class:"px-6 py-3 text-left text-xs font-semibold text-cafe/70 uppercase tracking-wider"}," Paciente "),e("th",{class:"px-6 py-3 text-left text-xs font-semibold text-cafe/70 uppercase tracking-wider"}," Modalidad "),e("th",{class:"px-6 py-3 text-left text-xs font-semibold text-cafe/70 uppercase tracking-wider"}," Estado "),e("th",{class:"px-6 py-3 text-left text-xs font-semibold text-cafe/70 uppercase tracking-wider"}," Bono "),e("th",{class:"px-6 py-3 text-right text-xs font-semibold text-cafe/70 uppercase tracking-wider"}," Monto "),e("th",{class:"px-6 py-3 text-center text-xs font-semibold text-cafe/70 uppercase tracking-wider"}," Acciones ")])],-1)),e("tbody",ns,[(i(!0),r(Y,null,O(D.value,s=>(i(),r("tr",{key:s.id,class:"hover:bg-gray-50 transition-colors duration-150"},[e("td",ls,[e("div",rs,a(z(s.fecha_cita)),1),e("div",is,a(X(s.fecha_cita)),1)]),e("td",ds,[e("div",cs,a(Z(s.hora_inicio)),1),e("div",ps,a(s.duracion_minutos||50)+" min ",1)]),e("td",us,[e("div",ms,[e("div",fs,a(U(s.paciente?.nombre_completo||"NN")),1),e("div",null,[e("div",xs,a(s.paciente?.nombre_completo||"Sin nombre"),1),s.paciente?.email?(i(),r("div",_s,a(s.paciente.email),1)):ie("",!0)])])]),e("td",bs,[e("span",{class:w(["inline-flex items-center gap-1 px-2.5 py-1 rounded-full text-xs font-medium",s.modalidad==="online"?"bg-blue-50 text-blue-700":"bg-purple-50 text-purple-700"])},[e("span",null,a(s.modalidad==="online"?"üíª":"üè¢"),1),M(" "+a(s.modalidad==="online"?"Online":"Presencial"),1)],2)]),e("td",gs,[e("span",{class:w(["inline-flex items-center gap-1.5 px-3 py-1 rounded-full text-xs font-medium",ee(s.estado)])},[e("span",{class:w(["w-1.5 h-1.5 rounded-full",te(s.estado)])},null,2),M(" "+a(se(s.estado)),1)],2)]),e("td",vs,[s.bono?(i(),r("div",hs,[e("div",ws,[p(m(k),{class:"w-4 h-4"}),t[45]||(t[45]=e("span",null,"Con bono",-1))]),e("div",ys,a(s.bono.sesiones_restantes||0)+"/"+a(s.bono.sesiones_totales||0)+" restantes ",1),s.bono.pagado?(i(),r("div",ks,[p(m(k),{class:"w-4 h-4"}),t[46]||(t[46]=e("span",{class:"font-semibold"},"Pagado",-1))])):(i(),r("div",Cs,[p(m(G),{class:"w-4 h-4"}),t[47]||(t[47]=e("span",{class:"font-semibold"},"Pend. pago",-1))]))])):(i(),r("div",js," Sin bono "))]),e("td",Ss,[e("div",Ds,a(u(s.precio_estimado||T))+"‚Ç¨ ",1),e("div",Es," Tu parte: "+a(u((s.precio_estimado||T)*.7))+"‚Ç¨ ",1)]),e("td",Ms,[e("button",{onClick:l=>K(s),class:"inline-flex items-center gap-1.5 px-3 py-1.5 text-sm text-purple-600 hover:bg-purple-600/10 rounded-lg transition-colors duration-200"},[p(m(me),{class:"w-4 h-4"}),t[48]||(t[48]=M(" Ver detalles ",-1))],8,Ts)])]))),128))])])]))])),p(de,{"is-open":B.value,"cita-id":q.value,onClose:Q,onActualizado:F,onEliminado:F},null,8,["is-open","cita-id"])]))}});export{Rs as default};
