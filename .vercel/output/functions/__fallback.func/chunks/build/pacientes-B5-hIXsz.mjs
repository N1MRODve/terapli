import{defineComponent as e,ref as t,computed as s,unref as a,useSSRContext as r}from"vue";import{ssrRenderAttrs as o,ssrRenderComponent as i,ssrInterpolate as l,ssrRenderAttr as n,ssrIncludeBooleanAttr as d,ssrLooseContain as c,ssrLooseEqual as p,ssrRenderList as u,ssrRenderClass as v}from"vue/server-renderer";import{UserGroupIcon as m,TicketIcon as x,CurrencyEuroIcon as b,ChartBarIcon as g}from"@heroicons/vue/24/outline";import{u as f}from"./useSupabaseClient-DykwVqLQ.mjs";import"./server.mjs";import"../nitro/nitro.mjs";import"node:http";import"node:https";import"node:events";import"node:buffer";import"node:fs";import"node:path";import"node:crypto";import"../routes/renderer.mjs";import"unhead/server";import"devalue";import"unhead/plugins";import"unhead/utils";import"vue-router";import"@supabase/ssr";import"@vercel/analytics/nuxt";const y=e({__name:"pacientes",__ssrInlineRender:!0,setup(e){f();const r=t(!0),y=t([]),h=t(""),w=t(""),_=t(""),$=s(()=>{const e=new Map;return y.value.forEach(t=>{t.terapeuta_id&&t.terapeuta_nombre&&e.set(t.terapeuta_id,{id:t.terapeuta_id,nombre:t.terapeuta_nombre})}),Array.from(e.values())}),A=s(()=>{let e=[...y.value];if(h.value){const t=h.value.toLowerCase();e=e.filter(e=>{var s,a;return(null==(s=e.nombre_completo)?void 0:s.toLowerCase().includes(t))||(null==(a=e.email)?void 0:a.toLowerCase().includes(t))})}return w.value&&(e=e.filter(e=>e.terapeuta_id===w.value)),"activo"===_.value?e=e.filter(e=>e.bono_activo):"sin_bono"===_.value&&(e=e.filter(e=>!e.bono_activo)),e}),j=s(()=>y.value.filter(e=>e.bono_activo).length),k=s(()=>y.value.reduce((e,t)=>e+(t.cltv||0),0)),C=s(()=>0===y.value.length?0:k.value/y.value.length),formatNumber=e=>e.toLocaleString("es-ES",{style:"currency",currency:"EUR",minimumFractionDigits:2,maximumFractionDigits:2});return(e,t,s,f)=>{t(`<div${o(f)}><div class="mb-8"><h2 class="text-3xl font-bold text-gray-900 mb-2">Gesti√≥n de Pacientes</h2><p class="text-gray-600">Vista completa de todos los pacientes del sistema</p></div>`),r.value?t('<div class="flex items-center justify-center py-20"><div class="text-center"><div class="w-16 h-16 border-4 border-gray-200 border-t-indigo-500 rounded-full animate-spin mx-auto mb-4"></div><p class="text-gray-600 text-sm">Cargando pacientes...</p></div></div>'):(t('\x3c!--[--\x3e<div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8"><div class="bg-gradient-to-br from-blue-50 to-blue-100 rounded-xl p-6 border border-blue-200"><div class="flex items-center justify-between mb-2"><span class="text-sm font-medium text-blue-700">Total Pacientes</span>'),t(i(a(m),{class:"w-5 h-5 text-blue-600"},null,s)),t(`</div><p class="text-3xl font-bold text-blue-900">${l(y.value.length)}</p></div><div class="bg-gradient-to-br from-green-50 to-green-100 rounded-xl p-6 border border-green-200"><div class="flex items-center justify-between mb-2"><span class="text-sm font-medium text-green-700">Con Bono Activo</span>`),t(i(a(x),{class:"w-5 h-5 text-green-600"},null,s)),t(`</div><p class="text-3xl font-bold text-green-900">${l(j.value)}</p></div><div class="bg-gradient-to-br from-purple-50 to-purple-100 rounded-xl p-6 border border-purple-200"><div class="flex items-center justify-between mb-2"><span class="text-sm font-medium text-purple-700">CLTV Total</span>`),t(i(a(b),{class:"w-5 h-5 text-purple-600"},null,s)),t(`</div><p class="text-3xl font-bold text-purple-900">${l(formatNumber(k.value))}</p></div><div class="bg-gradient-to-br from-orange-50 to-orange-100 rounded-xl p-6 border border-orange-200"><div class="flex items-center justify-between mb-2"><span class="text-sm font-medium text-orange-700">CLTV Promedio</span>`),t(i(a(g),{class:"w-5 h-5 text-orange-600"},null,s)),t(`</div><p class="text-3xl font-bold text-orange-900">${l(formatNumber(C.value))}</p></div></div><div class="bg-white rounded-xl shadow-md border border-gray-200 p-6 mb-6"><div class="grid grid-cols-1 md:grid-cols-3 gap-4"><div><label class="block text-sm font-medium text-gray-700 mb-2">Buscar paciente</label><input${n("value",h.value)} type="text" placeholder="Nombre o email..." class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent"></div><div><label class="block text-sm font-medium text-gray-700 mb-2">Filtrar por terapeuta</label><select class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent"><option value=""${d(Array.isArray(w.value)?c(w.value,""):p(w.value,""))?" selected":""}>Todos los terapeutas</option>\x3c!--[--\x3e`),u($.value,e=>{t(`<option${n("value",e.id)}${d(Array.isArray(w.value)?c(w.value,e.id):p(w.value,e.id))?" selected":""}>${l(e.nombre)}</option>`)}),t(`\x3c!--]--\x3e</select></div><div><label class="block text-sm font-medium text-gray-700 mb-2">Estado del bono</label><select class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent"><option value=""${d(Array.isArray(_.value)?c(_.value,""):p(_.value,""))?" selected":""}>Todos</option><option value="activo"${d(Array.isArray(_.value)?c(_.value,"activo"):p(_.value,"activo"))?" selected":""}>Con bono activo</option><option value="sin_bono"${d(Array.isArray(_.value)?c(_.value,"sin_bono"):p(_.value,"sin_bono"))?" selected":""}>Sin bono activo</option></select></div></div></div><div class="bg-white rounded-xl shadow-md border border-gray-200 overflow-hidden"><div class="overflow-x-auto"><table class="min-w-full divide-y divide-gray-200"><thead class="bg-gray-50"><tr><th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"> Paciente </th><th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"> Terapeuta </th><th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"> Bono Activo </th><th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"> Sesiones </th><th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"> CLTV </th><th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"> Estado </th></tr></thead><tbody class="bg-white divide-y divide-gray-200">\x3c!--[--\x3e`),u(A.value,e=>{var r,o;t(`<tr class="hover:bg-gray-50 transition-colors"><td class="px-6 py-4 whitespace-nowrap"><div class="flex items-center"><div class="flex-shrink-0 h-10 w-10 bg-gradient-to-br from-blue-400 to-indigo-500 rounded-full flex items-center justify-center"><span class="text-white font-semibold text-sm">${l((r=e.nombre_completo,r?r.split(" ").map(e=>e[0]).join("").toUpperCase().substring(0,2):"??"))}</span></div><div class="ml-4"><div class="text-sm font-medium text-gray-900">${l(e.nombre_completo)}</div><div class="text-sm text-gray-500">${l(e.email)}</div></div></div></td><td class="px-6 py-4 whitespace-nowrap"><div class="text-sm text-gray-900">${l(e.terapeuta_nombre||"Sin asignar")}</div></td><td class="px-6 py-4 whitespace-nowrap">`),e.bono_activo?(t('<div><div class="flex items-center">'),t(i(a(x),{class:"w-4 h-4 text-green-600 mr-2"},null,s)),t(`<span class="text-sm font-medium text-gray-900">${l((o=e.bono_tipo,{semanal:"Semanal",quincenal:"Quincenal",mensual:"Mensual",otro:"Otro"}[o]||o))}</span></div><div class="text-xs text-gray-500 mt-1">${l(e.bono_estado)}</div></div>`)):t('<div class="text-sm text-gray-400 italic">Sin bono activo</div>'),t('</td><td class="px-6 py-4 whitespace-nowrap">'),e.bono_activo?t(`<div class="text-sm"><span class="font-semibold text-gray-900">${l(e.sesiones_restantes)}</span><span class="text-gray-500"> / ${l(e.total_sesiones)}</span></div>`):t('<div class="text-sm text-gray-400">-</div>'),t(`</td><td class="px-6 py-4 whitespace-nowrap"><div class="text-sm font-semibold text-indigo-600">${l(formatNumber(e.cltv||0))}</div></td><td class="px-6 py-4 whitespace-nowrap"><span class="${v([e.activo?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800","px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full"])}">${l(e.activo?"Activo":"Inactivo")}</span></td></tr>`)}),t("\x3c!--]--\x3e</tbody></table></div>"),0===A.value.length?(t('<div class="text-center py-12">'),t(i(a(m),{class:"w-16 h-16 text-gray-300 mx-auto mb-4"},null,s)),t('<p class="text-gray-500 text-sm">No se encontraron pacientes</p></div>')):t("\x3c!----\x3e"),t(`</div><div class="mt-6 text-sm text-gray-500 text-right"> Mostrando ${l(A.value.length)} de ${l(y.value.length)} pacientes </div>\x3c!--]--\x3e`)),t("</div>")}}}),h=y.setup;y.setup=(e,t)=>{const s=r();return(s.modules||(s.modules=new Set)).add("pages/admin/pacientes.vue"),h?h(e,t):void 0};export{y as default};
//# sourceMappingURL=pacientes-B5-hIXsz.mjs.map
