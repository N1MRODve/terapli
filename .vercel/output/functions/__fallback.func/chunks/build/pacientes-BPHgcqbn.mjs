import{v as e,a,s}from"./server.mjs";import{r as t}from"./MagnifyingGlassIcon-GsbNDyPZ.mjs";import{r as o}from"./XMarkIcon-DCLwyE-W.mjs";import{r as n,a as r,c as l,b as i}from"./EyeIcon-BxBo7Ss-.mjs";import{r as d}from"./PlusIcon-CHLzv-V9.mjs";import{_ as c}from"./_plugin-vue_export-helper-1tPrXgE0.mjs";import{r as v}from"./UserGroupIcon-BhthmHUw.mjs";import{r as f}from"./CheckCircleIcon-CT9fzVFs.mjs";import{r as p}from"./TicketIcon-zZdrc71S.mjs";import{r as b}from"./ExclamationTriangleIcon-DQdM2y0F.mjs";import{r as u}from"./FunnelIcon-y4UDP9oS.mjs";import{r as m,a as h}from"./XCircleIcon-Cr4IlpzV.mjs";import{r as _}from"./PhoneIcon-acGzPaDV.mjs";import{r as g,a as A}from"./EllipsisVerticalIcon-BWwSvj92.mjs";import{r as $}from"./PencilIcon-BKWXEWgS.mjs";import{r as C}from"./TrashIcon-3HGFGGDp.mjs";import{u as I}from"./useSupabaseClient-DykwVqLQ.mjs";import{r as x}from"./UserIcon-CrHYaeI9.mjs";import{r as y}from"./ArrowPathIcon-D0-dipB5.mjs";import{r as R}from"./DocumentTextIcon-O51EkPyw.mjs";import{r as w}from"./ChartBarIcon-BEEST7f0.mjs";import{r as P}from"./CalendarIcon-BrsGHJBC.mjs";import{r as B}from"./ChevronRightIcon-4xxNHuWW.mjs";import"../routes/renderer.mjs";import"../nitro/nitro.mjs";import"node:http";import"node:https";import"node:events";import"node:buffer";import"node:fs";import"node:path";import"node:crypto";import"../_/shared.cjs.prod.mjs";import"../virtual/_commonjsHelpers.mjs";import"node:stream";import"../_/index2.mjs";import"@supabase/supabase-js";import"@vercel/analytics/nuxt";function render(a,s){return e.openBlock(),e.createElementBlock("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[e.createElementVNode("path",{"fill-rule":"evenodd",d:"M8.25 6.75a3.75 3.75 0 1 1 7.5 0 3.75 3.75 0 0 1-7.5 0ZM15.75 9.75a3 3 0 1 1 6 0 3 3 0 0 1-6 0ZM2.25 9.75a3 3 0 1 1 6 0 3 3 0 0 1-6 0ZM6.31 15.117A6.745 6.745 0 0 1 12 12a6.745 6.745 0 0 1 6.709 7.498.75.75 0 0 1-.372.568A12.696 12.696 0 0 1 12 21.75c-2.305 0-4.47-.612-6.337-1.684a.75.75 0 0 1-.372-.568 6.787 6.787 0 0 1 1.019-4.38Z","clip-rule":"evenodd"}),e.createElementVNode("path",{d:"M5.082 14.254a8.287 8.287 0 0 0-1.308 5.135 9.687 9.687 0 0 1-1.764-.44l-.115-.04a.563.563 0 0 1-.373-.487l-.01-.121a3.75 3.75 0 0 1 3.57-4.047ZM20.226 19.389a8.287 8.287 0 0 0-1.308-5.135 3.75 3.75 0 0 1 3.57 4.047l-.01.121a.563.563 0 0 1-.373.486l-.115.04c-.567.2-1.156.349-1.764.441Z"})])}const E=e.defineComponent({__name:"PacientesHeader",__ssrInlineRender:!0,props:{busqueda:{default:""},totalPacientes:{default:0},pacientesActivos:{default:0}},emits:["update:busqueda","nuevo-paciente","importar","exportar"],setup(a,{emit:l}){const i=a,c=e.ref(i.busqueda);return e.watch(()=>i.busqueda,e=>{c.value=e}),(l,i,v,f)=>{i(`<header${s.ssrRenderAttrs(e.mergeProps({class:"pacientes-header"},f))} data-v-500e1e84><div class="header-left" data-v-500e1e84><div class="header-icon" data-v-500e1e84>`),i(s.ssrRenderComponent(e.unref(render),{class:"w-6 h-6 text-white"},null,v)),i('</div><div class="header-text" data-v-500e1e84><h1 class="header-title" data-v-500e1e84>Pacientes</h1><p class="header-subtitle" data-v-500e1e84>Gestión y seguimiento de todos los pacientes de la clínica</p></div></div><div class="header-center" data-v-500e1e84><div class="search-container" data-v-500e1e84>'),i(s.ssrRenderComponent(e.unref(t),{class:"search-icon"},null,v)),i(`<input${s.ssrRenderAttr("value",e.unref(c))} type="search" placeholder="Buscar por nombre, email o teléfono..." class="search-input" aria-label="Buscar pacientes" data-v-500e1e84>`),e.unref(c)?(i('<button class="search-clear" aria-label="Limpiar búsqueda" data-v-500e1e84>'),i(s.ssrRenderComponent(e.unref(o),{class:"w-4 h-4"},null,v)),i("</button>")):i("\x3c!----\x3e"),i(`</div></div><div class="header-right" data-v-500e1e84><div class="header-stats" data-v-500e1e84><div class="stat-item" data-v-500e1e84><span class="stat-value" data-v-500e1e84>${s.ssrInterpolate(a.totalPacientes)}</span><span class="stat-label" data-v-500e1e84>Total</span></div><div class="stat-divider" data-v-500e1e84></div><div class="stat-item activos" data-v-500e1e84><span class="stat-value" data-v-500e1e84>${s.ssrInterpolate(a.pacientesActivos)}</span><span class="stat-label" data-v-500e1e84>Activos</span></div></div><button class="action-btn action-btn-tertiary" aria-label="Importar pacientes" title="Importar" data-v-500e1e84>`),i(s.ssrRenderComponent(e.unref(n),{class:"w-4 h-4"},null,v)),i('</button><button class="action-btn action-btn-tertiary" aria-label="Exportar pacientes" title="Exportar" data-v-500e1e84>'),i(s.ssrRenderComponent(e.unref(r),{class:"w-4 h-4"},null,v)),i('</button><button class="action-btn action-btn-primary" aria-label="Crear nuevo paciente" data-v-500e1e84>'),i(s.ssrRenderComponent(e.unref(d),{class:"w-4 h-4"},null,v)),i("<span data-v-500e1e84>Nuevo Paciente</span></button></div></header>")}}}),q=E.setup;E.setup=(a,s)=>{const t=e.useSSRContext();return(t.modules||(t.modules=new Set)).add("components/pacientes/PacientesHeader.vue"),q?q(a,s):void 0};const L=Object.assign(c(E,[["__scopeId","data-v-500e1e84"]]),{__name:"PacientesHeader"}),S=e.defineComponent({__name:"PacientesMetricas",__ssrInlineRender:!0,props:{totalPacientes:{},pacientesActivos:{},bonosActivos:{},bonosPorAgotar:{}},setup:a=>(t,o,n,r)=>{o(`<div${s.ssrRenderAttrs(e.mergeProps({class:"metricas-grid"},r))} data-v-51297926><div class="metrica-card" data-v-51297926><div class="metrica-icon icon-total" data-v-51297926>`),o(s.ssrRenderComponent(e.unref(v),{class:"w-6 h-6"},null,n)),o(`</div><div class="metrica-content" data-v-51297926><span class="metrica-valor" data-v-51297926>${s.ssrInterpolate(a.totalPacientes)}</span><span class="metrica-label" data-v-51297926>Total Pacientes</span></div></div><div class="metrica-card" data-v-51297926><div class="metrica-icon icon-activos" data-v-51297926>`),o(s.ssrRenderComponent(e.unref(f),{class:"w-6 h-6"},null,n)),o(`</div><div class="metrica-content" data-v-51297926><span class="metrica-valor activos" data-v-51297926>${s.ssrInterpolate(a.pacientesActivos)}</span><span class="metrica-label" data-v-51297926>Activos</span></div></div><div class="metrica-card" data-v-51297926><div class="metrica-icon icon-bonos" data-v-51297926>`),o(s.ssrRenderComponent(e.unref(p),{class:"w-6 h-6"},null,n)),o(`</div><div class="metrica-content" data-v-51297926><span class="metrica-valor bonos" data-v-51297926>${s.ssrInterpolate(a.bonosActivos)}</span><span class="metrica-label" data-v-51297926>Bonos Activos</span></div></div><div class="${s.ssrRenderClass([{alerta:a.bonosPorAgotar>0},"metrica-card"])}" data-v-51297926><div class="metrica-icon icon-alerta" data-v-51297926>`),o(s.ssrRenderComponent(e.unref(b),{class:"w-6 h-6"},null,n)),o(`</div><div class="metrica-content" data-v-51297926><span class="metrica-valor alerta" data-v-51297926>${s.ssrInterpolate(a.bonosPorAgotar)}</span><span class="metrica-label" data-v-51297926>Por Agotar</span></div></div></div>`)}}),j=S.setup;S.setup=(a,s)=>{const t=e.useSSRContext();return(t.modules||(t.modules=new Set)).add("components/pacientes/PacientesMetricas.vue"),j?j(a,s):void 0};const M=Object.assign(c(S,[["__scopeId","data-v-51297926"]]),{__name:"PacientesMetricas"}),T=e.defineComponent({__name:"PacientesFiltros",__ssrInlineRender:!0,props:{filtroEstado:{default:""},filtroTerapeuta:{default:""},filtroBono:{default:""},terapeutas:{default:()=>[]},totalResultados:{default:0},totalPacientes:{default:0}},emits:["update:filtroEstado","update:filtroTerapeuta","update:filtroBono","limpiar-filtros"],setup(a,{emit:t}){const n=a,r=e.computed(()=>n.filtroEstado||n.filtroTerapeuta||n.filtroBono),l=e.computed(()=>r.value&&n.totalResultados!==n.totalPacientes);return(t,n,i,d)=>{n(`<div${s.ssrRenderAttrs(e.mergeProps({class:"filtros-bar"},d))} data-v-87eef75a><div class="filtros-row" data-v-87eef75a><div class="filtros-icon" data-v-87eef75a>`),n(s.ssrRenderComponent(e.unref(u),{class:"w-4 h-4"},null,i)),n(`</div><div class="filtro-select-wrapper" data-v-87eef75a><select${s.ssrRenderAttr("value",a.filtroEstado)} class="filtro-select" aria-label="Filtrar por estado" data-v-87eef75a><option value="" data-v-87eef75a>Todos los estados</option><option value="activo" data-v-87eef75a>Activos</option><option value="inactivo" data-v-87eef75a>Inactivos</option></select></div><div class="filtro-select-wrapper" data-v-87eef75a><select${s.ssrRenderAttr("value",a.filtroTerapeuta)} class="filtro-select" aria-label="Filtrar por terapeuta" data-v-87eef75a><option value="" data-v-87eef75a>Todos los terapeutas</option>\x3c!--[--\x3e`),s.ssrRenderList(a.terapeutas,e=>{n(`<option${s.ssrRenderAttr("value",e.id)} data-v-87eef75a>${s.ssrInterpolate(e.nombre)}</option>`)}),n(`\x3c!--]--\x3e</select></div><div class="filtros-divider" data-v-87eef75a></div><div class="chips-container" data-v-87eef75a><button class="${s.ssrRenderClass([{active:"con-bono"===a.filtroBono},"filter-chip"])}" data-v-87eef75a>`),n(s.ssrRenderComponent(e.unref(p),{class:"w-3.5 h-3.5"},null,i)),n(` Con bono </button><button class="${s.ssrRenderClass([{active:"sin-bono"===a.filtroBono},"filter-chip"])}" data-v-87eef75a>`),n(s.ssrRenderComponent(e.unref(h),{class:"w-3.5 h-3.5"},null,i)),n(` Sin bono </button><button class="${s.ssrRenderClass([{active:"por-agotar"===a.filtroBono},"filter-chip chip-alerta"])}" data-v-87eef75a>`),n(s.ssrRenderComponent(e.unref(b),{class:"w-3.5 h-3.5"},null,i)),n(' Por agotar </button></div><div class="flex-1" data-v-87eef75a></div>'),e.unref(l)?n(`<div class="resultados-badge" data-v-87eef75a>${s.ssrInterpolate(a.totalResultados)} de ${s.ssrInterpolate(a.totalPacientes)}</div>`):n("\x3c!----\x3e"),e.unref(r)?(n('<button class="limpiar-btn" data-v-87eef75a>'),n(s.ssrRenderComponent(e.unref(o),{class:"w-4 h-4"},null,i)),n(" Limpiar </button>")):n("\x3c!----\x3e"),n("</div></div>")}}}),k=T.setup;T.setup=(a,s)=>{const t=e.useSSRContext();return(t.modules||(t.modules=new Set)).add("components/pacientes/PacientesFiltros.vue"),k?k(a,s):void 0};const N=Object.assign(c(T,[["__scopeId","data-v-87eef75a"]]),{__name:"PacientesFiltros"}),F=e.defineComponent({__name:"PacientesTabla",__ssrInlineRender:!0,props:{pacientes:{},cargando:{type:Boolean,default:!1},paginaActual:{default:1},porPagina:{default:15}},emits:["ver-detalle","editar","eliminar","whatsapp","cambiar-pagina"],setup(a,{emit:t}){const o=a,n=e.ref(null),r=e.computed(()=>Math.ceil(o.pacientes.length/o.porPagina)),d=e.computed(()=>{const e=(o.paginaActual-1)*o.porPagina,a=e+o.porPagina;return o.pacientes.slice(e,a)}),getEstadoConfig=(e,a)=>{const s="activo"===e||a;return{label:s?"Activo":"Inactivo",class:s?"estado-activo":"estado-inactivo"}};return(t,o,c,v)=>{o(`<div${s.ssrRenderAttrs(e.mergeProps({class:"tabla-container"},v))} data-v-fbffeefb>`),a.cargando?o('<div class="loading-state" data-v-fbffeefb><div class="loading-spinner" data-v-fbffeefb></div><p data-v-fbffeefb>Cargando pacientes...</p></div>'):0===a.pacientes.length?o('<div class="empty-state" data-v-fbffeefb><div class="empty-icon" data-v-fbffeefb><svg class="w-16 h-16" fill="none" viewBox="0 0 24 24" stroke="currentColor" data-v-fbffeefb><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z" data-v-fbffeefb></path></svg></div><h3 class="empty-title" data-v-fbffeefb>No se encontraron pacientes</h3><p class="empty-description" data-v-fbffeefb>Intenta con otros términos de búsqueda o ajusta los filtros</p></div>'):(o('\x3c!--[--\x3e<div class="table-wrapper" data-v-fbffeefb><table class="pacientes-table" data-v-fbffeefb><thead data-v-fbffeefb><tr data-v-fbffeefb><th class="th-paciente" data-v-fbffeefb>Paciente</th><th class="th-contacto" data-v-fbffeefb>Contacto</th><th class="th-terapeuta" data-v-fbffeefb>Terapeuta</th><th class="th-bono" data-v-fbffeefb>Estado Bono</th><th class="th-sesiones" data-v-fbffeefb>Sesiones</th><th class="th-estado" data-v-fbffeefb>Estado</th><th class="th-acciones" data-v-fbffeefb>Acciones</th></tr></thead><tbody data-v-fbffeefb>\x3c!--[--\x3e'),s.ssrRenderList(e.unref(d),a=>{var t,r;o(`<tr class="fila-paciente" data-v-fbffeefb><td class="td-paciente" data-v-fbffeefb><div class="paciente-info" data-v-fbffeefb><div class="avatar" data-v-fbffeefb><span data-v-fbffeefb>${s.ssrInterpolate((t=a.nombre_completo,t?t.split(" ").map(e=>e[0]).join("").toUpperCase().substring(0,2):"??"))}</span></div><div class="paciente-texto" data-v-fbffeefb><span class="paciente-nombre" data-v-fbffeefb>${s.ssrInterpolate(a.nombre_completo)}</span><span class="paciente-area" data-v-fbffeefb>${s.ssrInterpolate(a.area_de_acompanamiento||"Sin área asignada")}</span></div></div></td><td class="td-contacto" data-v-fbffeefb><div class="contacto-info" data-v-fbffeefb><a${s.ssrRenderAttr("href",`mailto:${a.email}`)} class="contacto-item"${s.ssrRenderAttr("title",a.email)} data-v-fbffeefb>`),o(s.ssrRenderComponent(e.unref(l),{class:"w-4 h-4"},null,c)),o(`<span class="contacto-texto" data-v-fbffeefb>${s.ssrInterpolate(a.email)}</span></a>`),a.telefono?(o(`<a${s.ssrRenderAttr("href",`tel:${a.telefono}`)} class="contacto-item" data-v-fbffeefb>`),o(s.ssrRenderComponent(e.unref(_),{class:"w-4 h-4"},null,c)),o(`<span data-v-fbffeefb>${s.ssrInterpolate(a.telefono)}</span></a>`)):o("\x3c!----\x3e"),o('</div></td><td class="td-terapeuta" data-v-fbffeefb>'),a.terapeuta_nombre?o(`<span class="terapeuta-nombre" data-v-fbffeefb>${s.ssrInterpolate(a.terapeuta_nombre)}</span>`):o('<span class="sin-asignar" data-v-fbffeefb>Sin asignar</span>'),o('</td><td class="td-bono" data-v-fbffeefb><div class="bono-info" data-v-fbffeefb>'),a.bono_activo?(o(`<div class="${s.ssrRenderClass([(r=a.bono_activo,r?0===r.sesiones_restantes?{label:"Agotado",class:"bono-agotado",icon:"warning"}:1===r.sesiones_restantes?{label:"Última sesión",class:"bono-ultimo",icon:"warning"}:2===r.sesiones_restantes?{label:"Por agotar",class:"bono-bajo",icon:"warning"}:{label:"Activo",class:"bono-activo",icon:"check"}:{label:"Sin bono",class:"bono-sin",icon:"none"}).class,"bono-detalle"])}" data-v-fbffeefb><div class="bono-sesiones" data-v-fbffeefb><span class="sesiones-valor" data-v-fbffeefb>${s.ssrInterpolate(a.bono_activo.sesiones_restantes)}</span><span class="sesiones-total" data-v-fbffeefb>/${s.ssrInterpolate(a.bono_activo.sesiones_totales)}</span></div><div class="bono-progreso" data-v-fbffeefb><div class="bono-progreso-fill" style="${s.ssrRenderStyle({width:a.bono_activo.sesiones_restantes/a.bono_activo.sesiones_totales*100+"%"})}" data-v-fbffeefb></div></div>`),a.bono_activo.sesiones_restantes<=2?(o('<div class="bono-alerta" data-v-fbffeefb>'),o(s.ssrRenderComponent(e.unref(b),{class:"w-3 h-3"},null,c)),o(`<span data-v-fbffeefb>${s.ssrInterpolate(0===a.bono_activo.sesiones_restantes?"Agotado":"Renovar")}</span></div>`)):o("\x3c!----\x3e"),o("</div>")):o('<span class="sin-bono" data-v-fbffeefb>Sin bono</span>'),o(`</div></td><td class="td-sesiones" data-v-fbffeefb><div class="sesiones-info" data-v-fbffeefb><span class="sesiones-total-num" data-v-fbffeefb>${s.ssrInterpolate(a.total_citas||0)}</span><span class="sesiones-label" data-v-fbffeefb>${s.ssrInterpolate(a.sesiones_completadas||0)} completadas</span></div></td><td class="td-estado" data-v-fbffeefb><span class="${s.ssrRenderClass([getEstadoConfig(a.estado,a.activo).class,"estado-badge"])}" data-v-fbffeefb><span class="estado-dot" data-v-fbffeefb></span> ${s.ssrInterpolate(getEstadoConfig(a.estado,a.activo).label)}</span></td><td class="td-acciones" data-v-fbffeefb><div class="acciones-group" data-v-fbffeefb>`),a.telefono?o('<button class="btn-accion btn-whatsapp" title="WhatsApp" data-v-fbffeefb><svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24" data-v-fbffeefb><path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.890-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413Z" data-v-fbffeefb></path></svg></button>'):o("\x3c!----\x3e"),o('<button class="btn-accion btn-ver" title="Ver detalles" data-v-fbffeefb>'),o(s.ssrRenderComponent(e.unref(i),{class:"w-5 h-5"},null,c)),o('</button><div class="menu-wrapper" data-v-fbffeefb><button class="btn-accion btn-menu" title="Más opciones" data-v-fbffeefb>'),o(s.ssrRenderComponent(e.unref(A),{class:"w-5 h-5"},null,c)),o("</button>"),e.unref(n)===a.id?(o('<div class="menu-dropdown" data-v-fbffeefb><button class="menu-item" data-v-fbffeefb>'),o(s.ssrRenderComponent(e.unref($),{class:"w-4 h-4"},null,c)),o(' Editar paciente </button><button class="menu-item menu-item-danger" data-v-fbffeefb>'),o(s.ssrRenderComponent(e.unref(C),{class:"w-4 h-4"},null,c)),o(" Eliminar paciente </button></div>")):o("\x3c!----\x3e"),o("</div></div></td></tr>")}),o("\x3c!--]--\x3e</tbody></table></div>"),e.unref(r)>1?(o(`<div class="paginacion" data-v-fbffeefb><div class="paginacion-info" data-v-fbffeefb> Mostrando ${s.ssrInterpolate((a.paginaActual-1)*a.porPagina+1)} - ${s.ssrInterpolate(Math.min(a.paginaActual*a.porPagina,a.pacientes.length))} de ${s.ssrInterpolate(a.pacientes.length)}</div><div class="paginacion-controles" data-v-fbffeefb><button${s.ssrIncludeBooleanAttr(1===a.paginaActual)?" disabled":""} class="pag-btn" data-v-fbffeefb><svg class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" data-v-fbffeefb><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" data-v-fbffeefb></path></svg></button>\x3c!--[--\x3e`),s.ssrRenderList(e.unref(r),t=>{o("\x3c!--[--\x3e"),1===t||t===e.unref(r)||t>=a.paginaActual-1&&t<=a.paginaActual+1?o(`<button class="${s.ssrRenderClass([{active:t===a.paginaActual},"pag-btn pag-num"])}" data-v-fbffeefb>${s.ssrInterpolate(t)}</button>`):t===a.paginaActual-2||t===a.paginaActual+2?o('<span class="pag-dots" data-v-fbffeefb> ... </span>'):o("\x3c!----\x3e"),o("\x3c!--]--\x3e")}),o(`\x3c!--]--\x3e<button${s.ssrIncludeBooleanAttr(a.paginaActual===e.unref(r))?" disabled":""} class="pag-btn" data-v-fbffeefb><svg class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" data-v-fbffeefb><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" data-v-fbffeefb></path></svg></button></div></div>`)):o("\x3c!----\x3e"),o("\x3c!--]--\x3e")),o("</div>")}}}),D=F.setup;F.setup=(a,s)=>{const t=e.useSSRContext();return(t.modules||(t.modules=new Set)).add("components/pacientes/PacientesTabla.vue"),D?D(a,s):void 0};const H=Object.assign(c(F,[["__scopeId","data-v-fbffeefb"]]),{__name:"PacientesTabla"}),z=e.defineComponent({__name:"pacientes",__ssrInlineRender:!0,setup(t){const n=I();a();const r=e.ref(!0),l=e.ref([]),i=e.ref([]),d=e.ref(""),c=e.ref(""),v=e.ref(""),u=e.ref(""),h=e.ref(1),_=e.ref(15),A=e.ref(!1),C=e.ref(!1),E=e.ref({nombre_completo:"",email:"",telefono:"+34 ",terapeuta_id:null,notas:"",activo:!0,tiene_bono_existente:!1,bono:{tipo:"",sesiones_totales:0,sesiones_consumidas:0,fecha_compra:null,monto_total:0,estado_pago:"pagado"}}),q=e.ref(null),S=e.ref(!1),j=e.ref(!1),T=e.ref({}),k=e.ref(!1),F=e.computed(()=>l.value.length),D=e.computed(()=>l.value.filter(e=>"activo"===e.estado||e.activo).length),z=e.computed(()=>l.value.filter(e=>e.bono_activo&&e.bono_activo.sesiones_restantes>0).length),G=e.computed(()=>l.value.filter(e=>e.bono_activo&&e.bono_activo.sesiones_restantes<=1).length),U=e.computed(()=>{let e=[...l.value];if(d.value.trim()){const a=d.value.toLowerCase();e=e.filter(e=>e.nombre_completo?.toLowerCase().includes(a)||e.email?.toLowerCase().includes(a)||e.telefono?.includes(a))}return"activo"===c.value?e=e.filter(e=>"activo"===e.estado||e.activo):"inactivo"===c.value&&(e=e.filter(e=>"inactivo"===e.estado||!e.activo)),v.value&&(e=e.filter(e=>e.terapeuta_id===v.value)),"con-bono"===u.value?e=e.filter(e=>e.bono_activo&&e.bono_activo.sesiones_restantes>0):"sin-bono"===u.value?e=e.filter(e=>!e.bono_activo):"por-agotar"===u.value&&(e=e.filter(e=>e.bono_activo&&e.bono_activo.sesiones_restantes<=2)),e}),formatearFechaCorta=e=>{if(!e)return"No especificada";return new Date(e).toLocaleDateString("es-ES",{day:"2-digit",month:"short",year:"numeric"})},limpiarFiltros=()=>{d.value="",c.value="",v.value="",u.value="",h.value=1},handleImportar=()=>{alert("Funcionalidad de importación próximamente")},handleExportar=()=>{alert("Funcionalidad de exportación próximamente")},verDetallePaciente=e=>{q.value=e,S.value=!0,j.value=!1},enviarWhatsApp=e=>{if(!e.telefono)return void alert("Este paciente no tiene teléfono registrado");const a=e.telefono.replace(/\D/g,""),s=encodeURIComponent(`Hola ${e.nombre_completo}, te escribo desde el consultorio de Psicóloga Karem.`);(void 0).open(`https://wa.me/${a}?text=${s}`,"_blank")},confirmarEliminarPaciente=e=>{confirm(`⚠️ ¿Estás seguro de que deseas eliminar a ${e.nombre_completo}?\n\nEsta acción eliminará:\n• El paciente\n• Todos sus bonos\n• Todas sus citas\n• Todo su historial\n\nEsta acción NO se puede deshacer.`)&&eliminarPaciente(e)},eliminarPaciente=async e=>{try{await n.from("bonos").delete().eq("paciente_id",e.id),await n.from("citas").delete().eq("paciente_id",e.id);const{error:a}=await n.from("pacientes").delete().eq("id",e.id);if(a)throw a;alert(`✅ Paciente ${e.nombre_completo} eliminado exitosamente`),await cargarPacientes()}catch(e){console.error("Error al eliminar paciente:",e),alert(`❌ Error al eliminar el paciente: ${e.message}`)}},cargarPacientes=async()=>{r.value=!0;try{const{data:e,error:a}=await n.from("pacientes").select("*").order("nombre_completo",{ascending:!0});if(a)throw a;if(!e)return void(l.value=[]);const s=[...new Set(e.map(e=>e.terapeuta_id).filter(Boolean))],t=new Map;if(s.length>0){const{data:e}=await n.from("terapeutas").select("id, nombre_completo").in("id",s);e?.forEach(e=>t.set(e.id,e.nombre_completo))}const o=await Promise.all(e.map(async e=>{const{data:a}=await n.from("bonos").select("id, sesiones_totales, sesiones_restantes, created_at, estado").eq("paciente_id",e.id).in("estado",["activo","pendiente"]).gt("sesiones_restantes",0).order("created_at",{ascending:!1}).limit(1).maybeSingle(),{count:s}=await n.from("citas").select("*",{count:"exact",head:!0}).eq("paciente_id",e.id),{count:o}=await n.from("citas").select("*",{count:"exact",head:!0}).eq("paciente_id",e.id).eq("estado","realizada");return{...e,terapeuta_nombre:t.get(e.terapeuta_id)||null,estado:e.activo?"activo":"inactivo",total_citas:s||0,sesiones_completadas:o||0,bono_activo:a?{...a,fecha_compra:a.created_at}:null}}));l.value=o}catch(e){console.error("Error al cargar pacientes:",e),l.value=[]}finally{r.value=!1}};return(a,t,n,l)=>{const I=L,V=M,Z=N,W=H;t(`<div${s.ssrRenderAttrs(e.mergeProps({class:"pacientes-page"},l))} data-v-56b06e95>`),t(s.ssrRenderComponent(I,{busqueda:e.unref(d),"onUpdate:busqueda":a=>e.isRef(d)?d.value=a:null,"total-pacientes":e.unref(F),"pacientes-activos":e.unref(D),onNuevoPaciente:e=>A.value=!0,onImportar:handleImportar,onExportar:handleExportar},null,n)),t(s.ssrRenderComponent(V,{"total-pacientes":e.unref(F),"pacientes-activos":e.unref(D),"bonos-activos":e.unref(z),"bonos-por-agotar":e.unref(G)},null,n)),t(s.ssrRenderComponent(Z,{"filtro-estado":e.unref(c),"onUpdate:filtroEstado":a=>e.isRef(c)?c.value=a:null,"filtro-terapeuta":e.unref(v),"onUpdate:filtroTerapeuta":a=>e.isRef(v)?v.value=a:null,"filtro-bono":e.unref(u),"onUpdate:filtroBono":a=>e.isRef(u)?u.value=a:null,terapeutas:e.unref(i),"total-resultados":e.unref(U).length,"total-pacientes":e.unref(F),onLimpiarFiltros:limpiarFiltros},null,n)),t(s.ssrRenderComponent(W,{pacientes:e.unref(U),cargando:e.unref(r),"pagina-actual":e.unref(h),"por-pagina":e.unref(_),onVerDetalle:verDetallePaciente,onEditar:e=>{verDetallePaciente(e),T.value={nombre_completo:q.value.nombre_completo||"",email:q.value.email||"",telefono:q.value.telefono||"",terapeuta_id:q.value.terapeuta_id||null,area_de_acompanamiento:q.value.area_de_acompanamiento||"",frecuencia:q.value.frecuencia||"",activo:q.value.activo??!0},j.value=!0},onEliminar:confirmarEliminarPaciente,onWhatsapp:enviarWhatsApp,onCambiarPagina:e=>h.value=e},null,n)),s.ssrRenderTeleport(t,a=>{var t,r;e.unref(S)&&e.unref(q)?(a(`<div class="modal-overlay" data-v-56b06e95><div class="modal-container" data-v-56b06e95><div class="modal-header" data-v-56b06e95><div class="modal-header-left" data-v-56b06e95><div class="modal-avatar" data-v-56b06e95>${s.ssrInterpolate((r=e.unref(q).nombre_completo,r?r.split(" ").map(e=>e[0]).join("").toUpperCase().substring(0,2):"PA"))}</div><div class="modal-title-group" data-v-56b06e95><h2 class="modal-title" data-v-56b06e95>${s.ssrInterpolate(e.unref(q).nombre_completo)}</h2><p class="modal-subtitle" data-v-56b06e95>${s.ssrInterpolate(e.unref(j)?"Editando información del paciente":"Información del paciente")}</p></div></div><div class="modal-header-actions" data-v-56b06e95>`),e.unref(j)?a("\x3c!----\x3e"):(a('<button class="modal-btn-icon" title="Editar paciente" data-v-56b06e95>'),a(s.ssrRenderComponent(e.unref($),{class:"w-5 h-5"},null,n)),a("</button>")),a('<button class="modal-btn-icon" data-v-56b06e95>'),a(s.ssrRenderComponent(e.unref(o),{class:"w-6 h-6"},null,n)),a('</button></div></div><div class="modal-body" data-v-56b06e95>'),e.unref(j)?(a('<div class="edit-form" data-v-56b06e95><div class="edit-alert" data-v-56b06e95>'),a(s.ssrRenderComponent(e.unref(m),{class:"w-5 h-5"},null,n)),a('<div data-v-56b06e95><p class="edit-alert-title" data-v-56b06e95>Modo de edición activado</p><p class="edit-alert-text" data-v-56b06e95>Modifica los campos necesarios y guarda los cambios</p></div></div><div class="form-section" data-v-56b06e95><h3 class="form-section-title" data-v-56b06e95>'),a(s.ssrRenderComponent(e.unref(x),{class:"w-5 h-5"},null,n)),a(` Información Personal </h3><div class="form-grid" data-v-56b06e95><div class="form-field" data-v-56b06e95><label class="form-label" data-v-56b06e95>Nombre Completo <span class="required" data-v-56b06e95>*</span></label><input${s.ssrRenderAttr("value",e.unref(T).nombre_completo)} type="text" class="form-input" placeholder="Nombre completo" data-v-56b06e95></div><div class="form-field" data-v-56b06e95><label class="form-label" data-v-56b06e95>Email <span class="required" data-v-56b06e95>*</span></label><input${s.ssrRenderAttr("value",e.unref(T).email)} type="email" class="form-input" placeholder="correo@ejemplo.com" data-v-56b06e95></div><div class="form-field" data-v-56b06e95><label class="form-label" data-v-56b06e95>Teléfono</label><input${s.ssrRenderAttr("value",e.unref(T).telefono)} type="tel" class="form-input" placeholder="+34 600 000 000" data-v-56b06e95></div><div class="form-field" data-v-56b06e95><label class="form-label" data-v-56b06e95>Terapeuta Asignado</label><select class="form-select" data-v-56b06e95><option${s.ssrRenderAttr("value",null)} data-v-56b06e95${s.ssrIncludeBooleanAttr(Array.isArray(e.unref(T).terapeuta_id)?s.ssrLooseContain(e.unref(T).terapeuta_id,null):s.ssrLooseEqual(e.unref(T).terapeuta_id,null))?" selected":""}>Sin asignar</option>\x3c!--[--\x3e`),s.ssrRenderList(e.unref(i),t=>{a(`<option${s.ssrRenderAttr("value",t.id)} data-v-56b06e95${s.ssrIncludeBooleanAttr(Array.isArray(e.unref(T).terapeuta_id)?s.ssrLooseContain(e.unref(T).terapeuta_id,t.id):s.ssrLooseEqual(e.unref(T).terapeuta_id,t.id))?" selected":""}>${s.ssrInterpolate(t.nombre)}</option>`)}),a(`\x3c!--]--\x3e</select></div><div class="form-field" data-v-56b06e95><label class="form-label" data-v-56b06e95>Área de Acompañamiento</label><input${s.ssrRenderAttr("value",e.unref(T).area_de_acompanamiento)} type="text" class="form-input" placeholder="Ej: Ansiedad, Depresión" data-v-56b06e95></div><div class="form-field" data-v-56b06e95><label class="form-label" data-v-56b06e95>Frecuencia</label><select class="form-select" data-v-56b06e95><option value="" data-v-56b06e95${s.ssrIncludeBooleanAttr(Array.isArray(e.unref(T).frecuencia)?s.ssrLooseContain(e.unref(T).frecuencia,""):s.ssrLooseEqual(e.unref(T).frecuencia,""))?" selected":""}>Seleccionar...</option><option value="semanal" data-v-56b06e95${s.ssrIncludeBooleanAttr(Array.isArray(e.unref(T).frecuencia)?s.ssrLooseContain(e.unref(T).frecuencia,"semanal"):s.ssrLooseEqual(e.unref(T).frecuencia,"semanal"))?" selected":""}>Semanal</option><option value="quincenal" data-v-56b06e95${s.ssrIncludeBooleanAttr(Array.isArray(e.unref(T).frecuencia)?s.ssrLooseContain(e.unref(T).frecuencia,"quincenal"):s.ssrLooseEqual(e.unref(T).frecuencia,"quincenal"))?" selected":""}>Quincenal</option><option value="mensual" data-v-56b06e95${s.ssrIncludeBooleanAttr(Array.isArray(e.unref(T).frecuencia)?s.ssrLooseContain(e.unref(T).frecuencia,"mensual"):s.ssrLooseEqual(e.unref(T).frecuencia,"mensual"))?" selected":""}>Mensual</option><option value="ocasional" data-v-56b06e95${s.ssrIncludeBooleanAttr(Array.isArray(e.unref(T).frecuencia)?s.ssrLooseContain(e.unref(T).frecuencia,"ocasional"):s.ssrLooseEqual(e.unref(T).frecuencia,"ocasional"))?" selected":""}>Ocasional</option></select></div></div></div><div class="form-section" data-v-56b06e95><h3 class="form-section-title" data-v-56b06e95>`),a(s.ssrRenderComponent(e.unref(f),{class:"w-5 h-5"},null,n)),a(` Estado del Paciente </h3><div class="toggle-field" data-v-56b06e95><input${s.ssrIncludeBooleanAttr(Array.isArray(e.unref(T).activo)?s.ssrLooseContain(e.unref(T).activo,null):e.unref(T).activo)?" checked":""} type="checkbox" id="activo-edicion" class="toggle-input" data-v-56b06e95><label for="activo-edicion" class="toggle-label" data-v-56b06e95> Paciente activo </label><span class="toggle-status" data-v-56b06e95>${s.ssrInterpolate(e.unref(T).activo?"Activo":"Inactivo")}</span></div></div><div class="form-actions" data-v-56b06e95><button${s.ssrIncludeBooleanAttr(e.unref(k))?" disabled":""} class="btn btn-secondary" data-v-56b06e95> Cancelar </button><button${s.ssrIncludeBooleanAttr(e.unref(k))?" disabled":""} class="btn btn-primary" data-v-56b06e95>`),e.unref(k)?a(s.ssrRenderComponent(e.unref(y),{class:"w-4 h-4 animate-spin"},null,n)):a(s.ssrRenderComponent(e.unref(g),{class:"w-4 h-4"},null,n)),a(` ${s.ssrInterpolate(e.unref(k)?"Guardando...":"Guardar Cambios")}</button></div></div>`)):(a(`<div class="detail-view" data-v-56b06e95><div class="detail-header" data-v-56b06e95><div class="detail-badges" data-v-56b06e95><span class="${s.ssrRenderClass([e.unref(q).activo?"badge-success":"badge-gray","badge"])}" data-v-56b06e95><span class="badge-dot" data-v-56b06e95></span> ${s.ssrInterpolate(e.unref(q).activo?"Activo":"Inactivo")}</span>`),e.unref(q).bono_activo?(a('<span class="badge badge-purple" data-v-56b06e95>'),a(s.ssrRenderComponent(e.unref(p),{class:"w-4 h-4"},null,n)),a(` Bono: ${s.ssrInterpolate(e.unref(q).bono_activo.sesiones_restantes)}/${s.ssrInterpolate(e.unref(q).bono_activo.sesiones_totales)}</span>`)):a("\x3c!----\x3e"),a('</div><div class="detail-actions" data-v-56b06e95>'),e.unref(q).telefono?a('<button class="btn btn-whatsapp" data-v-56b06e95><svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24" data-v-56b06e95><path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.890-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413Z" data-v-56b06e95></path></svg> WhatsApp </button>'):a("\x3c!----\x3e"),a('<button class="btn btn-primary" data-v-56b06e95>'),a(s.ssrRenderComponent(e.unref(R),{class:"w-4 h-4"},null,n)),a(' Historial Completo </button></div></div><div class="detail-section" data-v-56b06e95><h3 class="detail-section-title" data-v-56b06e95>'),a(s.ssrRenderComponent(e.unref(x),{class:"w-5 h-5"},null,n)),a(` Información Personal </h3><div class="info-grid" data-v-56b06e95><div class="info-card" data-v-56b06e95><span class="info-label" data-v-56b06e95>Nombre Completo</span><span class="info-value" data-v-56b06e95>${s.ssrInterpolate(e.unref(q).nombre_completo||"No especificado")}</span></div><div class="info-card" data-v-56b06e95><span class="info-label" data-v-56b06e95>Email</span><span class="info-value" data-v-56b06e95>${s.ssrInterpolate(e.unref(q).email||"No especificado")}</span></div><div class="info-card" data-v-56b06e95><span class="info-label" data-v-56b06e95>Teléfono</span><span class="info-value" data-v-56b06e95>${s.ssrInterpolate(e.unref(q).telefono||"No especificado")}</span></div><div class="info-card" data-v-56b06e95><span class="info-label" data-v-56b06e95>Terapeuta Asignado</span><span class="info-value" data-v-56b06e95>${s.ssrInterpolate(e.unref(q).terapeuta_nombre||"Sin asignar")}</span></div><div class="info-card" data-v-56b06e95><span class="info-label" data-v-56b06e95>Área de Acompañamiento</span><span class="info-value" data-v-56b06e95>${s.ssrInterpolate(e.unref(q).area_de_acompanamiento||"No especificado")}</span></div><div class="info-card" data-v-56b06e95><span class="info-label" data-v-56b06e95>Frecuencia</span><span class="info-value capitalize" data-v-56b06e95>${s.ssrInterpolate(e.unref(q).frecuencia||"No especificada")}</span></div></div></div><div class="detail-section" data-v-56b06e95><h3 class="detail-section-title" data-v-56b06e95>`),a(s.ssrRenderComponent(e.unref(w),{class:"w-5 h-5"},null,n)),a(` Estadísticas de Sesiones </h3><div class="stats-grid" data-v-56b06e95><div class="stat-card stat-blue" data-v-56b06e95><span class="stat-value" data-v-56b06e95>${s.ssrInterpolate(e.unref(q).total_citas||0)}</span><span class="stat-label" data-v-56b06e95>Total Citas</span></div><div class="stat-card stat-green" data-v-56b06e95><span class="stat-value" data-v-56b06e95>${s.ssrInterpolate(e.unref(q).sesiones_completadas||0)}</span><span class="stat-label" data-v-56b06e95>Completadas</span></div><div class="stat-card stat-purple" data-v-56b06e95><span class="stat-value" data-v-56b06e95>${s.ssrInterpolate(e.unref(q).bono_activo?.sesiones_restantes||0)}</span><span class="stat-label" data-v-56b06e95>Restantes</span></div><div class="stat-card stat-orange" data-v-56b06e95><span class="stat-value" data-v-56b06e95>${s.ssrInterpolate(e.unref(q).bono_activo?.sesiones_totales||0)}</span><span class="stat-label" data-v-56b06e95>Total Bono</span></div></div></div>`),e.unref(q).bono_activo?(a('<div class="detail-section" data-v-56b06e95><h3 class="detail-section-title" data-v-56b06e95>'),a(s.ssrRenderComponent(e.unref(p),{class:"w-5 h-5"},null,n)),a(` Bono Activo </h3><div class="bono-card" data-v-56b06e95><div class="bono-header" data-v-56b06e95><div data-v-56b06e95><p class="bono-label" data-v-56b06e95>Progreso del Bono</p><p class="bono-value" data-v-56b06e95>${s.ssrInterpolate(e.unref(q).bono_activo.sesiones_restantes)} / ${s.ssrInterpolate(e.unref(q).bono_activo.sesiones_totales)}</p><p class="bono-subtext" data-v-56b06e95>sesiones disponibles</p></div><div class="bono-percent" data-v-56b06e95><span class="percent-value" data-v-56b06e95>${s.ssrInterpolate(Math.round((e.unref(q).bono_activo.sesiones_totales-e.unref(q).bono_activo.sesiones_restantes)/e.unref(q).bono_activo.sesiones_totales*100))}%</span><span class="percent-label" data-v-56b06e95>consumido</span></div></div><div class="bono-progress" data-v-56b06e95><div style="${s.ssrRenderStyle({width:(e.unref(q).bono_activo.sesiones_totales-e.unref(q).bono_activo.sesiones_restantes)/e.unref(q).bono_activo.sesiones_totales*100+"%"})}" class="${s.ssrRenderClass([(t=e.unref(q).bono_activo.sesiones_restantes,0===t?"bg-red":1===t?"bg-orange":2===t?"bg-amber":"bg-green"),"bono-progress-bar"])}" data-v-56b06e95></div></div>`),e.unref(q).bono_activo.sesiones_restantes<=1?(a('<div class="bono-alert" data-v-56b06e95>'),a(s.ssrRenderComponent(e.unref(b),{class:"w-5 h-5"},null,n)),a(`<div data-v-56b06e95><p class="bono-alert-title" data-v-56b06e95>${s.ssrInterpolate(0===e.unref(q).bono_activo.sesiones_restantes?"Bono agotado":"Solo queda 1 sesión")}</p><p class="bono-alert-text" data-v-56b06e95>Se recomienda renovar el bono para continuar las sesiones</p></div></div>`)):a("\x3c!----\x3e"),a("</div></div>")):a("\x3c!----\x3e"),a('<div class="detail-section" data-v-56b06e95><h3 class="detail-section-title" data-v-56b06e95>'),a(s.ssrRenderComponent(e.unref(P),{class:"w-5 h-5"},null,n)),a(` Fechas del Sistema </h3><div class="info-grid cols-2" data-v-56b06e95><div class="info-card" data-v-56b06e95><span class="info-label" data-v-56b06e95>Fecha de Registro</span><span class="info-value" data-v-56b06e95>${s.ssrInterpolate(formatearFechaCorta(e.unref(q).created_at))}</span></div>`),e.unref(q).updated_at?a(`<div class="info-card" data-v-56b06e95><span class="info-label" data-v-56b06e95>Última Actualización</span><span class="info-value" data-v-56b06e95>${s.ssrInterpolate(formatearFechaCorta(e.unref(q).updated_at))}</span></div>`):a("\x3c!----\x3e"),a("</div></div></div>")),a('</div><div class="modal-footer" data-v-56b06e95><button class="btn btn-secondary" data-v-56b06e95> Cerrar </button>'),e.unref(j)?a("\x3c!----\x3e"):(a('<button class="btn btn-primary" data-v-56b06e95> Ver Historial Completo '),a(s.ssrRenderComponent(e.unref(B),{class:"w-4 h-4"},null,n)),a("</button>")),a("</div></div></div>")):a("\x3c!----\x3e")},"body",!1,n),s.ssrRenderTeleport(t,a=>{e.unref(A)?(a('<div class="modal-overlay" data-v-56b06e95><div class="modal-container modal-lg" data-v-56b06e95><div class="modal-header" data-v-56b06e95><h2 class="modal-title" data-v-56b06e95>Crear Nuevo Paciente</h2><button class="modal-btn-icon" data-v-56b06e95>'),a(s.ssrRenderComponent(e.unref(o),{class:"w-5 h-5"},null,n)),a(`</button></div><form class="modal-body" data-v-56b06e95><div class="form-section" data-v-56b06e95><h3 class="form-section-title" data-v-56b06e95>Información Personal</h3><div class="form-grid" data-v-56b06e95><div class="form-field" data-v-56b06e95><label class="form-label" data-v-56b06e95>Nombre Completo <span class="required" data-v-56b06e95>*</span></label><input${s.ssrRenderAttr("value",e.unref(E).nombre_completo)} type="text" required class="form-input" placeholder="Ej: Juan Pérez García" data-v-56b06e95></div><div class="form-field" data-v-56b06e95><label class="form-label" data-v-56b06e95>Email <span class="required" data-v-56b06e95>*</span></label><input${s.ssrRenderAttr("value",e.unref(E).email)} type="email" required class="form-input" placeholder="correo@ejemplo.com" data-v-56b06e95></div><div class="form-field" data-v-56b06e95><label class="form-label" data-v-56b06e95>Teléfono <span class="required" data-v-56b06e95>*</span></label><input${s.ssrRenderAttr("value",e.unref(E).telefono)} type="tel" required class="form-input" placeholder="+34 612 345 678" data-v-56b06e95></div></div></div><div class="form-section" data-v-56b06e95><h3 class="form-section-title" data-v-56b06e95>Asignación</h3><div class="form-field" data-v-56b06e95><label class="form-label" data-v-56b06e95>Terapeuta Asignado</label><select class="form-select" data-v-56b06e95><option${s.ssrRenderAttr("value",null)} data-v-56b06e95${s.ssrIncludeBooleanAttr(Array.isArray(e.unref(E).terapeuta_id)?s.ssrLooseContain(e.unref(E).terapeuta_id,null):s.ssrLooseEqual(e.unref(E).terapeuta_id,null))?" selected":""}>Sin asignar</option>\x3c!--[--\x3e`),s.ssrRenderList(e.unref(i),t=>{a(`<option${s.ssrRenderAttr("value",t.id)} data-v-56b06e95${s.ssrIncludeBooleanAttr(Array.isArray(e.unref(E).terapeuta_id)?s.ssrLooseContain(e.unref(E).terapeuta_id,t.id):s.ssrLooseEqual(e.unref(E).terapeuta_id,t.id))?" selected":""}>${s.ssrInterpolate(t.nombre)}</option>`)}),a('\x3c!--]--\x3e</select></div></div><div class="form-section bono-migration" data-v-56b06e95><div class="bono-migration-header" data-v-56b06e95>'),a(s.ssrRenderComponent(e.unref(m),{class:"w-5 h-5"},null,n)),a(`<div data-v-56b06e95><h3 class="form-section-title mb-0" data-v-56b06e95>Migración de Datos (Opcional)</h3><p class="form-section-hint" data-v-56b06e95>Si el paciente viene con un bono existente, completa esta información</p></div><input${s.ssrIncludeBooleanAttr(Array.isArray(e.unref(E).tiene_bono_existente)?s.ssrLooseContain(e.unref(E).tiene_bono_existente,null):e.unref(E).tiene_bono_existente)?" checked":""} type="checkbox" class="toggle-checkbox" data-v-56b06e95></div>`),e.unref(E).tiene_bono_existente?a(`<div class="bono-migration-form" data-v-56b06e95><div class="form-grid" data-v-56b06e95><div class="form-field" data-v-56b06e95><label class="form-label" data-v-56b06e95>Tipo de Bono <span class="required" data-v-56b06e95>*</span></label><select required class="form-select" data-v-56b06e95><option value="" data-v-56b06e95${s.ssrIncludeBooleanAttr(Array.isArray(e.unref(E).bono.tipo)?s.ssrLooseContain(e.unref(E).bono.tipo,""):s.ssrLooseEqual(e.unref(E).bono.tipo,""))?" selected":""}>Seleccionar...</option><option value="semanal" data-v-56b06e95${s.ssrIncludeBooleanAttr(Array.isArray(e.unref(E).bono.tipo)?s.ssrLooseContain(e.unref(E).bono.tipo,"semanal"):s.ssrLooseEqual(e.unref(E).bono.tipo,"semanal"))?" selected":""}>Semanal (4 sesiones/mes)</option><option value="quincenal" data-v-56b06e95${s.ssrIncludeBooleanAttr(Array.isArray(e.unref(E).bono.tipo)?s.ssrLooseContain(e.unref(E).bono.tipo,"quincenal"):s.ssrLooseEqual(e.unref(E).bono.tipo,"quincenal"))?" selected":""}>Quincenal (2 sesiones/mes)</option><option value="mensual" data-v-56b06e95${s.ssrIncludeBooleanAttr(Array.isArray(e.unref(E).bono.tipo)?s.ssrLooseContain(e.unref(E).bono.tipo,"mensual"):s.ssrLooseEqual(e.unref(E).bono.tipo,"mensual"))?" selected":""}>Mensual (1 sesión/mes)</option></select></div><div class="form-field" data-v-56b06e95><label class="form-label" data-v-56b06e95>Sesiones Totales</label><input${s.ssrRenderAttr("value",e.unref(E).bono.sesiones_totales)} type="number" disabled class="form-input disabled" data-v-56b06e95></div><div class="form-field" data-v-56b06e95><label class="form-label" data-v-56b06e95>Sesiones Consumidas <span class="required" data-v-56b06e95>*</span></label><input${s.ssrRenderAttr("value",e.unref(E).bono.sesiones_consumidas)} type="number" min="0"${s.ssrRenderAttr("max",e.unref(E).bono.sesiones_totales||0)} required${s.ssrIncludeBooleanAttr(!e.unref(E).bono.tipo)?" disabled":""} class="form-input" data-v-56b06e95></div><div class="form-field" data-v-56b06e95><label class="form-label" data-v-56b06e95>Fecha del Último Pago</label><input${s.ssrRenderAttr("value",e.unref(E).bono.fecha_compra)} type="date" class="form-input" data-v-56b06e95></div><div class="form-field" data-v-56b06e95><label class="form-label" data-v-56b06e95>Monto Pagado (€)</label><input${s.ssrRenderAttr("value",e.unref(E).bono.monto_total)} type="number" min="0" step="0.01" class="form-input" placeholder="0.00" data-v-56b06e95></div><div class="form-field" data-v-56b06e95><label class="form-label" data-v-56b06e95>Estado del Pago</label><select class="form-select" data-v-56b06e95><option value="pagado" data-v-56b06e95${s.ssrIncludeBooleanAttr(Array.isArray(e.unref(E).bono.estado_pago)?s.ssrLooseContain(e.unref(E).bono.estado_pago,"pagado"):s.ssrLooseEqual(e.unref(E).bono.estado_pago,"pagado"))?" selected":""}>Pagado</option><option value="pendiente" data-v-56b06e95${s.ssrIncludeBooleanAttr(Array.isArray(e.unref(E).bono.estado_pago)?s.ssrLooseContain(e.unref(E).bono.estado_pago,"pendiente"):s.ssrLooseEqual(e.unref(E).bono.estado_pago,"pendiente"))?" selected":""}>Pendiente</option><option value="parcial" data-v-56b06e95${s.ssrIncludeBooleanAttr(Array.isArray(e.unref(E).bono.estado_pago)?s.ssrLooseContain(e.unref(E).bono.estado_pago,"parcial"):s.ssrLooseEqual(e.unref(E).bono.estado_pago,"parcial"))?" selected":""}>Pago Parcial</option></select></div></div><div class="bono-summary" data-v-56b06e95><p class="bono-summary-title" data-v-56b06e95>Resumen del Bono:</p><div class="bono-summary-content" data-v-56b06e95><div class="bono-summary-progress" data-v-56b06e95><div class="bono-summary-labels" data-v-56b06e95><span data-v-56b06e95>${s.ssrInterpolate(e.unref(E).bono.sesiones_consumidas||0)} consumidas</span><span data-v-56b06e95>${s.ssrInterpolate((e.unref(E).bono.sesiones_totales||0)-(e.unref(E).bono.sesiones_consumidas||0))} restantes</span></div><div class="bono-summary-bar" data-v-56b06e95><div class="bono-summary-fill" style="${s.ssrRenderStyle({width:(e.unref(E).bono.sesiones_totales>0?e.unref(E).bono.sesiones_consumidas/e.unref(E).bono.sesiones_totales*100:0)+"%"})}" data-v-56b06e95></div></div></div><div class="bono-summary-count" data-v-56b06e95><span class="count-value" data-v-56b06e95>${s.ssrInterpolate((e.unref(E).bono.sesiones_totales||0)-(e.unref(E).bono.sesiones_consumidas||0))}</span><span class="count-total" data-v-56b06e95>de ${s.ssrInterpolate(e.unref(E).bono.sesiones_totales||0)}</span></div></div></div></div>`):a("\x3c!----\x3e"),a(`</div><div class="form-section" data-v-56b06e95><h3 class="form-section-title" data-v-56b06e95>Información Adicional</h3><div class="form-field" data-v-56b06e95><label class="form-label" data-v-56b06e95>Notas</label><textarea rows="3" class="form-textarea" placeholder="Notas adicionales sobre el paciente..." data-v-56b06e95>${s.ssrInterpolate(e.unref(E).notas)}</textarea></div><div class="toggle-field" data-v-56b06e95><input${s.ssrIncludeBooleanAttr(Array.isArray(e.unref(E).activo)?s.ssrLooseContain(e.unref(E).activo,null):e.unref(E).activo)?" checked":""} type="checkbox" id="activo-nuevo" class="toggle-input" data-v-56b06e95><label for="activo-nuevo" class="toggle-label" data-v-56b06e95>Paciente Activo</label></div></div><div class="form-actions" data-v-56b06e95><button type="button" class="btn btn-secondary" data-v-56b06e95> Cancelar </button><button type="submit"${s.ssrIncludeBooleanAttr(e.unref(C))?" disabled":""} class="btn btn-primary" data-v-56b06e95>`),e.unref(C)?a(s.ssrRenderComponent(e.unref(y),{class:"w-4 h-4 animate-spin"},null,n)):a("\x3c!----\x3e"),a(` ${s.ssrInterpolate(e.unref(C)?"Creando...":"Crear Paciente")}</button></div></form></div></div>`)):a("\x3c!----\x3e")},"body",!1,n),t("</div>")}}}),G=z.setup;z.setup=(a,s)=>{const t=e.useSSRContext();return(t.modules||(t.modules=new Set)).add("pages/coordinadora/pacientes.vue"),G?G(a,s):void 0};const U=c(z,[["__scopeId","data-v-56b06e95"]]);export{U as default};
//# sourceMappingURL=pacientes-BPHgcqbn.mjs.map
