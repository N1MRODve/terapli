import{v as e,s as t}from"./server.mjs";import{u as s}from"./useSupabaseClient-DykwVqLQ.mjs";import{r}from"./UserGroupIcon-BhthmHUw.mjs";import{r as o}from"./TicketIcon-zZdrc71S.mjs";import{r as a}from"./ChartBarIcon-BEEST7f0.mjs";import"entities/lib/decode.js";import"../routes/renderer.mjs";import"../nitro/nitro.mjs";import"node:http";import"node:https";import"node:events";import"node:buffer";import"node:fs";import"node:path";import"node:crypto";import"../_/shared.cjs.prod.mjs";import"estree-walker";import"source-map-js";import"node:stream";import"devalue";import"@supabase/ssr";import"@vercel/analytics/nuxt";function render(t,s){return e.openBlock(),e.createElementBlock("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e.createElementVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M14.25 7.756a4.5 4.5 0 1 0 0 8.488M7.5 10.5h5.25m-5.25 3h5.25M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})])}const n=e.defineComponent({__name:"pacientes",__ssrInlineRender:!0,setup(n){s();const l=e.ref(!0),i=e.ref([]),d=e.ref(""),c=e.ref(""),p=e.ref(""),u=e.computed(()=>{const e=new Map;return i.value.forEach(t=>{t.terapeuta_id&&t.terapeuta_nombre&&e.set(t.terapeuta_id,{id:t.terapeuta_id,nombre:t.terapeuta_nombre})}),Array.from(e.values())}),m=e.computed(()=>{let e=[...i.value];if(d.value){const t=d.value.toLowerCase();e=e.filter(e=>e.nombre_completo?.toLowerCase().includes(t)||e.email?.toLowerCase().includes(t))}return c.value&&(e=e.filter(e=>e.terapeuta_id===c.value)),"activo"===p.value?e=e.filter(e=>e.bono_activo):"sin_bono"===p.value&&(e=e.filter(e=>!e.bono_activo)),e}),v=e.computed(()=>i.value.filter(e=>e.bono_activo).length),x=e.computed(()=>i.value.reduce((e,t)=>e+(t.cltv||0),0)),b=e.computed(()=>0===i.value.length?0:x.value/i.value.length),formatNumber=e=>e.toLocaleString("es-ES",{style:"currency",currency:"EUR",minimumFractionDigits:2,maximumFractionDigits:2});return(s,n,g,f)=>{n(`<div${t.ssrRenderAttrs(f)}><div class="mb-8"><h2 class="text-3xl font-bold text-gray-900 mb-2">Gesti√≥n de Pacientes</h2><p class="text-gray-600">Vista completa de todos los pacientes del sistema</p></div>`),l.value?n('<div class="flex items-center justify-center py-20"><div class="text-center"><div class="w-16 h-16 border-4 border-gray-200 border-t-indigo-500 rounded-full animate-spin mx-auto mb-4"></div><p class="text-gray-600 text-sm">Cargando pacientes...</p></div></div>'):(n('\x3c!--[--\x3e<div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8"><div class="bg-gradient-to-br from-blue-50 to-blue-100 rounded-xl p-6 border border-blue-200"><div class="flex items-center justify-between mb-2"><span class="text-sm font-medium text-blue-700">Total Pacientes</span>'),n(t.ssrRenderComponent(e.unref(r),{class:"w-5 h-5 text-blue-600"},null,g)),n(`</div><p class="text-3xl font-bold text-blue-900">${t.ssrInterpolate(i.value.length)}</p></div><div class="bg-gradient-to-br from-green-50 to-green-100 rounded-xl p-6 border border-green-200"><div class="flex items-center justify-between mb-2"><span class="text-sm font-medium text-green-700">Con Bono Activo</span>`),n(t.ssrRenderComponent(e.unref(o),{class:"w-5 h-5 text-green-600"},null,g)),n(`</div><p class="text-3xl font-bold text-green-900">${t.ssrInterpolate(v.value)}</p></div><div class="bg-gradient-to-br from-purple-50 to-purple-100 rounded-xl p-6 border border-purple-200"><div class="flex items-center justify-between mb-2"><span class="text-sm font-medium text-purple-700">CLTV Total</span>`),n(t.ssrRenderComponent(e.unref(render),{class:"w-5 h-5 text-purple-600"},null,g)),n(`</div><p class="text-3xl font-bold text-purple-900">${t.ssrInterpolate(formatNumber(x.value))}</p></div><div class="bg-gradient-to-br from-orange-50 to-orange-100 rounded-xl p-6 border border-orange-200"><div class="flex items-center justify-between mb-2"><span class="text-sm font-medium text-orange-700">CLTV Promedio</span>`),n(t.ssrRenderComponent(e.unref(a),{class:"w-5 h-5 text-orange-600"},null,g)),n(`</div><p class="text-3xl font-bold text-orange-900">${t.ssrInterpolate(formatNumber(b.value))}</p></div></div><div class="bg-white rounded-xl shadow-md border border-gray-200 p-6 mb-6"><div class="grid grid-cols-1 md:grid-cols-3 gap-4"><div><label class="block text-sm font-medium text-gray-700 mb-2">Buscar paciente</label><input${t.ssrRenderAttr("value",d.value)} type="text" placeholder="Nombre o email..." class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent"></div><div><label class="block text-sm font-medium text-gray-700 mb-2">Filtrar por terapeuta</label><select class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent"><option value=""${t.ssrIncludeBooleanAttr(Array.isArray(c.value)?t.ssrLooseContain(c.value,""):t.ssrLooseEqual(c.value,""))?" selected":""}>Todos los terapeutas</option>\x3c!--[--\x3e`),t.ssrRenderList(u.value,e=>{n(`<option${t.ssrRenderAttr("value",e.id)}${t.ssrIncludeBooleanAttr(Array.isArray(c.value)?t.ssrLooseContain(c.value,e.id):t.ssrLooseEqual(c.value,e.id))?" selected":""}>${t.ssrInterpolate(e.nombre)}</option>`)}),n(`\x3c!--]--\x3e</select></div><div><label class="block text-sm font-medium text-gray-700 mb-2">Estado del bono</label><select class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent"><option value=""${t.ssrIncludeBooleanAttr(Array.isArray(p.value)?t.ssrLooseContain(p.value,""):t.ssrLooseEqual(p.value,""))?" selected":""}>Todos</option><option value="activo"${t.ssrIncludeBooleanAttr(Array.isArray(p.value)?t.ssrLooseContain(p.value,"activo"):t.ssrLooseEqual(p.value,"activo"))?" selected":""}>Con bono activo</option><option value="sin_bono"${t.ssrIncludeBooleanAttr(Array.isArray(p.value)?t.ssrLooseContain(p.value,"sin_bono"):t.ssrLooseEqual(p.value,"sin_bono"))?" selected":""}>Sin bono activo</option></select></div></div></div><div class="bg-white rounded-xl shadow-md border border-gray-200 overflow-hidden"><div class="overflow-x-auto"><table class="min-w-full divide-y divide-gray-200"><thead class="bg-gray-50"><tr><th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"> Paciente </th><th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"> Terapeuta </th><th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"> Bono Activo </th><th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"> Sesiones </th><th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"> CLTV </th><th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"> Estado </th></tr></thead><tbody class="bg-white divide-y divide-gray-200">\x3c!--[--\x3e`),t.ssrRenderList(m.value,s=>{var r,a;n(`<tr class="hover:bg-gray-50 transition-colors"><td class="px-6 py-4 whitespace-nowrap"><div class="flex items-center"><div class="flex-shrink-0 h-10 w-10 bg-gradient-to-br from-blue-400 to-indigo-500 rounded-full flex items-center justify-center"><span class="text-white font-semibold text-sm">${t.ssrInterpolate((r=s.nombre_completo,r?r.split(" ").map(e=>e[0]).join("").toUpperCase().substring(0,2):"??"))}</span></div><div class="ml-4"><div class="text-sm font-medium text-gray-900">${t.ssrInterpolate(s.nombre_completo)}</div><div class="text-sm text-gray-500">${t.ssrInterpolate(s.email)}</div></div></div></td><td class="px-6 py-4 whitespace-nowrap"><div class="text-sm text-gray-900">${t.ssrInterpolate(s.terapeuta_nombre||"Sin asignar")}</div></td><td class="px-6 py-4 whitespace-nowrap">`),s.bono_activo?(n('<div><div class="flex items-center">'),n(t.ssrRenderComponent(e.unref(o),{class:"w-4 h-4 text-green-600 mr-2"},null,g)),n(`<span class="text-sm font-medium text-gray-900">${t.ssrInterpolate((a=s.bono_tipo,{semanal:"Semanal",quincenal:"Quincenal",mensual:"Mensual",otro:"Otro"}[a]||a))}</span></div><div class="text-xs text-gray-500 mt-1">${t.ssrInterpolate(s.bono_estado)}</div></div>`)):n('<div class="text-sm text-gray-400 italic">Sin bono activo</div>'),n('</td><td class="px-6 py-4 whitespace-nowrap">'),s.bono_activo?n(`<div class="text-sm"><span class="font-semibold text-gray-900">${t.ssrInterpolate(s.sesiones_restantes)}</span><span class="text-gray-500"> / ${t.ssrInterpolate(s.total_sesiones)}</span></div>`):n('<div class="text-sm text-gray-400">-</div>'),n(`</td><td class="px-6 py-4 whitespace-nowrap"><div class="text-sm font-semibold text-indigo-600">${t.ssrInterpolate(formatNumber(s.cltv||0))}</div></td><td class="px-6 py-4 whitespace-nowrap"><span class="${t.ssrRenderClass([s.activo?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800","px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full"])}">${t.ssrInterpolate(s.activo?"Activo":"Inactivo")}</span></td></tr>`)}),n("\x3c!--]--\x3e</tbody></table></div>"),0===m.value.length?(n('<div class="text-center py-12">'),n(t.ssrRenderComponent(e.unref(r),{class:"w-16 h-16 text-gray-300 mx-auto mb-4"},null,g)),n('<p class="text-gray-500 text-sm">No se encontraron pacientes</p></div>')):n("\x3c!----\x3e"),n(`</div><div class="mt-6 text-sm text-gray-500 text-right"> Mostrando ${t.ssrInterpolate(m.value.length)} de ${t.ssrInterpolate(i.value.length)} pacientes </div>\x3c!--]--\x3e`)),n("</div>")}}}),l=n.setup;n.setup=(t,s)=>{const r=e.useSSRContext();return(r.modules||(r.modules=new Set)).add("pages/admin/pacientes.vue"),l?l(t,s):void 0};export{n as default};
//# sourceMappingURL=pacientes-DhP8PS-v.mjs.map
