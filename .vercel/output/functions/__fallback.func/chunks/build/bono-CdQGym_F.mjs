import{_ as e}from"./nuxt-link-C_f1d2Rj.mjs";import{v as t,s}from"./server.mjs";import{u as o}from"./usePacientes-BPAABr51.mjs";import"../nitro/nitro.mjs";import"node:http";import"node:https";import"node:events";import"node:buffer";import"node:fs";import"node:path";import"node:crypto";import"../routes/renderer.mjs";import"../_/shared.cjs.prod.mjs";import"../virtual/_commonjsHelpers.mjs";import"node:stream";import"../_/index2.mjs";import"@supabase/supabase-js";import"@vercel/analytics/nuxt";import"./useSupabaseClient-DykwVqLQ.mjs";const n=t.defineComponent({__name:"bono",__ssrInlineRender:!0,setup(n){o();const a=t.ref(!0),r=t.ref([]),i=t.computed(()=>r.value.find(e=>"activo"===e.estado)),d=t.computed(()=>r.value.filter(e=>"activo"!==e.estado).sort((e,t)=>new Date(t.created_at).getTime()-new Date(e.created_at).getTime())),formatearFecha=e=>e?new Date(e).toLocaleDateString("es-ES",{day:"numeric",month:"long",year:"numeric"}):"",formatearPrecio=e=>{try{return new Intl.NumberFormat("es-ES",{style:"decimal",minimumFractionDigits:2,maximumFractionDigits:2}).format(e)}catch{return e}},estadoBonoTexto=e=>({activo:"Activo",agotado:"Agotado",expirado:"Expirado",cancelado:"Cancelado"}[e]||e),estadoBonoClass=e=>({activo:"bg-green-100 text-green-800",agotado:"bg-red-100 text-red-800",expirado:"bg-gray-100 text-gray-800",cancelado:"bg-orange-100 text-orange-800"}[e]||"bg-gray-100 text-gray-800"),getProgressColor=(e,t)=>{const s=e/t*100;return s>50?"bg-[#5550F2]":s>25?"bg-amber-500":"bg-red-500"};return(o,n,r,l)=>{const c=e;n(`<div${s.ssrRenderAttrs(t.mergeProps({class:"max-w-4xl mx-auto space-y-6 px-4 py-8"},l))}>`),t.unref(a)?n('<div class="flex flex-col items-center justify-center min-h-[40vh]"><div class="animate-spin rounded-full h-12 w-12 border-b-2 border-[#5550F2]"></div><p class="mt-4 text-[#2D3748] opacity-70 font-sans">Cargando tu bono...</p></div>'):(n('<div><header class="mb-8"><h1 class="text-2xl sm:text-3xl font-serif font-medium text-[#2D3748]"> Mi Bono </h1><p class="text-sm text-[#2D3748] opacity-70 font-sans mt-1"> Gestiona y consulta tu bono de sesiones </p></header>'),t.unref(i)?(n(`<section class="bg-white rounded-xl shadow-sm border border-[#E2E8F0]/30 p-6 mb-8"><header class="flex items-center justify-between mb-4"><div><h2 class="text-xl font-serif font-medium text-[#2D3748]">Bono de ${s.ssrInterpolate(t.unref(i).total_sesiones)} Sesiones</h2><p class="text-sm text-[#2D3748] opacity-70 font-sans">Contratado el ${s.ssrInterpolate(formatearFecha(t.unref(i).created_at))}</p></div><div><span class="${s.ssrRenderClass([estadoBonoClass(t.unref(i).estado),"px-3 py-1 rounded-full text-xs font-sans font-medium"])}">${s.ssrInterpolate(estadoBonoTexto(t.unref(i).estado))}</span></div></header><div class="grid grid-cols-1 sm:grid-cols-3 gap-6 mb-6"><div class="text-center"><p class="text-4xl font-serif font-bold text-[#5550F2]">${s.ssrInterpolate(t.unref(i).sesiones_restantes)}</p><p class="text-sm text-[#2D3748] opacity-70 font-sans mt-1">Disponibles</p></div><div class="text-center"><p class="text-4xl font-serif font-bold text-[#2D3748]">${s.ssrInterpolate(t.unref(i).total_sesiones)}</p><p class="text-sm text-[#2D3748] opacity-70 font-sans mt-1">Totales</p></div><div class="text-center"><p class="text-4xl font-serif font-bold text-[#2D3748] opacity-50">${s.ssrInterpolate(t.unref(i).sesiones_usadas)}</p><p class="text-sm text-[#2D3748] opacity-70 font-sans mt-1">Completadas</p></div></div><div class="space-y-2"><div class="flex justify-between text-xs font-sans text-[#2D3748] opacity-70"><span>Progreso del bono</span><span>${s.ssrInterpolate(Math.round(t.unref(i).sesiones_usadas/t.unref(i).total_sesiones*100))}%</span></div><div class="w-full bg-[#E2E8F0]/30 rounded-full h-3 overflow-hidden"><div class="${s.ssrRenderClass([getProgressColor(t.unref(i).sesiones_restantes,t.unref(i).total_sesiones),"h-full rounded-full transition-all duration-500"])}" style="${s.ssrRenderStyle({width:t.unref(i).sesiones_usadas/t.unref(i).total_sesiones*100+"%"})}"></div></div></div><div class="grid grid-cols-1 sm:grid-cols-2 gap-4 mt-6"><div class="flex items-center space-x-3 p-4 bg-[#F2F2F2] rounded-lg"><div class="w-10 h-10 rounded-full bg-[#5550F2]/20 flex items-center justify-center flex-shrink-0"><svg class="w-5 h-5 text-[#5550F2]" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg></div><div><p class="text-xs text-[#2D3748] opacity-70 font-sans">Precio total</p><p class="text-lg font-serif font-medium text-[#2D3748]">${s.ssrInterpolate(formatearPrecio(t.unref(i).precio_total))}€</p><p class="text-xs text-[#2D3748] opacity-50 font-sans">${s.ssrInterpolate(formatearPrecio(t.unref(i).precio_total/t.unref(i).total_sesiones))}€ por sesión</p></div></div><div class="flex items-center space-x-3 p-4 bg-[#F2F2F2] rounded-lg"><div class="w-10 h-10 rounded-full bg-[#5550F2]/20 flex items-center justify-center flex-shrink-0"><svg class="w-5 h-5 text-[#5550F2]" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg></div><div><p class="text-xs text-[#2D3748] opacity-70 font-sans">Estado</p><p class="text-lg font-serif font-medium text-[#2D3748]">${s.ssrInterpolate(estadoBonoTexto(t.unref(i).estado))}</p>`),t.unref(i).fecha_expiracion?n(`<p class="text-xs text-[#2D3748] opacity-50 font-sans">Válido hasta ${s.ssrInterpolate(formatearFecha(t.unref(i).fecha_expiracion))}</p>`):n("\x3c!----\x3e"),n("</div></div></div>"),t.unref(i).sesiones_restantes<=2&&t.unref(i).sesiones_restantes>0?n('<div class="flex items-start space-x-3 p-4 bg-amber-50 border border-amber-200 rounded-lg mt-6"><svg class="w-5 h-5 text-amber-600 flex-shrink-0 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path></svg><div><p class="text-sm font-sans font-medium text-amber-900">Quedan pocas sesiones</p><p class="text-xs font-sans text-amber-700 mt-1">Considera renovar tu bono pronto para mantener la continuidad.</p></div></div>'):n("\x3c!----\x3e"),0===t.unref(i).sesiones_restantes?n('<div class="flex items-start space-x-3 p-4 bg-red-50 border border-red-200 rounded-lg mt-6"><svg class="w-5 h-5 text-red-600 flex-shrink-0 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg><div><p class="text-sm font-sans font-medium text-red-900">Bono agotado</p><p class="text-xs font-sans text-red-700 mt-1">Has utilizado todas las sesiones. Contacta para adquirir uno nuevo.</p></div></div>'):n("\x3c!----\x3e"),t.unref(i).sesiones_restantes<=2?(n('<div class="pt-4 border-t border-[#E2E8F0]/30 mt-6">'),n(s.ssrRenderComponent(c,{to:"/como-empezar",class:"block w-full text-center px-6 py-3 bg-[#5550F2] hover:bg-[#C89B8A] text-white rounded-lg font-sans font-medium transition-colors"},{default:t.withCtx((e,s,o,n)=>{if(!s)return[t.createTextVNode("Renovar Bono")];s("Renovar Bono")}),_:1},r)),n("</div>")):n("\x3c!----\x3e"),n("</section>")):n("\x3c!----\x3e"),t.unref(d).length>0?(n('<section class="space-y-4"><h2 class="text-lg font-serif font-medium text-[#2D3748] mb-2">Historial de Bonos</h2><div class="space-y-3">\x3c!--[--\x3e'),s.ssrRenderList(t.unref(d),e=>{n(`<article class="bg-white rounded-lg shadow-sm border border-[#E2E8F0]/30 p-4"><div class="flex items-center justify-between mb-3"><div><h3 class="text-base font-sans font-medium text-[#2D3748]">Bono de ${s.ssrInterpolate(e.total_sesiones)} Sesiones</h3><p class="text-xs text-[#2D3748] opacity-70 font-sans">${s.ssrInterpolate(formatearFecha(e.created_at))}</p></div><div class="text-right"><p class="text-sm font-serif font-medium text-[#2D3748]">${s.ssrInterpolate(e.sesiones_usadas)}/${s.ssrInterpolate(e.total_sesiones)}</p><p class="text-xs text-[#2D3748] opacity-70 font-sans">sesiones</p></div></div><div class="w-full bg-[#E2E8F0]/30 rounded-full h-2"><div class="h-full bg-[#2D3748] opacity-30 rounded-full" style="${s.ssrRenderStyle({width:e.sesiones_usadas/e.total_sesiones*100+"%"})}"></div></div><div class="flex items-center space-x-2 mt-2 text-xs text-[#2D3748] opacity-60 font-sans"><span class="${s.ssrRenderClass([estadoBonoClass(e.estado),"px-2 py-0.5 rounded-full font-medium"])}">${s.ssrInterpolate(estadoBonoTexto(e.estado))}</span><span>·</span><span>Contratado: ${s.ssrInterpolate(formatearFecha(e.created_at))}</span>`),e.fecha_expiracion?n(`<span>· Expira: ${s.ssrInterpolate(formatearFecha(e.fecha_expiracion))}</span>`):n("\x3c!----\x3e"),n("</div></article>")}),n("\x3c!--]--\x3e</div></section>")):n("\x3c!----\x3e"),t.unref(i)||0!==t.unref(d).length?n("\x3c!----\x3e"):(n('<div class="flex flex-col items-center justify-center text-center py-16"><div class="w-20 h-20 rounded-full bg-[#E2E8F0]/30 flex items-center justify-center mb-4"><svg class="w-10 h-10 text-[#5550F2]" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4"></path></svg></div><h3 class="text-xl font-serif font-medium text-[#2D3748] mb-2">No tienes bonos activos</h3><p class="text-sm text-[#2D3748] opacity-70 font-sans max-w-md mb-6">Adquiere un bono para comenzar tu proceso terapéutico.</p>'),n(s.ssrRenderComponent(c,{to:"/contacto",class:"px-6 py-3 bg-[#5550F2] hover:bg-[#C89B8A] text-white rounded-lg font-sans font-medium transition-colors"},{default:t.withCtx((e,s,o,n)=>{if(!s)return[t.createTextVNode("Contactar")];s("Contactar")}),_:1},r)),n("</div>")),n("</div>")),n("</div>")}}}),a=n.setup;n.setup=(e,s)=>{const o=t.useSSRContext();return(o.modules||(o.modules=new Set)).add("pages/paciente/bono.vue"),a?a(e,s):void 0};export{n as default};
//# sourceMappingURL=bono-CdQGym_F.mjs.map
