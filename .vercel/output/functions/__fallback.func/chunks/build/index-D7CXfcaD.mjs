import{v as e,e as t,s}from"./server.mjs";import{M as a}from"./ModalDetallesCita-Db71gcxb.mjs";import{u as o}from"./useSupabaseClient-DykwVqLQ.mjs";import{r as n}from"./ClockIcon-BxdFtPqx.mjs";import{r}from"./CheckCircleIcon-CT9fzVFs.mjs";import{r as l}from"./MagnifyingGlassIcon-GsbNDyPZ.mjs";import{r as i}from"./ExclamationTriangleIcon-DQdM2y0F.mjs";import{r as d}from"./CalendarDaysIcon-f8DhK37e.mjs";import{r as c}from"./EyeIcon-CVap-E73.mjs";import"../routes/renderer.mjs";import"../nitro/nitro.mjs";import"node:http";import"node:https";import"node:events";import"node:buffer";import"node:fs";import"node:path";import"node:crypto";import"../_/shared.cjs.prod.mjs";import"../virtual/_commonjsHelpers.mjs";import"node:stream";import"../_/index2.mjs";import"@supabase/supabase-js";import"@vercel/analytics/nuxt";import"./XCircleIcon-BCxujS_I.mjs";import"./ExclamationCircleIcon-DhXgUVTW.mjs";import"./CalendarIcon-BrsGHJBC.mjs";import"./XMarkIcon-DCLwyE-W.mjs";import"./UserIcon-CrHYaeI9.mjs";import"./TicketIcon-zZdrc71S.mjs";import"./_plugin-vue_export-helper-1tPrXgE0.mjs";const p=e.defineComponent({__name:"index",__ssrInlineRender:!0,setup(p){const m=o(),u=t(),x=e.ref(!0),f=e.ref(null),b=e.ref([]),v=e.ref([]),g=e.ref({busqueda:"",estado:"",periodo:"todos"}),h=e.ref(!1),y=e.ref(null),_=e.ref(!0),w=e.ref(null),C=e.computed(()=>{let e=[...b.value];if(g.value.busqueda){const t=g.value.busqueda.toLowerCase();e=e.filter(e=>e.paciente?.nombre_completo?.toLowerCase().includes(t))}g.value.estado&&(e=e.filter(e=>e.estado===g.value.estado));const t=new Date;if("mes-actual"===g.value.periodo){const s=new Date(t.getFullYear(),t.getMonth(),1),a=new Date(t.getFullYear(),t.getMonth()+1,0);e=e.filter(e=>{const t=new Date(e.fecha_cita);return t>=s&&t<=a})}else if("mes-anterior"===g.value.periodo){const s=new Date(t.getFullYear(),t.getMonth()-1,1),a=new Date(t.getFullYear(),t.getMonth(),0);e=e.filter(e=>{const t=new Date(e.fecha_cita);return t>=s&&t<=a})}else if("trimestre"===g.value.periodo){const s=new Date(t);s.setMonth(t.getMonth()-3),e=e.filter(e=>new Date(e.fecha_cita)>=s)}return e.sort((e,t)=>{const s=new Date(e.fecha_cita+"T"+e.hora_inicio);return new Date(t.fecha_cita+"T"+t.hora_inicio).getTime()-s.getTime()}),e}),I=e.computed(()=>{const e={pendientes:0,confirmadas:0,completadas:0,canceladas:0,montoPendiente:0,montoConfirmado:0,montoCompletado:0,montoCancelado:0};return C.value.forEach(t=>{const s=t.monto_terapeuta||.7*(t.precio_estimado||50);switch(t.estado){case"pendiente":e.pendientes++,t.esta_pagado||t.bono?.pagado?e.montoConfirmado+=s:e.montoPendiente+=s;break;case"confirmada":e.confirmadas++,t.esta_pagado||t.bono?.pagado?e.montoConfirmado+=s:e.montoPendiente+=s;break;case"realizada":case"completada":e.completadas++,t.esta_pagado||t.bono?.pagado?e.montoConfirmado+=s:e.montoCompletado+=s;break;case"cancelada":e.canceladas++,e.montoCancelado+=s}}),e}),$=e.computed(()=>v.value.map(e=>{const t=(e.sesiones_totales||0)-(e.sesiones_restantes||0),s=e.sesiones_totales>0?e.monto_total/e.sesiones_totales:0,a=.7*e.monto_total;return{bono_id:e.id,paciente_id:e.paciente_id,paciente_nombre:e.paciente_nombre,paciente_email:e.paciente_email,bono_sesiones_totales:e.sesiones_totales,bono_sesiones_restantes:e.sesiones_restantes,bono_monto_total:e.monto_total,bono_fecha_pago:e.fecha_pago,bono_metodo_pago:e.metodo_pago,tipo_bono:e.tipo_bono||"Est√°ndar",sesiones_usadas:t,precio_por_sesion:s,monto_total_terapeuta:a}}).sort((e,t)=>{const s=new Date(e.bono_fecha_pago||0);return new Date(t.bono_fecha_pago||0).getTime()-s.getTime()})),j=e.computed(()=>$.value.reduce((e,t)=>e+(t.monto_total_terapeuta||0),0)),cargarSesiones=async()=>{try{x.value=!0,f.value=null;let e=0;for(;!u.value&&e<50;)await new Promise(e=>setTimeout(e,100)),e++;if(!u.value)throw new Error("Usuario no autenticado");console.log("üë§ Usuario verificado:",u.value.id);const{data:t,error:s}=await m.from("terapeutas").select("id").eq("email",u.value.email).single();if(s)throw console.error("Error al buscar terapeuta:",s),s;if(!t)throw new Error("No se encontr√≥ el terapeuta asociado a este usuario");console.log("Terapeuta encontrado:",t);const{data:a,error:o}=await m.from("vista_sesiones_psicologa").select("*").eq("terapeuta_id",t.id).order("fecha",{ascending:!1});if(o)throw console.error("Error al cargar sesiones:",o),o;console.log("Sesiones cargadas:",a?.length||0,a),b.value=(a||[]).map(e=>(console.log("Sesi√≥n individual:",{id:e.id,bono_id:e.bono_id,bono_pagado:e.bono_pagado,esta_pagado:e.esta_pagado,categoria_financiera:e.categoria_financiera,precio_sesion:e.precio_sesion,monto_terapeuta:e.monto_terapeuta,paciente:e.paciente_nombre}),{...e,precio_estimado:e.precio_sesion||50,paciente:{id:e.paciente_id,nombre_completo:e.paciente_nombre,email:e.paciente_email,telefono:e.paciente_telefono},bono:e.bono_id?{id:e.bono_id,sesiones_totales:e.bono_sesiones_totales,sesiones_restantes:e.bono_sesiones_restantes,monto_total:e.bono_monto_total,pagado:e.bono_pagado,fecha_pago:e.bono_fecha_pago,metodo_pago:e.bono_metodo_pago}:null})),console.log("Sesiones procesadas:",b.value.length)}catch(e){console.error("Error al cargar sesiones:",e),f.value=e.message||"Error desconocido al cargar las sesiones"}finally{x.value=!1}},cerrarModalDetalles=()=>{h.value=!1,y.value=null},formatearPrecio=e=>e.toFixed(2),formatearFecha=e=>{if(!e)return"-";const t=new Date(e);return isNaN(t.getTime())?"-":t.toLocaleDateString("es-ES",{day:"2-digit",month:"2-digit",year:"numeric"})},obtenerIniciales=e=>e.split(" ").map(e=>e[0]).join("").toUpperCase().substring(0,2),obtenerColorPuntoEstado=e=>({pendiente:"bg-yellow-500",confirmada:"bg-green-500",realizada:"bg-blue-500",completada:"bg-blue-500",cancelada:"bg-red-500"}[e]||"bg-gray-500");return(t,o,p,m)=>{o(`<div${s.ssrRenderAttrs(e.mergeProps({class:"min-h-screen bg-base-bg"},m))}><div class="mb-8"><h1 class="text-3xl font-serif font-bold text-cafe mb-2"> Gesti√≥n de Sesiones </h1><p class="text-purple-600"> Visualiza y gestiona todas tus sesiones con informaci√≥n financiera </p></div><div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8"><div class="bg-white rounded-xl shadow-sm border border-gray-100 p-6"><div class="flex items-center justify-between mb-4"><div class="w-12 h-12 bg-yellow-100 rounded-lg flex items-center justify-center">`),o(s.ssrRenderComponent(e.unref(n),{class:"w-6 h-6 text-yellow-600"},null,p)),o(`</div><span class="text-sm font-medium text-yellow-600 bg-yellow-50 px-3 py-1 rounded-full"> Pendientes </span></div><p class="text-sm text-cafe/60 mb-1">Sesiones pendientes</p><p class="text-3xl font-bold text-cafe mb-2">${s.ssrInterpolate(I.value.pendientes)}</p><div class="pt-3 border-t border-gray-100"><p class="text-xs text-cafe/50 mb-1">Monto estimado</p><p class="text-xl font-semibold text-yellow-600">${s.ssrInterpolate(formatearPrecio(I.value.montoPendiente))}‚Ç¨ </p></div></div><div class="bg-white rounded-xl shadow-sm border border-gray-100 p-6"><div class="flex items-center justify-between mb-4"><div class="w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center">`),o(s.ssrRenderComponent(e.unref(r),{class:"w-6 h-6 text-green-600"},null,p)),o(`</div><span class="text-sm font-medium text-green-600 bg-green-50 px-3 py-1 rounded-full"> Confirmadas </span></div><p class="text-sm text-cafe/60 mb-1">Sesiones confirmadas</p><p class="text-3xl font-bold text-cafe mb-2">${s.ssrInterpolate(I.value.confirmadas)}</p><div class="pt-3 border-t border-gray-100"><p class="text-xs text-cafe/50 mb-1">Monto asegurado</p><p class="text-xl font-semibold text-green-600">${s.ssrInterpolate(formatearPrecio(I.value.montoConfirmado))}‚Ç¨ </p></div></div><div class="bg-white rounded-xl shadow-sm border border-gray-100 p-6"><div class="flex items-center justify-between mb-4"><div class="w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center">`),o(s.ssrRenderComponent(e.unref(r),{class:"w-6 h-6 text-blue-600"},null,p)),o(`</div><span class="text-sm font-medium text-blue-600 bg-blue-50 px-3 py-1 rounded-full"> Completadas </span></div><p class="text-sm text-cafe/60 mb-1">Sesiones realizadas</p><p class="text-3xl font-bold text-cafe mb-2">${s.ssrInterpolate(I.value.completadas)}</p><div class="pt-3 border-t border-gray-100"><p class="text-xs text-cafe/50 mb-1">Monto por cobrar</p><p class="text-xl font-semibold text-blue-600">${s.ssrInterpolate(formatearPrecio(I.value.montoCompletado))}‚Ç¨ </p></div></div><div class="bg-white rounded-xl shadow-sm border border-gray-100 p-6"><div class="flex items-center justify-between mb-4"><div class="w-12 h-12 bg-red-100 rounded-lg flex items-center justify-center"><span class="text-2xl">‚úï</span></div><span class="text-sm font-medium text-red-600 bg-red-50 px-3 py-1 rounded-full"> Canceladas </span></div><p class="text-sm text-cafe/60 mb-1">Sesiones canceladas</p><p class="text-3xl font-bold text-cafe mb-2">${s.ssrInterpolate(I.value.canceladas)}</p><div class="pt-3 border-t border-gray-100"><p class="text-xs text-cafe/50 mb-1">Monto perdido</p><p class="text-xl font-semibold text-red-600">${s.ssrInterpolate(formatearPrecio(I.value.montoCancelado))}‚Ç¨ </p></div></div></div><div class="bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden mb-6"><div class="bg-gradient-to-r from-green-50 to-emerald-50 border-b border-green-100 px-6 py-5"><div class="flex items-center justify-between"><div class="flex items-center gap-4"><div class="w-12 h-12 rounded-xl bg-green-600 flex items-center justify-center">`),o(s.ssrRenderComponent(e.unref(r),{class:"w-6 h-6 text-white"},null,p)),o(`</div><div><h2 class="text-xl font-bold text-cafe">Pagos Confirmados</h2><p class="text-sm text-cafe/60 mt-0.5">Bonos procesados por coordinaci√≥n</p></div></div><div class="flex items-center gap-6"><div class="text-right"><p class="text-xs text-cafe/50 uppercase font-semibold tracking-wide">Total Confirmado</p><p class="text-3xl font-bold text-green-700">${s.ssrInterpolate(formatearPrecio(j.value))}‚Ç¨</p><p class="text-xs text-cafe/60 mt-0.5">${s.ssrInterpolate($.value.length)} ${s.ssrInterpolate(1===$.value.length?"bono":"bonos")}</p></div><button class="${s.ssrRenderClass([{"rotate-180":_.value},"w-10 h-10 rounded-lg bg-white/80 hover:bg-white border border-green-200 flex items-center justify-center text-green-700 hover:text-green-800 transition-all duration-200"])}"><span class="text-lg">‚ñº</span></button></div></div></div><div style="${s.ssrRenderStyle(_.value?null:{display:"none"})}">`),0===$.value.length?o('<div class="text-center py-12 px-6"><div class="w-20 h-20 mx-auto mb-4 rounded-full bg-cafe/5 flex items-center justify-center"><span class="text-4xl">üì≠</span></div><p class="text-cafe/60 font-medium">No hay pagos confirmados a√∫n</p><p class="text-sm text-cafe/40 mt-1">Los bonos pagados aparecer√°n aqu√≠</p></div>'):(o('<div class="divide-y divide-gray-100">\x3c!--[--\x3e'),s.ssrRenderList($.value,(e,t)=>{o(`<div class="group hover:bg-green-50/30 transition-colors duration-150"><div class="px-6 py-4 cursor-pointer flex items-center gap-4"><div class="flex-shrink-0 w-1 h-12 rounded-full bg-green-500"></div><div class="flex-shrink-0 w-10 h-10 rounded-full bg-gradient-to-br from-green-600 to-emerald-600 flex items-center justify-center text-white font-bold text-sm shadow-sm">${s.ssrInterpolate(obtenerIniciales(e.paciente_nombre))}</div><div class="flex-1 min-w-0 grid grid-cols-5 gap-4 items-center"><div class="col-span-2"><p class="font-semibold text-cafe truncate">${s.ssrInterpolate(e.paciente_nombre)}</p><p class="text-xs text-cafe/50 truncate">${s.ssrInterpolate(e.tipo_bono||"Bono Est√°ndar")}</p></div><div class="text-center"><p class="text-sm font-semibold text-cafe">${s.ssrInterpolate(e.sesiones_usadas)}/${s.ssrInterpolate(e.bono_sesiones_totales)}</p><p class="text-xs text-cafe/50">sesiones</p></div><div class="text-right"><p class="text-lg font-bold text-green-700">${s.ssrInterpolate(formatearPrecio(e.monto_total_terapeuta))}‚Ç¨</p><p class="text-xs text-cafe/50">tu parte (70%)</p></div><div class="text-right"><p class="text-sm font-medium text-cafe flex items-center justify-end gap-1.5">${s.ssrInterpolate(formatearFecha(e.bono_fecha_pago))}</p><p class="text-xs text-cafe/50 capitalize flex items-center justify-end gap-1.5 mt-0.5">${s.ssrInterpolate(e.bono_metodo_pago||"No especificado")}</p></div></div><div class="flex-shrink-0 ml-2"><span class="${s.ssrRenderClass([{"rotate-180":w.value===e.bono_id},"block w-6 h-6 rounded-full bg-cafe/5 group-hover:bg-cafe/10 flex items-center justify-center text-cafe/40 text-xs transition-all duration-200"])}"> ‚ñº </span></div></div><div class="bg-gradient-to-b from-green-50/50 to-transparent" style="${s.ssrRenderStyle(w.value===e.bono_id?null:{display:"none"})}"><div class="px-6 pb-6 pt-2 ml-16"><div class="bg-white rounded-xl border border-green-100 p-5 shadow-sm"><div class="grid grid-cols-3 gap-6"><div class="space-y-3"><p class="text-xs text-cafe/40 uppercase font-bold tracking-wider mb-3">üìã Paciente</p><div class="space-y-2"><div class="flex justify-between text-sm"><span class="text-cafe/60">Nombre:</span><span class="font-medium text-cafe">${s.ssrInterpolate(e.paciente_nombre)}</span></div><div class="flex justify-between text-sm"><span class="text-cafe/60">Email:</span><span class="font-medium text-cafe text-xs truncate max-w-[150px]"${s.ssrRenderAttr("title",e.paciente_email)}>${s.ssrInterpolate(e.paciente_email)}</span></div></div></div><div class="space-y-3"><p class="text-xs text-cafe/40 uppercase font-bold tracking-wider mb-3">üßæ Detalles del Bono</p><div class="space-y-2"><div class="flex justify-between text-sm"><span class="text-cafe/60">Tipo:</span><span class="font-medium text-cafe">${s.ssrInterpolate(e.tipo_bono||"Est√°ndar")}</span></div><div class="flex justify-between text-sm"><span class="text-cafe/60">Sesiones totales:</span><span class="font-medium text-cafe">${s.ssrInterpolate(e.bono_sesiones_totales)}</span></div><div class="flex justify-between text-sm"><span class="text-cafe/60">Sesiones usadas:</span><span class="font-medium text-cafe">${s.ssrInterpolate(e.sesiones_usadas)}</span></div><div class="flex justify-between text-sm"><span class="text-cafe/60">Sesiones restantes:</span><span class="font-semibold text-green-700">${s.ssrInterpolate(e.bono_sesiones_restantes)}</span></div></div></div><div class="space-y-3"><p class="text-xs text-cafe/40 uppercase font-bold tracking-wider mb-3">Financiero</p><div class="space-y-2"><div class="flex justify-between text-sm"><span class="text-cafe/60">Monto total:</span><span class="font-bold text-cafe">${s.ssrInterpolate(formatearPrecio(e.bono_monto_total))}‚Ç¨</span></div><div class="flex justify-between text-sm bg-green-50 px-2 py-1.5 rounded-lg"><span class="text-cafe/60 font-medium">Tu parte (70%):</span><span class="font-bold text-green-700">${s.ssrInterpolate(formatearPrecio(e.monto_total_terapeuta))}‚Ç¨</span></div><div class="flex justify-between text-sm"><span class="text-cafe/60">Por sesi√≥n:</span><span class="font-medium text-cafe/80">${s.ssrInterpolate(formatearPrecio(e.precio_por_sesion))}‚Ç¨</span></div><div class="pt-2 border-t border-green-100 mt-3"><div class="flex justify-between text-xs text-cafe/50 mb-1"><span>M√©todo de pago:</span><span class="font-medium capitalize">${s.ssrInterpolate(e.bono_metodo_pago||"No especificado")}</span></div><div class="flex justify-between text-xs text-cafe/50"><span>Fecha de pago:</span><span class="font-medium">${s.ssrInterpolate(formatearFecha(e.bono_fecha_pago))}</span></div></div></div></div></div></div></div></div></div>`)}),o("\x3c!--]--\x3e</div>")),o(`</div></div><div class="bg-white rounded-xl shadow-sm border border-gray-100 p-6 mb-6"><div class="grid grid-cols-1 md:grid-cols-4 gap-4"><div class="md:col-span-2"><label class="block text-sm font-medium text-cafe mb-2"> Buscar paciente </label><div class="relative"><input${s.ssrRenderAttr("value",g.value.busqueda)} type="text" placeholder="Nombre del paciente..." class="w-full px-4 py-2 pl-10 bg-base-bg rounded-lg border border-transparent focus:border-purple-600 focus:outline-none focus:ring-2 focus:ring-purple-300/20">`),o(s.ssrRenderComponent(e.unref(l),{class:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-cafe/50"},null,p)),o(`</div></div><div><label class="block text-sm font-medium text-cafe mb-2"> Estado </label><select class="w-full px-4 py-2 bg-base-bg rounded-lg border border-transparent focus:border-purple-600 focus:outline-none focus:ring-2 focus:ring-purple-300/20 text-cafe"><option value=""${s.ssrIncludeBooleanAttr(Array.isArray(g.value.estado)?s.ssrLooseContain(g.value.estado,""):s.ssrLooseEqual(g.value.estado,""))?" selected":""}>Todos los estados</option><option value="pendiente"${s.ssrIncludeBooleanAttr(Array.isArray(g.value.estado)?s.ssrLooseContain(g.value.estado,"pendiente"):s.ssrLooseEqual(g.value.estado,"pendiente"))?" selected":""}>Pendiente</option><option value="confirmada"${s.ssrIncludeBooleanAttr(Array.isArray(g.value.estado)?s.ssrLooseContain(g.value.estado,"confirmada"):s.ssrLooseEqual(g.value.estado,"confirmada"))?" selected":""}>Confirmada</option><option value="realizada"${s.ssrIncludeBooleanAttr(Array.isArray(g.value.estado)?s.ssrLooseContain(g.value.estado,"realizada"):s.ssrLooseEqual(g.value.estado,"realizada"))?" selected":""}>Completada</option><option value="cancelada"${s.ssrIncludeBooleanAttr(Array.isArray(g.value.estado)?s.ssrLooseContain(g.value.estado,"cancelada"):s.ssrLooseEqual(g.value.estado,"cancelada"))?" selected":""}>Cancelada</option></select></div><div><label class="block text-sm font-medium text-cafe mb-2"> Per√≠odo </label><select class="w-full px-4 py-2 bg-base-bg rounded-lg border border-transparent focus:border-purple-600 focus:outline-none focus:ring-2 focus:ring-purple-300/20 text-cafe"><option value="mes-actual"${s.ssrIncludeBooleanAttr(Array.isArray(g.value.periodo)?s.ssrLooseContain(g.value.periodo,"mes-actual"):s.ssrLooseEqual(g.value.periodo,"mes-actual"))?" selected":""}>Mes actual</option><option value="mes-anterior"${s.ssrIncludeBooleanAttr(Array.isArray(g.value.periodo)?s.ssrLooseContain(g.value.periodo,"mes-anterior"):s.ssrLooseEqual(g.value.periodo,"mes-anterior"))?" selected":""}>Mes anterior</option><option value="trimestre"${s.ssrIncludeBooleanAttr(Array.isArray(g.value.periodo)?s.ssrLooseContain(g.value.periodo,"trimestre"):s.ssrLooseEqual(g.value.periodo,"trimestre"))?" selected":""}>√öltimo trimestre</option><option value="todos"${s.ssrIncludeBooleanAttr(Array.isArray(g.value.periodo)?s.ssrLooseContain(g.value.periodo,"todos"):s.ssrLooseEqual(g.value.periodo,"todos"))?" selected":""}>Todos</option></select></div></div></div>`),x.value?o('<div class="flex items-center justify-center py-12"><div class="text-center"><div class="inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-purple-600 mb-4"></div><p class="text-cafe/60">Cargando sesiones...</p></div></div>'):f.value?(o('<div class="bg-red-50 border border-red-200 rounded-xl p-6"><div class="flex items-start gap-3">'),o(s.ssrRenderComponent(e.unref(i),{class:"w-6 h-6 text-red-600"},null,p)),o(`<div><h3 class="font-semibold text-red-800 mb-1">Error al cargar sesiones</h3><p class="text-sm text-red-600">${s.ssrInterpolate(f.value)}</p></div></div></div>`)):(o(`<div class="bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden"><div class="bg-gray-50 border-b border-gray-100 px-6 py-4"><h3 class="font-semibold text-cafe"> Listado de Sesiones <span class="text-sm font-normal text-cafe/60 ml-2"> (${s.ssrInterpolate(C.value.length)} sesiones) </span></h3></div>`),0===C.value.length?(o('<div class="p-12 text-center"><div class="w-16 h-16 bg-cafe-claro/20 rounded-full flex items-center justify-center mx-auto mb-4">'),o(s.ssrRenderComponent(e.unref(d),{class:"w-8 h-8 text-cafe/40"},null,p)),o(`</div><h3 class="text-lg font-semibold text-cafe mb-2"> No hay sesiones para mostrar </h3><p class="text-cafe/60 mb-6">${s.ssrInterpolate(g.value.busqueda||g.value.estado?"Intenta ajustar los filtros de b√∫squeda":"No tienes sesiones programadas a√∫n")}</p></div>`)):(o('<div class="overflow-x-auto"><table class="w-full"><thead class="bg-gray-50 border-b border-gray-200"><tr><th class="px-6 py-3 text-left text-xs font-semibold text-cafe/70 uppercase tracking-wider"> Fecha </th><th class="px-6 py-3 text-left text-xs font-semibold text-cafe/70 uppercase tracking-wider"> Hora </th><th class="px-6 py-3 text-left text-xs font-semibold text-cafe/70 uppercase tracking-wider"> Paciente </th><th class="px-6 py-3 text-left text-xs font-semibold text-cafe/70 uppercase tracking-wider"> Modalidad </th><th class="px-6 py-3 text-left text-xs font-semibold text-cafe/70 uppercase tracking-wider"> Estado </th><th class="px-6 py-3 text-left text-xs font-semibold text-cafe/70 uppercase tracking-wider"> Bono </th><th class="px-6 py-3 text-right text-xs font-semibold text-cafe/70 uppercase tracking-wider"> Monto </th><th class="px-6 py-3 text-center text-xs font-semibold text-cafe/70 uppercase tracking-wider"> Acciones </th></tr></thead><tbody class="bg-white divide-y divide-gray-100">\x3c!--[--\x3e'),s.ssrRenderList(C.value,t=>{var a,l,i;o(`<tr class="hover:bg-gray-50 transition-colors duration-150"><td class="px-6 py-4 whitespace-nowrap"><div class="text-sm font-medium text-cafe">${s.ssrInterpolate(formatearFecha(t.fecha_cita))}</div><div class="text-xs text-cafe/50">${s.ssrInterpolate((l=t.fecha_cita,new Date(l+"T00:00:00").toLocaleDateString("es-ES",{weekday:"long"})))}</div></td><td class="px-6 py-4 whitespace-nowrap"><div class="text-sm text-cafe">${s.ssrInterpolate((a=t.hora_inicio,a?a.substring(0,5):"-"))}</div><div class="text-xs text-cafe/50">${s.ssrInterpolate(t.duracion_minutos||50)} min </div></td><td class="px-6 py-4"><div class="flex items-center gap-3"><div class="w-10 h-10 rounded-full bg-purple-600/20 text-purple-600 flex items-center justify-center font-semibold text-sm flex-shrink-0">${s.ssrInterpolate(obtenerIniciales(t.paciente?.nombre_completo||"NN"))}</div><div><div class="text-sm font-medium text-cafe">${s.ssrInterpolate(t.paciente?.nombre_completo||"Sin nombre")}</div>`),t.paciente?.email?o(`<div class="text-xs text-cafe/50">${s.ssrInterpolate(t.paciente.email)}</div>`):o("\x3c!----\x3e"),o(`</div></div></td><td class="px-6 py-4 whitespace-nowrap"><span class="${s.ssrRenderClass(["inline-flex items-center gap-1 px-2.5 py-1 rounded-full text-xs font-medium","online"===t.modalidad?"bg-blue-50 text-blue-700":"bg-purple-50 text-purple-700"])}"><span>${s.ssrInterpolate("online"===t.modalidad?"üíª":"üè¢")}</span> ${s.ssrInterpolate("online"===t.modalidad?"Online":"Presencial")}</span></td><td class="px-6 py-4 whitespace-nowrap"><span class="${s.ssrRenderClass(["inline-flex items-center gap-1.5 px-3 py-1 rounded-full text-xs font-medium",(i=t.estado,{pendiente:"bg-yellow-50 text-yellow-700",confirmada:"bg-green-50 text-green-700",realizada:"bg-blue-50 text-blue-700",completada:"bg-blue-50 text-blue-700",cancelada:"bg-red-50 text-red-700"}[i]||"bg-gray-50 text-gray-700")])}"><span class="${s.ssrRenderClass([obtenerColorPuntoEstado(t.estado),"w-1.5 h-1.5 rounded-full"])}"></span> ${s.ssrInterpolate((e=>({pendiente:"Pendiente",confirmada:"Confirmada",realizada:"Completada",completada:"Completada",cancelada:"Cancelada"}[e]||e))(t.estado))}</span></td><td class="px-6 py-4 whitespace-nowrap">`),t.bono?(o('<div class="text-xs space-y-1"><div class="flex items-center gap-1 text-green-600">'),o(s.ssrRenderComponent(e.unref(r),{class:"w-4 h-4"},null,p)),o(`<span>Con bono</span></div><div class="text-cafe/50">${s.ssrInterpolate(t.bono.sesiones_restantes||0)}/${s.ssrInterpolate(t.bono.sesiones_totales||0)} restantes </div>`),t.bono.pagado?(o('<div class="flex items-center gap-1 text-green-700 bg-green-50 px-2 py-0.5 rounded-full">'),o(s.ssrRenderComponent(e.unref(r),{class:"w-4 h-4"},null,p)),o('<span class="font-semibold">Pagado</span></div>')):(o('<div class="flex items-center gap-1 text-orange-600 bg-orange-50 px-2 py-0.5 rounded-full animate-pulse">'),o(s.ssrRenderComponent(e.unref(n),{class:"w-4 h-4"},null,p)),o('<span class="font-semibold">Pend. pago</span></div>')),o("</div>")):o('<div class="text-xs text-cafe/50"> Sin bono </div>'),o(`</td><td class="px-6 py-4 whitespace-nowrap text-right"><div class="text-sm font-semibold text-cafe">${s.ssrInterpolate(formatearPrecio(t.precio_estimado||50))}‚Ç¨ </div><div class="text-xs text-cafe/50"> Tu parte: ${s.ssrInterpolate(formatearPrecio(.7*(t.precio_estimado||50)))}‚Ç¨ </div></td><td class="px-6 py-4 whitespace-nowrap text-center"><button class="inline-flex items-center gap-1.5 px-3 py-1.5 text-sm text-purple-600 hover:bg-purple-600/10 rounded-lg transition-colors duration-200">`),o(s.ssrRenderComponent(e.unref(c),{class:"w-4 h-4"},null,p)),o(" Ver detalles </button></td></tr>")}),o("\x3c!--]--\x3e</tbody></table></div>")),o("</div>")),o(s.ssrRenderComponent(a,{"is-open":h.value,"cita-id":y.value,onClose:cerrarModalDetalles,onActualizado:cargarSesiones,onEliminado:cargarSesiones},null,p)),o("</div>")}}}),m=p.setup;p.setup=(t,s)=>{const a=e.useSSRContext();return(a.modules||(a.modules=new Set)).add("pages/terapeuta/sesiones/index.vue"),m?m(t,s):void 0};export{p as default};
//# sourceMappingURL=index-D7CXfcaD.mjs.map
