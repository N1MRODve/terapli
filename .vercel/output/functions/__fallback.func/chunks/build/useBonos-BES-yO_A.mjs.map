{"version":3,"file":"useBonos-BES-yO_A.mjs","sources":["../../../../../../composables/useRoles.ts","../../../../../../composables/useBonos.ts"],"sourcesContent":null,"names":["useRoles","userProfile","getUserRole","useSupabase","isPsicologa","computed","value","rol","isPaciente","isCoordinadora","getDashboardPath","role","psicologa","coordinadora","paciente","readonly","hasRole","hasAnyRole","roles","some","getRoleName","goToDashboard","async","path","navigateTo","useBonos","supabase","useSupabaseClient","getBonosPorPaciente","pacienteId","data","error","from","select","eq","order","ascending","console","warn","message","err","puedeGestionarBonos","puedeConfirmarPagos","getBonoConPagos","bonoId","bono","errorBono","single","pagos","errorPagos","getBonosActivos","getPagosPorBono","getRenovaciones","or","calcularMetricas","bonos","activos","filter","b","estado","length","completados","vencidos","pendientes","hoy","Date","proximosAVencer","fecha_fin","fechaFin","diasRestantes","Math","ceil","getTime","pocasSesiones","sesiones_restantes","total","crearBono","bonoData","insert","Error","actualizarBono","cambios","update","updated_at","toISOString","registrarPago","monto","metodo","confirmado","pagoData","bono_id","metodo_pago","fecha_pago","split","confirmado_por","id","fecha_confirmacion","confirmarPago","pagoId","rpc","p_pago_id","resultado","success","mensaje","renovarBono","motivo","modificarSesiones","modificarMonto","userId","p_bono_id","p_usuario_id","p_motivo","p_modificar_sesiones","p_modificar_monto","calcularPorcentajeUso","sesiones_totales","sesionesUsadas","round","getEstadoColor","pendiente","activo","completado","vencido","cancelado","getEstadoTexto"],"mappings":"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"}