import{v as e,s}from"./server.mjs";import{u as t}from"./useBonos-B2-LOzOF.mjs";import{u as o}from"./useSupabase-DfFg84CY.mjs";const n=e.defineComponent({__name:"ModalNuevoBono",__ssrInlineRender:!0,props:{mostrar:{type:Boolean},pacienteId:{},pacienteNombre:{},psicologaId:{},bonoExistente:{}},emits:["close","created","updated"],setup(n,{emit:a}){const r=n;t(),o();const l=e.computed(()=>!!r.bonoExistente),i=e.ref({tipo:"mensual",frecuencia:"semanal",sesiones_totales:4,sesiones_usadas:0,monto:0,fecha_inicio:(new Date).toISOString().split("T")[0],fecha_fin:"",estado:"pendiente",renovacion_automatica:!1,notas:""});e.watch(()=>r.bonoExistente,e=>{e&&(i.value={tipo:e.tipo||"mensual",frecuencia:e.frecuencia||"semanal",sesiones_totales:e.sesiones_totales||4,sesiones_usadas:e.sesiones_usadas||0,monto:e.monto_total||0,fecha_inicio:e.fecha_inicio||(new Date).toISOString().split("T")[0],fecha_fin:e.fecha_fin||"",estado:e.estado||"pendiente",renovacion_automatica:e.renovacion_automatica||!1,notas:e.notas||""})},{immediate:!0});const d=e.ref(!1),u=e.ref(""),c=e.computed(()=>i.value.tipo&&i.value.sesiones_totales&&i.value.monto),p=e.computed(()=>{if(!i.value.sesiones_totales||!i.value.monto)return"0.00";return(i.value.monto/i.value.sesiones_totales).toFixed(2)}),f=e.computed(()=>Math.max(0,i.value.sesiones_totales-(i.value.sesiones_usadas||0))),m=e.computed(()=>!!(i.value.tipo&&i.value.frecuencia&&i.value.sesiones_totales>0&&i.value.monto>0&&i.value.estado));return e.watch(()=>i.value.tipo,e=>{if(i.value.fecha_inicio&&e){const s=new Date(i.value.fecha_inicio);let t=new Date(s);switch(e){case"quincenal":t.setDate(t.getDate()+15);break;case"mensual":t.setMonth(t.getMonth()+1);break;case"semestral":t.setMonth(t.getMonth()+6)}i.value.fecha_fin=t?.toISOString().split("T")[0]||""}}),(t,o,a,r)=>{n.mostrar?(o(`<div${s.ssrRenderAttrs(e.mergeProps({class:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 p-4"},r))}><div class="bg-white/95 backdrop-blur-md rounded-3xl shadow-2xl border border-white/50 max-w-3xl w-full max-h-[90vh] overflow-hidden relative"><div class="absolute inset-0 bg-gradient-to-br from-[#5550F2]/5 via-transparent to-[#04BF9D]/5 pointer-events-none"></div><div class="absolute -top-20 -right-20 w-40 h-40 bg-gradient-to-br from-[#F2B33D]/20 to-[#5550F2]/20 rounded-full blur-2xl"></div><div class="relative max-h-[90vh] overflow-y-auto"><div class="sticky top-0 bg-white/90 backdrop-blur-md border-b border-gray-200/50 px-8 py-6 flex justify-between items-center z-10"><div class="flex items-center gap-4"><div class="w-14 h-14 rounded-2xl bg-gradient-to-br from-[#5550F2] to-[#027368] shadow-lg flex items-center justify-center"><svg class="w-7 h-7 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 5v2m0 4v2m0 4v2M5 5a2 2 0 00-2 2v3a2 2 0 110 4v3a2 2 0 002 2h14a2 2 0 002-2v-3a2 2 0 110-4V7a2 2 0 00-2-2H5z"></path></svg></div><div><h2 class="text-3xl font-[&#39;Elms_Sans&#39;] font-bold bg-gradient-to-r from-[#5550F2] to-[#027368] bg-clip-text text-transparent">${s.ssrInterpolate(e.unref(l)?"Editar Bono":"Nuevo Bono")}</h2><p class="text-sm font-sans text-gray-600 mt-1">${s.ssrInterpolate(e.unref(l)?"Modifica los datos del bono de":"Crea un nuevo bono para")} ${s.ssrInterpolate(n.pacienteNombre)}</p></div></div><button class="p-3 text-gray-500 hover:text-[#5550F2] hover:bg-gradient-to-br from-[#5550F2]/10 to-[#027368]/10 rounded-2xl transition-all duration-300 backdrop-blur-sm border border-white/50 hover:shadow-lg" aria-label="Cerrar modal"><svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button></div><form class="px-8 py-8 space-y-8"><div class="grid grid-cols-2 gap-6"><div><label class="block text-sm font-sans font-semibold text-gray-700 mb-3"> Tipo de Bono <span class="text-[#F2B33D]">*</span></label><select required class="w-full px-4 py-3 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-[#5550F2]/20 focus:border-[#5550F2] bg-white/80 backdrop-blur-sm transition-all duration-300 font-sans hover:bg-white shadow-sm hover:shadow-md"><option value=""${s.ssrIncludeBooleanAttr(Array.isArray(e.unref(i).tipo)?s.ssrLooseContain(e.unref(i).tipo,""):s.ssrLooseEqual(e.unref(i).tipo,""))?" selected":""}>Seleccionar tipo</option><option value="quincenal"${s.ssrIncludeBooleanAttr(Array.isArray(e.unref(i).tipo)?s.ssrLooseContain(e.unref(i).tipo,"quincenal"):s.ssrLooseEqual(e.unref(i).tipo,"quincenal"))?" selected":""}>Quincenal</option><option value="mensual"${s.ssrIncludeBooleanAttr(Array.isArray(e.unref(i).tipo)?s.ssrLooseContain(e.unref(i).tipo,"mensual"):s.ssrLooseEqual(e.unref(i).tipo,"mensual"))?" selected":""}>Mensual</option><option value="semestral"${s.ssrIncludeBooleanAttr(Array.isArray(e.unref(i).tipo)?s.ssrLooseContain(e.unref(i).tipo,"semestral"):s.ssrLooseEqual(e.unref(i).tipo,"semestral"))?" selected":""}>Semestral</option></select></div><div><label class="block text-sm font-medium text-[#2D3748] mb-2"> Frecuencia Sugerida <span class="text-red-500">*</span></label><select required class="w-full px-4 py-2 border border-[#5550F2]/30 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#5550F2] bg-white"><option value=""${s.ssrIncludeBooleanAttr(Array.isArray(e.unref(i).frecuencia)?s.ssrLooseContain(e.unref(i).frecuencia,""):s.ssrLooseEqual(e.unref(i).frecuencia,""))?" selected":""}>Seleccionar frecuencia</option><option value="semanal"${s.ssrIncludeBooleanAttr(Array.isArray(e.unref(i).frecuencia)?s.ssrLooseContain(e.unref(i).frecuencia,"semanal"):s.ssrLooseEqual(e.unref(i).frecuencia,"semanal"))?" selected":""}>Semanal</option><option value="quincenal"${s.ssrIncludeBooleanAttr(Array.isArray(e.unref(i).frecuencia)?s.ssrLooseContain(e.unref(i).frecuencia,"quincenal"):s.ssrLooseEqual(e.unref(i).frecuencia,"quincenal"))?" selected":""}>Quincenal</option><option value="mensual"${s.ssrIncludeBooleanAttr(Array.isArray(e.unref(i).frecuencia)?s.ssrLooseContain(e.unref(i).frecuencia,"mensual"):s.ssrLooseEqual(e.unref(i).frecuencia,"mensual"))?" selected":""}>Mensual</option></select></div></div><div class="grid grid-cols-2 gap-4"><div><label class="block text-sm font-medium text-[#2D3748] mb-2"> Sesiones Totales <span class="text-red-500">*</span></label><input${s.ssrRenderAttr("value",e.unref(i).sesiones_totales)} type="number" min="1" max="100" required placeholder="Ej: 4, 8, 12..." class="w-full px-4 py-2 border border-[#5550F2]/30 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#5550F2]"><p class="text-xs text-[#2D3748]/60 mt-1"> Sesiones incluidas en el bono </p></div><div><label class="block text-sm font-medium text-[#2D3748] mb-2"> Sesiones Ya Usadas </label><input${s.ssrRenderAttr("value",e.unref(i).sesiones_usadas)} type="number" min="0"${s.ssrRenderAttr("max",e.unref(i).sesiones_totales-1)} placeholder="0" class="w-full px-4 py-2 border border-[#5550F2]/30 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#5550F2]"><p class="text-xs text-[#2D3748]/60 mt-1"> Para migraci√≥n desde otra plataforma </p></div></div>`),e.unref(i).sesiones_usadas>0?o(`<div class="flex items-center gap-2 p-3 bg-blue-50 border border-blue-200 rounded-lg"><span class="text-blue-600">‚ÑπÔ∏è</span><p class="text-sm text-blue-800"><strong>${s.ssrInterpolate(e.unref(f))}</strong> de ${s.ssrInterpolate(e.unref(i).sesiones_totales)} sesiones disponibles (${s.ssrInterpolate(e.unref(i).sesiones_usadas)} ya consumidas) </p></div>`):o("\x3c!----\x3e"),o(`<div><label class="block text-sm font-medium text-[#2D3748] mb-2"> Monto Total <span class="text-red-500">*</span></label><div class="relative"><span class="absolute left-3 top-1/2 -translate-y-1/2 text-[#2D3748]/60">‚Ç¨</span><input${s.ssrRenderAttr("value",e.unref(i).monto)} type="number" min="0" step="0.01" required placeholder="0.00" class="w-full pl-8 pr-4 py-2 border border-[#5550F2]/30 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#5550F2]"></div><p class="text-xs text-[#2D3748]/60 mt-1"> Precio total del bono (todas las sesiones) </p></div><div class="grid grid-cols-2 gap-4"><div><label class="block text-sm font-medium text-[#2D3748] mb-2"> Fecha de Inicio </label><input${s.ssrRenderAttr("value",e.unref(i).fecha_inicio)} type="date" class="w-full px-4 py-2 border border-[#5550F2]/30 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#5550F2]"></div><div><label class="block text-sm font-medium text-[#2D3748] mb-2"> Fecha de Vencimiento </label><input${s.ssrRenderAttr("value",e.unref(i).fecha_fin)} type="date"${s.ssrRenderAttr("min",e.unref(i).fecha_inicio)} class="w-full px-4 py-2 border border-[#5550F2]/30 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#5550F2]"></div></div><div class="flex items-start gap-3 p-4 bg-purple-50 border border-purple-200 rounded-lg"><input${s.ssrIncludeBooleanAttr(Array.isArray(e.unref(i).renovacion_automatica)?s.ssrLooseContain(e.unref(i).renovacion_automatica,null):e.unref(i).renovacion_automatica)?" checked":""} type="checkbox" id="renovacion-auto" class="mt-1 w-4 h-4 text-purple-600 border-gray-300 rounded focus:ring-purple-500"><label for="renovacion-auto" class="flex-1 cursor-pointer"><div class="text-sm font-medium text-purple-900 flex items-center gap-1.5"><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path></svg> Renovaci√≥n Autom√°tica </div><div class="text-xs text-purple-700 mt-1"> El bono se renovar√° autom√°ticamente cuando se complete o venza </div></label></div><div><label class="block text-sm font-medium text-[#2D3748] mb-2"> Estado Inicial </label><div class="grid grid-cols-2 gap-3"><label class="${s.ssrRenderClass(["pendiente"===e.unref(i).estado?"border-yellow-400 bg-yellow-50":"border-gray-300 hover:border-yellow-300","flex items-center gap-2 p-3 border-2 rounded-lg cursor-pointer transition-all"])}"><input${s.ssrIncludeBooleanAttr(s.ssrLooseEqual(e.unref(i).estado,"pendiente"))?" checked":""} type="radio" value="pendiente" class="w-4 h-4 text-yellow-600"><div><div class="text-sm font-medium text-[#2D3748]">‚è≥ Pendiente</div><div class="text-xs text-[#2D3748]/60">Requiere pago</div></div></label><label class="${s.ssrRenderClass(["activo"===e.unref(i).estado?"border-green-400 bg-green-50":"border-gray-300 hover:border-green-300","flex items-center gap-2 p-3 border-2 rounded-lg cursor-pointer transition-all"])}"><input${s.ssrIncludeBooleanAttr(s.ssrLooseEqual(e.unref(i).estado,"activo"))?" checked":""} type="radio" value="activo" class="w-4 h-4 text-green-600"><div><div class="text-sm font-medium text-[#2D3748]">‚úÖ Activo</div><div class="text-xs text-[#2D3748]/60">Ya pagado</div></div></label></div></div><div><label class="block text-sm font-medium text-[#2D3748] mb-2"> Notas (Opcional) </label><textarea rows="3" placeholder="Informaci√≥n adicional sobre el bono..." class="w-full px-4 py-2 border border-[#5550F2]/30 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#5550F2] resize-none">${s.ssrInterpolate(e.unref(i).notas)}</textarea></div>`),e.unref(c)?o(`<div class="p-4 bg-gradient-to-r from-[#5550F2]/10 to-[#ECC8BA]/10 rounded-lg border border-[#5550F2]/30"><div class="font-medium text-[#2D3748] mb-3 flex items-center gap-2"><span>üìã</span> Resumen del Bono </div><div class="grid grid-cols-2 gap-3 text-sm"><div><span class="text-[#2D3748]/60">Tipo:</span><span class="font-medium text-[#2D3748] ml-1 capitalize">${s.ssrInterpolate(e.unref(i).tipo||"-")}</span></div><div><span class="text-[#2D3748]/60">Frecuencia:</span><span class="font-medium text-[#2D3748] ml-1 capitalize">${s.ssrInterpolate(e.unref(i).frecuencia||"-")}</span></div><div><span class="text-[#2D3748]/60">Sesiones:</span><span class="font-medium text-[#2D3748] ml-1">${s.ssrInterpolate(e.unref(f))}/${s.ssrInterpolate(e.unref(i).sesiones_totales||0)}</span></div><div><span class="text-[#2D3748]/60">Monto:</span><span class="font-medium text-[#2D3748] ml-1">‚Ç¨${s.ssrInterpolate(e.unref(i).monto||0)}</span></div><div><span class="text-[#2D3748]/60">Precio/sesi√≥n:</span><span class="font-medium text-[#2D3748] ml-1">‚Ç¨${s.ssrInterpolate(e.unref(p))}</span></div><div><span class="text-[#2D3748]/60">Estado:</span><span class="${s.ssrRenderClass(["activo"===e.unref(i).estado?"text-green-600":"text-yellow-600","font-medium capitalize ml-1"])}">${s.ssrInterpolate(e.unref(i).estado||"-")}</span></div></div></div>`):o("\x3c!----\x3e"),e.unref(u)?o(`<div class="p-4 bg-red-50 border border-red-200 rounded-lg"><p class="text-sm text-red-700 flex items-center gap-2"><span>‚ùå</span> ${s.ssrInterpolate(e.unref(u))}</p></div>`):o("\x3c!----\x3e"),o(`<div class="flex gap-3 pt-4 border-t border-[#5550F2]/30"><button type="button" class="flex-1 px-6 py-3 bg-white border border-[#5550F2]/30 text-[#2D3748] rounded-lg hover:bg-[#5550F2]/10 transition-colors font-medium"${s.ssrIncludeBooleanAttr(e.unref(d))?" disabled":""}> Cancelar </button><button type="submit" class="flex-1 px-6 py-3 bg-[#5550F2] text-white rounded-lg hover:bg-[#C89B8A] transition-colors font-medium disabled:opacity-50 disabled:cursor-not-allowed"${s.ssrIncludeBooleanAttr(e.unref(d)||!e.unref(m))?" disabled":""}>${s.ssrInterpolate(e.unref(d)?e.unref(l)?"Guardando...":"Creando...":e.unref(l)?"Guardar Cambios":"Crear Bono")}</button></div></form></div></div></div>`)):o("\x3c!----\x3e")}}}),a=n.setup;n.setup=(s,t)=>{const o=e.useSSRContext();return(o.modules||(o.modules=new Set)).add("components/ModalNuevoBono.vue"),a?a(s,t):void 0};const r=Object.assign(n,{__name:"ModalNuevoBono"});export{r as _};
//# sourceMappingURL=ModalNuevoBono-Mje0VtwW.mjs.map
