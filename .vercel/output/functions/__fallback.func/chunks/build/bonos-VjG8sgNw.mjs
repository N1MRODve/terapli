import{v as e,a as t,s}from"./server.mjs";import{u as r}from"./useSupabaseClient-DykwVqLQ.mjs";import{u as n}from"./useSupabase-DfFg84CY.mjs";import{u as o}from"./useBonos-B2-LOzOF.mjs";import{r as a}from"./PlusIcon-CHLzv-V9.mjs";import{r as l}from"./CurrencyEuroIcon-DCwNI2Go.mjs";import{r as i}from"./ChevronRightIcon-4xxNHuWW.mjs";import{r as d}from"./CheckCircleIcon-CT9fzVFs.mjs";import{r as c}from"./ExclamationTriangleIcon-DQdM2y0F.mjs";import{r as p,a as u}from"./EllipsisVerticalIcon-BWwSvj92.mjs";import{r as x}from"./ExclamationCircleIcon-DhXgUVTW.mjs";import{r as m}from"./UserGroupIcon-BhthmHUw.mjs";import{r as g}from"./ClockIcon-BxdFtPqx.mjs";import{r as f}from"./ChevronDownIcon-CvdhRGll.mjs";import{r as b}from"./TicketIcon-zZdrc71S.mjs";import{r as v}from"./ClipboardDocumentListIcon-tIc_vSd1.mjs";import{r as y}from"./CalendarIcon-BrsGHJBC.mjs";import{r as h}from"./PencilIcon-BKWXEWgS.mjs";import{r as w}from"./TrashIcon-3HGFGGDp.mjs";import{r as $}from"./MagnifyingGlassIcon-GsbNDyPZ.mjs";import{r as _}from"./XMarkIcon-DCLwyE-W.mjs";import"../routes/renderer.mjs";import"../nitro/nitro.mjs";import"node:http";import"node:https";import"node:events";import"node:buffer";import"node:fs";import"node:path";import"node:crypto";import"../_/shared.cjs.prod.mjs";import"../virtual/_commonjsHelpers.mjs";import"node:stream";import"../_/index2.mjs";import"@supabase/supabase-js";import"@vercel/analytics/nuxt";function render$3(t,s){return e.openBlock(),e.createElementBlock("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e.createElementVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m20.25 7.5-.625 10.632a2.25 2.25 0 0 1-2.247 2.118H6.622a2.25 2.25 0 0 1-2.247-2.118L3.75 7.5M10 11.25h4M3.375 7.5h17.25c.621 0 1.125-.504 1.125-1.125v-1.5c0-.621-.504-1.125-1.125-1.125H3.375c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125Z"})])}function render$2(t,s){return e.openBlock(),e.createElementBlock("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e.createElementVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15.75 5.25v13.5m-7.5-13.5v13.5"})])}function render$1(t,s){return e.openBlock(),e.createElementBlock("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e.createElementVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M5.25 5.653c0-.856.917-1.398 1.667-.986l11.54 6.347a1.125 1.125 0 0 1 0 1.972l-11.54 6.347a1.125 1.125 0 0 1-1.667-.986V5.653Z"})])}function render(t,s){return e.openBlock(),e.createElementBlock("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e.createElementVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 9v6m3-3H9m12 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})])}const C=e.defineComponent({__name:"bonos",__ssrInlineRender:!0,setup(C){t(),r(),n();const{calcularPorcentajeUso:I}=o(),A=e.ref("pacientes"),R=e.ref([]),j=e.ref(null);e.ref(!1),e.ref(!1),e.ref(null);const P=e.ref([]),B=e.ref(!1),L=e.ref(null),k=e.ref({nombre:"",descripcion:"",sesiones:4,precio:160,frecuencia:"mensual"}),q=e.ref({semanal:40,quincenal:50,unica:60}),E=e.ref({semanal:40,quincenal:50,unica:60}),S=e.ref(!1),T=e.ref(!1),D=e.computed(()=>JSON.stringify(q.value)!==JSON.stringify(E.value)),V=e.ref([]),H=e.ref(!1),M=e.ref(""),N=e.ref(""),z=e.ref(""),F=e.ref("reciente"),G=e.ref(null),U=e.ref([]),O=e.computed(()=>{const e=new Map;for(const t of V.value){const s=t.tipo||"otro";e.has(s)||e.set(s,{tipo:s,pacientes:[],activos:0,completados:0,montoTotal:0,montoPendiente:0,precioPromedio:0,sesionesPromedio:0});const r=e.get(s);let n=r.pacientes.find(e=>e.paciente_id===t.paciente_id);n||(n={paciente_id:t.paciente_id,nombre:t.paciente_nombre||"Desconocido",bonoActivo:null,bonosHistoricos:[],totalBonos:0,montoTotal:0,montoPendiente:0},r.pacientes.push(n));const o={bono_id:t.id,paciente_id:t.paciente_id,nombre:t.paciente_nombre||"Desconocido",sesiones_usadas:t.sesiones_totales-t.sesiones_restantes,sesiones_totales:t.sesiones_totales,estado:t.estado,monto:t.monto_total||0,pagado:t.pagado,created_at:t.created_at},a="activo"===t.estado||"pendiente"===t.estado&&t.sesiones_restantes>0;"completado"===t.estado||"agotado"===t.estado||t.sesiones_restantes,a&&!n.bonoActivo?n.bonoActivo=o:a&&n.bonoActivo&&new Date(t.created_at)>new Date(n.bonoActivo.created_at)?(n.bonosHistoricos.push(n.bonoActivo),n.bonoActivo=o):n.bonosHistoricos.push(o),n.totalBonos++,n.montoTotal+=t.monto_total||0,t.pagado||(n.montoPendiente+=t.monto_total||0),r.montoTotal+=t.monto_total||0,t.pagado||(r.montoPendiente+=t.monto_total||0),"activo"===t.estado&&r.activos++,"completado"!==t.estado&&0!==t.sesiones_restantes||r.completados++}for(const t of e.values()){for(const e of t.pacientes)e.bonosHistoricos.sort((e,t)=>new Date(t.created_at).getTime()-new Date(e.created_at).getTime());if(t.pacientes.length>0){const e=t.pacientes.reduce((e,t)=>e+t.totalBonos,0);t.precioPromedio=t.montoTotal/e;const s=t.pacientes.reduce((e,t)=>e+(t.bonoActivo?.sesiones_totales||0)+t.bonosHistoricos.reduce((e,t)=>e+t.sesiones_totales,0),0);t.sesionesPromedio=Math.round(s/e)}}return Array.from(e.values()).sort((e,t)=>t.pacientes.length-e.pacientes.length)}),W=e.computed(()=>{const e=new Map;for(const t of V.value){const s=t.paciente_id;if(!s)continue;e.has(s)||e.set(s,{id:s,nombre:t.paciente_nombre||"Desconocido",bonos:[],sesionesUsadas:0,sesionesTotales:0,montoTotal:0,montoPendiente:0,requiereAccion:!1,prioridad:"normal"});const r=e.get(s);r.bonos.push(t),r.sesionesUsadas+=t.sesiones_totales-t.sesiones_restantes,r.sesionesTotales+=t.sesiones_totales,r.montoTotal+=t.monto_total||0,t.pagado||(r.montoPendiente+=t.monto_total||0);const n=0===t.sesiones_restantes,o=!t.pagado;n&&o?(r.requiereAccion=!0,r.prioridad="urgente"):(t.sesiones_restantes<=2&&"activo"===t.estado||o)&&(r.requiereAccion=!0,"urgente"!==r.prioridad&&(r.prioridad="atencion"))}return Array.from(e.values()).sort((e,t)=>{const s={urgente:0,atencion:1,normal:2},r=s[e.prioridad],n=s[t.prioridad];return r!==n?r-n:t.montoPendiente-e.montoPendiente})});e.computed(()=>V.value.filter(e=>"activo"===e.estado).length);const Q=e.computed(()=>{const e=V.value.filter(e=>"activo"===e.estado).length,t=V.value.filter(e=>"pendiente"===e.estado).length,s=V.value.filter(e=>"completado"===e.estado||"agotado"===e.estado||0===e.sesiones_restantes).length,r=V.value.filter(e=>!e.pagado),n=r.reduce((e,t)=>e+(t.monto_total||0),0),o=V.value.filter(e=>"activo"===e.estado&&e.sesiones_restantes<=2&&e.sesiones_restantes>0).length,a=V.value.filter(e=>0===e.sesiones_restantes&&!e.pagado).length;return{activos:e,pendientes:t,completados:s,montoPendiente:n,bonosSinPagar:r.length,proximosAgotar:o,urgentes:a}}),Z=e.computed(()=>{let e=[...V.value];if(G.value&&("pendientes_cobro"===G.value?e=e.filter(e=>!e.pagado):"proximos_agotar"===G.value?e=e.filter(e=>"activo"===e.estado&&e.sesiones_restantes<=2&&e.sesiones_restantes>0):"urgentes"===G.value&&(e=e.filter(e=>0===e.sesiones_restantes&&!e.pagado))),M.value){const t=M.value.toLowerCase();e=e.filter(e=>e.paciente_nombre?.toLowerCase().includes(t))}return N.value&&(e=e.filter(e=>e.estado===N.value)),z.value&&("pagado"===z.value?e=e.filter(e=>e.pagado):"pendiente"===z.value&&(e=e.filter(e=>!e.pagado))),"reciente"===F.value?e.sort((e,t)=>new Date(t.created_at).getTime()-new Date(e.created_at).getTime()):"antiguo"===F.value?e.sort((e,t)=>new Date(e.created_at).getTime()-new Date(t.created_at).getTime()):"nombre"===F.value?e.sort((e,t)=>(e.paciente_nombre||"").localeCompare(t.paciente_nombre||"")):"monto_desc"===F.value?e.sort((e,t)=>(t.monto_total||0)-(e.monto_total||0)):"monto_asc"===F.value?e.sort((e,t)=>(e.monto_total||0)-(t.monto_total||0)):"progreso"===F.value&&e.sort((e,t)=>{const s=e.sesiones_totales>0?(e.sesiones_totales-e.sesiones_restantes)/e.sesiones_totales:0;return(t.sesiones_totales>0?(t.sesiones_totales-t.sesiones_restantes)/t.sesiones_totales:0)-s}),e}),formatearPrecio=e=>e?.toFixed(2)||"0.00",frecuenciaLabel=e=>({semanal:"Semanal",quincenal:"Quincenal",mensual:"Mensual",cualquiera:"Cualquiera",otro:"Otro"}[e]||e||"Otro"),getIniciales=e=>e?e.split(" ").map(e=>e[0]).join("").substring(0,2).toUpperCase():"?",getEstadoColorPunto=e=>({activo:"bg-green-500",pendiente:"bg-amber-500",completado:"bg-gray-400",vencido:"bg-red-500",agotado:"bg-gray-400"}[e]||"bg-gray-400"),getProgresoColor=e=>"activo"===e.estado?"bg-purple-500":"completado"===e.estado||"agotado"===e.estado?"bg-green-500":"bg-gray-400",getProgresoColorSemantico=e=>{const t=e.sesiones_totales-e.sesiones_usadas,s=t/e.sesiones_totales*100;return 0===t||s<25?"bg-red-500":s<=50?"bg-amber-500":"bg-green-500"},getUrgenciaPacienteTipo=e=>{const t=e.sesiones_totales-e.sesiones_usadas;return 0!==t||e.pagado?t<=2&&t>0&&e.pagado?{texto:"Casi agotado",clase:"bg-orange-100 text-orange-700",icono:c}:!e.pagado&&t>0?{texto:"Sin pagar",clase:"bg-amber-100 text-amber-700",icono:g}:null:{texto:"Cobrar",clase:"bg-red-100 text-red-700",icono:x}},getTipoBonoColor=e=>({semanal:"bg-blue-100 text-blue-600",quincenal:"bg-purple-100 text-purple-600",mensual:"bg-amber-100 text-amber-600","5_sesiones":"bg-emerald-100 text-emerald-600","10_sesiones":"bg-teal-100 text-teal-600",personalizado:"bg-pink-100 text-pink-600",otro:"bg-gray-100 text-gray-600"}[e]||"bg-gray-100 text-gray-600"),getPrioridadPacienteClase=e=>"urgente"===e.prioridad?"bg-red-100 text-red-700 border border-red-200":"atencion"===e.prioridad?"bg-amber-100 text-amber-700 border border-amber-200":"bg-gray-100 text-gray-600",getEstadoUnificadoClase=e=>0!==e.sesiones_restantes||e.pagado?0===e.sesiones_restantes&&e.pagado?"bg-green-100 text-green-700":e.sesiones_restantes<=2&&"activo"===e.estado?"bg-orange-100 text-orange-700":"activo"===e.estado?"bg-blue-100 text-blue-700":"pendiente"===e.estado?"bg-amber-100 text-amber-700":"bg-gray-100 text-gray-600":"bg-red-100 text-red-700",getProgresoColorUnificado=e=>0!==e.sesiones_restantes||e.pagado?0===e.sesiones_restantes?"bg-green-500":e.sesiones_restantes<=2?"bg-orange-500":"bg-purple-500":"bg-red-500",formatearFechaCorta=e=>e?new Date(e).toLocaleDateString("es-ES",{day:"numeric",month:"short"}):"";return(t,r,n,o)=>{r(`<div${s.ssrRenderAttrs(o)}><header class="mb-6"><div class="flex items-center justify-between mb-4"><div class="flex items-center gap-6"><h1 class="text-2xl font-semibold text-gray-900">Bonos</h1><nav class="flex items-center gap-1 bg-gray-100 rounded-lg p-1"><button class="${s.ssrRenderClass(["pacientes"===e.unref(A)?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900","px-3 py-1.5 text-sm font-medium rounded-md transition-all"])}"> Por Paciente <span class="${s.ssrRenderClass(["pacientes"===e.unref(A)?"text-gray-500":"text-gray-400","ml-1 text-xs"])}">${s.ssrInterpolate(e.unref(W).length)}</span></button><button class="${s.ssrRenderClass(["resumen"===e.unref(A)?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900","px-3 py-1.5 text-sm font-medium rounded-md transition-all"])}"> Por Tipo <span class="${s.ssrRenderClass(["resumen"===e.unref(A)?"text-gray-500":"text-gray-400","ml-1 text-xs"])}">${s.ssrInterpolate(e.unref(O).length)}</span></button><button class="${s.ssrRenderClass(["bonos"===e.unref(A)?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900","px-3 py-1.5 text-sm font-medium rounded-md transition-all"])}"> Todos <span class="${s.ssrRenderClass(["bonos"===e.unref(A)?"text-gray-500":"text-gray-400","ml-1 text-xs"])}">${s.ssrInterpolate(e.unref(V).length)}</span></button><button class="${s.ssrRenderClass(["plantillas"===e.unref(A)?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900","px-3 py-1.5 text-sm font-medium rounded-md transition-all"])}"> Plantillas <span class="${s.ssrRenderClass(["plantillas"===e.unref(A)?"text-gray-500":"text-gray-400","ml-1 text-xs"])}">${s.ssrInterpolate(e.unref(P).length)}</span></button></nav></div>`),"plantillas"===e.unref(A)?(r('<button class="h-10 px-4 bg-purple-600 text-white text-sm font-medium rounded-lg hover:bg-purple-700 transition-colors flex items-center gap-2 shadow-sm">'),r(s.ssrRenderComponent(e.unref(a),{class:"w-4 h-4"},null,n)),r(" Nueva Plantilla </button>")):r("\x3c!----\x3e"),r("</div>"),"bonos"===e.unref(A)||"resumen"===e.unref(A)||"pacientes"===e.unref(A)?(r('<div class="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-5 gap-3 mb-4"><div class="col-span-2 md:col-span-1 bg-gradient-to-br from-amber-50 to-orange-50 border border-amber-200 rounded-xl p-4 cursor-pointer hover:shadow-md transition-all group"><div class="flex items-center gap-2 mb-1"><div class="w-8 h-8 bg-amber-100 rounded-lg flex items-center justify-center">'),r(s.ssrRenderComponent(e.unref(l),{class:"w-4 h-4 text-amber-600"},null,n)),r(`</div><span class="text-xs font-medium text-amber-600 uppercase">Por Cobrar</span></div><p class="text-2xl font-bold text-amber-900">${s.ssrInterpolate(formatearPrecio(e.unref(Q).montoPendiente))}€</p><div class="flex items-center justify-between mt-1"><p class="text-xs text-amber-600">${s.ssrInterpolate(e.unref(Q).bonosSinPagar)} bonos</p><span class="text-xs text-amber-500 group-hover:text-amber-700 flex items-center gap-1"> Ver `),r(s.ssrRenderComponent(e.unref(i),{class:"w-3 h-3"},null,n)),r('</span></div></div><div class="bg-white border border-gray-100 rounded-xl p-4"><div class="flex items-center gap-2 mb-1"><div class="w-8 h-8 bg-green-100 rounded-lg flex items-center justify-center">'),r(s.ssrRenderComponent(e.unref(d),{class:"w-4 h-4 text-green-600"},null,n)),r(`</div><span class="text-xs font-medium text-green-600 uppercase">Activos</span></div><p class="text-2xl font-bold text-gray-900">${s.ssrInterpolate(e.unref(Q).activos)}</p><p class="text-xs text-gray-500 mt-1">En uso actualmente</p></div>`),e.unref(Q).proximosAgotar>0?(r('<div class="bg-gradient-to-br from-red-50 to-rose-50 border border-red-200 rounded-xl p-4 cursor-pointer hover:shadow-md transition-all group"><div class="flex items-center gap-2 mb-1"><div class="w-8 h-8 bg-red-100 rounded-lg flex items-center justify-center">'),r(s.ssrRenderComponent(e.unref(c),{class:"w-4 h-4 text-red-600"},null,n)),r(`</div><span class="text-xs font-medium text-red-600 uppercase">Por Agotar</span></div><p class="text-2xl font-bold text-red-900">${s.ssrInterpolate(e.unref(Q).proximosAgotar)}</p><div class="flex items-center justify-between mt-1"><p class="text-xs text-red-600">≤2 sesiones</p><span class="text-xs text-red-500 group-hover:text-red-700 flex items-center gap-1"> Ver `),r(s.ssrRenderComponent(e.unref(i),{class:"w-3 h-3"},null,n)),r("</span></div></div>")):(r('<div class="bg-white border border-gray-100 rounded-xl p-4"><div class="flex items-center gap-2 mb-1"><div class="w-8 h-8 bg-gray-100 rounded-lg flex items-center justify-center">'),r(s.ssrRenderComponent(e.unref(p),{class:"w-4 h-4 text-gray-600"},null,n)),r(`</div><span class="text-xs font-medium text-gray-600 uppercase">Finalizados</span></div><p class="text-2xl font-bold text-gray-900">${s.ssrInterpolate(e.unref(Q).completados)}</p><p class="text-xs text-gray-500 mt-1">Este mes</p></div>`)),e.unref(Q).urgentes>0?(r('<div class="bg-gradient-to-br from-red-100 to-rose-100 border-2 border-red-300 rounded-xl p-4 cursor-pointer hover:shadow-md transition-all group animate-pulse-subtle"><div class="flex items-center gap-2 mb-1"><div class="w-8 h-8 bg-red-200 rounded-lg flex items-center justify-center">'),r(s.ssrRenderComponent(e.unref(x),{class:"w-4 h-4 text-red-700"},null,n)),r(`</div><span class="text-xs font-medium text-red-700 uppercase">Urgente</span></div><p class="text-2xl font-bold text-red-900">${s.ssrInterpolate(e.unref(Q).urgentes)}</p><div class="flex items-center justify-between mt-1"><p class="text-xs text-red-700">Agotados sin pagar</p><span class="text-xs text-red-600 group-hover:text-red-800 flex items-center gap-1"> Ver `),r(s.ssrRenderComponent(e.unref(i),{class:"w-3 h-3"},null,n)),r("</span></div></div>")):r("\x3c!----\x3e"),e.unref(Q).proximosAgotar>0?(r('<div class="bg-white border border-gray-100 rounded-xl p-4"><div class="flex items-center gap-2 mb-1"><div class="w-8 h-8 bg-gray-100 rounded-lg flex items-center justify-center">'),r(s.ssrRenderComponent(e.unref(render$3),{class:"w-4 h-4 text-gray-600"},null,n)),r(`</div><span class="text-xs font-medium text-gray-600 uppercase">Finalizados</span></div><p class="text-2xl font-bold text-gray-900">${s.ssrInterpolate(e.unref(Q).completados)}</p><p class="text-xs text-gray-500 mt-1">Sesiones agotadas</p></div>`)):r("\x3c!----\x3e"),r("</div>")):r("\x3c!----\x3e"),r("</header>"),"pacientes"===e.unref(A)?(r('<div class="space-y-4">'),e.unref(H)?r('<div class="flex items-center justify-center py-20"><div class="w-8 h-8 border-2 border-purple-600 border-t-transparent rounded-full animate-spin"></div></div>'):0===e.unref(W).length?(r('<div class="bg-white border border-gray-100 rounded-lg py-12 text-center">'),r(s.ssrRenderComponent(e.unref(m),{class:"w-12 h-12 text-gray-300 mx-auto mb-3"},null,n)),r('<p class="text-gray-600 font-medium mb-1">Sin bonos asignados</p><p class="text-sm text-gray-400">Los bonos de tus pacientes aparecerán aquí</p></div>')):(r('<div class="space-y-3">\x3c!--[--\x3e'),s.ssrRenderList(e.unref(W),t=>{r(`<div class="bg-white border border-gray-100 rounded-lg overflow-hidden"><div class="px-4 py-3 flex items-center justify-between cursor-pointer hover:bg-gray-50/50 transition-colors"><div class="flex items-center gap-3"><div class="w-10 h-10 rounded-full bg-purple-100 text-purple-600 flex items-center justify-center text-sm font-semibold">${s.ssrInterpolate(getIniciales(t.nombre))}</div><div><p class="font-medium text-gray-900">${s.ssrInterpolate(t.nombre)}</p><div class="flex items-center gap-2 text-xs text-gray-500"><span>${s.ssrInterpolate(t.bonos.length)} ${s.ssrInterpolate(1===t.bonos.length?"bono":"bonos")}</span><span class="text-gray-300">|</span><span>${s.ssrInterpolate(t.sesionesUsadas)}/${s.ssrInterpolate(t.sesionesTotales)} sesiones</span></div></div></div><div class="flex items-center gap-4">`),t.requiereAccion?(r(`<span class="${s.ssrRenderClass([getPrioridadPacienteClase(t),"inline-flex items-center gap-1.5 px-2.5 py-1 rounded-full text-xs font-medium"])}">`),"urgente"===t.prioridad?r(s.ssrRenderComponent(e.unref(x),{class:"w-3.5 h-3.5"},null,n)):"atencion"===t.prioridad?r(s.ssrRenderComponent(e.unref(g),{class:"w-3.5 h-3.5"},null,n)):r("\x3c!----\x3e"),r(` ${s.ssrInterpolate((e=>"urgente"===e.prioridad?"Cobro urgente":"atencion"===e.prioridad?"Requiere atención":"")(t))}</span>`)):r("\x3c!----\x3e"),r(`<div class="text-right min-w-[80px]"><p class="text-sm font-semibold text-gray-900">${s.ssrInterpolate(formatearPrecio(t.montoTotal))}€</p><p class="${s.ssrRenderClass([t.montoPendiente>0?"text-amber-600":"text-green-600","text-xs"])}">${s.ssrInterpolate(t.montoPendiente>0?`${formatearPrecio(t.montoPendiente)}€ pend.`:"Todo pagado")}</p></div>`),r(s.ssrRenderComponent(e.unref(f),{class:["w-5 h-5 text-gray-400 transition-transform",{"rotate-180":e.unref(R).includes(t.id)}]},null,n)),r("</div></div>"),e.unref(R).includes(t.id)?(r('<div class="border-t border-gray-100 overflow-hidden"><div class="divide-y divide-gray-50">\x3c!--[--\x3e'),s.ssrRenderList(t.bonos,t=>{r(`<div class="px-4 py-3 pl-16 hover:bg-gray-50/50 transition-colors group"><div class="flex items-center justify-between"><div class="flex items-center gap-3 cursor-pointer flex-1"><div class="${s.ssrRenderClass([getTipoBonoColor(t.tipo),"w-8 h-8 rounded-lg flex items-center justify-center"])}">`),r(s.ssrRenderComponent(e.unref(b),{class:"w-4 h-4"},null,n)),r(`</div><div><div class="flex items-center gap-2"><span class="text-sm font-medium text-gray-900">${s.ssrInterpolate(frecuenciaLabel(t.tipo))}</span><span class="${s.ssrRenderClass([getEstadoUnificadoClase(t),"inline-flex items-center gap-1 px-2 py-0.5 rounded text-xs font-medium"])}">`),s.ssrRenderVNode(r,e.createVNode(e.resolveDynamicComponent((e=>0!==e.sesiones_restantes||e.pagado?0===e.sesiones_restantes?d:e.sesiones_restantes<=2&&"activo"===e.estado?c:"activo"===e.estado?d:"pendiente"===e.estado?g:p:x)(t)),{class:"w-3 h-3"},null),n),r(` ${s.ssrInterpolate((e=>0!==e.sesiones_restantes||e.pagado?0===e.sesiones_restantes?"Finalizado":e.sesiones_restantes<=2&&"activo"===e.estado?"Por agotar":"activo"===e.estado?"Activo":"pendiente"===e.estado?"Sin iniciar":"Finalizado":"Cobrar")(t))}</span></div><p class="text-xs text-gray-500">${s.ssrInterpolate(t.sesiones_totales-t.sesiones_restantes)}/${s.ssrInterpolate(t.sesiones_totales)} sesiones `),t.fecha_fin?r(`<span class="ml-2">• Vence ${s.ssrInterpolate(formatearFechaCorta(t.fecha_fin))}</span>`):r("\x3c!----\x3e"),r('</p></div></div><div class="flex items-center gap-3">'),t.pagado?0===t.sesiones_restantes?(r('<button class="hidden sm:flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium bg-purple-100 text-purple-700 hover:bg-purple-200 rounded-lg transition-all">'),r(s.ssrRenderComponent(e.unref(a),{class:"w-3.5 h-3.5"},null,n)),r(" Nuevo bono </button>")):r("\x3c!----\x3e"):(r(`<button class="${s.ssrRenderClass([0===t.sesiones_restantes?"bg-red-100 text-red-700 hover:bg-red-200":"bg-amber-100 text-amber-700 hover:bg-amber-200","hidden sm:flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium rounded-lg transition-all"])}">`),r(s.ssrRenderComponent(e.unref(l),{class:"w-3.5 h-3.5"},null,n)),r(` ${s.ssrInterpolate(0===t.sesiones_restantes?"Cobrar ahora":"Registrar pago")}</button>`)),r(`<div class="w-16 h-1.5 bg-gray-200 rounded-full overflow-hidden hidden md:block"><div class="${s.ssrRenderClass([getProgresoColorUnificado(t),"h-full rounded-full transition-all"])}" style="${s.ssrRenderStyle({width:`${e.unref(I)(t)}%`})}"></div></div><div class="text-right min-w-[60px]"><p class="text-sm font-medium text-gray-900">${s.ssrInterpolate(t.monto_total)}€</p><p class="${s.ssrRenderClass([t.pagado?"text-green-600":"text-amber-600","text-xs"])}">${s.ssrInterpolate(t.pagado?"Pagado":"Pendiente")}</p></div><div class="relative"><button class="p-1.5 rounded-lg text-gray-400 hover:text-gray-600 hover:bg-gray-100 transition-colors">`),r(s.ssrRenderComponent(e.unref(u),{class:"w-5 h-5"},null,n)),r("</button>"),e.unref(j)===t.id?(r('<div class="absolute right-0 top-full mt-1 w-48 bg-white rounded-lg shadow-lg border border-gray-100 py-1 z-50"><button class="w-full px-3 py-2 text-left text-sm text-gray-700 hover:bg-gray-50 flex items-center gap-2">'),r(s.ssrRenderComponent(e.unref(v),{class:"w-4 h-4 text-gray-400"},null,n)),r(" Ver historial </button>"),t.pagado?r("\x3c!----\x3e"):(r('<button class="w-full px-3 py-2 text-left text-sm text-gray-700 hover:bg-gray-50 flex items-center gap-2">'),r(s.ssrRenderComponent(e.unref(l),{class:"w-4 h-4 text-gray-400"},null,n)),r(" Registrar pago </button>")),"activo"===t.estado&&t.sesiones_restantes>0?(r('<button class="w-full px-3 py-2 text-left text-sm text-gray-700 hover:bg-gray-50 flex items-center gap-2">'),r(s.ssrRenderComponent(e.unref(y),{class:"w-4 h-4 text-gray-400"},null,n)),r(" Añadir sesión </button>")):r("\x3c!----\x3e"),r('<button class="w-full px-3 py-2 text-left text-sm text-gray-700 hover:bg-gray-50 flex items-center gap-2">'),r(s.ssrRenderComponent(e.unref(h),{class:"w-4 h-4 text-gray-400"},null,n)),r(' Editar bono </button><div class="border-t border-gray-100 my-1"></div>'),"activo"===t.estado?(r('<button class="w-full px-3 py-2 text-left text-sm text-amber-600 hover:bg-amber-50 flex items-center gap-2">'),r(s.ssrRenderComponent(e.unref(render$2),{class:"w-4 h-4"},null,n)),r(" Pausar bono </button>")):"pausado"===t.estado?(r('<button class="w-full px-3 py-2 text-left text-sm text-green-600 hover:bg-green-50 flex items-center gap-2">'),r(s.ssrRenderComponent(e.unref(render$1),{class:"w-4 h-4"},null,n)),r(" Reactivar bono </button>")):r("\x3c!----\x3e"),0===t.sesiones_restantes?(r('<button class="w-full px-3 py-2 text-left text-sm text-purple-600 hover:bg-purple-50 flex items-center gap-2">'),r(s.ssrRenderComponent(e.unref(render),{class:"w-4 h-4"},null,n)),r(" Crear nuevo bono </button>")):r("\x3c!----\x3e"),r('<button class="w-full px-3 py-2 text-left text-sm text-red-600 hover:bg-red-50 flex items-center gap-2">'),r(s.ssrRenderComponent(e.unref(w),{class:"w-4 h-4"},null,n)),r(" Eliminar bono </button></div>")):r("\x3c!----\x3e"),r("</div></div></div></div>")}),r("\x3c!--]--\x3e</div></div>")):r("\x3c!----\x3e"),r("</div>")}),r("\x3c!--]--\x3e</div>")),r("</div>")):r("\x3c!----\x3e"),"resumen"===e.unref(A)?(r('<div class="space-y-6">'),e.unref(H)?r('<div class="flex items-center justify-center py-20"><div class="w-8 h-8 border-2 border-purple-600 border-t-transparent rounded-full animate-spin"></div></div>'):0===e.unref(O).length?(r('<div class="bg-white border border-gray-100 rounded-lg py-12 text-center">'),r(s.ssrRenderComponent(e.unref(b),{class:"w-12 h-12 text-gray-300 mx-auto mb-3"},null,n)),r('<p class="text-gray-600 font-medium mb-1">Sin bonos asignados</p><p class="text-sm text-gray-400">Los bonos de tus pacientes apareceran aqui agrupados por tipo</p></div>')):(r('<div class="grid gap-4">\x3c!--[--\x3e'),s.ssrRenderList(e.unref(O),t=>{var o;r(`<div class="bg-white border border-gray-100 rounded-lg overflow-hidden"><div class="px-5 py-4 border-b border-gray-100 bg-gray-50/50"><div class="flex items-center justify-between"><div class="flex items-center gap-3"><div class="${s.ssrRenderClass([getTipoBonoColor(t.tipo),"w-10 h-10 rounded-lg flex items-center justify-center"])}">`),r(s.ssrRenderComponent(e.unref(b),{class:"w-5 h-5"},null,n)),r(`</div><div><h3 class="font-semibold text-gray-900">${s.ssrInterpolate((o=t.tipo,{semanal:"Bono Semanal",quincenal:"Bono Quincenal",mensual:"Bono Mensual","5_sesiones":"Bono 5 Sesiones","10_sesiones":"Bono 10 Sesiones",personalizado:"Bono Personalizado",otro:"Otros Bonos"}[o]||`Bono ${o.charAt(0).toUpperCase()+o.slice(1)}`))}</h3><p class="text-sm text-gray-500">${s.ssrInterpolate(t.pacientes.length)} ${s.ssrInterpolate(1===t.pacientes.length?"paciente":"pacientes")}</p></div></div><div class="flex items-center gap-4 text-sm"><div class="text-right"><p class="text-gray-500">Activos</p><p class="font-semibold text-green-600">${s.ssrInterpolate(t.activos)}</p></div><div class="text-right"><p class="text-gray-500">Completados</p><p class="font-semibold text-gray-600">${s.ssrInterpolate(t.completados)}</p></div><div class="text-right"><p class="text-gray-500">Total facturado</p><p class="font-semibold text-gray-900">${s.ssrInterpolate(formatearPrecio(t.montoTotal))}€</p></div></div></div></div><div class="divide-y divide-gray-50">\x3c!--[--\x3e`),s.ssrRenderList(t.pacientes,o=>{r('<div class="overflow-hidden">'),o.bonoActivo?(r(`<div class="px-5 py-3 hover:bg-gray-50/50 transition-colors flex items-center justify-between"><div class="flex items-center gap-3 cursor-pointer flex-1"><div class="w-8 h-8 rounded-full bg-purple-100 text-purple-600 flex items-center justify-center text-xs font-semibold">${s.ssrInterpolate(getIniciales(o.nombre))}</div><div><div class="flex items-center gap-2"><p class="text-sm font-medium text-gray-900">${s.ssrInterpolate(o.nombre)}</p><span class="inline-flex items-center gap-1 px-1.5 py-0.5 rounded text-xs font-medium bg-green-100 text-green-700">`),r(s.ssrRenderComponent(e.unref(d),{class:"w-3 h-3"},null,n)),r(" Activo </span>"),getUrgenciaPacienteTipo(o.bonoActivo)?(r(`<span class="${s.ssrRenderClass([getUrgenciaPacienteTipo(o.bonoActivo).clase,"inline-flex items-center gap-1 px-1.5 py-0.5 rounded text-xs font-medium"])}">`),s.ssrRenderVNode(r,e.createVNode(e.resolveDynamicComponent(getUrgenciaPacienteTipo(o.bonoActivo).icono),{class:"w-3 h-3"},null),n),r(` ${s.ssrInterpolate(getUrgenciaPacienteTipo(o.bonoActivo).texto)}</span>`)):r("\x3c!----\x3e"),r(`</div><p class="text-xs text-gray-500"> Creado: ${s.ssrInterpolate(formatearFechaCorta(o.bonoActivo.created_at))} `),o.totalBonos>1?r(`<span class="text-gray-400 ml-1"> • ${s.ssrInterpolate(o.totalBonos)} bonos en total </span>`):r("\x3c!----\x3e"),r(`</p></div></div><div class="flex items-center gap-4"><div class="flex items-center gap-2"><div class="w-20 h-2 bg-gray-200 rounded-full overflow-hidden"><div class="${s.ssrRenderClass([getProgresoColorSemantico(o.bonoActivo),"h-full rounded-full transition-all"])}" style="${s.ssrRenderStyle({width:o.bonoActivo.sesiones_usadas/o.bonoActivo.sesiones_totales*100+"%"})}"></div></div><span class="text-xs text-gray-500 min-w-[40px]">${s.ssrInterpolate(o.bonoActivo.sesiones_totales-o.bonoActivo.sesiones_usadas)}/${s.ssrInterpolate(o.bonoActivo.sesiones_totales)}</span></div><div class="text-right min-w-[70px]"><p class="text-sm font-medium text-gray-900">${s.ssrInterpolate(o.bonoActivo.monto)}€</p><p class="${s.ssrRenderClass([o.bonoActivo.pagado?"text-green-600":"text-amber-600","text-xs"])}">${s.ssrInterpolate(o.bonoActivo.pagado?"Pagado":"Pendiente")}</p></div>`),o.bonosHistoricos.length>0?(r(`<button class="p-1.5 rounded-lg text-gray-400 hover:text-gray-600 hover:bg-gray-100 transition-colors"${s.ssrRenderAttr("title",`Ver ${o.bonosHistoricos.length} bono(s) anterior(es)`)}>`),r(s.ssrRenderComponent(e.unref(f),{class:["w-4 h-4 transition-transform",{"rotate-180":e.unref(U).includes(`${t.tipo}-${o.paciente_id}`)}]},null,n)),r("</button>")):r(s.ssrRenderComponent(e.unref(i),{class:"w-4 h-4 text-gray-400"},null,n)),r("</div></div>")):o.bonosHistoricos.length>0?(r(`<div class="px-5 py-3 hover:bg-gray-50/50 transition-colors flex items-center justify-between"><div class="flex items-center gap-3 flex-1"><div class="w-8 h-8 rounded-full bg-gray-100 text-gray-500 flex items-center justify-center text-xs font-semibold">${s.ssrInterpolate(getIniciales(o.nombre))}</div><div><div class="flex items-center gap-2"><p class="text-sm font-medium text-gray-600">${s.ssrInterpolate(o.nombre)}</p><span class="inline-flex items-center gap-1 px-1.5 py-0.5 rounded text-xs font-medium bg-gray-100 text-gray-600">`),r(s.ssrRenderComponent(e.unref(render$3),{class:"w-3 h-3"},null,n)),r(` Solo histórico </span></div><p class="text-xs text-gray-400">${s.ssrInterpolate(o.bonosHistoricos.length)} bono(s) completado(s) </p></div></div><button class="p-1.5 rounded-lg text-gray-400 hover:text-gray-600 hover:bg-gray-100 transition-colors flex items-center gap-1"><span class="text-xs">Ver historial</span>`),r(s.ssrRenderComponent(e.unref(f),{class:["w-4 h-4 transition-transform",{"rotate-180":e.unref(U).includes(`${t.tipo}-${o.paciente_id}`)}]},null,n)),r("</button></div>")):r("\x3c!----\x3e"),e.unref(U).includes(`${t.tipo}-${o.paciente_id}`)&&o.bonosHistoricos.length>0?(r('<div class="bg-gray-50/50 border-t border-gray-100 overflow-hidden"><div class="px-5 py-2 text-xs font-medium text-gray-500 uppercase tracking-wider border-b border-gray-100"> Historial de bonos </div><div class="divide-y divide-gray-100">\x3c!--[--\x3e'),s.ssrRenderList(o.bonosHistoricos,t=>{r('<div class="px-5 py-2 pl-16 flex items-center justify-between text-sm hover:bg-gray-100/50 cursor-pointer"><div class="flex items-center gap-3"><div class="w-6 h-6 rounded bg-gray-200 flex items-center justify-center">'),r(s.ssrRenderComponent(e.unref(render$3),{class:"w-3.5 h-3.5 text-gray-500"},null,n)),r(`</div><div><div class="flex items-center gap-2"><span class="text-gray-600">${s.ssrInterpolate(t.sesiones_usadas)}/${s.ssrInterpolate(t.sesiones_totales)} sesiones</span><span class="${s.ssrRenderClass([t.pagado?"bg-green-100 text-green-700":"bg-amber-100 text-amber-700","inline-flex items-center px-1.5 py-0.5 rounded text-xs"])}">${s.ssrInterpolate(t.pagado?"Pagado":"Pendiente")}</span></div><p class="text-xs text-gray-400"> Creado: ${s.ssrInterpolate(formatearFechaCorta(t.created_at))}</p></div></div><div class="text-right"><p class="text-gray-600">${s.ssrInterpolate(t.monto)}€</p></div></div>`)}),r("\x3c!--]--\x3e</div></div>")):r("\x3c!----\x3e"),r("</div>")}),r("\x3c!--]--\x3e</div>"),t.montoPendiente>0?r(`<div class="px-5 py-2 bg-amber-50/50 border-t border-amber-100 flex items-center justify-between text-sm"><span class="text-amber-700 font-medium">Por cobrar en este tipo:</span><span class="font-semibold text-amber-700">${s.ssrInterpolate(formatearPrecio(t.montoPendiente))}€</span></div>`):r("\x3c!----\x3e"),r("</div>")}),r("\x3c!--]--\x3e</div>")),r("</div>")):r("\x3c!----\x3e"),"plantillas"===e.unref(A)?(r(`<div class="space-y-4"><div class="bg-white border border-gray-100 rounded-lg p-4"><div class="flex flex-wrap items-center gap-4"><span class="text-sm font-medium text-gray-700">Precios base:</span><div class="flex items-center gap-2"><label class="text-sm text-gray-500">Semanal</label><div class="relative"><input${s.ssrRenderAttr("value",e.unref(q).semanal)} type="number" step="0.01" min="0" class="w-20 h-9 px-2 pr-6 text-sm bg-gray-50 border border-gray-200 rounded-lg focus:ring-1 focus:ring-purple-500 focus:border-purple-500"><span class="absolute right-2 top-1/2 -translate-y-1/2 text-xs text-gray-400">€</span></div></div><span class="text-gray-300">|</span><div class="flex items-center gap-2"><label class="text-sm text-gray-500">Quincenal</label><div class="relative"><input${s.ssrRenderAttr("value",e.unref(q).quincenal)} type="number" step="0.01" min="0" class="w-20 h-9 px-2 pr-6 text-sm bg-gray-50 border border-gray-200 rounded-lg focus:ring-1 focus:ring-purple-500 focus:border-purple-500"><span class="absolute right-2 top-1/2 -translate-y-1/2 text-xs text-gray-400">€</span></div></div><span class="text-gray-300">|</span><div class="flex items-center gap-2"><label class="text-sm text-gray-500">Única</label><div class="relative"><input${s.ssrRenderAttr("value",e.unref(q).unica)} type="number" step="0.01" min="0" class="w-20 h-9 px-2 pr-6 text-sm bg-gray-50 border border-gray-200 rounded-lg focus:ring-1 focus:ring-purple-500 focus:border-purple-500"><span class="absolute right-2 top-1/2 -translate-y-1/2 text-xs text-gray-400">€</span></div></div><button${s.ssrIncludeBooleanAttr(e.unref(S))?" disabled":""} class="${s.ssrRenderClass([e.unref(D)?"bg-purple-600 text-white hover:bg-purple-700":"bg-gray-100 text-gray-500","ml-auto h-9 px-4 text-sm font-medium rounded-lg transition-colors flex items-center gap-2"])}">`),e.unref(S)||e.unref(T)?r("\x3c!----\x3e"):r(s.ssrRenderComponent(e.unref(p),{class:"w-4 h-4"},null,n)),e.unref(S)?r('<span class="w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"></span>'):r("\x3c!----\x3e"),e.unref(T)?r(s.ssrRenderComponent(e.unref(d),{class:"w-4 h-4 text-green-500"},null,n)):r("\x3c!----\x3e"),r(` ${s.ssrInterpolate(e.unref(T)?"Guardado":e.unref(S)?"Guardando...":"Guardar")}</button></div></div><div class="bg-white border border-gray-100 rounded-lg overflow-hidden">`),0===e.unref(P).length?(r('<div class="py-12 text-center">'),r(s.ssrRenderComponent(e.unref(b),{class:"w-12 h-12 text-gray-300 mx-auto mb-3"},null,n)),r('<p class="text-gray-600 font-medium mb-1">Sin plantillas</p><p class="text-sm text-gray-400 mb-4">Crea plantillas para asignar bonos rápidamente</p><button class="text-sm text-purple-600 font-medium hover:text-purple-700"> + Crear primera plantilla </button></div>')):(r('<table class="w-full"><thead><tr class="border-b border-gray-100 bg-gray-50/50"><th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Nombre</th><th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Frecuencia</th><th class="px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider">Sesiones</th><th class="px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">Precio</th><th class="px-4 py-3 w-20"></th></tr></thead><tbody class="divide-y divide-gray-50">\x3c!--[--\x3e'),s.ssrRenderList(e.unref(P),(t,o)=>{var a;r(`<tr class="hover:bg-gray-50/50 transition-colors"><td class="px-4 py-3"><div class="text-sm font-medium text-gray-900">${s.ssrInterpolate(t.nombre)}</div>`),t.descripcion?r(`<div class="text-xs text-gray-500">${s.ssrInterpolate(t.descripcion)}</div>`):r("\x3c!----\x3e"),r(`</td><td class="px-4 py-3"><span class="${s.ssrRenderClass([(a=t.frecuencia,{semanal:"bg-blue-100 text-blue-700",quincenal:"bg-purple-100 text-purple-700",mensual:"bg-amber-100 text-amber-700",cualquiera:"bg-gray-100 text-gray-700"}[a]||"bg-gray-100 text-gray-700"),"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium"])}">${s.ssrInterpolate(frecuenciaLabel(t.frecuencia))}</span></td><td class="px-4 py-3 text-center text-sm text-gray-600">${s.ssrInterpolate(t.sesiones)}</td><td class="px-4 py-3 text-right text-sm font-medium text-gray-900">${s.ssrInterpolate(t.precio)}€</td><td class="px-4 py-3"><div class="flex items-center justify-end gap-1"><button class="p-1.5 text-gray-400 hover:text-purple-600 hover:bg-purple-50 rounded transition-colors">`),r(s.ssrRenderComponent(e.unref(h),{class:"w-4 h-4"},null,n)),r('</button><button class="p-1.5 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded transition-colors">'),r(s.ssrRenderComponent(e.unref(w),{class:"w-4 h-4"},null,n)),r("</button></div></td></tr>")}),r("\x3c!--]--\x3e</tbody></table>")),r("</div></div>")):r("\x3c!----\x3e"),"bonos"===e.unref(A)?(r(`<div class="space-y-4"><div class="flex flex-wrap items-center gap-3"><div class="relative flex-1 min-w-[200px] max-w-md"><input${s.ssrRenderAttr("value",e.unref(M))} type="text" placeholder="Buscar por paciente..." class="w-full h-10 px-4 pl-9 bg-white border border-gray-200 rounded-lg text-sm focus:border-purple-500 focus:ring-2 focus:ring-purple-500/20">`),r(s.ssrRenderComponent(e.unref($),{class:"w-4 h-4 absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"},null,n)),r(`</div><select class="h-10 px-3 bg-white border border-gray-200 rounded-lg text-sm text-gray-700 focus:border-purple-500 focus:ring-1 focus:ring-purple-500/20"><option value=""${s.ssrIncludeBooleanAttr(Array.isArray(e.unref(N))?s.ssrLooseContain(e.unref(N),""):s.ssrLooseEqual(e.unref(N),""))?" selected":""}>Estado: Todos</option><option value="activo"${s.ssrIncludeBooleanAttr(Array.isArray(e.unref(N))?s.ssrLooseContain(e.unref(N),"activo"):s.ssrLooseEqual(e.unref(N),"activo"))?" selected":""}>Activos</option><option value="pendiente"${s.ssrIncludeBooleanAttr(Array.isArray(e.unref(N))?s.ssrLooseContain(e.unref(N),"pendiente"):s.ssrLooseEqual(e.unref(N),"pendiente"))?" selected":""}>Pendientes</option><option value="completado"${s.ssrIncludeBooleanAttr(Array.isArray(e.unref(N))?s.ssrLooseContain(e.unref(N),"completado"):s.ssrLooseEqual(e.unref(N),"completado"))?" selected":""}>Completados</option><option value="vencido"${s.ssrIncludeBooleanAttr(Array.isArray(e.unref(N))?s.ssrLooseContain(e.unref(N),"vencido"):s.ssrLooseEqual(e.unref(N),"vencido"))?" selected":""}>Vencidos</option></select><select class="h-10 px-3 bg-white border border-gray-200 rounded-lg text-sm text-gray-700 focus:border-purple-500 focus:ring-1 focus:ring-purple-500/20"><option value=""${s.ssrIncludeBooleanAttr(Array.isArray(e.unref(z))?s.ssrLooseContain(e.unref(z),""):s.ssrLooseEqual(e.unref(z),""))?" selected":""}>Pago: Todos</option><option value="pagado"${s.ssrIncludeBooleanAttr(Array.isArray(e.unref(z))?s.ssrLooseContain(e.unref(z),"pagado"):s.ssrLooseEqual(e.unref(z),"pagado"))?" selected":""}>Pagados</option><option value="pendiente"${s.ssrIncludeBooleanAttr(Array.isArray(e.unref(z))?s.ssrLooseContain(e.unref(z),"pendiente"):s.ssrLooseEqual(e.unref(z),"pendiente"))?" selected":""}>Pendientes cobro</option></select><select class="h-10 px-3 bg-white border border-gray-200 rounded-lg text-sm text-gray-700 focus:border-purple-500 focus:ring-1 focus:ring-purple-500/20"><option value="reciente"${s.ssrIncludeBooleanAttr(Array.isArray(e.unref(F))?s.ssrLooseContain(e.unref(F),"reciente"):s.ssrLooseEqual(e.unref(F),"reciente"))?" selected":""}>Más recientes</option><option value="antiguo"${s.ssrIncludeBooleanAttr(Array.isArray(e.unref(F))?s.ssrLooseContain(e.unref(F),"antiguo"):s.ssrLooseEqual(e.unref(F),"antiguo"))?" selected":""}>Más antiguos</option><option value="nombre"${s.ssrIncludeBooleanAttr(Array.isArray(e.unref(F))?s.ssrLooseContain(e.unref(F),"nombre"):s.ssrLooseEqual(e.unref(F),"nombre"))?" selected":""}>Nombre A-Z</option><option value="monto_desc"${s.ssrIncludeBooleanAttr(Array.isArray(e.unref(F))?s.ssrLooseContain(e.unref(F),"monto_desc"):s.ssrLooseEqual(e.unref(F),"monto_desc"))?" selected":""}>Mayor monto</option><option value="monto_asc"${s.ssrIncludeBooleanAttr(Array.isArray(e.unref(F))?s.ssrLooseContain(e.unref(F),"monto_asc"):s.ssrLooseEqual(e.unref(F),"monto_asc"))?" selected":""}>Menor monto</option><option value="progreso"${s.ssrIncludeBooleanAttr(Array.isArray(e.unref(F))?s.ssrLooseContain(e.unref(F),"progreso"):s.ssrLooseEqual(e.unref(F),"progreso"))?" selected":""}>Por progreso</option></select>`),e.unref(G)?r(`<div class="${s.ssrRenderClass([{"bg-amber-100 text-amber-700":"pendientes_cobro"===e.unref(G),"bg-orange-100 text-orange-700":"proximos_agotar"===e.unref(G),"bg-red-100 text-red-700":"urgentes"===e.unref(G)},"flex items-center gap-2 h-10 px-3 rounded-lg text-sm font-medium"])}"><span>${s.ssrInterpolate("pendientes_cobro"===e.unref(G)?"Pendientes de cobro":"proximos_agotar"===e.unref(G)?"Por agotar (≤2 sesiones)":"Urgentes (agotados sin pagar)")}</span><span class="text-xs opacity-75">(${s.ssrInterpolate(e.unref(Z).length)})</span></div>`):r("\x3c!----\x3e"),e.unref(M)||e.unref(N)||e.unref(G)||e.unref(z)||"reciente"!==e.unref(F)?(r('<button class="h-10 px-3 text-sm text-gray-500 hover:text-gray-700 flex items-center gap-1">'),r(s.ssrRenderComponent(e.unref(_),{class:"w-4 h-4"},null,n)),r(" Limpiar </button>")):r("\x3c!----\x3e"),r("</div>"),e.unref(H)?r('<div class="flex items-center justify-center py-20"><div class="w-8 h-8 border-2 border-purple-600 border-t-transparent rounded-full animate-spin"></div></div>'):(r('<div class="bg-white border border-gray-100 rounded-lg overflow-hidden">'),0===e.unref(Z).length?(r('<div class="py-12 text-center">'),r(s.ssrRenderComponent(e.unref(b),{class:"w-12 h-12 text-gray-300 mx-auto mb-3"},null,n)),r(`<p class="text-gray-600 font-medium mb-1">${s.ssrInterpolate(e.unref(M)||e.unref(N)?"Sin resultados":"Sin bonos")}</p><p class="text-sm text-gray-400">${s.ssrInterpolate(e.unref(M)||e.unref(N)?"Prueba ajustando los filtros":"Los bonos de tus pacientes aparecerán aquí")}</p></div>`)):(r('<table class="w-full"><thead><tr class="border-b border-gray-100 bg-gray-50/50"><th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Paciente</th><th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Tipo</th><th class="px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider">Progreso</th><th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Estado</th><th class="px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">Monto</th><th class="px-4 py-3 w-10"></th></tr></thead><tbody class="divide-y divide-gray-50">\x3c!--[--\x3e'),s.ssrRenderList(e.unref(Z),t=>{var o;r(`<tr class="hover:bg-gray-50/50 transition-colors cursor-pointer"><td class="px-4 py-3"><div class="flex items-center gap-2"><div class="w-8 h-8 rounded-full bg-purple-100 text-purple-600 flex items-center justify-center text-xs font-semibold flex-shrink-0">${s.ssrInterpolate(getIniciales(t.paciente_nombre))}</div><span class="text-sm font-medium text-gray-900 truncate">${s.ssrInterpolate(t.paciente_nombre)}</span></div></td><td class="px-4 py-3"><span class="text-sm text-gray-600">${s.ssrInterpolate(frecuenciaLabel(t.tipo))}</span></td><td class="px-4 py-3"><div class="flex items-center gap-2 justify-center"><div class="w-16 h-1.5 bg-gray-200 rounded-full overflow-hidden"><div class="${s.ssrRenderClass([getProgresoColor(t),"h-full rounded-full transition-all"])}" style="${s.ssrRenderStyle({width:`${e.unref(I)(t)}%`})}"></div></div><span class="text-xs text-gray-500">${s.ssrInterpolate(t.sesiones_totales-t.sesiones_restantes)}/${s.ssrInterpolate(t.sesiones_totales)}</span></div></td><td class="px-4 py-3"><span class="${s.ssrRenderClass([(o=t.estado,{activo:"text-green-600",pendiente:"text-amber-600",completado:"text-gray-600",vencido:"text-red-600",agotado:"text-gray-500"}[o]||"text-gray-600"),"inline-flex items-center gap-1.5 text-sm"])}"><span class="${s.ssrRenderClass([getEstadoColorPunto(t.estado),"w-1.5 h-1.5 rounded-full"])}"></span> ${s.ssrInterpolate((e=>({activo:"Activo",pendiente:"Pendiente",completado:"Completado",vencido:"Vencido",agotado:"Agotado"}[e]||e))(t.estado))}</span></td><td class="px-4 py-3 text-right"><div class="text-sm font-medium text-gray-900">${s.ssrInterpolate(t.monto_total)}€</div><div class="${s.ssrRenderClass([t.pagado?"text-green-600":"text-amber-600","text-xs"])}">${s.ssrInterpolate(t.pagado?"Pagado":"Pendiente")}</div></td><td class="px-4 py-3 text-right">`),r(s.ssrRenderComponent(e.unref(i),{class:"w-4 h-4 text-gray-400"},null,n)),r("</td></tr>")}),r("\x3c!--]--\x3e</tbody></table>")),r("</div>")),r("</div>")):r("\x3c!----\x3e"),s.ssrRenderTeleport(r,t=>{e.unref(B)?(t(`<div class="fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50"><div class="bg-white rounded-xl shadow-2xl w-full max-w-md"><div class="px-5 py-4 border-b border-gray-100 flex items-center justify-between"><h3 class="font-semibold text-gray-900">${s.ssrInterpolate(null!==e.unref(L)?"Editar Plantilla":"Nueva Plantilla")}</h3><button class="p-1 text-gray-400 hover:text-gray-600 rounded">`),t(s.ssrRenderComponent(e.unref(_),{class:"w-5 h-5"},null,n)),t(`</button></div><div class="p-5 space-y-4"><div><label class="block text-sm font-medium text-gray-700 mb-1">Nombre</label><input${s.ssrRenderAttr("value",e.unref(k).nombre)} type="text" placeholder="Ej: Bono Mensual" class="w-full h-10 px-3 bg-gray-50 border border-gray-200 rounded-lg text-sm focus:ring-1 focus:ring-purple-500 focus:border-purple-500"></div><div><label class="block text-sm font-medium text-gray-700 mb-1">Descripción (opcional)</label><input${s.ssrRenderAttr("value",e.unref(k).descripcion)} type="text" placeholder="Descripción breve..." class="w-full h-10 px-3 bg-gray-50 border border-gray-200 rounded-lg text-sm focus:ring-1 focus:ring-purple-500 focus:border-purple-500"></div><div class="grid grid-cols-2 gap-3"><div><label class="block text-sm font-medium text-gray-700 mb-1">Sesiones</label><input${s.ssrRenderAttr("value",e.unref(k).sesiones)} type="number" min="1" class="w-full h-10 px-3 bg-gray-50 border border-gray-200 rounded-lg text-sm focus:ring-1 focus:ring-purple-500 focus:border-purple-500"></div><div><label class="block text-sm font-medium text-gray-700 mb-1">Precio (€)</label><input${s.ssrRenderAttr("value",e.unref(k).precio)} type="number" step="0.01" min="0" class="w-full h-10 px-3 bg-gray-50 border border-gray-200 rounded-lg text-sm focus:ring-1 focus:ring-purple-500 focus:border-purple-500"></div></div><div><label class="block text-sm font-medium text-gray-700 mb-1">Frecuencia</label><select class="w-full h-10 px-3 bg-gray-50 border border-gray-200 rounded-lg text-sm focus:ring-1 focus:ring-purple-500 focus:border-purple-500"><option value="semanal"${s.ssrIncludeBooleanAttr(Array.isArray(e.unref(k).frecuencia)?s.ssrLooseContain(e.unref(k).frecuencia,"semanal"):s.ssrLooseEqual(e.unref(k).frecuencia,"semanal"))?" selected":""}>Semanal</option><option value="quincenal"${s.ssrIncludeBooleanAttr(Array.isArray(e.unref(k).frecuencia)?s.ssrLooseContain(e.unref(k).frecuencia,"quincenal"):s.ssrLooseEqual(e.unref(k).frecuencia,"quincenal"))?" selected":""}>Quincenal</option><option value="mensual"${s.ssrIncludeBooleanAttr(Array.isArray(e.unref(k).frecuencia)?s.ssrLooseContain(e.unref(k).frecuencia,"mensual"):s.ssrLooseEqual(e.unref(k).frecuencia,"mensual"))?" selected":""}>Mensual</option><option value="cualquiera"${s.ssrIncludeBooleanAttr(Array.isArray(e.unref(k).frecuencia)?s.ssrLooseContain(e.unref(k).frecuencia,"cualquiera"):s.ssrLooseEqual(e.unref(k).frecuencia,"cualquiera"))?" selected":""}>Cualquiera</option></select></div></div><div class="px-5 py-4 border-t border-gray-100 flex items-center justify-end gap-3"><button class="h-10 px-4 text-sm text-gray-700 hover:bg-gray-100 rounded-lg transition-colors"> Cancelar </button><button${s.ssrIncludeBooleanAttr(!e.unref(k).nombre||!e.unref(k).sesiones||!e.unref(k).precio)?" disabled":""} class="h-10 px-4 bg-purple-600 text-white text-sm font-medium rounded-lg hover:bg-purple-700 transition-colors disabled:opacity-50">${s.ssrInterpolate(null!==e.unref(L)?"Guardar":"Crear")}</button></div></div></div>`)):t("\x3c!----\x3e")},"body",!1,n),r("</div>")}}}),I=C.setup;C.setup=(t,s)=>{const r=e.useSSRContext();return(r.modules||(r.modules=new Set)).add("pages/terapeuta/bonos.vue"),I?I(t,s):void 0};export{C as default};
//# sourceMappingURL=bonos-VjG8sgNw.mjs.map
