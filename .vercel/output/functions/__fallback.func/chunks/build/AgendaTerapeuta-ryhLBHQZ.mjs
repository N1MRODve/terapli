import{e,v as a,s as t}from"./server.mjs";import{_ as r}from"./_plugin-vue_export-helper-1tPrXgE0.mjs";import{u as s,_ as o}from"./ModalNuevaCitaEnhanced-CK2odB5s.mjs";import{M as n}from"./ModalDetallesCita-Db71gcxb.mjs";import{u as d}from"./useSupabaseClient-DykwVqLQ.mjs";import{a as l}from"./usePacientes-BPAABr51.mjs";import{r as i}from"./CheckCircleIcon-DZf4GX3q.mjs";import{r as c,a as u}from"./FunnelIcon-Cg1OAnfP.mjs";import{r as v}from"./ClipboardDocumentListIcon-tIc_vSd1.mjs";import{r as p}from"./PlusIcon-CHLzv-V9.mjs";import{r as b}from"./MagnifyingGlassIcon-GsbNDyPZ.mjs";import{r as m}from"./XMarkIcon-DCLwyE-W.mjs";import{r as g}from"./UserIcon-CrHYaeI9.mjs";function render$1(e,t){return a.openBlock(),a.createElementBlock("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[a.createElementVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M3.75 3.75v4.5m0-4.5h4.5m-4.5 0L9 9M3.75 20.25v-4.5m0 4.5h4.5m-4.5 0L9 15M20.25 3.75h-4.5m4.5 0v4.5m0-4.5L15 9m5.25 11.25h-4.5m4.5 0v-4.5m0 4.5L15 15"})])}const x={pendiente:{border:"border-amber-200 dark:border-amber-800",bg:"bg-white dark:bg-zinc-800",badge:"bg-amber-400 dark:bg-amber-500",dot:"bg-amber-400 dark:bg-amber-500",hover:"hover:bg-amber-50 dark:hover:bg-amber-950/20"},confirmada:{border:"border-emerald-200 dark:border-emerald-800",bg:"bg-white dark:bg-zinc-800",badge:"bg-emerald-400 dark:bg-emerald-500",dot:"bg-emerald-400 dark:bg-emerald-500",hover:"hover:bg-emerald-50 dark:hover:bg-emerald-950/20"},cancelada:{border:"border-rose-200 dark:border-rose-800",bg:"bg-white dark:bg-zinc-800",badge:"bg-rose-400 dark:bg-rose-500",dot:"bg-rose-400 dark:bg-rose-500",hover:"hover:bg-rose-50 dark:hover:bg-rose-950/20"},realizada:{border:"border-blue-200 dark:border-blue-800",bg:"bg-white dark:bg-zinc-800",badge:"bg-blue-400 dark:bg-blue-500",dot:"bg-blue-400 dark:bg-blue-500",hover:"hover:bg-blue-50 dark:hover:bg-blue-950/20"}},formatearMesAnio=e=>new Date(e+"T00:00:00").toLocaleDateString("es-ES",{month:"long",year:"numeric"}),formatearDiaSemana=e=>new Date(e+"T00:00:00").toLocaleDateString("es-ES",{weekday:"long",day:"numeric",month:"short"}),obtenerTituloAgenda=(e,a)=>{const t="string"==typeof a?a:a.toISOString().split("T")[0];switch(e){case"dia":return(e=>new Date(e+"T00:00:00").toLocaleDateString("es-ES",{day:"2-digit",month:"long",year:"numeric"}))(t);case"5dias":return`${formatearMesAnio(t)} ‚Äî 5 d√≠as`;case"semana":return`${formatearMesAnio(t)} ‚Äî Semana ${(e=>{const a=new Date(e+"T00:00:00"),t=new Date(a.getFullYear(),0,1),r=a.getTime()-t.getTime();return Math.ceil((r/864e5+t.getDay()+1)/7)})(t)}`;case"mes":return formatearMesAnio(t);default:return""}},generarBloquesHorarios=(e="08:00",a="20:00",t=30)=>{const r=[],[s,o]=e.split(":").map(Number),[n,d]=a.split(":").map(Number);let l=s,i=o;for(;l<n||l===n&&i<d;)r.push(`${String(l).padStart(2,"0")}:${String(i).padStart(2,"0")}`),i+=t,i>=60&&(l++,i-=60);return r},agregarDias=(e,a)=>{const t=new Date(e+"T00:00:00");return t.setDate(t.getDate()+a),t.toISOString().split("T")[0]},inicioSemana=e=>{const a=new Date(e+"T00:00:00"),t=a.getDay(),r=0===t?-6:1-t;return a.setDate(a.getDate()+r),a.toISOString().split("T")[0]};function useAgenda(){const t=d(),r=e(),s=a.ref([]),o=a.ref(!1),n=a.ref(null),l=a.ref(null),i=a.ref({});a.ref(new Map);const c=a.computed(()=>{const e=(new Date).toISOString().split("T")[0];return s.value.filter(a=>a.fecha_cita===e)}),u=a.computed(()=>s.value.filter(e=>"pendiente"===e.estado||"confirmada"===e.estado)),v=a.computed(()=>s.value.filter(e=>"completada"===e.estado||"realizada"===e.estado)),p=a.computed(()=>s.value.filter(e=>e.bono&&e.bono.sesiones_restantes<=2&&e.bono.sesiones_restantes>0&&("pendiente"===e.estado||"confirmada"===e.estado))),getCitasDelTerapeuta=async e=>{try{if(o.value=!0,n.value=null,!r.value?.id)throw new Error("Usuario no autenticado");let a=t.from("citas").select("\n          id,\n          fecha_cita,\n          hora_inicio,\n          hora_fin,\n          estado,\n          modalidad,\n          observaciones,\n          paciente_id,\n          terapeuta_id,\n          bono_id,\n          sesion_descontada,\n          consumo_registrado,\n          paciente:pacientes (\n            id,\n            nombre_completo,\n            telefono,\n            email\n          ),\n          bono:bonos (\n            id,\n            sesiones_restantes,\n            sesiones_totales,\n            estado\n          )\n        ").eq("terapeuta_id",r.value.id);e?.fechaInicio&&(a=a.gte("fecha_cita",e.fechaInicio)),e?.fechaFin&&(a=a.lte("fecha_cita",e.fechaFin)),e?.incluirCompletadas||(a=a.in("estado",["pendiente","confirmada"])),a=a.order("fecha_cita",{ascending:!0}).order("hora_inicio",{ascending:!0});const{data:d,error:l}=await a;if(l)throw l;return s.value=d||[],console.log(`‚úÖ [Agenda] Cargadas ${s.value.length} citas`),s.value}catch(e){throw console.error("‚ùå [Agenda] Error al cargar citas:",e),n.value=e.message||"Error al cargar citas",e}finally{o.value=!1}},b=a.ref([]),detectarInconsistencias=async()=>{try{console.log("üîç [Agenda] Detectando inconsistencias...");const{data:e,error:a}=await t.from("citas").select("\n          id,\n          fecha_cita,\n          hora_inicio,\n          hora_fin,\n          estado,\n          modalidad,\n          observaciones,\n          paciente_id,\n          terapeuta_id,\n          bono_id,\n          sesion_descontada,\n          consumo_registrado,\n          paciente:pacientes (\n            id,\n            nombre_completo,\n            telefono,\n            email\n          ),\n          bono:bonos (\n            id,\n            sesiones_restantes,\n            sesiones_totales,\n            estado\n          )\n        ").in("estado",["completada","realizada"]).not("bono_id","is",null).or("sesion_descontada.eq.false,consumo_registrado.eq.false").eq("terapeuta_id",r.value?.id||"");if(a)throw a;return b.value=e||[],b.value.length>0?console.warn(`‚ö†Ô∏è [Agenda] ${b.value.length} cita(s) con inconsistencias detectadas`):console.log("‚úÖ [Agenda] No se detectaron inconsistencias"),b.value}catch(e){return console.error("‚ùå [Agenda] Error al detectar inconsistencias:",e),b.value=[],[]}},resincronizarBono=async e=>{try{console.log(`üîÑ [Agenda] Re-sincronizando bono para cita: ${e}`);const{data:a,error:r}=await t.rpc("actualizar_bono_por_cita",{p_cita_id:e});if(r)throw r;const s=a;return s.success?(console.log("‚úÖ [Agenda] Bono re-sincronizado exitosamente"),"ya_descontada"===s.warning?mostrarNotificacion("info","Esta sesi√≥n ya estaba descontada"):(mostrarNotificacion("success","Bono re-sincronizado correctamente"),s.alerta&&s.mensaje_alerta&&setTimeout(()=>{mostrarNotificacion("warning",s.mensaje_alerta)},500)),await Promise.all([getCitasDelTerapeuta(),detectarInconsistencias()]),s):(console.warn("‚ö†Ô∏è [Agenda] No se pudo re-sincronizar:",s.message),mostrarNotificacion("warning",s.message||"No se pudo re-sincronizar"),s)}catch(e){throw console.error("‚ùå [Agenda] Error al re-sincronizar bono:",e),mostrarNotificacion("error","Error al re-sincronizar el bono"),e}},suscribirCitasRealtime=()=>{r.value?.id?(l.value&&t.removeChannel(l.value),console.log("üì° [Agenda] Iniciando suscripci√≥n Realtime..."),l.value=t.channel(`citas_terapeuta_${r.value.id}`).on("postgres_changes",{event:"*",schema:"public",table:"citas",filter:`terapeuta_id=eq.${r.value.id}`},async e=>{console.log("üì° [Realtime] Cambio detectado en citas:",e.eventType),await getCitasDelTerapeuta(),"INSERT"===e.eventType?mostrarNotificacion("info","Nueva cita agregada a tu agenda"):"UPDATE"===e.eventType?mostrarNotificacion("info","Una cita ha sido actualizada"):"DELETE"===e.eventType&&mostrarNotificacion("warning","Una cita ha sido eliminada")}).subscribe(e=>{"SUBSCRIBED"===e?console.log("‚úÖ [Realtime] Suscripci√≥n activa"):"CHANNEL_ERROR"===e?console.error("‚ùå [Realtime] Error en suscripci√≥n"):"TIMED_OUT"===e&&console.warn("‚ö†Ô∏è [Realtime] Tiempo de espera agotado")})):console.warn("‚ö†Ô∏è [Agenda] No se puede suscribir sin usuario autenticado")},mostrarNotificacion=(e,a)=>{{const t={success:"‚úÖ",error:"‚ùå",warning:"‚ö†Ô∏è",info:"‚ÑπÔ∏è"};console.log(`${t[e]} [Agenda] ${a}`)}},mostrarAlerta=e=>{if(!e.alerta||!e.mensaje_alerta)return;const a="bono_agotado"===e.tipo_alerta?"success":(e.tipo_alerta,"warning");mostrarNotificacion(a,e.mensaje_alerta)};a.watchEffect(()=>{r.value?.id&&(getCitasDelTerapeuta(),suscribirCitasRealtime())});const m=a.computed(()=>{let e=s.value;if(i.value.paciente&&(e=e.filter(e=>e.paciente?.nombre_completo.toLowerCase().includes(i.value.paciente.toLowerCase()))),i.value.busqueda){const a=i.value.busqueda.toLowerCase();e=e.filter(e=>e.paciente?.nombre_completo.toLowerCase().includes(a)||e.observaciones?.toLowerCase().includes(a)||e.fecha_cita.includes(a))}return i.value.estado&&i.value.estado.length>0&&(e=e.filter(e=>i.value.estado.includes(e.estado))),i.value.area_terapeutica&&(e=e.filter(e=>e.area_terapeutica===i.value.area_terapeutica)),i.value.tipo_sesion&&i.value.tipo_sesion.length>0&&(e=e.filter(e=>e.tipo_sesion&&i.value.tipo_sesion.includes(e.tipo_sesion))),i.value.fecha_desde&&(e=e.filter(e=>e.fecha_cita>=i.value.fecha_desde)),i.value.fecha_hasta&&(e=e.filter(e=>e.fecha_cita<=i.value.fecha_hasta)),e}),calcularCargaDiaria=(e,a)=>{const t=s.value.filter(t=>{const r=t.fecha_cita===e,s=!a||t.terapeuta_id===a,o=["pendiente","confirmada"].includes(t.estado);return r&&s&&o});return{total:t.length,confirmadas:t.filter(e=>"confirmada"===e.estado).length,pendientes:t.filter(e=>"pendiente"===e.estado).length}};return{citas:s,loading:o,error:n,filtros:i,citasDelDia:c,citasPendientes:u,citasCompletadas:v,citasConBonoProximoAgotar:p,citasFiltradas:m,getCitasDelTerapeuta:getCitasDelTerapeuta,completarCita:async e=>{try{console.log(`üîÑ [Agenda] Completando cita: ${e}`);const{data:a,error:r}=await t.rpc("completar_cita",{p_cita_id:e});if(r)throw console.error("‚ùå [Agenda] Error en RPC:",r),r;const o=a;if(o.success){console.log("‚úÖ [Agenda] Cita completada exitosamente");const a=s.value.findIndex(a=>a.id===e);if(-1!==a){const e=s.value[a];e&&(e.estado="completada",e.sesion_descontada=!0,e.consumo_registrado=!0,e.bono&&void 0!==o.sesiones_despues&&(e.bono.sesiones_restantes=o.sesiones_despues,o.bono_completado&&(e.bono.estado="completado")))}return o.alerta?mostrarAlerta(o):mostrarNotificacion("success",o.message),await getCitasDelTerapeuta(),o}return o.warning?(console.warn("‚ö†Ô∏è [Agenda] Advertencia:",o.message),mostrarNotificacion("warning",o.message)):(console.error("‚ùå [Agenda] Error:",o.message),mostrarNotificacion("error",o.message||"No se pudo completar la cita")),o}catch(e){console.error("‚ùå [Agenda] Error al completar cita:",e);const a=e.message||"Error desconocido al completar cita";return mostrarNotificacion("error",a),{success:!1,message:a,error:e.code||"unknown_error"}}},obtenerHistorialBono:async e=>{try{const{data:a,error:r}=await t.rpc("obtener_historial_bono",{p_bono_id:e});if(r)throw r;return console.log(`‚úÖ [Agenda] Historial de bono obtenido: ${a?.length||0} movimientos`),a||[]}catch(e){throw console.error("‚ùå [Agenda] Error al obtener historial:",e),e}},verificarBonoCitas:async e=>{try{const{data:a,error:r}=await t.rpc("verificar_bono_citas",{p_bono_id:e});if(r)throw r;return console.log("‚úÖ [Agenda] Verificaci√≥n de bono:",a),a?.alerta&&console.warn("‚ö†Ô∏è [Agenda] Alerta en bono:",a.mensaje_alerta),a}catch(e){throw console.error("‚ùå [Agenda] Error al verificar bono:",e),e}},citasPendientesSync:b,detectarInconsistencias:detectarInconsistencias,resincronizarBono:resincronizarBono,resincronizarTodos:async()=>{if(0!==b.value.length)try{console.log(`üîÑ [Agenda] Re-sincronizando ${b.value.length} citas...`);let e=0,a=0,t=0;for(const r of b.value)try{const s=await resincronizarBono(r.id);s.success?"ya_descontada"===s.warning?t++:e++:a++,await new Promise(e=>setTimeout(e,300))}catch{a++}const r=[];e>0&&r.push(`${e} sincronizada(s)`),t>0&&r.push(`${t} ya estaba(n) descontada(s)`),a>0&&r.push(`${a} fallida(s)`);const s=`‚úÖ Re-sincronizaci√≥n completa: ${r.join(", ")}`;mostrarNotificacion(0===a?"success":"warning",s),console.log("‚úÖ [Agenda] Re-sincronizaci√≥n masiva completada:",{exitosos:e,yaDescontados:t,fallidos:a})}catch(e){console.error("‚ùå [Agenda] Error en re-sincronizaci√≥n masiva:",e),mostrarNotificacion("error","Error al re-sincronizar todas las citas")}else mostrarNotificacion("info","No hay citas pendientes de sincronizaci√≥n")},aplicarFiltros:e=>{i.value={...e}},limpiarFiltros:()=>{i.value={}},reprogramarCita:async(e,a,r,n)=>{try{o.value=!0;const{data:d,error:l}=await t.from("citas").update({fecha_cita:a,hora_inicio:r,hora_fin:n||r,updated_at:(new Date).toISOString()}).eq("id",e).select().single();if(l)throw l;const i=s.value.findIndex(a=>a.id===e);return-1!==i&&d&&(s.value[i]={...s.value[i],...d}),{success:!0,cita:d}}catch(e){return console.error("Error al reprogramar cita:",e),{success:!1,error:e.message}}finally{o.value=!1}},actualizarNotasRapidas:async(e,a,r)=>{try{const{data:o,error:n}=await t.from("citas").update({notas_rapidas:a,enlace_videollamada:r,updated_at:(new Date).toISOString()}).eq("id",e).select().single();if(n)throw n;const d=s.value.findIndex(a=>a.id===e);return-1!==d&&o&&(s.value[d]={...s.value[d],...o}),{success:!0}}catch(e){return console.error("Error al actualizar notas:",e),{success:!1,error:e.message}}},obtenerDisponibilidad:async e=>{try{const a=e||r.value?.id;if(!a)throw new Error("ID de terapeuta requerido");const{data:s,error:o}=await t.from("terapeutas").select("disponibilidad").eq("id",a).single();if(o)throw o;return s?.disponibilidad||[]}catch(e){return console.error("Error al obtener disponibilidad:",e),[]}},calcularHuecosLibres:(e,a)=>{const t=new Date(e+"T00:00:00").getDay(),r=s.value.filter(a=>a.fecha_cita===e),o=a.filter(e=>e.dia_semana===t&&e.disponible);if(0===o.length)return[];const n=[];return o.forEach(e=>{const a=e.hora_inicio,t=e.hora_fin;r.some(e=>e.hora_inicio>=a&&e.hora_inicio<t||e.hora_fin>a&&e.hora_fin<=t||e.hora_inicio<=a&&e.hora_fin>=t)||n.push({hora_inicio:a,hora_fin:t})}),n},programarRecordatorios:async e=>{try{const a=s.value.find(a=>a.id===e);if(!a||!a.paciente)return{success:!1,error:"Cita no encontrada"};const r=new Date(a.fecha_cita+"T"+a.hora_inicio),o=new Date;new Date(r.getTime()-864e5)>o&&!a.recordatorio_24h_enviado&&(await t.from("notificaciones").insert({usuario_id:a.paciente_id,tipo:"cita",titulo:"üìÖ Recordatorio: Cita ma√±ana",mensaje:`Tu cita est√° programada para ma√±ana ${a.fecha_cita} a las ${a.hora_inicio}`,metadata:{cita_id:e,tipo_recordatorio:"24h",fecha_cita:a.fecha_cita,hora:a.hora_inicio}}),await t.from("citas").update({recordatorio_24h_enviado:!0}).eq("id",e));return new Date(r.getTime()-144e5)>o&&!a.recordatorio_4h_enviado&&(await t.from("notificaciones").insert({usuario_id:a.paciente_id,tipo:"cita",titulo:"‚è∞ Recordatorio: Cita en 4 horas",mensaje:`Tu cita est√° programada para hoy ${a.fecha_cita} a las ${a.hora_inicio}`,metadata:{cita_id:e,tipo_recordatorio:"4h",fecha_cita:a.fecha_cita,hora:a.hora_inicio,enlace_videollamada:a.enlace_videollamada}}),await t.from("citas").update({recordatorio_4h_enviado:!0}).eq("id",e)),{success:!0}}catch(e){return console.error("Error al programar recordatorios:",e),{success:!1,error:e.message}}},calcularCargaDiaria:calcularCargaDiaria,obtenerResumenSemanal:e=>{const a=new Date(e+"T00:00:00"),t=[];for(let e=0;e<7;e++){const r=new Date(a);r.setDate(a.getDate()+e);const s=r.toISOString().split("T")[0]||"";if(!s)continue;const o=calcularCargaDiaria(s);t.push({fecha:s,dia:r.toLocaleDateString("es-ES",{weekday:"short"}),citas:o.total,confirmadas:o.confirmadas,pendientes:o.pendientes})}return t},obtenerResumenMensual:(e,a)=>{const t=new Date(e,a+1,0),r=new Map;for(let s=1;s<=t.getDate();s++){const t=new Date(e,a,s).toISOString().split("T")[0]||"";if(!t)continue;const o=calcularCargaDiaria(t);r.set(t,{dia:s,citas:o.total,confirmadas:o.confirmadas,pendientes:o.pendientes})}return r},suscribirCitasRealtime:suscribirCitasRealtime,desuscribirCitasRealtime:()=>{l.value&&(console.log("üì° [Realtime] Cerrando suscripci√≥n..."),t.removeChannel(l.value),l.value=null)}}}const h=a.defineComponent({__name:"AgendaHeader",__ssrInlineRender:!0,props:a.mergeModels({rolActivo:{default:"terapeuta"},mostrarRol:{type:Boolean,default:!1}},{vista:{default:"semana"},vistaModifiers:{},fechaActual:{default:()=>new Date},fechaActualModifiers:{},darkMode:{type:Boolean,default:!1},darkModeModifiers:{}}),emits:a.mergeModels(["nueva-cita"],["update:vista","update:fechaActual","update:darkMode"]),setup(e,{emit:r}){const s=a.useModel(e,"vista"),o=a.useModel(e,"fechaActual"),n=a.useModel(e,"darkMode"),d=[{value:"dia",label:"D√≠a",shortcut:"1"},{value:"5dias",label:"5 D√≠as",shortcut:"4"},{value:"semana",label:"Semana",shortcut:"2"},{value:"mes",label:"Mes",shortcut:"3"}],l=a.computed(()=>obtenerTituloAgenda(s.value,o.value));return(r,o,i,c)=>{o(`<div${t.ssrRenderAttrs(a.mergeProps({class:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3 px-4 py-3 bg-white dark:bg-gray-900 border-b border-cafe/10 dark:border-gray-800"},c))}><div class="flex items-center gap-3"><div class="flex items-center gap-1"><button class="p-2 rounded-lg hover:bg-purple-50 dark:hover:bg-gray-800 text-cafe/70 dark:text-gray-400 hover:text-purple-600 dark:hover:text-purple-400 transition-colors" title="Anterior"><svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path></svg></button><button class="px-3 py-1.5 text-sm font-medium rounded-lg border border-purple-200 dark:border-purple-700 text-purple-600 dark:text-purple-400 hover:bg-purple-50 dark:hover:bg-purple-900/30 transition-colors"> Hoy </button><button class="p-2 rounded-lg hover:bg-purple-50 dark:hover:bg-gray-800 text-cafe/70 dark:text-gray-400 hover:text-purple-600 dark:hover:text-purple-400 transition-colors" title="Siguiente"><svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path></svg></button></div><h1 class="text-lg sm:text-xl font-[&#39;Elms_Sans&#39;] font-bold text-neutral-800 dark:text-gray-100 capitalize">${t.ssrInterpolate(a.unref(l))}</h1></div><div class="flex items-center gap-3"><div class="flex items-center bg-gray-100 dark:bg-gray-800 rounded-lg p-1">\x3c!--[--\x3e`),t.ssrRenderList(d,e=>{o(`<button class="${t.ssrRenderClass([s.value===e.value?"bg-white dark:bg-gray-700 text-purple-600 dark:text-purple-400 shadow-sm":"text-cafe/70 dark:text-gray-400 hover:text-cafe dark:hover:text-gray-200","px-3 py-1.5 text-sm font-medium rounded-md transition-all"])}"${t.ssrRenderAttr("title",`Vista ${e.label} (${e.shortcut})`)}>${t.ssrInterpolate(e.label)}</button>`)}),o(`\x3c!--]--\x3e</div><button class="p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800 text-cafe/70 dark:text-gray-400 transition-colors"${t.ssrRenderAttr("title",n.value?"Modo claro":"Modo oscuro")}>`),n.value?o('<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"></path></svg>'):o('<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"></path></svg>'),o('</button><button class="flex items-center gap-2 px-4 py-2 bg-purple-600 hover:bg-purple-700 text-white text-sm font-medium rounded-lg shadow-sm hover:shadow transition-all"><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path></svg><span class="hidden sm:inline">Nueva Cita</span></button>'),e.mostrarRol?o(`<div class="hidden lg:flex items-center gap-2"><div class="px-3 py-1.5 bg-purple-50 dark:bg-purple-900/30 border border-purple-200 dark:border-purple-700 rounded-lg"><span class="text-sm font-semibold text-purple-700 dark:text-purple-400">${t.ssrInterpolate("coordinadora"===e.rolActivo?"Coordinadora":"Terapeuta")}</span></div></div>`):o("\x3c!----\x3e"),o("</div></div>")}}}),f=h.setup;h.setup=(e,t)=>{const r=a.useSSRContext();return(r.modules||(r.modules=new Set)).add("components/agenda/AgendaHeader.vue"),f?f(e,t):void 0};const w=Object.assign(h,{__name:"AgendaHeader"});function render(e,t){return a.openBlock(),a.createElementBlock("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[a.createElementVNode("path",{"fill-rule":"evenodd",d:"M19.916 4.626a.75.75 0 0 1 .208 1.04l-9 13.5a.75.75 0 0 1-1.154.114l-6-6a.75.75 0 0 1 1.06-1.06l5.353 5.353 8.493-12.74a.75.75 0 0 1 1.04-.207Z","clip-rule":"evenodd"})])}const y=a.defineComponent({__name:"TarjetaCita",__ssrInlineRender:!0,props:{cita:{},compact:{type:Boolean}},emits:["completar","verHistorial"],setup(e,{emit:r}){const s=e,formatearHora=e=>e.substring(0,5),o=a.computed(()=>({pendiente:"bg-yellow-100 text-yellow-800 border-yellow-300",confirmada:"bg-blue-100 text-blue-800 border-blue-300",completada:"bg-green-100 text-green-800 border-green-300",realizada:"bg-green-100 text-green-800 border-green-300",cancelada:"bg-red-100 text-red-800 border-red-300"}[s.cita.estado]||"bg-gray-100 text-gray-800 border-gray-300")),n=a.computed(()=>{if(!s.cita.bono)return null;const e=s.cita.bono.sesiones_restantes,a=s.cita.bono.estado;return"completado"===a||0===e?{color:"text-red-600",icono:"üö´",alerta:!0,mensajeAlerta:"Bono agotado",clase:"bg-red-50 border-red-200"}:1===e?{color:"text-orange-600",icono:"‚ö†Ô∏è",alerta:!0,mensajeAlerta:"√öltima sesi√≥n del bono",clase:"bg-orange-50 border-orange-200"}:e<=2?{color:"text-yellow-600",icono:"‚ö†Ô∏è",alerta:!0,mensajeAlerta:"Pocas sesiones restantes",clase:"bg-yellow-50 border-yellow-200"}:"activo"===a?{color:"text-green-600",icono:"‚úì",alerta:!1,mensajeAlerta:null,clase:"bg-green-50 border-green-200"}:{color:"text-gray-600",icono:"‚ÑπÔ∏è",alerta:!1,mensajeAlerta:null,clase:"bg-gray-50 border-gray-200"}}),d=a.computed(()=>"pendiente"===s.cita.estado||"confirmada"===s.cita.estado);return(r,s,l,i)=>{s(`<div${t.ssrRenderAttrs(a.mergeProps({class:["border rounded-xl shadow-sm hover:shadow-md transition-all duration-200 bg-white overflow-hidden",e.compact?"p-3":"p-5"]},i))} data-v-3085384e><div class="flex items-start justify-between gap-4" data-v-3085384e><div class="flex-1 min-w-0" data-v-3085384e><div class="flex items-center gap-3 mb-2 flex-wrap" data-v-3085384e><h3 class="${t.ssrRenderClass([e.compact?"text-base":"text-lg","font-semibold text-gray-900 truncate"])}" data-v-3085384e>${t.ssrInterpolate(e.cita.paciente?.nombre_completo||"Paciente")}</h3><span class="${t.ssrRenderClass(["px-3 py-1 text-xs font-medium rounded-full border",a.unref(o)])}" data-v-3085384e>${t.ssrInterpolate(e.cita.estado.toUpperCase())}</span></div><div class="${t.ssrRenderClass(["space-y-1",e.compact?"text-xs":"text-sm","text-gray-600"])}" data-v-3085384e><div class="flex items-center gap-2" data-v-3085384e><svg class="h-4 w-4 flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor" data-v-3085384e><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" data-v-3085384e></path></svg><span class="truncate" data-v-3085384e>${t.ssrInterpolate(formatearHora(e.cita.hora_inicio))} - ${t.ssrInterpolate(formatearHora(e.cita.hora_fin))}</span>`),e.cita.modalidad?s('<span class="text-gray-400" data-v-3085384e>‚Ä¢</span>'):s("\x3c!----\x3e"),e.cita.modalidad?s(`<span class="capitalize truncate" data-v-3085384e>${t.ssrInterpolate(e.cita.modalidad)}</span>`):s("\x3c!----\x3e"),s("</div>"),e.cita.paciente?.telefono&&!e.compact?s(`<div class="flex items-center gap-2" data-v-3085384e><svg class="h-4 w-4 flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor" data-v-3085384e><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z" data-v-3085384e></path></svg><span class="truncate" data-v-3085384e>${t.ssrInterpolate(e.cita.paciente.telefono)}</span></div>`):s("\x3c!----\x3e"),s("</div>"),e.cita.bono?(s(`<div class="${t.ssrRenderClass(["mt-3 p-3 rounded-lg border",a.unref(n)?.clase||"bg-gray-50 border-gray-200"])}" data-v-3085384e><div class="flex items-center justify-between gap-2" data-v-3085384e><div class="flex-1 min-w-0" data-v-3085384e><p class="text-xs font-medium text-gray-700 mb-1" data-v-3085384e>${t.ssrInterpolate(a.unref(n)?.icono)} Bono de Sesiones </p><div class="flex items-center gap-2 flex-wrap" data-v-3085384e><p class="${t.ssrRenderClass(["text-sm font-semibold",a.unref(n)?.color||"text-gray-900"])}" data-v-3085384e>${t.ssrInterpolate(e.cita.bono.sesiones_restantes)} / ${t.ssrInterpolate(e.cita.bono.sesiones_totales)} sesiones </p><span class="text-xs text-gray-500 capitalize" data-v-3085384e> (${t.ssrInterpolate(e.cita.bono.estado)}) </span></div>`),a.unref(n)?.alerta?s(`<p class="${t.ssrRenderClass(["mt-2 text-xs font-medium",a.unref(n).color])}" data-v-3085384e>${t.ssrInterpolate(a.unref(n).mensajeAlerta)}</p>`):s("\x3c!----\x3e"),s("</div>"),e.compact?s("\x3c!----\x3e"):s('<button class="text-xs text-blue-600 hover:text-blue-800 font-medium whitespace-nowrap px-2 py-1 hover:bg-blue-50 rounded transition-colors" type="button" data-v-3085384e> üìä Historial </button>'),s("</div></div>")):s('<div class="mt-3 p-3 bg-gray-50 border border-gray-200 rounded-lg" data-v-3085384e><p class="text-xs text-gray-500 italic flex items-center gap-2" data-v-3085384e><svg class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" data-v-3085384e><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" data-v-3085384e></path></svg> Sin bono activo - Consulta individual </p></div>'),e.cita.observaciones&&!e.compact?s(`<div class="mt-3 p-2 bg-gray-50 rounded text-xs text-gray-700" data-v-3085384e><p class="font-medium text-gray-500 mb-1" data-v-3085384e>Observaciones:</p> ${t.ssrInterpolate(e.cita.observaciones)}</div>`):s("\x3c!----\x3e"),s('</div><div class="flex flex-col gap-2" data-v-3085384e>'),a.unref(d)?s(`<button class="${t.ssrRenderClass(["px-4 py-2 bg-green-600 text-white font-medium rounded-lg hover:bg-green-700 transition-colors",e.compact?"text-xs":"text-sm"])}" type="button" data-v-3085384e> ‚úÖ Completar </button>`):"completada"===e.cita.estado||"realizada"===e.cita.estado?s(`<span class="${t.ssrRenderClass(["px-4 py-2 bg-green-100 text-green-800 font-medium rounded-lg text-center",e.compact?"text-xs":"text-sm"])}" data-v-3085384e> ‚úì Completada </span>`):s("\x3c!----\x3e"),s("</div></div></div>")}}}),_=y.setup;y.setup=(e,t)=>{const r=a.useSSRContext();return(r.modules||(r.modules=new Set)).add("components/TarjetaCita.vue"),_?_(e,t):void 0};const C=Object.assign(r(y,[["__scopeId","data-v-3085384e"]]),{__name:"TarjetaCita"}),$=a.defineComponent({__name:"AgendaStatusFilters",__ssrInlineRender:!0,props:{citas:{},estadosActivos:{default:()=>["pendiente","confirmada","realizada","cancelada"]}},emits:["filtrar","update:estadosActivos"],setup(e,{emit:r}){const s=e,o=a.ref(new Set(s.estadosActivos)),n=[{key:"pendiente",label:"Pendientes",emoji:"‚è≥",bgInactive:"bg-white hover:bg-yellow-50",textInactive:"text-yellow-700",borderInactive:"border-yellow-300",bgActive:"bg-yellow-500",textActive:"text-white",borderActive:"border-yellow-600",ringColor:"ring-yellow-500"},{key:"confirmada",label:"Confirmadas",emoji:"‚úì",bgInactive:"bg-white hover:bg-emerald-50",textInactive:"text-emerald-700",borderInactive:"border-emerald-300",bgActive:"bg-emerald-500",textActive:"text-white",borderActive:"border-emerald-600",ringColor:"ring-emerald-500"},{key:"realizada",label:"Realizadas",emoji:"‚úî",bgInactive:"bg-white hover:bg-blue-50",textInactive:"text-blue-700",borderInactive:"border-blue-300",bgActive:"bg-blue-500",textActive:"text-white",borderActive:"border-blue-600",ringColor:"ring-blue-500"},{key:"cancelada",label:"Canceladas",emoji:"‚úï",bgInactive:"bg-white hover:bg-red-50",textInactive:"text-red-700",borderInactive:"border-red-300",bgActive:"bg-red-500",textActive:"text-white",borderActive:"border-red-600",ringColor:"ring-red-500"}],d=a.computed(()=>s.citas.length),l=a.computed(()=>0===o.value.size?s.citas.length:s.citas.filter(e=>o.value.has(e.estado)).length),c=a.computed(()=>o.value.size<n.length&&o.value.size>0),u=a.computed(()=>o.value.size===n.length),estaActivo=e=>o.value.has(e);return(e,r,v,p)=>{r(`<div${t.ssrRenderAttrs(a.mergeProps({class:"space-y-3"},p))} data-v-8acd89bc><div class="flex items-center justify-between" data-v-8acd89bc><div class="flex items-center gap-3" data-v-8acd89bc><h3 class="text-sm font-bold text-gray-800 uppercase tracking-wide" data-v-8acd89bc>Filtrar por Estado</h3>`),c.value?r(`<div class="px-3 py-1 bg-gradient-to-r from-teal-500 to-teal-600 text-white text-xs font-bold rounded-full shadow-sm" data-v-8acd89bc>${t.ssrInterpolate(l.value)} de ${t.ssrInterpolate(d.value)} citas </div>`):u.value?r(`<div class="px-3 py-1 bg-gray-100 text-gray-700 text-xs font-semibold rounded-full" data-v-8acd89bc>${t.ssrInterpolate(d.value)} citas totales </div>`):r('<div class="px-3 py-1 bg-orange-100 text-orange-700 text-xs font-bold rounded-full animate-pulse" data-v-8acd89bc> Sin filtros - 0 citas visibles </div>'),r('</div><div class="flex items-center gap-2" data-v-8acd89bc>'),u.value?r("\x3c!----\x3e"):(r('<button class="text-xs font-medium text-teal-600 hover:text-teal-700 hover:underline transition-colors flex items-center gap-1" data-v-8acd89bc>'),r(t.ssrRenderComponent(a.unref(i),{class:"w-4 h-4"},null,v)),r(" Seleccionar todos </button>")),c.value||!u.value?r('<button class="text-xs font-medium text-gray-500 hover:text-gray-700 hover:underline transition-colors flex items-center gap-1" data-v-8acd89bc><svg class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" data-v-8acd89bc><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" data-v-8acd89bc></path></svg> Limpiar filtros </button>'):r("\x3c!----\x3e"),r('</div></div><div class="flex flex-wrap gap-3" data-v-8acd89bc>\x3c!--[--\x3e'),t.ssrRenderList(n,e=>{r(`<div class="${t.ssrRenderClass((e=>["relative flex items-center gap-2 px-4 py-2.5 rounded-xl text-sm font-semibold border-2 transition-all duration-200 cursor-pointer select-none","hover:shadow-md hover:-translate-y-0.5 active:translate-y-0","focus:outline-none focus:ring-2 focus:ring-offset-2",estaActivo(e.key)?[e.bgActive,e.textActive,e.borderActive,"shadow-sm"]:[e.bgInactive,e.textInactive,e.borderInactive],e.ringColor])(e))}" role="button"${t.ssrRenderAttr("aria-pressed",estaActivo(e.key))} tabindex="0" data-v-8acd89bc>`),estaActivo(e.key)?(r(`<div class="${t.ssrRenderClass([e.borderActive,"absolute -top-2 -right-2 w-6 h-6 bg-white rounded-full flex items-center justify-center shadow-lg border-2"])}" data-v-8acd89bc>`),r(t.ssrRenderComponent(a.unref(i),{class:["w-5 h-5",e.textInactive]},null,v)),r("</div>")):r("\x3c!----\x3e"),r(`<span class="text-lg leading-none" data-v-8acd89bc>${t.ssrInterpolate(e.emoji)}</span><span class="font-bold" data-v-8acd89bc>${t.ssrInterpolate(e.label)}</span><span class="${t.ssrRenderClass([estaActivo(e.key)?"bg-white/30":"bg-gray-100","ml-1 px-2 py-0.5 rounded-full text-xs font-bold"])}" data-v-8acd89bc>${t.ssrInterpolate((e=>s.citas.filter(a=>a.estado===e).length)(e.key))}</span></div>`)}),r("\x3c!--]--\x3e</div>"),0===o.value.size?r('<div class="mt-4 text-center py-8 px-4 bg-orange-50 rounded-xl border-2 border-orange-200" data-v-8acd89bc><div class="text-4xl mb-2" data-v-8acd89bc>üîç</div><p class="text-sm font-semibold text-orange-800 mb-1" data-v-8acd89bc> No hay filtros activos </p><p class="text-xs text-orange-600 mb-3" data-v-8acd89bc> Selecciona al menos un estado para ver las citas </p><button class="px-4 py-2 bg-orange-500 hover:bg-orange-600 text-white text-sm font-semibold rounded-lg transition-colors shadow-sm" data-v-8acd89bc> Mostrar todas las citas </button></div>'):0===l.value&&o.value.size>0?r('<div class="mt-4 text-center py-8 px-4 bg-gray-50 rounded-xl border-2 border-gray-200" data-v-8acd89bc><div class="text-4xl mb-2" data-v-8acd89bc>üì≠</div><p class="text-sm font-semibold text-gray-700 mb-1" data-v-8acd89bc> No hay citas con los estados seleccionados </p><p class="text-xs text-gray-500 mb-3" data-v-8acd89bc> Prueba seleccionando otros estados o todos </p><button class="text-sm font-medium text-teal-600 hover:text-teal-700 hover:underline" data-v-8acd89bc> Ver todas las citas </button></div>'):r("\x3c!----\x3e"),r("</div>")}}}),k=$.setup;$.setup=(e,t)=>{const r=a.useSSRContext();return(r.modules||(r.modules=new Set)).add("components/agenda/AgendaStatusFilters.vue"),k?k(e,t):void 0};const A=Object.assign(r($,[["__scopeId","data-v-8acd89bc"]]),{__name:"AgendaStatusFilters"}),R=a.defineComponent({__name:"AgendaViewControls",__ssrInlineRender:!0,props:{vista:{},fechaActual:{},loading:{type:Boolean,default:!1},lastUpdateTime:{default:null}},emits:["cambiar-vista","navegar-fecha","ir-hoy","actualizar"],setup(e,{emit:r}){const s=e,o=a.computed(()=>s.fechaActual.toLocaleDateString("es-ES",{weekday:"long",day:"numeric",month:"long",year:"numeric"})),n=a.computed(()=>o.value.charAt(0).toUpperCase()+o.value.slice(1));return(a,r,s,o)=>{r(`\x3c!--[--\x3e<div class="flex items-center justify-between gap-4 flex-wrap" data-v-c3b9a6c3><div class="flex items-center gap-3" data-v-c3b9a6c3><div class="text-sm" data-v-c3b9a6c3><span class="font-medium text-neutral-800" data-v-c3b9a6c3>${t.ssrInterpolate(n.value)}</span></div><div class="flex items-center gap-1 border border-neutral-200 rounded-lg p-1 bg-white" data-v-c3b9a6c3><button class="p-1.5 rounded hover:bg-neutral-100 text-neutral-600 hover:text-neutral-800 transition-colors"${t.ssrRenderAttr("aria-label","dia"===e.vista?"D√≠a anterior":"Semana anterior")} title="Anterior" data-v-c3b9a6c3><svg class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" data-v-c3b9a6c3><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" data-v-c3b9a6c3></path></svg></button><button class="px-3 py-1.5 text-xs font-semibold text-teal-700 hover:bg-teal-50 rounded transition-colors" data-v-c3b9a6c3> Hoy </button><button class="p-1.5 rounded hover:bg-neutral-100 text-neutral-600 hover:text-neutral-800 transition-colors"${t.ssrRenderAttr("aria-label","dia"===e.vista?"D√≠a siguiente":"Semana siguiente")} title="Siguiente" data-v-c3b9a6c3><svg class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" data-v-c3b9a6c3><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" data-v-c3b9a6c3></path></svg></button></div></div><div class="flex items-center gap-3" data-v-c3b9a6c3><div class="flex bg-neutral-100 rounded-lg p-1" role="tablist" data-v-c3b9a6c3><button role="tab"${t.ssrRenderAttr("aria-selected","dia"===e.vista)} class="${t.ssrRenderClass(["dia"===e.vista?"bg-white text-neutral-800 shadow-sm":"text-neutral-600 hover:text-neutral-800","px-3 py-1.5 rounded-md text-sm font-medium transition-all"])}" data-v-c3b9a6c3> D√≠a </button><button role="tab"${t.ssrRenderAttr("aria-selected","calendario"===e.vista)} class="${t.ssrRenderClass(["calendario"===e.vista?"bg-white text-neutral-800 shadow-sm":"text-neutral-600 hover:text-neutral-800","px-3 py-1.5 rounded-md text-sm font-medium transition-all"])}" data-v-c3b9a6c3> Semana </button><button role="tab"${t.ssrRenderAttr("aria-selected","lista"===e.vista)} class="${t.ssrRenderClass(["lista"===e.vista?"bg-white text-neutral-800 shadow-sm":"text-neutral-600 hover:text-neutral-800","px-3 py-1.5 rounded-md text-sm font-medium transition-all"])}" data-v-c3b9a6c3> Lista </button></div><button${t.ssrIncludeBooleanAttr(e.loading)?" disabled":""} class="flex items-center gap-2 px-3 py-2 bg-white border border-neutral-200 rounded-lg hover:bg-neutral-50 transition-colors shadow-sm disabled:opacity-50 disabled:cursor-not-allowed" aria-label="Actualizar agenda" data-v-c3b9a6c3><svg class="${t.ssrRenderClass(["w-4 h-4 text-teal-600",e.loading?"animate-spin":""])}" fill="none" viewBox="0 0 24 24" stroke="currentColor" data-v-c3b9a6c3><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" data-v-c3b9a6c3></path></svg>`),e.loading?r('<span class="text-sm font-medium text-neutral-500" data-v-c3b9a6c3>Actualizando...</span>'):r('<span class="text-sm font-medium text-neutral-700" data-v-c3b9a6c3>Actualizar</span>'),r("</button></div></div>"),e.lastUpdateTime&&!e.loading?r(`<div class="mt-2 text-right" data-v-c3b9a6c3><span class="text-xs text-neutral-400" data-v-c3b9a6c3>${t.ssrInterpolate(e.lastUpdateTime)}</span></div>`):r("\x3c!----\x3e"),r("\x3c!--]--\x3e")}}}),I=R.setup;R.setup=(e,t)=>{const r=a.useSSRContext();return(r.modules||(r.modules=new Set)).add("components/agenda/AgendaViewControls.vue"),I?I(e,t):void 0};const S=Object.assign(r(R,[["__scopeId","data-v-c3b9a6c3"]]),{__name:"AgendaViewControls"}),D=a.defineComponent({__name:"AgendaUnifiedHeader",__ssrInlineRender:!0,props:{vista:{},fechaActual:{},loading:{type:Boolean,default:!1},modoCoordinadora:{type:Boolean,default:!1}},emits:["cambiar-vista","navegar-fecha","ir-hoy","actualizar","nueva-cita","nueva-tarea"],setup(e,{emit:r}){const s=e,o=a.computed(()=>{const e=new Date(s.fechaActual),a=new Date(e.getFullYear(),0,1),t=Math.floor((e.getTime()-a.getTime())/864e5);return Math.ceil((t+a.getDay()+1)/7)}),n=a.computed(()=>{const e=new Date(s.fechaActual),a=e.getDay(),t=0===a?-6:1-a,r=new Date(e);r.setDate(e.getDate()+t);const o=new Date(r);o.setDate(r.getDate()+6);const formatoCorto=e=>e.getDate(),mes=e=>e.toLocaleDateString("es-ES",{month:"short"}),a√±o=e=>e.getFullYear();return r.getMonth()===o.getMonth()?`${formatoCorto(r)}‚Äì${formatoCorto(o)} ${mes(o)} ${a√±o(o)}`:`${formatoCorto(r)} ${mes(r)} ‚Äì ${formatoCorto(o)} ${mes(o)} ${a√±o(o)}`}),d=a.computed(()=>s.fechaActual.toLocaleDateString("es-ES",{weekday:"long",day:"numeric",month:"long",year:"numeric"})),l=a.computed(()=>{if("dia"===s.vista){const e=d.value;return e.charAt(0).toUpperCase()+e.slice(1)}return`Semana ${o.value} ¬∑ ${n.value}`}),i=[{value:"dia",label:"D√≠a"},{value:"calendario",label:"Semana"},{value:"lista",label:"Lista"}],u=a.computed(()=>"dia"===s.vista?{anterior:"D√≠a anterior",siguiente:"D√≠a siguiente"}:{anterior:"Semana anterior",siguiente:"Semana siguiente"});return(r,s,o,n)=>{s(`<header${t.ssrRenderAttrs(a.mergeProps({class:"agenda-unified-header"},n))} data-v-e95c8bd7><div class="header-left" data-v-e95c8bd7><h1 class="header-title" data-v-e95c8bd7>${t.ssrInterpolate(l.value)}</h1><nav class="nav-controls" aria-label="Navegaci√≥n temporal" data-v-e95c8bd7><button class="nav-btn"${t.ssrRenderAttr("aria-label",u.value.anterior)}${t.ssrRenderAttr("title",u.value.anterior)} data-v-e95c8bd7><svg class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" data-v-e95c8bd7><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" data-v-e95c8bd7></path></svg></button><button class="nav-today" data-v-e95c8bd7> Hoy </button><button class="nav-btn"${t.ssrRenderAttr("aria-label",u.value.siguiente)}${t.ssrRenderAttr("title",u.value.siguiente)} data-v-e95c8bd7><svg class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" data-v-e95c8bd7><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" data-v-e95c8bd7></path></svg></button></nav></div><div class="header-center" data-v-e95c8bd7><div class="view-selector" role="tablist" data-v-e95c8bd7>\x3c!--[--\x3e`),t.ssrRenderList(i,a=>{s(`<button role="tab"${t.ssrRenderAttr("aria-selected",e.vista===a.value)} class="${t.ssrRenderClass([{active:e.vista===a.value},"view-btn"])}" data-v-e95c8bd7>${t.ssrInterpolate(a.label)}</button>`)}),s(`\x3c!--]--\x3e</div></div><div class="header-right" data-v-e95c8bd7><button${t.ssrIncludeBooleanAttr(e.loading)?" disabled":""} class="action-btn action-btn-secondary" aria-label="Actualizar agenda" title="Actualizar" data-v-e95c8bd7>`),s(t.ssrRenderComponent(a.unref(c),{class:["w-4 h-4",e.loading?"animate-spin":""]},null,o)),s("</button>"),e.modoCoordinadora?(s('<button class="action-btn action-btn-secondary" aria-label="Crear nueva tarea" data-v-e95c8bd7>'),s(t.ssrRenderComponent(a.unref(v),{class:"w-4 h-4"},null,o)),s('<span class="hidden sm:inline" data-v-e95c8bd7>Nueva tarea</span></button>')):s("\x3c!----\x3e"),s('<button class="action-btn action-btn-primary" aria-label="Crear nueva cita" data-v-e95c8bd7>'),s(t.ssrRenderComponent(a.unref(p),{class:"w-4 h-4"},null,o)),s("<span data-v-e95c8bd7>Nueva cita</span></button></div></header>")}}}),j=D.setup;D.setup=(e,t)=>{const r=a.useSSRContext();return(r.modules||(r.modules=new Set)).add("components/agenda/AgendaUnifiedHeader.vue"),j?j(e,t):void 0};const z=Object.assign(r(D,[["__scopeId","data-v-e95c8bd7"]]),{__name:"AgendaUnifiedHeader"}),B=a.defineComponent({__name:"AgendaFilterBar",__ssrInlineRender:!0,props:{citas:{},modoCoordinadora:{type:Boolean,default:!1},terapeutas:{default:()=>[]},terapeutaSeleccionado:{default:null},estadosActivos:{default:()=>["pendiente","confirmada","realizada","cancelada"]},busqueda:{default:""}},emits:["update:busqueda","update:terapeutaSeleccionado","update:estadosActivos","filtrar-estados"],setup(e,{emit:r}){const s=e,o=a.ref(s.busqueda),n=a.ref(new Set(s.estadosActivos));a.watch(()=>s.busqueda,e=>{o.value=e}),a.watch(()=>s.estadosActivos,e=>{n.value=new Set(e)});const d=[{key:"pendiente",label:"Pendientes",color:"#F59E0B",bgLight:"rgba(245, 158, 11, 0.1)"},{key:"confirmada",label:"Confirmadas",color:"#10B981",bgLight:"rgba(16, 185, 129, 0.1)"},{key:"realizada",label:"Realizadas",color:"#6366F1",bgLight:"rgba(99, 102, 241, 0.1)"},{key:"cancelada",label:"Canceladas",color:"#EF4444",bgLight:"rgba(239, 68, 68, 0.1)"}],l=a.computed(()=>0===n.value.size?0:s.citas.filter(e=>n.value.has(e.estado)).length),estaActivo=e=>n.value.has(e),i=a.computed(()=>n.value.size===d.length);return(r,n,c,v)=>{n(`<div${t.ssrRenderAttrs(a.mergeProps({class:"filter-bar"},v))} data-v-06d28784><div class="filter-row-main" data-v-06d28784><div class="search-container" data-v-06d28784>`),n(t.ssrRenderComponent(a.unref(b),{class:"search-icon"},null,c)),n(`<input${t.ssrRenderAttr("value",o.value)} type="search" placeholder="Buscar por paciente, terapeuta o nota..." class="search-input" aria-label="Buscar en la agenda" data-v-06d28784>`),o.value?(n('<button class="search-clear" aria-label="Limpiar b√∫squeda" data-v-06d28784>'),n(t.ssrRenderComponent(a.unref(m),{class:"w-4 h-4"},null,c)),n("</button>")):n("\x3c!----\x3e"),n("</div>"),e.modoCoordinadora&&e.terapeutas.length>0?(n('<div class="terapeuta-selector" data-v-06d28784>'),n(t.ssrRenderComponent(a.unref(g),{class:"w-4 h-4 text-gray-400"},null,c)),n(`<select${t.ssrRenderAttr("value",e.terapeutaSeleccionado)} class="terapeuta-select" aria-label="Filtrar por terapeuta" data-v-06d28784><option value="" data-v-06d28784>Todos los terapeutas</option>\x3c!--[--\x3e`),t.ssrRenderList(e.terapeutas,e=>{n(`<option${t.ssrRenderAttr("value",e.id)} data-v-06d28784>${t.ssrInterpolate(e.nombre)}</option>`)}),n("\x3c!--]--\x3e</select></div>")):n("\x3c!----\x3e"),n('</div><div class="filter-row-states" data-v-06d28784><div class="states-label" data-v-06d28784>'),n(t.ssrRenderComponent(a.unref(u),{class:"w-3.5 h-3.5"},null,c)),n('<span data-v-06d28784>Estado</span></div><div class="states-chips" data-v-06d28784>\x3c!--[--\x3e'),t.ssrRenderList(d,e=>{n(`<button class="${t.ssrRenderClass([{active:estaActivo(e.key)},"state-chip"])}" style="${t.ssrRenderStyle({"--chip-color":e.color,"--chip-bg":e.bgLight})}"${t.ssrRenderAttr("aria-pressed",estaActivo(e.key))} data-v-06d28784><span class="chip-dot" style="${t.ssrRenderStyle({backgroundColor:e.color})}" data-v-06d28784></span><span class="chip-label" data-v-06d28784>${t.ssrInterpolate(e.label)}</span><span class="chip-count" data-v-06d28784>${t.ssrInterpolate((e=>s.citas.filter(a=>a.estado===e).length)(e.key))}</span>`),estaActivo(e.key)?n(t.ssrRenderComponent(a.unref(render),{class:"chip-check"},null,c)):n("\x3c!----\x3e"),n("</button>")}),n('\x3c!--]--\x3e</div><div class="results-count" data-v-06d28784>'),i.value?n(`<span class="results-total" data-v-06d28784>${t.ssrInterpolate(e.citas.length)} citas </span>`):n(`<span class="results-filtered" data-v-06d28784>${t.ssrInterpolate(l.value)} de ${t.ssrInterpolate(e.citas.length)}</span>`),i.value?n("\x3c!----\x3e"):n('<button class="show-all-btn" data-v-06d28784> Ver todas </button>'),n("</div></div>"),o.value?(n(`<div class="search-indicator" data-v-06d28784><span class="search-indicator-text" data-v-06d28784> Buscando: <strong data-v-06d28784>&quot;${t.ssrInterpolate(o.value)}&quot;</strong></span><button class="search-indicator-clear" data-v-06d28784>`),n(t.ssrRenderComponent(a.unref(m),{class:"w-3.5 h-3.5"},null,c)),n(" Limpiar </button></div>")):n("\x3c!----\x3e"),n("</div>")}}}),M=B.setup;B.setup=(e,t)=>{const r=a.useSSRContext();return(r.modules||(r.modules=new Set)).add("components/agenda/AgendaFilterBar.vue"),M?M(e,t):void 0};const L=Object.assign(r(B,[["__scopeId","data-v-06d28784"]]),{__name:"AgendaFilterBar"}),E=a.defineComponent({__name:"AgendaTerapeuta",__ssrInlineRender:!0,props:{modoCoordinadora:{type:Boolean,default:!1},mostrarFiltroTerapeuta:{type:Boolean,default:!1}},setup(e){const r=e,{citas:i,loading:c,error:u,citasConBonoProximoAgotar:v,lastUpdateTime:p,refreshAppointments:b}=s(),{completarCita:m,obtenerHistorialBono:g,verificarBonoCitas:x}=useAgenda();d();const toast_success=e=>{console.info("[SUCCESS]",e)},toast_error=e=>{console.error("[ERROR]",e),alert(e)},h=a.ref("hoy"),f=a.ref("calendario"),y=a.ref(new Date),_=a.ref(!1),$=a.ref(null),k=a.ref([]),R=a.ref(null),I=a.ref(!1),D=a.ref(null),j=a.ref([]),B=a.ref(["pendiente","confirmada","realizada","cancelada"]),M=a.ref(""),E=a.computed(()=>r.modoCoordinadora&&D.value?i.value.filter(e=>e.terapeuta?.id===D.value):i.value),T=a.computed(()=>0===B.value.length?[]:E.value.filter(e=>B.value.includes(e.estado))),H=a.computed(()=>{if(!M.value.trim())return T.value;const e=M.value.toLowerCase().trim();return T.value.filter(a=>{const t=(a.paciente_nombre||a.paciente?.nombre_completo||"").toLowerCase(),r=(a.terapeuta_nombre||a.terapeuta?.nombre_completo||"").toLowerCase(),s=(a.observaciones||"").toLowerCase(),o=(a.modalidad||"").toLowerCase();return t.includes(e)||r.includes(e)||s.includes(e)||o.includes(e)})}),V=a.computed(()=>H.value);a.ref(null);const P=a.ref(null),O=a.ref(!1),N=a.ref(null),F=a.ref(null),q=a.ref(null),U=a.ref(!1),Y=a.ref(null),G=a.ref(null);a.ref(null),a.ref(null),a.ref(!1);const W=a.ref(null),X=["11:00","12:00","13:00","17:00","18:00","19:00","20:00","21:00","22:00"],Z=a.computed(()=>{const e=new Date(y.value),a=e.getDay(),t=0===a?-6:1-a;e.setDate(e.getDate()+t);const r=[];for(let a=0;a<7;a++){const t=new Date(e);t.setDate(e.getDate()+a),r.push({fecha:t.toISOString().split("T")[0],nombreDia:t.toLocaleDateString("es-ES",{weekday:"short"}),numeroDia:t.getDate(),mes:t.toLocaleDateString("es-ES",{month:"short"})})}return r}),K=a.computed(()=>{const e=V.value,a=(new Date).toISOString().split("T")[0];switch(h.value){case"hoy":return e.filter(e=>e.fecha_cita===a);case"pendientes":return e.filter(e=>"pendiente"===e.estado);case"completadas":return e.filter(e=>"completada"===e.estado||"realizada"===e.estado);default:return e}}),formatearHora=e=>e.substring(0,5),formatearFechaCompleta=e=>e.toLocaleDateString("es-ES",{weekday:"long",day:"numeric",month:"long",year:"numeric"}),getBadgeEstado=e=>({pendiente:"bg-amber-100 text-amber-700 border border-amber-200",confirmada:"bg-green-100 text-green-700 border border-green-200",completada:"bg-blue-100 text-blue-700 border border-blue-200",realizada:"bg-blue-100 text-blue-700 border border-blue-200",cancelada:"bg-red-100 text-red-700 border border-red-200"}[e]||"bg-gray-100 text-gray-700 border border-gray-200"),esHoy=e=>e===(new Date).toISOString().split("T")[0],cambiarFecha=e=>{const a=new Date(y.value);"dia"===f.value?a.setDate(a.getDate()+e):a.setDate(a.getDate()+7*e),y.value=a},irHoy=()=>{y.value=new Date},citasPorHora=e=>{const a=y.value.toISOString().split("T")[0];return V.value.filter(t=>t.fecha_cita===a&&t.hora_inicio?.startsWith(e))},getClasesCita=e=>({pendiente:"bg-yellow-100 border-l-4 border-yellow-500",confirmada:"bg-green-100 border-l-4 border-green-500",completada:"bg-blue-100 border-l-4 border-blue-500",realizada:"bg-blue-100 border-l-4 border-blue-500",cancelada:"bg-red-100 border-l-4 border-red-500"}[e]||"bg-gray-100 border-l-4 border-gray-500"),getEstadoLabel=e=>({pendiente:"Pendiente",confirmada:"Confirmada",completada:"Completada",realizada:"Realizada",cancelada:"Cancelada"}[e]||e),citasPorDiaHora=(e,a)=>V.value.filter(t=>t.fecha_cita===e&&t.hora_inicio?.startsWith(a)),handleCitaCreated=async()=>{O.value=!1,N.value=null,F.value=null,await b(),toast_success("Cita creada exitosamente")},handleModalCerrar=()=>{O.value=!1,N.value=null,F.value=null,q.value=null,W.value=null},handleCerrarDetallesCita=()=>{U.value=!1,setTimeout(()=>{Y.value=null},300)},handleCitaActualizada=async()=>{await b(),toast_success("Cita actualizada correctamente")},Q=a.ref(null),J=a.ref(null),ee=a.ref(!1),ae=a.ref(null),te=a.ref(""),re=a.ref(""),se=a.ref(""),oe=a.computed(()=>{if(!re.value)return X;const e=X.indexOf(re.value);return-1===e?X:[...X.slice(e+1),"23:00"]}),esCeldaEnRango=(e,a)=>{if(!W.value)return!1;const{fechaInicio:t,horaInicio:r,fechaFin:s,horaFin:o}=W.value;if(e===t&&e===s){const e=X.indexOf(a),t=X.indexOf(r),s=X.indexOf(o);if(-1===e||-1===t||-1===s)return!1;const n=Math.min(t,s),d=Math.max(t,s);return e>=n&&e<=d}return!1},esCeldaObjetivo=(e,a)=>P.value?.fecha===e&&P.value?.hora===a,handleCompletarCita=async e=>{if(confirm("¬øEst√°s seguro de marcar esta cita como completada?"))try{(await m(e)).success&&console.log("Cita completada")}catch(e){console.error("Error al completar cita:",e)}},abrirHistorial=async e=>{try{I.value=!0,$.value=e,_.value=!0;const[a,t]=await Promise.all([g(e),x(e)]);k.value=a,R.value=t}catch(e){console.error("Error al cargar historial:",e)}finally{I.value=!1}},recargarCitas=async()=>{try{await b(),toast_success("Agenda actualizada")}catch(e){console.error("Error al recargar citas:",e),toast_error("Error al actualizar la agenda")}},handleFiltrarPorEstado=e=>{B.value=e,l.debug("filter_change","Filtros de estado actualizados",{estados:e})};return(r,s,d,l)=>{const b=C,m=o,g=n;s(`<div${t.ssrRenderAttrs(a.mergeProps({class:["agenda-layout",{"modo-coordinadora":e.modoCoordinadora}]},l))} data-v-8cde2423>`),e.modoCoordinadora?(s("\x3c!--[--\x3e"),s(t.ssrRenderComponent(z,{vista:f.value,"fecha-actual":y.value,loading:a.unref(c),"modo-coordinadora":!0,onCambiarVista:e=>f.value=e,onNavegarFecha:cambiarFecha,onIrHoy:irHoy,onActualizar:recargarCitas,onNuevaCita:e=>O.value=!0,onNuevaTarea:()=>{}},null,d)),s(t.ssrRenderComponent(L,{citas:a.unref(i),"modo-coordinadora":!0,terapeutas:j.value,"terapeuta-seleccionado":D.value,"estados-activos":B.value,busqueda:M.value,"onUpdate:busqueda":e=>M.value=e,"onUpdate:terapeutaSeleccionado":e=>D.value=e,"onUpdate:estadosActivos":handleFiltrarPorEstado,onFiltrarEstados:handleFiltrarPorEstado},null,d)),s("\x3c!--]--\x3e")):(s('\x3c!--[--\x3e<div class="bg-white/90 backdrop-blur-sm rounded-2xl shadow-sm border border-white/30 p-4" data-v-8cde2423>'),s(t.ssrRenderComponent(w,{titulo:"Mi Agenda",subtitulo:"Tus citas programadas","rol-activo":"terapeuta","mostrar-rol":!1},null,d)),s('</div><div class="bg-white/90 backdrop-blur-sm rounded-2xl shadow-sm border border-white/30 p-4" data-v-8cde2423>'),s(t.ssrRenderComponent(S,{vista:f.value,"fecha-actual":y.value,loading:a.unref(c),"last-update-time":a.unref(p),onCambiarVista:e=>f.value=e,onNavegarFecha:cambiarFecha,onIrHoy:irHoy,onActualizar:recargarCitas},null,d)),s(`</div><div class="bg-white/90 backdrop-blur-sm rounded-2xl shadow-sm border border-white/30 p-4 space-y-4" data-v-8cde2423><div class="flex-1 relative" data-v-8cde2423><label for="buscar-citas" class="sr-only" data-v-8cde2423>Buscar paciente o cita</label><div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none" data-v-8cde2423><svg class="h-4 w-4 text-neutral-400" fill="none" viewBox="0 0 24 24" stroke="currentColor" data-v-8cde2423><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" data-v-8cde2423></path></svg></div><input id="buscar-citas"${t.ssrRenderAttr("value",M.value)} type="search" placeholder="Buscar por paciente o nota..." class="block w-full pl-10 pr-4 py-2.5 bg-white border border-neutral-200 rounded-xl text-sm text-neutral-800 placeholder-neutral-400 focus:outline-none focus:ring-2 focus:ring-teal-500/30 focus:border-teal-500 transition-all" aria-label="Buscar paciente o cita" data-v-8cde2423>`),M.value?s('<button class="absolute inset-y-0 right-0 pr-3 flex items-center text-neutral-400 hover:text-neutral-600" aria-label="Limpiar b√∫squeda" data-v-8cde2423><svg class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" data-v-8cde2423><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" data-v-8cde2423></path></svg></button>'):s("\x3c!----\x3e"),s("</div>"),M.value?s(`<div class="flex items-center gap-2 text-sm" data-v-8cde2423><span class="text-neutral-500" data-v-8cde2423>${t.ssrInterpolate(V.value.length)} resultado${t.ssrInterpolate(1!==V.value.length?"s":"")} para </span><span class="px-2 py-0.5 bg-teal-50 text-teal-700 rounded-md font-medium" data-v-8cde2423> &quot;${t.ssrInterpolate(M.value)}&quot; </span></div>`):s("\x3c!----\x3e"),s(t.ssrRenderComponent(A,{citas:a.unref(i),"estados-activos":B.value,onFiltrar:handleFiltrarPorEstado},null,d)),s("</div>\x3c!--]--\x3e")),a.unref(v).length>0?s(`<div class="bg-gradient-to-r from-amber-50 to-orange-50 border border-amber-200 rounded-2xl p-4 mb-4 shadow-sm" data-v-8cde2423><div class="flex items-center gap-3" data-v-8cde2423><div class="w-10 h-10 rounded-xl bg-gradient-to-br from-[#F2B33D] to-[#F2B33D]/70 flex items-center justify-center flex-shrink-0" data-v-8cde2423><svg class="h-5 w-5 text-white" fill="currentColor" viewBox="0 0 20 20" data-v-8cde2423><path fill-rule="evenodd" d="M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z" clip-rule="evenodd" data-v-8cde2423></path></svg></div><div class="flex-1" data-v-8cde2423><p class="text-sm font-medium text-amber-900" data-v-8cde2423> Atenci√≥n: ${t.ssrInterpolate(a.unref(v).length)} paciente(s) con pocas sesiones restantes </p><p class="text-xs text-amber-700 mt-1" data-v-8cde2423> Considera informar a estos pacientes para renovar sus bonos </p></div></div></div>`):s("\x3c!----\x3e"),"dia"===f.value?(s(`<div class="bg-white/90 backdrop-blur-sm rounded-2xl shadow-sm border border-white/30 overflow-hidden flex flex-col" style="${t.ssrRenderStyle({height:"calc(100vh - 200px)"})}" data-v-8cde2423><div class="sticky top-0 z-10 bg-gradient-to-r from-white/95 via-white/90 to-white/95 backdrop-blur-md border-b border-neutral-200 shadow-sm p-4" data-v-8cde2423><div class="flex items-center justify-between" data-v-8cde2423><div data-v-8cde2423><h3 class="font-[&#39;Elms_Sans&#39;] font-semibold text-lg text-neutral-800" data-v-8cde2423>${t.ssrInterpolate(formatearFechaCompleta(y.value))}</h3><p class="text-sm text-neutral-600 mt-1" data-v-8cde2423>${t.ssrInterpolate(citasPorHora?Object.values(X).reduce((e,a)=>e+citasPorHora(a).length,0):0)} citas programadas </p></div></div></div><div class="flex-1 overflow-y-auto" data-v-8cde2423>`),0===K.value.length?s(`<div class="flex items-center justify-center py-16" data-v-8cde2423><div class="text-center" data-v-8cde2423><div class="w-16 h-16 mx-auto mb-4 rounded-full bg-gradient-to-br from-[#027368]/10 to-[#04BF9D]/10 flex items-center justify-center" data-v-8cde2423><svg class="w-8 h-8 text-[#027368]" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-8cde2423><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" data-v-8cde2423></path></svg></div><h3 class="font-[&#39;Elms_Sans&#39;] font-medium text-neutral-800 mb-2" data-v-8cde2423>No hay citas programadas</h3><p class="text-neutral-600 text-sm" data-v-8cde2423>${t.ssrInterpolate(formatearFechaCompleta(y.value))} est√° libre</p></div></div>`):(s('<div class="divide-y divide-neutral-100" data-v-8cde2423>\x3c!--[--\x3e'),t.ssrRenderList(X,(r,o)=>{s(`<div${t.ssrRenderAttr("data-hora",r)} class="flex hover:bg-neutral-50/50 transition-colors" data-v-8cde2423><div class="w-20 p-3 text-sm font-medium text-neutral-600 border-r border-neutral-200 bg-neutral-50/50 flex-shrink-0" data-v-8cde2423>${t.ssrInterpolate(r)}</div><div class="flex-1 p-3 cursor-pointer hover:bg-[#027368]/5 transition-colors relative group/cell" data-v-8cde2423>`),0===citasPorHora(r).length?s('<button class="absolute right-3 top-1/2 -translate-y-1/2 w-7 h-7 rounded-full bg-[#027368] text-white flex items-center justify-center opacity-0 group-hover/cell:opacity-100 transition-all hover:bg-[#025a52] hover:scale-110 shadow-sm" title="Crear nueva cita" aria-label="Crear nueva cita a las {{ hora }}" data-v-8cde2423><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-8cde2423><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" data-v-8cde2423></path></svg></button>'):s("\x3c!----\x3e"),s("\x3c!--[--\x3e"),t.ssrRenderList(citasPorHora(r),r=>{s(`<div draggable="true" class="${t.ssrRenderClass([[getClasesCita(r.estado),G.value===r.id?"opacity-60 pointer-events-none":"cursor-pointer"],"mb-2 p-3 rounded-xl transition-all hover:shadow-md hover:ring-2 hover:ring-[#027368]/30 group relative backdrop-blur-sm"])}" role="button" tabindex="0"${t.ssrRenderAttr("aria-label",`Cita ${r.estado} de ${r.paciente_nombre||"paciente"}, ${formatearHora(r.hora_inicio)} a ${formatearHora(r.hora_fin)}, ${r.modalidad}${"pendiente"===r.estado?". Pulsa para ver detalles o confirmar.":". Pulsa para ver detalles."}`)}${t.ssrRenderAttr("title",`${r.paciente_nombre||"Sin paciente"} - ${formatearHora(r.hora_inicio)} a ${formatearHora(r.hora_fin)}. Click para ver detalles.`)} data-v-8cde2423><div class="absolute top-2 right-2 flex items-center gap-1 opacity-0 group-hover:opacity-100 group-focus-within:opacity-100 transition-all z-10" data-v-8cde2423>`),"pendiente"===r.estado?(s(`<button class="${t.ssrRenderClass([{"animate-pulse":G.value===r.id},"w-6 h-6 rounded-full bg-emerald-500 text-white flex items-center justify-center hover:bg-emerald-600 hover:scale-110 shadow-sm transition-all"])}"${t.ssrIncludeBooleanAttr(G.value===r.id)?" disabled":""}${t.ssrRenderAttr("title",G.value===r.id?"Confirmando...":"Confirmar cita")}${t.ssrRenderAttr("aria-label",`Confirmar cita de ${r.paciente_nombre||"paciente"}`)} type="button" data-v-8cde2423>`),G.value===r.id?s('<svg class="w-3.5 h-3.5 animate-spin" fill="none" viewBox="0 0 24 24" data-v-8cde2423><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4" data-v-8cde2423></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z" data-v-8cde2423></path></svg>'):s('<svg class="w-3.5 h-3.5" fill="currentColor" viewBox="0 0 20 20" data-v-8cde2423><path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" data-v-8cde2423></path></svg>'),s("</button>")):s("\x3c!----\x3e"),"cancelada"!==r.estado?s(`<button class="w-6 h-6 rounded-full bg-blue-500 text-white flex items-center justify-center hover:bg-blue-600 hover:scale-110 shadow-sm transition-all"${t.ssrIncludeBooleanAttr(J.value===r.id)?" disabled":""} title="Reprogramar cita"${t.ssrRenderAttr("aria-label",`Reprogramar cita de ${r.paciente_nombre||"paciente"}`)} type="button" data-v-8cde2423><svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-8cde2423><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" data-v-8cde2423></path></svg></button>`):s("\x3c!----\x3e"),"cancelada"!==r.estado&&"completada"!==r.estado&&"realizada"!==r.estado?(s(`<button class="${t.ssrRenderClass([{"animate-pulse":Q.value===r.id},"w-6 h-6 rounded-full bg-red-500 text-white flex items-center justify-center hover:bg-red-600 hover:scale-110 shadow-sm transition-all"])}"${t.ssrIncludeBooleanAttr(Q.value===r.id)?" disabled":""}${t.ssrRenderAttr("title",Q.value===r.id?"Cancelando...":"Cancelar cita")}${t.ssrRenderAttr("aria-label",`Cancelar cita de ${r.paciente_nombre||"paciente"}`)} type="button" data-v-8cde2423>`),Q.value===r.id?s('<svg class="w-3.5 h-3.5 animate-spin" fill="none" viewBox="0 0 24 24" data-v-8cde2423><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4" data-v-8cde2423></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z" data-v-8cde2423></path></svg>'):s('<svg class="w-3.5 h-3.5" fill="currentColor" viewBox="0 0 20 20" data-v-8cde2423><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd" data-v-8cde2423></path></svg>'),s("</button>")):s("\x3c!----\x3e"),s('</div><div class="flex items-start justify-between gap-3" data-v-8cde2423><div class="opacity-0 group-hover:opacity-100 transition-opacity flex-shrink-0" data-v-8cde2423>'),s(t.ssrRenderComponent(a.unref(render$1),{class:"w-4 h-4 text-neutral-500"},null,d)),s(`</div><div class="flex-1 min-w-0" data-v-8cde2423><p class="font-medium text-sm text-neutral-800 truncate" data-v-8cde2423>${t.ssrInterpolate(r.paciente_nombre||r.paciente?.nombre_completo||"Sin paciente")}</p><div class="flex items-center flex-wrap gap-2 mt-1" data-v-8cde2423><span class="text-xs text-neutral-600 font-medium" data-v-8cde2423>${t.ssrInterpolate(formatearHora(r.hora_inicio))} - ${t.ssrInterpolate(formatearHora(r.hora_fin))}</span><span class="inline-flex items-center gap-1 text-xs px-2 py-0.5 rounded-lg bg-white/60 text-neutral-700" data-v-8cde2423>`),"online"===r.modalidad?s('<span title="Online" data-v-8cde2423>üíª</span>'):s('<span title="Presencial" data-v-8cde2423>üè•</span>'),s(` ${t.ssrInterpolate("online"===r.modalidad?"Online":"Presencial")}</span>`),void 0!==r.bono_sesiones_restantes&&null!==r.bono_sesiones_restantes?s(`<span class="${t.ssrRenderClass([{"bg-red-100 text-red-700":0===r.bono_sesiones_restantes,"bg-orange-100 text-orange-700":1===r.bono_sesiones_restantes,"bg-yellow-100 text-yellow-700":2===r.bono_sesiones_restantes,"bg-green-100 text-green-700":r.bono_sesiones_restantes>2},"text-xs px-2 py-0.5 rounded-lg font-medium"])}" data-v-8cde2423>${t.ssrInterpolate(r.bono_sesiones_restantes)}/${t.ssrInterpolate(r.bono_sesiones_totales||"?")} sesiones </span>`):s("\x3c!----\x3e"),s("</div>"),e.modoCoordinadora&&(r.terapeuta_nombre||r.terapeuta?.nombre_completo)?s(`<p class="text-xs text-neutral-500 mt-1 flex items-center gap-1" data-v-8cde2423><span data-v-8cde2423>üë§</span> ${t.ssrInterpolate(r.terapeuta_nombre||r.terapeuta?.nombre_completo)}</p>`):s("\x3c!----\x3e"),s(`</div><div class="flex items-center gap-2 flex-shrink-0" data-v-8cde2423><span class="${t.ssrRenderClass([getBadgeEstado(r.estado),"text-xs px-2 py-1 rounded-lg font-medium whitespace-nowrap"])}" data-v-8cde2423>${t.ssrInterpolate(getEstadoLabel(r.estado))}</span></div></div></div>`)}),s("\x3c!--]--\x3e</div></div>")}),s("\x3c!--]--\x3e</div>")),s("</div></div>")):"calendario"===f.value?(s(`<div class="bg-white/90 backdrop-blur-sm rounded-2xl shadow-sm border border-white/30 overflow-hidden flex flex-col" style="${t.ssrRenderStyle({height:"calc(100vh - 200px)"})}" data-v-8cde2423><div class="min-w-[800px] overflow-x-auto flex-1 flex flex-col" data-v-8cde2423><div class="sticky top-0 z-10 bg-white border-b border-gray-200 shadow-sm" data-v-8cde2423><div class="grid grid-cols-8" data-v-8cde2423><div class="p-2 border-r border-gray-200 bg-gray-50" data-v-8cde2423></div>\x3c!--[--\x3e`),t.ssrRenderList(Z.value,e=>{s(`<div class="${t.ssrRenderClass([esHoy(e.fecha)?"bg-blue-50":"bg-white","p-2 text-center border-r border-gray-200 last:border-r-0"])}" data-v-8cde2423><div class="flex items-center justify-center gap-1" data-v-8cde2423><span class="text-xs font-medium text-gray-600 uppercase" data-v-8cde2423>${t.ssrInterpolate(e.nombreDia)}</span><span class="${t.ssrRenderClass([esHoy(e.fecha)?"text-blue-600":"","text-lg font-bold text-gray-900"])}" data-v-8cde2423>${t.ssrInterpolate(e.numeroDia)}</span></div><div class="text-xs text-gray-500" data-v-8cde2423>${t.ssrInterpolate(e.mes)}</div></div>`)}),s('\x3c!--]--\x3e</div></div><div class="flex-1 overflow-y-auto" data-v-8cde2423><div class="divide-y divide-gray-100" data-v-8cde2423>\x3c!--[--\x3e'),t.ssrRenderList(X,r=>{s(`<div${t.ssrRenderAttr("data-hora",r)} class="grid grid-cols-8" data-v-8cde2423><div class="p-3 text-sm font-medium text-gray-600 border-r border-gray-100 bg-gray-50 sticky left-0" data-v-8cde2423>${t.ssrInterpolate(r)}</div>\x3c!--[--\x3e`),t.ssrRenderList(Z.value,o=>{s(`<div class="${t.ssrRenderClass([[esHoy(o.fecha)?"bg-blue-50/20":"",esCeldaObjetivo(o.fecha,r)?"bg-blue-100 ring-2 ring-blue-500 ring-inset":"",esCeldaEnRango(o.fecha,r)?"bg-[#027368]/20 ring-2 ring-[#027368] ring-inset":""],"p-2 border-r border-gray-100 last:border-r-0 hover:bg-blue-50/30 transition-colors min-h-[70px] cursor-pointer relative group/cell"])}" data-v-8cde2423>`),0===citasPorDiaHora(o.fecha,r).length?s(`<div class="absolute inset-0 flex items-center justify-center opacity-0 group-hover/cell:opacity-100 transition-all duration-200 pointer-events-none" data-v-8cde2423><div class="w-6 h-6 rounded-full bg-teal-500/90 text-white flex items-center justify-center shadow-md transform scale-90 group-hover/cell:scale-100 transition-transform"${t.ssrRenderAttr("title",`Crear cita el ${o.nombreDia} ${o.numeroDia} a las ${r}`)} data-v-8cde2423><svg class="w-3.5 h-3.5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5" data-v-8cde2423><path stroke-linecap="round" stroke-linejoin="round" d="M12 4v16m8-8H4" data-v-8cde2423></path></svg></div></div>`):s("\x3c!----\x3e"),s("\x3c!--[--\x3e"),t.ssrRenderList(citasPorDiaHora(o.fecha,r),r=>{s(`<div draggable="true" class="${t.ssrRenderClass([[getClasesCita(r.estado),G.value===r.id?"opacity-60 pointer-events-none":"cursor-pointer"],"text-xs p-2 rounded-lg mb-1.5 hover:shadow-lg hover:ring-2 hover:ring-teal-400 transition-all group relative border-l-3"])}" role="button" tabindex="0"${t.ssrRenderAttr("aria-label",`Cita ${r.estado} de ${r.paciente_nombre||"paciente"}, ${formatearHora(r.hora_inicio)} a ${formatearHora(r.hora_fin)}, ${r.modalidad}${"pendiente"===r.estado?". Pulsa para ver detalles o confirmar.":". Pulsa para ver detalles."}`)}${t.ssrRenderAttr("title",`${r.paciente_nombre||"Sin paciente"} - ${formatearHora(r.hora_inicio)} a ${formatearHora(r.hora_fin)}. Click para ver detalles.`)} data-v-8cde2423><div class="absolute top-0.5 right-0.5 flex items-center gap-0.5 opacity-0 group-hover:opacity-100 group-focus-within:opacity-100 transition-all z-10" data-v-8cde2423>`),"pendiente"===r.estado?(s(`<button class="${t.ssrRenderClass([{"animate-pulse":G.value===r.id},"w-5 h-5 rounded-full bg-emerald-500 text-white flex items-center justify-center hover:bg-emerald-600 hover:scale-110 shadow-sm transition-all"])}"${t.ssrIncludeBooleanAttr(G.value===r.id)?" disabled":""}${t.ssrRenderAttr("title",G.value===r.id?"Confirmando...":"Confirmar cita")}${t.ssrRenderAttr("aria-label",`Confirmar cita de ${r.paciente_nombre||"paciente"}`)} type="button" data-v-8cde2423>`),G.value===r.id?s('<svg class="w-2.5 h-2.5 animate-spin" fill="none" viewBox="0 0 24 24" data-v-8cde2423><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4" data-v-8cde2423></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z" data-v-8cde2423></path></svg>'):s('<svg class="w-2.5 h-2.5" fill="currentColor" viewBox="0 0 20 20" data-v-8cde2423><path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" data-v-8cde2423></path></svg>'),s("</button>")):s("\x3c!----\x3e"),"cancelada"!==r.estado?s(`<button class="w-5 h-5 rounded-full bg-blue-500 text-white flex items-center justify-center hover:bg-blue-600 hover:scale-110 shadow-sm transition-all"${t.ssrIncludeBooleanAttr(J.value===r.id)?" disabled":""} title="Reprogramar cita"${t.ssrRenderAttr("aria-label",`Reprogramar cita de ${r.paciente_nombre||"paciente"}`)} type="button" data-v-8cde2423><svg class="w-2.5 h-2.5" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-8cde2423><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" data-v-8cde2423></path></svg></button>`):s("\x3c!----\x3e"),"cancelada"!==r.estado&&"completada"!==r.estado&&"realizada"!==r.estado?(s(`<button class="${t.ssrRenderClass([{"animate-pulse":Q.value===r.id},"w-5 h-5 rounded-full bg-red-500 text-white flex items-center justify-center hover:bg-red-600 hover:scale-110 shadow-sm transition-all"])}"${t.ssrIncludeBooleanAttr(Q.value===r.id)?" disabled":""}${t.ssrRenderAttr("title",Q.value===r.id?"Cancelando...":"Cancelar cita")}${t.ssrRenderAttr("aria-label",`Cancelar cita de ${r.paciente_nombre||"paciente"}`)} type="button" data-v-8cde2423>`),Q.value===r.id?s('<svg class="w-2.5 h-2.5 animate-spin" fill="none" viewBox="0 0 24 24" data-v-8cde2423><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4" data-v-8cde2423></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z" data-v-8cde2423></path></svg>'):s('<svg class="w-2.5 h-2.5" fill="currentColor" viewBox="0 0 20 20" data-v-8cde2423><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd" data-v-8cde2423></path></svg>'),s("</button>")):s("\x3c!----\x3e"),s('<div class="w-5 h-5 flex items-center justify-center" data-v-8cde2423>'),s(t.ssrRenderComponent(a.unref(render$1),{class:"w-3 h-3 text-gray-500"},null,d)),s(`</div></div><div class="pr-8" data-v-8cde2423><p class="font-semibold truncate text-sm text-gray-800" data-v-8cde2423>${t.ssrInterpolate(r.paciente_nombre||r.paciente?.nombre_completo||"Sin paciente")}</p><p class="text-xs text-gray-500 mt-0.5 font-medium" data-v-8cde2423>${t.ssrInterpolate(formatearHora(r.hora_inicio))} ‚Äì ${t.ssrInterpolate(formatearHora(r.hora_fin))}</p><div class="flex items-center gap-1.5 mt-1.5 flex-wrap" data-v-8cde2423><span class="inline-flex items-center gap-0.5 text-xs px-1.5 py-0.5 rounded bg-white/70 text-gray-600" data-v-8cde2423>`),"online"===r.modalidad?s('<span title="Online" data-v-8cde2423>üíª</span>'):"presencial"===r.modalidad?s('<span title="Presencial" data-v-8cde2423>üè•</span>'):s('<span title="Telef√≥nica" data-v-8cde2423>üìû</span>'),s(`<span class="hidden sm:inline" data-v-8cde2423>${t.ssrInterpolate(r.modalidad)}</span></span><span class="${t.ssrRenderClass([getBadgeEstado(r.estado),"text-[10px] px-1.5 py-0.5 rounded-full font-semibold"])}" data-v-8cde2423>${t.ssrInterpolate(getEstadoLabel(r.estado))}</span>`),r.bono_id?s(`<span class="text-[10px] px-1.5 py-0.5 rounded bg-emerald-100 text-emerald-700 font-medium"${t.ssrRenderAttr("title",`Bono: ${r.bono_sesiones_restantes||0}/${r.bono_sesiones_totales||0} sesiones`)} data-v-8cde2423> üé´ ${t.ssrInterpolate(r.bono_sesiones_restantes||0)}</span>`):s("\x3c!----\x3e"),s("</div>"),e.modoCoordinadora&&(r.terapeuta_nombre||r.terapeuta?.nombre_completo)?s(`<p class="text-[10px] text-gray-400 mt-1 truncate" data-v-8cde2423> üë§ ${t.ssrInterpolate(r.terapeuta_nombre||r.terapeuta?.nombre_completo)}</p>`):s("\x3c!----\x3e"),s("</div></div>")}),s("\x3c!--]--\x3e</div>")}),s("\x3c!--]--\x3e</div>")}),s("\x3c!--]--\x3e</div></div></div></div>")):(s('<div data-v-8cde2423><div class="flex flex-wrap gap-2 mb-6" data-v-8cde2423>\x3c!--[--\x3e'),t.ssrRenderList([{key:"hoy",label:"Hoy",count:V.value.filter(e=>e.fecha_cita===(new Date).toISOString().split("T")[0]).length},{key:"pendientes",label:"Pendientes",count:V.value.filter(e=>"pendiente"===e.estado).length},{key:"completadas",label:"Completadas",count:V.value.filter(e=>"completada"===e.estado||"realizada"===e.estado).length},{key:"todas",label:"Todas",count:V.value.length}],e=>{s(`<button class="${t.ssrRenderClass(["px-4 py-2 rounded-lg font-medium transition-colors",h.value===e.key?"bg-blue-600 text-white":"bg-white text-gray-700 hover:bg-gray-50 border border-gray-300"])}" data-v-8cde2423>${t.ssrInterpolate(e.label)} (${t.ssrInterpolate(e.count)}) </button>`)}),s("\x3c!--]--\x3e</div>"),a.unref(u)?s(`<div class="bg-red-50 border-l-4 border-red-400 p-4 mb-6" data-v-8cde2423><p class="text-red-700" data-v-8cde2423>${t.ssrInterpolate(a.unref(u))}</p></div>`):s("\x3c!----\x3e"),a.unref(c)&&0===a.unref(i).length?s('<div class="text-center py-12" data-v-8cde2423><div class="animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4" data-v-8cde2423></div><p class="text-gray-600" data-v-8cde2423>Cargando citas...</p></div>'):0===K.value.length?s(`<div class="text-center py-12 bg-gray-50 rounded-lg" data-v-8cde2423><svg class="mx-auto h-12 w-12 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor" data-v-8cde2423><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" data-v-8cde2423></path></svg><h3 class="mt-2 text-sm font-medium text-gray-900" data-v-8cde2423>No hay citas</h3><p class="mt-1 text-sm text-gray-500" data-v-8cde2423>${t.ssrInterpolate("hoy"===h.value?"No tienes citas programadas para hoy.":"No hay citas en esta categor√≠a.")}</p></div>`):(s('<div class="space-y-4" data-v-8cde2423>\x3c!--[--\x3e'),t.ssrRenderList(K.value,e=>{s(t.ssrRenderComponent(b,{key:e.id,cita:e,onCompletar:handleCompletarCita,onVerHistorial:abrirHistorial},null,d))}),s("\x3c!--]--\x3e</div>")),s("</div>")),t.ssrRenderTeleport(s,e=>{var a;_.value?(e('<div class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4" data-v-8cde2423><div class="bg-white rounded-lg shadow-xl max-w-3xl w-full max-h-[90vh] overflow-hidden" data-v-8cde2423><div class="px-6 py-4 border-b border-gray-200 flex items-center justify-between" data-v-8cde2423><h2 class="text-xl font-bold text-gray-900" data-v-8cde2423>Historial del Bono</h2><button class="text-gray-400 hover:text-gray-600 transition-colors" data-v-8cde2423><svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" data-v-8cde2423><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" data-v-8cde2423></path></svg></button></div><div class="px-6 py-4 overflow-y-auto max-h-[calc(90vh-140px)]" data-v-8cde2423>'),I.value?e('<div class="text-center py-8" data-v-8cde2423><div class="animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto" data-v-8cde2423></div></div>'):(e("<div data-v-8cde2423>"),R.value?(e(`<div class="mb-6 p-4 bg-blue-50 rounded-lg" data-v-8cde2423><h3 class="font-semibold text-gray-900 mb-3" data-v-8cde2423>Resumen</h3><div class="grid grid-cols-3 gap-4 text-center" data-v-8cde2423><div data-v-8cde2423><p class="text-2xl font-bold text-blue-600" data-v-8cde2423>${t.ssrInterpolate(R.value.bono.sesiones_totales)}</p><p class="text-xs text-gray-600" data-v-8cde2423>Sesiones Totales</p></div><div data-v-8cde2423><p class="text-2xl font-bold text-green-600" data-v-8cde2423>${t.ssrInterpolate(R.value.bono.sesiones_usadas)}</p><p class="text-xs text-gray-600" data-v-8cde2423>Sesiones Usadas</p></div><div data-v-8cde2423><p class="${t.ssrRenderClass(["text-2xl font-bold",(a=R.value.bono.sesiones_restantes,0===a?"text-red-600 font-bold":1===a?"text-orange-600 font-semibold":a<=2?"text-yellow-600 font-medium":"text-green-600")])}" data-v-8cde2423>${t.ssrInterpolate(R.value.bono.sesiones_restantes)}</p><p class="text-xs text-gray-600" data-v-8cde2423>Sesiones Restantes</p></div></div>`),R.value.alerta?e(`<div class="mt-3 p-2 bg-yellow-100 border border-yellow-300 rounded text-sm text-yellow-800" data-v-8cde2423>${t.ssrInterpolate(R.value.mensaje_alerta)}</div>`):e("\x3c!----\x3e"),e("</div>")):e("\x3c!----\x3e"),e('<div data-v-8cde2423><h3 class="font-semibold text-gray-900 mb-3" data-v-8cde2423>Movimientos</h3>'),0===k.value.length?e('<div class="text-center py-8 text-gray-500" data-v-8cde2423> No hay movimientos registrados </div>'):(e('<div class="space-y-3" data-v-8cde2423>\x3c!--[--\x3e'),t.ssrRenderList(k.value,a=>{e(`<div class="border border-gray-200 rounded-lg p-4 hover:bg-gray-50 transition-colors" data-v-8cde2423><div class="flex items-start justify-between" data-v-8cde2423><div class="flex-1" data-v-8cde2423><div class="flex items-center gap-2 mb-1" data-v-8cde2423><span class="${t.ssrRenderClass(["px-2 py-1 text-xs font-medium rounded","descuento"===a.tipo_movimiento?"bg-red-100 text-red-700":"reembolso"===a.tipo_movimiento?"bg-green-100 text-green-700":"bg-gray-100 text-gray-700"])}" data-v-8cde2423>${t.ssrInterpolate(a.tipo_movimiento)}</span><span class="text-xs text-gray-500" data-v-8cde2423>${t.ssrInterpolate(new Date(a.fecha).toLocaleString("es-ES"))}</span></div><p class="text-sm text-gray-700" data-v-8cde2423>${t.ssrInterpolate(a.motivo)}</p></div><div class="text-right ml-4" data-v-8cde2423><p class="text-sm font-semibold text-gray-900" data-v-8cde2423>${t.ssrInterpolate(a.sesiones_antes)} ‚Üí ${t.ssrInterpolate(a.sesiones_despues)}</p><p class="${t.ssrRenderClass(["text-xs font-medium",a.sesiones_modificadas>0?"text-red-600":"text-green-600"])}" data-v-8cde2423>${t.ssrInterpolate(a.sesiones_modificadas>0?"-":"+")}${t.ssrInterpolate(Math.abs(a.sesiones_modificadas))}</p></div></div></div>`)}),e("\x3c!--]--\x3e</div>")),e("</div></div>")),e('</div><div class="px-6 py-4 border-t border-gray-200 flex justify-end" data-v-8cde2423><button class="px-4 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300 transition-colors" data-v-8cde2423> Cerrar </button></div></div></div>')):e("\x3c!----\x3e")},"body",!1,d),s(t.ssrRenderComponent(m,{"is-open":O.value,"fecha-inicial":N.value||void 0,"hora-inicial":F.value||void 0,"hora-final":q.value||void 0,onCreated:handleCitaCreated,onClose:handleModalCerrar},null,d)),s(t.ssrRenderComponent(g,{"cita-id":Y.value,onClose:handleCerrarDetallesCita,onCitaActualizada:handleCitaActualizada,onActualizado:handleCitaActualizada},null,d)),t.ssrRenderTeleport(s,e=>{var a;ee.value&&ae.value?(e(`<div class="fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4" data-v-8cde2423><div class="bg-white rounded-2xl shadow-2xl max-w-md w-full overflow-hidden" data-v-8cde2423><div class="px-6 py-4 border-b border-gray-100 bg-gradient-to-r from-blue-50 to-indigo-50" data-v-8cde2423><div class="flex items-center justify-between" data-v-8cde2423><div data-v-8cde2423><h2 class="text-lg font-semibold text-gray-900" data-v-8cde2423>Reprogramar Cita</h2><p class="text-sm text-gray-500 mt-0.5" data-v-8cde2423>${t.ssrInterpolate(ae.value.paciente_nombre||ae.value.paciente?.nombre_completo||"Paciente")}</p></div><button class="w-8 h-8 rounded-full bg-white/80 flex items-center justify-center text-gray-400 hover:text-gray-600 hover:bg-white transition-all" data-v-8cde2423><svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-8cde2423><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" data-v-8cde2423></path></svg></button></div></div><div class="p-6 space-y-5" data-v-8cde2423><div class="bg-gray-50 rounded-xl p-4" data-v-8cde2423><p class="text-xs font-medium text-gray-500 uppercase tracking-wider mb-2" data-v-8cde2423>Cita actual</p><div class="flex items-center gap-3" data-v-8cde2423><div class="w-10 h-10 rounded-lg bg-blue-100 flex items-center justify-center" data-v-8cde2423><svg class="w-5 h-5 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-8cde2423><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" data-v-8cde2423></path></svg></div><div data-v-8cde2423><p class="font-medium text-gray-900" data-v-8cde2423>${t.ssrInterpolate((a=ae.value.fecha_cita,new Date(a+"T00:00:00").toLocaleDateString("es-ES",{weekday:"long",day:"numeric",month:"long",year:"numeric"})))}</p><p class="text-sm text-gray-500" data-v-8cde2423>${t.ssrInterpolate(formatearHora(ae.value.hora_inicio))} - ${t.ssrInterpolate(formatearHora(ae.value.hora_fin))}</p></div></div></div><div data-v-8cde2423><label class="block text-sm font-medium text-gray-700 mb-2" data-v-8cde2423>Nueva fecha</label><input type="date"${t.ssrRenderAttr("value",te.value)}${t.ssrRenderAttr("min",(new Date).toISOString().split("T")[0])} class="w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500/30 focus:border-blue-500 transition-all" data-v-8cde2423></div><div class="grid grid-cols-2 gap-4" data-v-8cde2423><div data-v-8cde2423><label class="block text-sm font-medium text-gray-700 mb-2" data-v-8cde2423>Hora inicio</label><select class="w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500/30 focus:border-blue-500 transition-all" data-v-8cde2423>\x3c!--[--\x3e`),t.ssrRenderList(X,a=>{e(`<option${t.ssrRenderAttr("value",a)} data-v-8cde2423${t.ssrIncludeBooleanAttr(Array.isArray(re.value)?t.ssrLooseContain(re.value,a):t.ssrLooseEqual(re.value,a))?" selected":""}>${t.ssrInterpolate(a)}</option>`)}),e('\x3c!--]--\x3e</select></div><div data-v-8cde2423><label class="block text-sm font-medium text-gray-700 mb-2" data-v-8cde2423>Hora fin</label><select class="w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500/30 focus:border-blue-500 transition-all" data-v-8cde2423>\x3c!--[--\x3e'),t.ssrRenderList(oe.value,a=>{e(`<option${t.ssrRenderAttr("value",a)} data-v-8cde2423${t.ssrIncludeBooleanAttr(Array.isArray(se.value)?t.ssrLooseContain(se.value,a):t.ssrLooseEqual(se.value,a))?" selected":""}>${t.ssrInterpolate(a)}</option>`)}),e(`\x3c!--]--\x3e</select></div></div></div><div class="px-6 py-4 border-t border-gray-100 bg-gray-50 flex items-center justify-end gap-3" data-v-8cde2423><button class="px-5 py-2.5 text-gray-700 font-medium rounded-xl hover:bg-gray-100 transition-colors" data-v-8cde2423> Cancelar </button><button${t.ssrIncludeBooleanAttr(!te.value||!re.value||!se.value||J.value)?" disabled":""} class="px-5 py-2.5 bg-blue-600 text-white font-medium rounded-xl hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center gap-2" data-v-8cde2423>`),J.value?e('<svg class="w-4 h-4 animate-spin" fill="none" viewBox="0 0 24 24" data-v-8cde2423><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4" data-v-8cde2423></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z" data-v-8cde2423></path></svg>'):e("\x3c!----\x3e"),e(` ${t.ssrInterpolate(J.value?"Reprogramando...":"Confirmar")}</button></div></div></div>`)):e("\x3c!----\x3e")},"body",!1,d),s("</div>")}}}),T=E.setup;E.setup=(e,t)=>{const r=a.useSSRContext();return(r.modules||(r.modules=new Set)).add("components/AgendaTerapeuta.vue"),T?T(e,t):void 0};const H=Object.assign(r(E,[["__scopeId","data-v-8cde2423"]]),{__name:"AgendaTerapeuta"});export{w as A,x as C,H as _,agregarDias as a,C as b,formatearDiaSemana as f,generarBloquesHorarios as g,inicioSemana as i,render as r,useAgenda as u};
//# sourceMappingURL=AgendaTerapeuta-ryhLBHQZ.mjs.map
