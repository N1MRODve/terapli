import{v as e,e as t,s as r,_ as o}from"./server.mjs";import{u as s}from"./useSupabaseClient-DykwVqLQ.mjs";import{u as n}from"./useSupabase-DfFg84CY.mjs";import"../routes/renderer.mjs";import"../nitro/nitro.mjs";import"node:http";import"node:https";import"node:events";import"node:buffer";import"node:fs";import"node:path";import"node:crypto";import"../_/shared.cjs.prod.mjs";import"../virtual/_commonjsHelpers.mjs";import"node:stream";import"../_/index2.mjs";import"@supabase/supabase-js";import"@vercel/analytics/nuxt";const a=e.defineComponent({__name:"mensajes",__ssrInlineRender:!0,setup(a){const l=s();t();const{getUserId:i}=n(),d=e.ref([]),c=e.ref(null),u=e.ref(""),obtenerIniciales=e=>e.split(" ").map(e=>e[0]).join("").toUpperCase().substring(0,2),enviarMensajeInterno=async()=>{if(u.value.trim()&&c.value)try{const e=i();if(!e)return void alert("❌ No estás autenticado");const{error:t}=await l.from("mensajes").insert({remitente_id:e,destinatario_id:c.value.id,mensaje:u.value,visto:!1});if(t)throw t;alert("✅ Mensaje enviado exitosamente"),u.value=""}catch(e){console.error("Error:",e),alert("❌ Error al enviar mensaje")}},abrirWhatsApp=()=>{if(!u.value.trim()||!c.value.telefono)return;const e=c.value.telefono.replace(/\D/g,""),t=encodeURIComponent(u.value);(void 0).open(`https://wa.me/${e}?text=${t}`,"_blank")};return(t,s,n,a)=>{const l=o,i=e.resolveComponent("Icon");s(`<div${r.ssrRenderAttrs(a)}>`),s(r.ssrRenderComponent(l,{name:"coordinacion"},{default:e.withCtx((t,o,s,n)=>{if(!o)return[e.createVNode("div",{class:"mb-8"},[e.createVNode("h1",{class:"text-3xl font-lora font-bold text-[#5D4A44] mb-2"}," Mensajería "),e.createVNode("p",{class:"text-[#8B7470]"}," Comunicación con pacientes y terapeutas ")]),e.createVNode("div",{class:"bg-white rounded-xl shadow-md border border-[#E8DFD8] p-6 mb-6"},[e.createVNode("label",{class:"block text-sm font-medium text-[#5D4A44] mb-3"}," Seleccionar paciente "),e.withDirectives(e.createVNode("select",{"onUpdate:modelValue":t=>e.isRef(c)?c.value=t:null,class:"w-full px-4 py-3 border border-[#E8DFD8] rounded-lg focus:ring-2 focus:ring-[#D8AFA0] focus:border-transparent"},[e.createVNode("option",{value:""},"-- Selecciona un paciente --"),(e.openBlock(!0),e.createBlock(e.Fragment,null,e.renderList(e.unref(d),t=>(e.openBlock(),e.createBlock("option",{key:t.id,value:t},e.toDisplayString(t.nombre),9,["value"]))),128))],8,["onUpdate:modelValue"]),[[e.vModelSelect,e.unref(c)]])]),e.unref(c)?(e.openBlock(),e.createBlock("div",{key:0,class:"bg-white rounded-xl shadow-md border border-[#E8DFD8] p-6"},[e.createVNode("div",{class:"mb-4 flex items-center space-x-3"},[e.createVNode("div",{class:"w-12 h-12 rounded-full bg-gradient-to-br from-[#D8AFA0] to-[#C49484] flex items-center justify-center"},[e.createVNode("span",{class:"text-white font-semibold"},e.toDisplayString(obtenerIniciales(e.unref(c).nombre)),1)]),e.createVNode("div",null,[e.createVNode("p",{class:"font-semibold text-[#5D4A44]"},e.toDisplayString(e.unref(c).nombre),1),e.createVNode("p",{class:"text-sm text-[#8B7470]"},e.toDisplayString(e.unref(c).telefono),1)])]),e.withDirectives(e.createVNode("textarea",{"onUpdate:modelValue":t=>e.isRef(u)?u.value=t:null,placeholder:"Escribe tu mensaje aquí...",rows:"5",class:"w-full px-4 py-3 border border-[#E8DFD8] rounded-lg focus:ring-2 focus:ring-[#D8AFA0] focus:border-transparent resize-none mb-4"},null,8,["onUpdate:modelValue"]),[[e.vModelText,e.unref(u)]]),e.createVNode("div",{class:"flex space-x-3"},[e.createVNode("button",{onClick:enviarMensajeInterno,disabled:!e.unref(u).trim(),class:"flex-1 px-6 py-3 bg-[#D8AFA0] text-white rounded-lg hover:bg-[#C49484] transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center space-x-2"},[e.createVNode(i,{name:"heroicons:paper-airplane",class:"w-5 h-5"}),e.createVNode("span",null,"Enviar mensaje interno")],8,["disabled"]),e.createVNode("button",{onClick:abrirWhatsApp,disabled:!e.unref(u).trim(),class:"flex-1 px-6 py-3 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center space-x-2"},[e.createVNode(i,{name:"heroicons:chat-bubble-oval-left-ellipsis",class:"w-5 h-5"}),e.createVNode("span",null,"Abrir WhatsApp")],8,["disabled"])])])):(e.openBlock(),e.createBlock("div",{key:1,class:"bg-white rounded-xl shadow-md border border-[#E8DFD8] p-12 text-center"},[e.createVNode(i,{name:"heroicons:chat-bubble-left-right",class:"w-20 h-20 mx-auto text-[#D8AFA0] opacity-30 mb-4"}),e.createVNode("p",{class:"text-[#8B7470]"},"Selecciona un paciente para comenzar")]))];o(`<div class="mb-8"${n}><h1 class="text-3xl font-lora font-bold text-[#5D4A44] mb-2"${n}> Mensajería </h1><p class="text-[#8B7470]"${n}> Comunicación con pacientes y terapeutas </p></div><div class="bg-white rounded-xl shadow-md border border-[#E8DFD8] p-6 mb-6"${n}><label class="block text-sm font-medium text-[#5D4A44] mb-3"${n}> Seleccionar paciente </label><select class="w-full px-4 py-3 border border-[#E8DFD8] rounded-lg focus:ring-2 focus:ring-[#D8AFA0] focus:border-transparent"${n}><option value=""${r.ssrIncludeBooleanAttr(Array.isArray(e.unref(c))?r.ssrLooseContain(e.unref(c),""):r.ssrLooseEqual(e.unref(c),""))?" selected":""}${n}>-- Selecciona un paciente --</option>\x3c!--[--\x3e`),r.ssrRenderList(e.unref(d),t=>{o(`<option${r.ssrRenderAttr("value",t)}${r.ssrIncludeBooleanAttr(Array.isArray(e.unref(c))?r.ssrLooseContain(e.unref(c),t):r.ssrLooseEqual(e.unref(c),t))?" selected":""}${n}>${r.ssrInterpolate(t.nombre)}</option>`)}),o("\x3c!--]--\x3e</select></div>"),e.unref(c)?(o(`<div class="bg-white rounded-xl shadow-md border border-[#E8DFD8] p-6"${n}><div class="mb-4 flex items-center space-x-3"${n}><div class="w-12 h-12 rounded-full bg-gradient-to-br from-[#D8AFA0] to-[#C49484] flex items-center justify-center"${n}><span class="text-white font-semibold"${n}>${r.ssrInterpolate(obtenerIniciales(e.unref(c).nombre))}</span></div><div${n}><p class="font-semibold text-[#5D4A44]"${n}>${r.ssrInterpolate(e.unref(c).nombre)}</p><p class="text-sm text-[#8B7470]"${n}>${r.ssrInterpolate(e.unref(c).telefono)}</p></div></div><textarea placeholder="Escribe tu mensaje aquí..." rows="5" class="w-full px-4 py-3 border border-[#E8DFD8] rounded-lg focus:ring-2 focus:ring-[#D8AFA0] focus:border-transparent resize-none mb-4"${n}>${r.ssrInterpolate(e.unref(u))}</textarea><div class="flex space-x-3"${n}><button${r.ssrIncludeBooleanAttr(!e.unref(u).trim())?" disabled":""} class="flex-1 px-6 py-3 bg-[#D8AFA0] text-white rounded-lg hover:bg-[#C49484] transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center space-x-2"${n}>`),o(r.ssrRenderComponent(i,{name:"heroicons:paper-airplane",class:"w-5 h-5"},null,s,n)),o(`<span${n}>Enviar mensaje interno</span></button><button${r.ssrIncludeBooleanAttr(!e.unref(u).trim())?" disabled":""} class="flex-1 px-6 py-3 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center space-x-2"${n}>`),o(r.ssrRenderComponent(i,{name:"heroicons:chat-bubble-oval-left-ellipsis",class:"w-5 h-5"},null,s,n)),o(`<span${n}>Abrir WhatsApp</span></button></div></div>`)):(o(`<div class="bg-white rounded-xl shadow-md border border-[#E8DFD8] p-12 text-center"${n}>`),o(r.ssrRenderComponent(i,{name:"heroicons:chat-bubble-left-right",class:"w-20 h-20 mx-auto text-[#D8AFA0] opacity-30 mb-4"},null,s,n)),o(`<p class="text-[#8B7470]"${n}>Selecciona un paciente para comenzar</p></div>`))}),_:1},n)),s("</div>")}}}),l=a.setup;a.setup=(t,r)=>{const o=e.useSSRContext();return(o.modules||(o.modules=new Set)).add("pages/coordinacion/mensajes.vue"),l?l(t,r):void 0};export{a as default};
//# sourceMappingURL=mensajes-CyotNPXY.mjs.map
