import{v as e,s as t}from"./server.mjs";import{u as a,a as o}from"./useBonos-I7-Zi1mD.mjs";import{_ as s}from"./_plugin-vue_export-helper-1tPrXgE0.mjs";import{_ as r}from"./ModalNuevoBono-C-simKwt.mjs";import{u as n}from"./useSupabaseClient-DykwVqLQ.mjs";import{u as d}from"./useSupabase-COsu_foS.mjs";import"../routes/renderer.mjs";import"../nitro/nitro.mjs";import"node:http";import"node:https";import"node:events";import"node:buffer";import"node:fs";import"node:path";import"node:crypto";import"../_/shared.cjs.prod.mjs";import"../virtual/_commonjsHelpers.mjs";import"node:stream";import"../_/index2.mjs";import"@supabase/supabase-js";import"@vercel/analytics/nuxt";const l={__name:"DashboardCard",__ssrInlineRender:!0,props:{customClass:{type:String,default:""}},setup:a=>(o,s,r,n)=>{s(`<div${t.ssrRenderAttrs(e.mergeProps({class:["bg-white rounded-xl p-6 shadow-sm hover:shadow-md transition-shadow duration-300",a.customClass]},n))}>`),t.ssrRenderSlot(o.$slots,"default",{},null,s,r),s("</div>")}},i=l.setup;l.setup=(t,a)=>{const o=e.useSSRContext();return(o.modules||(o.modules=new Set)).add("components/dashboard/DashboardCard.vue"),i?i(t,a):void 0};const c=e.defineComponent({__name:"BonoCard",__ssrInlineRender:!0,props:{bono:{}},emits:["renovar","verPagos","editar"],setup(s){const r=s,{getEstadoColor:n,getEstadoTexto:d,calcularPorcentajeUso:l,puedeGestionarBonos:i,puedeConfirmarPagos:c}=a(),{isCoordinadora:u}=o(),p=e.computed(()=>({quincenal:"Quincenal",mensual:"Mensual",semestral:"Semestral"}[r.bono.tipo]||r.bono.tipo||"EstÃ¡ndar")),v=e.computed(()=>n(r.bono.estado)),b=e.computed(()=>d(r.bono.estado)),m=e.computed(()=>({pendiente:"â³",activo:"âœ…",completado:"âœ”ï¸",vencido:"âŒ",cancelado:"ğŸš«"}[r.bono.estado]||"ğŸ“‹")),f=e.computed(()=>({pendiente:"border-yellow-300",activo:"border-green-300",completado:"border-gray-300",vencido:"border-red-300",cancelado:"border-gray-400"}[r.bono.estado]||"border-gray-300")),x=e.computed(()=>r.bono.sesiones_restantes??0),g=e.computed(()=>(r.bono.sesiones_totales||0)-x.value),h=e.computed(()=>l(r.bono)),y=e.computed(()=>{const e=h.value;return e>=90?"bg-red-500":e>=70?"bg-orange-500":e>=50?"bg-yellow-500":"bg-gradient-to-r from-[#5550F2] to-[#ECC8BA]"}),w=e.computed(()=>{if(!r.bono.fecha_fin)return null;const e=new Date,t=new Date(r.bono.fecha_fin);return Math.ceil((t.getTime()-e.getTime())/864e5)}),A=e.computed(()=>"activo"===r.bono.estado&&null!==w.value&&(w.value>=0&&w.value<=7)),$=e.computed(()=>"activo"===r.bono.estado&&x.value>0&&x.value<=2),D=e.computed(()=>i.value||c.value),C=e.computed(()=>i.value),I=e.computed(()=>u.value),formatearFecha=e=>{if(!e)return"";try{return new Date(e+"T00:00:00").toLocaleDateString("es-ES",{day:"numeric",month:"short",year:"numeric"})}catch{return e}};return(a,o,r,n)=>{var d;o(`<div${t.ssrRenderAttrs(e.mergeProps({class:["group bono-card bg-white/90 backdrop-blur-md border-2 rounded-2xl p-6 hover:shadow-xl transition-all duration-500 relative overflow-hidden hover:bg-white/95 hover:scale-[1.02]",[e.unref(f),{"opacity-60":"cancelado"===s.bono.estado}]]},n))} data-v-22bd053c><div class="absolute inset-0 bg-gradient-to-br from-[#5550F2]/5 via-transparent to-[#04BF9D]/5 opacity-0 group-hover:opacity-100 transition-opacity duration-500" data-v-22bd053c></div><div class="absolute -top-20 -right-20 w-40 h-40 bg-gradient-to-br from-[#F2B33D]/10 to-[#5550F2]/10 rounded-full blur-2xl opacity-0 group-hover:opacity-60 transition-all duration-700" data-v-22bd053c></div><div class="relative flex items-start justify-between mb-6" data-v-22bd053c><div class="flex-1" data-v-22bd053c><div class="flex items-center gap-4 mb-3" data-v-22bd053c><div class="w-12 h-12 rounded-xl bg-gradient-to-br from-[#5550F2] to-[#027368] shadow-lg flex items-center justify-center group-hover:scale-110 transition-transform duration-300" data-v-22bd053c><span class="text-xl" data-v-22bd053c>ğŸ«</span></div><h3 class="font-[&#39;Elms_Sans&#39;] text-xl font-bold bg-gradient-to-r from-[#5550F2] to-[#027368] bg-clip-text text-transparent" data-v-22bd053c> Bono ${t.ssrInterpolate(e.unref(p))}</h3></div><div class="flex items-center gap-3 flex-wrap" data-v-22bd053c><span class="${t.ssrRenderClass([e.unref(v),"inline-flex items-center px-4 py-2 rounded-xl text-xs font-sans font-semibold border backdrop-blur-sm shadow-sm"])}" data-v-22bd053c>${t.ssrInterpolate(e.unref(m))} ${t.ssrInterpolate(e.unref(b))}</span>`),e.unref(A)?o('<span class="inline-flex items-center px-3 py-1.5 rounded-xl text-xs font-sans font-semibold bg-gradient-to-r from-[#F2B33D]/20 to-[#F2B33D]/10 text-[#F2B33D] border border-[#F2B33D]/30 backdrop-blur-sm shadow-sm" data-v-22bd053c> âš ï¸ Vence pronto </span>'):o("\x3c!----\x3e"),e.unref($)?o('<span class="inline-flex items-center px-3 py-1.5 rounded-xl text-xs font-sans font-semibold bg-gradient-to-r from-[#04BF9D]/20 to-[#027368]/10 text-[#027368] border border-[#04BF9D]/30 backdrop-blur-sm shadow-sm" data-v-22bd053c> ğŸ“Š Pocas sesiones </span>'):o("\x3c!----\x3e"),o('</div></div><div class="flex gap-3" data-v-22bd053c>'),e.unref(D)?o('<button class="p-3 hover:bg-gradient-to-br from-[#5550F2]/10 to-[#027368]/10 rounded-xl transition-all duration-300 backdrop-blur-sm border border-white/50 hover:shadow-lg hover:scale-110 group/btn" title="Ver pagos" data-v-22bd053c><span class="text-lg group-hover/btn:scale-110 transition-transform duration-300" data-v-22bd053c>ğŸ’°</span></button>'):o("\x3c!----\x3e"),e.unref(C)?o('<button class="p-3 hover:bg-gradient-to-br from-[#04BF9D]/10 to-[#F2B33D]/10 rounded-xl transition-all duration-300 backdrop-blur-sm border border-white/50 hover:shadow-lg hover:scale-110 group/btn" title="Renovar bono" data-v-22bd053c><span class="text-lg group-hover/btn:scale-110 transition-transform duration-300" data-v-22bd053c>ğŸ”„</span></button>'):o("\x3c!----\x3e"),o(`</div></div><div class="relative mb-6" data-v-22bd053c><div class="flex items-center justify-between mb-3" data-v-22bd053c><span class="text-sm font-sans text-gray-600 font-medium" data-v-22bd053c>Sesiones</span><span class="text-sm font-sans font-semibold bg-gradient-to-r from-[#5550F2] to-[#027368] bg-clip-text text-transparent" data-v-22bd053c>${t.ssrInterpolate(e.unref(x))} / ${t.ssrInterpolate(s.bono.sesiones_totales)} disponibles </span></div><div class="relative w-full bg-gradient-to-r from-gray-100 to-gray-50 rounded-full h-4 overflow-hidden shadow-inner" data-v-22bd053c><div class="${t.ssrRenderClass([e.unref(y),"h-4 rounded-full transition-all duration-700 ease-out shadow-lg relative overflow-hidden"])}" style="${t.ssrRenderStyle({width:e.unref(h)+"%"})}" data-v-22bd053c><div class="absolute inset-0 bg-gradient-to-r from-white/30 to-transparent" data-v-22bd053c></div><div class="absolute inset-0 bg-gradient-to-r from-transparent via-white/20 to-transparent animate-pulse" data-v-22bd053c></div></div></div><div class="flex justify-between mt-2 text-xs font-sans text-gray-600" data-v-22bd053c><span data-v-22bd053c>${t.ssrInterpolate(e.unref(g))} usadas</span><span class="font-semibold" data-v-22bd053c>${t.ssrInterpolate(e.unref(h))}% completado</span></div></div><div class="relative grid grid-cols-2 gap-4 mb-6" data-v-22bd053c><div class="p-4 bg-white/70 backdrop-blur-sm rounded-xl border border-white/50 shadow-sm group-hover:shadow-md transition-all duration-300" data-v-22bd053c><div class="text-xs font-sans text-gray-500 uppercase tracking-wider mb-2" data-v-22bd053c>Tipo</div><div class="text-sm font-sans font-semibold text-gray-800 capitalize" data-v-22bd053c>${t.ssrInterpolate(s.bono.tipo||"EstÃ¡ndar")}</div></div><div class="p-4 bg-white/70 backdrop-blur-sm rounded-xl border border-white/50 shadow-sm group-hover:shadow-md transition-all duration-300" data-v-22bd053c><div class="text-xs font-sans text-gray-500 uppercase tracking-wider mb-2" data-v-22bd053c>Frecuencia</div><div class="text-sm font-sans font-semibold text-gray-800 capitalize" data-v-22bd053c>${t.ssrInterpolate(s.bono.frecuencia||"Semanal")}</div></div><div class="p-3 bg-white rounded-lg border border-[#5550F2]/20" data-v-22bd053c><div class="text-xs text-[#2D3748]/60 mb-1" data-v-22bd053c>Monto</div><div class="text-sm font-medium text-[#2D3748]" data-v-22bd053c>${t.ssrInterpolate((d=s.bono.monto,d?new Intl.NumberFormat("es-ES",{style:"currency",currency:"EUR"}).format(d):"$ 0"))}</div></div><div class="p-3 bg-white rounded-lg border border-[#5550F2]/20" data-v-22bd053c><div class="text-xs text-[#2D3748]/60 mb-1" data-v-22bd053c>Pago</div><div class="${t.ssrRenderClass([s.bono.pagado?"text-green-600":"text-orange-600","text-sm font-medium flex items-center gap-1"])}" data-v-22bd053c>${t.ssrInterpolate(s.bono.pagado?"âœ“ Pagado":"â³ Pendiente")}</div></div></div>`),s.bono.fecha_inicio||s.bono.fecha_fin?(o('<div class="mb-4 p-3 bg-gradient-to-r from-[#5550F2]/10 to-[#ECC8BA]/10 rounded-lg" data-v-22bd053c><div class="flex items-center justify-between text-sm" data-v-22bd053c>'),s.bono.fecha_inicio?o(`<div data-v-22bd053c><span class="text-[#2D3748]/60" data-v-22bd053c>Inicio:</span><span class="font-medium text-[#2D3748] ml-1" data-v-22bd053c>${t.ssrInterpolate(formatearFecha(s.bono.fecha_inicio))}</span></div>`):o("\x3c!----\x3e"),s.bono.fecha_fin?o(`<div data-v-22bd053c><span class="text-[#2D3748]/60" data-v-22bd053c>Vence:</span><span class="${t.ssrRenderClass([e.unref(A)?"text-orange-600":"text-[#2D3748]","font-medium ml-1"])}" data-v-22bd053c>${t.ssrInterpolate(formatearFecha(s.bono.fecha_fin))}</span></div>`):o("\x3c!----\x3e"),o("</div>"),null!==e.unref(w)&&"activo"===s.bono.estado?o(`<div class="mt-2 text-xs text-center text-[#2D3748]/60" data-v-22bd053c>${t.ssrInterpolate(e.unref(w)>0?`${e.unref(w)} dÃ­as restantes`:"Vencido")}</div>`):o("\x3c!----\x3e"),o("</div>")):o("\x3c!----\x3e"),s.bono.renovacion_automatica?o('<div class="flex items-center gap-2 mb-4 p-2 bg-purple-50 border border-purple-200 rounded-lg" data-v-22bd053c><span class="text-sm" data-v-22bd053c>ğŸ”„</span><span class="text-xs text-purple-700 font-medium" data-v-22bd053c>RenovaciÃ³n automÃ¡tica activada</span></div>'):o("\x3c!----\x3e"),s.bono.notas?o(`<div class="mb-4" data-v-22bd053c><div class="text-xs text-[#2D3748]/60 mb-1" data-v-22bd053c>Notas</div><div class="text-sm text-[#2D3748]/80 p-2 bg-white rounded-lg border border-[#5550F2]/20" data-v-22bd053c>${t.ssrInterpolate(s.bono.notas)}</div></div>`):o("\x3c!----\x3e"),o('<div class="flex gap-2 pt-3 border-t border-[#5550F2]/20" data-v-22bd053c>'),e.unref(D)?o('<button class="flex-1 px-4 py-2 bg-[#5550F2] text-white rounded-lg hover:bg-[#C89B8A] transition-colors text-sm font-medium flex items-center justify-center gap-2" data-v-22bd053c><span data-v-22bd053c>ğŸ’°</span><span data-v-22bd053c>Ver Pagos</span></button>'):o("\x3c!----\x3e"),e.unref(C)&&"activo"!==s.bono.estado?o('<button class="flex-1 px-4 py-2 bg-purple-500 text-white rounded-lg hover:bg-purple-600 transition-colors text-sm font-medium flex items-center justify-center gap-2" data-v-22bd053c><span data-v-22bd053c>ğŸ”„</span><span data-v-22bd053c>Renovar</span></button>'):o("\x3c!----\x3e"),e.unref(I)?o('<button class="px-4 py-2 bg-white border border-[#5550F2]/30 text-[#2D3748] rounded-lg hover:bg-[#5550F2]/10 transition-colors text-sm font-medium" data-v-22bd053c> âœï¸ </button>'):o("\x3c!----\x3e"),o("</div></div>")}}}),u=c.setup;c.setup=(t,a)=>{const o=e.useSSRContext();return(o.modules||(o.modules=new Set)).add("components/BonoCard.vue"),u?u(t,a):void 0};const p=Object.assign(s(c,[["__scopeId","data-v-22bd053c"]]),{__name:"BonoCard"}),v=e.defineComponent({__name:"ModalPagosBono",__ssrInlineRender:!0,props:{mostrar:{type:Boolean},bono:{}},emits:["close","updated"],setup(o,{emit:s}){const r=o,{getPagosPorBono:n,puedeGestionarBonos:d,puedeConfirmarPagos:l}=a(),i=e.ref([]),c=e.ref(!1),u=e.ref(!1),p=e.ref(!1),v=e.ref(null),b=e.ref(""),m=e.ref(""),f=e.ref({monto:0,metodo:"",confirmado:!1}),x=e.computed(()=>[...i.value].sort((e,t)=>new Date(t.fecha_pago).getTime()-new Date(e.fecha_pago).getTime())),g=e.computed(()=>i.value.filter(e=>e.confirmado).reduce((e,t)=>e+(t.monto||0),0)),h=e.computed(()=>{const e=r.bono?.monto||0;return Math.max(0,e-g.value)}),y=e.computed(()=>{const e=r.bono?.monto||0;return 0===e?0:Math.round(g.value/e*100)}),formatearFecha=e=>{if(!e)return"";try{return new Date(e).toLocaleDateString("es-ES",{day:"numeric",month:"short",year:"numeric"})}catch{return e}},formatearMonto=e=>e?new Intl.NumberFormat("es-ES",{style:"currency",currency:"EUR"}).format(e):"â‚¬ 0.00";return e.watch(()=>r.mostrar,e=>{e&&(async()=>{if(r.bono?.id)try{c.value=!0,b.value="",i.value=await n(r.bono.id)}catch(e){console.error("[ModalPagosBono] Error al cargar pagos:",e),b.value="Error al cargar los pagos"}finally{c.value=!1}})()},{immediate:!0}),(a,s,r,n)=>{o.mostrar?(s(`<div${t.ssrRenderAttrs(e.mergeProps({class:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 p-4"},n))} data-v-5db71466><div class="bg-white/95 backdrop-blur-md rounded-3xl shadow-2xl border border-white/50 max-w-4xl w-full max-h-[90vh] overflow-hidden relative" data-v-5db71466><div class="absolute inset-0 bg-gradient-to-br from-[#5550F2]/5 via-transparent to-[#04BF9D]/5 pointer-events-none" data-v-5db71466></div><div class="absolute -top-20 -right-20 w-40 h-40 bg-gradient-to-br from-[#F2B33D]/20 to-[#5550F2]/20 rounded-full blur-2xl" data-v-5db71466></div><div class="relative max-h-[90vh] overflow-y-auto" data-v-5db71466><div class="sticky top-0 bg-white/90 backdrop-blur-md border-b border-gray-200/50 px-8 py-6 z-10" data-v-5db71466><div class="flex justify-between items-start" data-v-5db71466><div class="flex-1" data-v-5db71466><div class="flex items-center gap-4 mb-3" data-v-5db71466><div class="w-14 h-14 rounded-2xl bg-gradient-to-br from-[#5550F2] to-[#027368] shadow-lg flex items-center justify-center" data-v-5db71466><span class="text-2xl" data-v-5db71466>ğŸ’°</span></div><h2 class="text-3xl font-[&#39;Elms_Sans&#39;] font-bold bg-gradient-to-r from-[#5550F2] to-[#027368] bg-clip-text text-transparent" data-v-5db71466> Pagos del Bono </h2></div><p class="text-sm font-sans text-gray-600 ml-18" data-v-5db71466> Gestiona los pagos y confirma transacciones de forma segura </p></div><button class="p-3 text-gray-500 hover:text-[#5550F2] hover:bg-gradient-to-br from-[#5550F2]/10 to-[#027368]/10 rounded-2xl transition-all duration-300 backdrop-blur-sm border border-white/50 hover:shadow-lg" aria-label="Cerrar modal" data-v-5db71466><svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-5db71466><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" data-v-5db71466></path></svg></button></div>`),o.bono?s(`<div class="mt-6 p-6 bg-gradient-to-r from-[#5550F2]/5 via-[#027368]/5 to-[#04BF9D]/5 backdrop-blur-sm rounded-2xl border border-white/50 shadow-lg" data-v-5db71466><div class="grid grid-cols-3 gap-6 text-sm" data-v-5db71466><div class="text-center" data-v-5db71466><div class="text-xs font-sans text-gray-500 uppercase tracking-wider mb-2" data-v-5db71466>Tipo</div><div class="font-sans font-semibold text-gray-800 capitalize text-lg" data-v-5db71466>${t.ssrInterpolate(o.bono.tipo)}</div></div><div class="text-center" data-v-5db71466><div class="text-xs font-sans text-gray-500 uppercase tracking-wider mb-2" data-v-5db71466>Monto Total</div><div class="font-[&#39;Elms_Sans&#39;] font-bold bg-gradient-to-r from-[#F2B33D] to-[#5550F2] bg-clip-text text-transparent text-2xl" data-v-5db71466>${t.ssrInterpolate(formatearMonto(o.bono.monto))}</div></div><div class="text-center" data-v-5db71466><div class="text-xs font-sans text-gray-500 uppercase tracking-wider mb-2" data-v-5db71466>Estado</div><div class="${t.ssrRenderClass([o.bono.pagado?"text-[#04BF9D]":"text-[#F2B33D]","font-sans font-semibold text-lg capitalize"])}" data-v-5db71466>${t.ssrInterpolate(o.bono.pagado?"âœ“ Pagado":"â³ Pendiente")}</div></div></div></div>`):s("\x3c!----\x3e"),s(`</div><div class="px-6 py-6 space-y-6" data-v-5db71466><div class="p-4 bg-white border-2 border-[#5550F2]/30 rounded-xl" data-v-5db71466><div class="grid grid-cols-3 gap-4 text-center" data-v-5db71466><div data-v-5db71466><div class="text-2xl font-bold text-green-600" data-v-5db71466>${t.ssrInterpolate(formatearMonto(e.unref(g)))}</div><div class="text-xs text-[#2D3748]/60 mt-1" data-v-5db71466>Total Pagado</div></div><div data-v-5db71466><div class="text-2xl font-bold text-orange-600" data-v-5db71466>${t.ssrInterpolate(formatearMonto(e.unref(h)))}</div><div class="text-xs text-[#2D3748]/60 mt-1" data-v-5db71466>Pendiente</div></div><div data-v-5db71466><div class="text-2xl font-bold text-[#2D3748]" data-v-5db71466>${t.ssrInterpolate(e.unref(i).length)}</div><div class="text-xs text-[#2D3748]/60 mt-1" data-v-5db71466>Transacciones</div></div></div><div class="mt-4" data-v-5db71466><div class="flex justify-between text-xs text-[#2D3748]/60 mb-1" data-v-5db71466><span data-v-5db71466>Progreso de pago</span><span data-v-5db71466>${t.ssrInterpolate(e.unref(y))}%</span></div><div class="w-full bg-gray-200 rounded-full h-2" data-v-5db71466><div class="${t.ssrRenderClass([e.unref(y)>=100?"bg-green-500":"bg-gradient-to-r from-[#5550F2] to-[#ECC8BA]","h-2 rounded-full transition-all duration-500"])}" style="${t.ssrRenderStyle({width:Math.min(e.unref(y),100)+"%"})}" data-v-5db71466></div></div></div></div>`),e.unref(d)?s(`<div class="flex justify-end" data-v-5db71466><button class="px-4 py-2 bg-[#5550F2] text-white rounded-lg hover:bg-[#C89B8A] transition-colors font-medium flex items-center gap-2" data-v-5db71466><span data-v-5db71466>${t.ssrInterpolate(e.unref(u)?"âœ•":"+")}</span><span data-v-5db71466>${t.ssrInterpolate(e.unref(u)?"Cancelar":"Registrar Pago")}</span></button></div>`):s("\x3c!----\x3e"),e.unref(u)?(s(`<div class="p-5 bg-green-50 border-2 border-green-300 rounded-xl" data-v-5db71466><h3 class="font-serif text-lg font-semibold text-[#2D3748] mb-4 flex items-center gap-2" data-v-5db71466><span data-v-5db71466>ğŸ’³</span> Registrar Nuevo Pago </h3><form class="space-y-4" data-v-5db71466><div class="grid grid-cols-2 gap-4" data-v-5db71466><div data-v-5db71466><label class="block text-sm font-medium text-[#2D3748] mb-2" data-v-5db71466> Monto <span class="text-red-500" data-v-5db71466>*</span></label><div class="relative" data-v-5db71466><span class="absolute left-3 top-1/2 -translate-y-1/2 text-[#2D3748]/60" data-v-5db71466>â‚¬</span><input${t.ssrRenderAttr("value",e.unref(f).monto)} type="number" min="0" step="0.01" required placeholder="0.00" class="w-full pl-8 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#5550F2] bg-white" data-v-5db71466></div></div><div data-v-5db71466><label class="block text-sm font-medium text-[#2D3748] mb-2" data-v-5db71466> MÃ©todo de Pago <span class="text-red-500" data-v-5db71466>*</span></label><select required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#5550F2] bg-white" data-v-5db71466><option value="" data-v-5db71466${t.ssrIncludeBooleanAttr(Array.isArray(e.unref(f).metodo)?t.ssrLooseContain(e.unref(f).metodo,""):t.ssrLooseEqual(e.unref(f).metodo,""))?" selected":""}>Seleccionar mÃ©todo</option><option value="efectivo" data-v-5db71466${t.ssrIncludeBooleanAttr(Array.isArray(e.unref(f).metodo)?t.ssrLooseContain(e.unref(f).metodo,"efectivo"):t.ssrLooseEqual(e.unref(f).metodo,"efectivo"))?" selected":""}>ğŸ’µ Efectivo</option><option value="transferencia" data-v-5db71466${t.ssrIncludeBooleanAttr(Array.isArray(e.unref(f).metodo)?t.ssrLooseContain(e.unref(f).metodo,"transferencia"):t.ssrLooseEqual(e.unref(f).metodo,"transferencia"))?" selected":""}>ğŸ¦ Transferencia</option><option value="tarjeta" data-v-5db71466${t.ssrIncludeBooleanAttr(Array.isArray(e.unref(f).metodo)?t.ssrLooseContain(e.unref(f).metodo,"tarjeta"):t.ssrLooseEqual(e.unref(f).metodo,"tarjeta"))?" selected":""}>ğŸ’³ Tarjeta</option><option value="bizum" data-v-5db71466${t.ssrIncludeBooleanAttr(Array.isArray(e.unref(f).metodo)?t.ssrLooseContain(e.unref(f).metodo,"bizum"):t.ssrLooseEqual(e.unref(f).metodo,"bizum"))?" selected":""}>ğŸ“± Bizum</option><option value="paypal" data-v-5db71466${t.ssrIncludeBooleanAttr(Array.isArray(e.unref(f).metodo)?t.ssrLooseContain(e.unref(f).metodo,"paypal"):t.ssrLooseEqual(e.unref(f).metodo,"paypal"))?" selected":""}>ğŸ…¿ï¸ PayPal</option></select></div></div>`),e.unref(l)?s(`<div class="flex items-center gap-2 p-3 bg-white border border-green-300 rounded-lg" data-v-5db71466><input${t.ssrIncludeBooleanAttr(Array.isArray(e.unref(f).confirmado)?t.ssrLooseContain(e.unref(f).confirmado,null):e.unref(f).confirmado)?" checked":""} type="checkbox" id="confirmar-pago" class="w-4 h-4 text-green-600 border-gray-300 rounded focus:ring-green-500" data-v-5db71466><label for="confirmar-pago" class="text-sm text-[#2D3748] cursor-pointer" data-v-5db71466> âœ“ Confirmar pago inmediatamente (ya verificado) </label></div>`):s("\x3c!----\x3e"),s(`<div class="flex gap-3" data-v-5db71466><button type="button" class="flex-1 px-4 py-2 bg-white border border-gray-300 text-[#2D3748] rounded-lg hover:bg-gray-50 transition-colors" data-v-5db71466> Cancelar </button><button type="submit" class="flex-1 px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors font-medium disabled:opacity-50"${t.ssrIncludeBooleanAttr(e.unref(p))?" disabled":""} data-v-5db71466>${t.ssrInterpolate(e.unref(p)?"Registrando...":"Guardar Pago")}</button></div></form></div>`)):s("\x3c!----\x3e"),s(`<div data-v-5db71466><h3 class="font-serif text-lg font-semibold text-[#2D3748] mb-4 flex items-center gap-2" data-v-5db71466><span data-v-5db71466>ğŸ“œ</span> Historial de Pagos (${t.ssrInterpolate(e.unref(i).length)}) </h3>`),e.unref(c)?s('<div class="text-center py-8" data-v-5db71466><div class="animate-spin w-10 h-10 border-4 border-[#5550F2] border-t-transparent rounded-full mx-auto mb-3" data-v-5db71466></div><p class="text-[#2D3748]/60" data-v-5db71466>Cargando pagos...</p></div>'):0===e.unref(i).length?s('<div class="text-center py-12" data-v-5db71466><span class="text-6xl mb-3 block opacity-40" data-v-5db71466>ğŸ’¸</span><p class="text-[#2D3748]/60" data-v-5db71466>No hay pagos registrados aÃºn</p></div>'):(s('<div class="space-y-3" data-v-5db71466>\x3c!--[--\x3e'),t.ssrRenderList(e.unref(x),a=>{var o;s(`<div class="${t.ssrRenderClass([a.confirmado?"bg-green-50 border-green-300":"bg-yellow-50 border-yellow-300","p-4 border-2 rounded-lg transition-all"])}" data-v-5db71466><div class="flex items-start justify-between gap-4" data-v-5db71466><div class="flex-1" data-v-5db71466><div class="flex items-center gap-3 mb-2" data-v-5db71466><span class="${t.ssrRenderClass([a.confirmado?"text-green-600":"text-yellow-600","text-2xl font-bold"])}" data-v-5db71466>${t.ssrInterpolate(formatearMonto(a.monto))}</span><span class="${t.ssrRenderClass([a.confirmado?"bg-green-200 text-green-800":"bg-yellow-200 text-yellow-800","px-2 py-1 rounded-full text-xs font-medium capitalize"])}" data-v-5db71466>${t.ssrInterpolate(a.confirmado?"âœ“ Confirmado":"â³ Pendiente")}</span></div><div class="space-y-1 text-sm text-[#2D3748]/70" data-v-5db71466><div class="flex items-center gap-2" data-v-5db71466><span data-v-5db71466>ğŸ’³</span><span class="capitalize" data-v-5db71466>${t.ssrInterpolate((o=a.metodo_pago,{efectivo:"Efectivo",transferencia:"Transferencia Bancaria",tarjeta:"Tarjeta de CrÃ©dito/DÃ©bito",bizum:"Bizum",paypal:"PayPal"}[o]||o))}</span></div><div class="flex items-center gap-2" data-v-5db71466><span data-v-5db71466>ğŸ“…</span><span data-v-5db71466>${t.ssrInterpolate(formatearFecha(a.fecha_pago))}</span></div>`),a.confirmado&&a.fecha_confirmacion?s(`<div class="flex items-center gap-2" data-v-5db71466><span data-v-5db71466>âœ…</span><span data-v-5db71466>Confirmado el ${t.ssrInterpolate(formatearFecha(a.fecha_confirmacion))}</span></div>`):s("\x3c!----\x3e"),s("</div></div>"),e.unref(l)&&!a.confirmado?s(`<div data-v-5db71466><button class="px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors text-sm font-medium"${t.ssrIncludeBooleanAttr(e.unref(v)===a.id)?" disabled":""} data-v-5db71466>${t.ssrInterpolate(e.unref(v)===a.id?"Confirmando...":"âœ“ Confirmar")}</button></div>`):s("\x3c!----\x3e"),s("</div></div>")}),s("\x3c!--]--\x3e</div>")),s("</div>"),e.unref(b)?s(`<div class="p-4 bg-red-50 border border-red-200 rounded-lg" data-v-5db71466><p class="text-sm text-red-700 flex items-center gap-2" data-v-5db71466><span data-v-5db71466>âŒ</span> ${t.ssrInterpolate(e.unref(b))}</p></div>`):s("\x3c!----\x3e"),e.unref(m)?s(`<div class="p-4 bg-green-50 border border-green-200 rounded-lg" data-v-5db71466><p class="text-sm text-green-700 flex items-center gap-2" data-v-5db71466><span data-v-5db71466>âœ…</span> ${t.ssrInterpolate(e.unref(m))}</p></div>`):s("\x3c!----\x3e"),s('</div><div class="sticky bottom-0 bg-[#F2F2F2] border-t border-[#5550F2]/30 px-6 py-4" data-v-5db71466><button class="w-full px-6 py-3 bg-[#2D3748] text-white rounded-lg hover:bg-[#4A3A34] transition-colors font-medium" data-v-5db71466> Cerrar </button></div></div></div></div>')):s("\x3c!----\x3e")}}}),b=v.setup;v.setup=(t,a)=>{const o=e.useSSRContext();return(o.modules||(o.modules=new Set)).add("components/ModalPagosBono.vue"),b?b(t,a):void 0};const m=Object.assign(s(v,[["__scopeId","data-v-5db71466"]]),{__name:"ModalPagosBono"}),f=e.defineComponent({__name:"ModalRenovacionBono",__ssrInlineRender:!0,props:{mostrar:{type:Boolean},bono:{}},emits:["close","renovated"],setup(o,{emit:s}){const r=o;a();const n=e.ref(!0),d=e.ref(!1),l=e.ref(""),i=e.ref({sesiones_nuevas:r.bono?.sesiones_totales||0,monto_nuevo:r.bono?.monto||0,motivo:""}),c=e.computed(()=>({pendiente:"text-yellow-600",activo:"text-green-600",completado:"text-gray-600",vencido:"text-red-600",cancelado:"text-gray-500"}[r.bono?.estado]||"text-gray-600")),u=e.computed(()=>{if(!r.bono?.sesiones_totales||!r.bono?.monto)return"0.00";return(r.bono.monto/r.bono.sesiones_totales).toFixed(2)}),p=e.computed(()=>{if(!i.value.sesiones_nuevas||!i.value.monto_nuevo)return"0.00";return(i.value.monto_nuevo/i.value.sesiones_nuevas).toFixed(2)}),formatearMonto=e=>e?new Intl.NumberFormat("es-ES",{style:"currency",currency:"EUR"}).format(e):"â‚¬ 0.00";return e.watch(()=>r.bono,e=>{e&&(i.value.sesiones_nuevas=e.sesiones_totales||0,i.value.monto_nuevo=e.monto||0)},{immediate:!0}),(a,s,r,v)=>{o.mostrar?(s(`<div${t.ssrRenderAttrs(e.mergeProps({class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"},v))}><div class="bg-[#F2F2F2] rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto"><div class="sticky top-0 bg-[#F2F2F2] border-b border-[#5550F2]/30 px-6 py-4 flex justify-between items-center"><div><h2 class="text-2xl font-serif text-[#2D3748] font-semibold flex items-center gap-2"><span class="text-2xl">ğŸ”„</span> Renovar Bono </h2><p class="text-sm text-[#2D3748]/60 mt-1"> Crea una nueva renovaciÃ³n basada en el bono actual </p></div><button class="text-[#2D3748] hover:text-[#5550F2] transition-colors" aria-label="Cerrar modal"><svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button></div><div class="px-6 py-6 space-y-6"><div class="p-5 bg-gradient-to-r from-gray-100 to-gray-50 border-2 border-gray-300 rounded-xl"><h3 class="font-serif text-lg font-semibold text-[#2D3748] mb-4 flex items-center gap-2"><span>ğŸ“‹</span> Bono Actual </h3><div class="grid grid-cols-2 gap-4 text-sm"><div class="p-3 bg-white rounded-lg"><div class="text-[#2D3748]/60 mb-1">Tipo</div><div class="font-medium text-[#2D3748] capitalize">${t.ssrInterpolate(o.bono.tipo)}</div></div><div class="p-3 bg-white rounded-lg"><div class="text-[#2D3748]/60 mb-1">Frecuencia</div><div class="font-medium text-[#2D3748] capitalize">${t.ssrInterpolate(o.bono.frecuencia)}</div></div><div class="p-3 bg-white rounded-lg"><div class="text-[#2D3748]/60 mb-1">Sesiones Totales</div><div class="font-medium text-[#2D3748]">${t.ssrInterpolate(o.bono.sesiones_totales)}</div></div><div class="p-3 bg-white rounded-lg"><div class="text-[#2D3748]/60 mb-1">Sesiones Restantes</div><div class="font-medium text-[#2D3748]">${t.ssrInterpolate(o.bono.sesiones_restantes||0)}</div></div><div class="p-3 bg-white rounded-lg"><div class="text-[#2D3748]/60 mb-1">Monto</div><div class="font-bold text-[#5550F2] text-lg">${t.ssrInterpolate(formatearMonto(o.bono.monto))}</div></div><div class="p-3 bg-white rounded-lg"><div class="text-[#2D3748]/60 mb-1">Estado</div><div class="${t.ssrRenderClass([e.unref(c),"font-medium capitalize"])}">${t.ssrInterpolate(o.bono.estado)}</div></div></div></div><form class="space-y-5"><div class="p-5 bg-gradient-to-r from-purple-50 to-indigo-50 border-2 border-purple-300 rounded-xl"><h3 class="font-serif text-lg font-semibold text-[#2D3748] mb-4 flex items-center gap-2"><span>âœ¨</span> Datos del Nuevo Bono </h3><div class="mb-5 p-3 bg-white border border-purple-200 rounded-lg"><label class="flex items-center gap-3 cursor-pointer"><input${t.ssrIncludeBooleanAttr(Array.isArray(e.unref(n))?t.ssrLooseContain(e.unref(n),null):e.unref(n))?" checked":""} type="checkbox" class="w-5 h-5 text-purple-600 border-gray-300 rounded focus:ring-purple-500"><div><div class="text-sm font-medium text-[#2D3748]"> Mantener los mismos valores del bono original </div><div class="text-xs text-[#2D3748]/60 mt-1"> Si lo desmarcas, podrÃ¡s personalizar las sesiones y el monto </div></div></label></div>`),e.unref(n)?s(`<div class="p-4 bg-green-50 border border-green-300 rounded-lg"><p class="text-sm text-green-700 flex items-center gap-2"><span>âœ“</span> Se duplicarÃ¡n los valores originales: <strong>${t.ssrInterpolate(o.bono.sesiones_totales)} sesiones</strong> por <strong>${t.ssrInterpolate(formatearMonto(o.bono.monto))}</strong></p></div>`):s(`<div class="space-y-4"><div class="grid grid-cols-2 gap-4"><div><label class="block text-sm font-medium text-[#2D3748] mb-2"> Sesiones Totales </label><input${t.ssrRenderAttr("value",e.unref(i).sesiones_nuevas)} type="number" min="1" max="100" required class="w-full px-4 py-2 border border-purple-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 bg-white"></div><div><label class="block text-sm font-medium text-[#2D3748] mb-2"> Monto Total </label><div class="relative"><span class="absolute left-3 top-1/2 -translate-y-1/2 text-[#2D3748]/60">â‚¬</span><input${t.ssrRenderAttr("value",e.unref(i).monto_nuevo)} type="number" min="0" step="0.01" required placeholder="0.00" class="w-full pl-8 pr-4 py-2 border border-purple-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 bg-white"></div></div></div><div class="p-3 bg-purple-100 rounded-lg text-sm"><div class="flex justify-between mb-1"><span class="text-[#2D3748]/70">Precio por sesiÃ³n (nuevo):</span><span class="font-bold text-purple-700">â‚¬${t.ssrInterpolate(e.unref(p))}</span></div><div class="flex justify-between"><span class="text-[#2D3748]/70">Precio por sesiÃ³n (original):</span><span class="font-medium text-[#2D3748]/60">â‚¬${t.ssrInterpolate(e.unref(u))}</span></div></div></div>`),s(`</div><div><label class="block text-sm font-medium text-[#2D3748] mb-2"> Motivo de la RenovaciÃ³n (Opcional) </label><textarea rows="3" placeholder="Explica por quÃ© se renueva este bono..." class="w-full px-4 py-2 border border-[#5550F2]/30 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#5550F2] resize-none">${t.ssrInterpolate(e.unref(i).motivo)}</textarea></div><div class="p-4 bg-blue-50 border-2 border-blue-300 rounded-lg"><h4 class="font-medium text-blue-900 mb-2 flex items-center gap-2"><span>â„¹ï¸</span> InformaciÃ³n Importante </h4><ul class="text-sm text-blue-800 space-y-1.5"><li class="flex items-start gap-2"><span class="mt-0.5">â€¢</span><span>El bono actual se marcarÃ¡ como <strong>completado</strong></span></li><li class="flex items-start gap-2"><span class="mt-0.5">â€¢</span><span>Se crearÃ¡ un <strong>nuevo bono</strong> con estado <strong>pendiente</strong> hasta que se confirme el pago</span></li><li class="flex items-start gap-2"><span class="mt-0.5">â€¢</span><span>La fecha de inicio serÃ¡ <strong>hoy</strong> y la de vencimiento se calcularÃ¡ automÃ¡ticamente</span></li><li class="flex items-start gap-2"><span class="mt-0.5">â€¢</span><span>Se guardarÃ¡ un registro en el historial de renovaciones</span></li></ul></div>`),e.unref(l)?s(`<div class="p-4 bg-red-50 border border-red-200 rounded-lg"><p class="text-sm text-red-700 flex items-center gap-2"><span>âŒ</span> ${t.ssrInterpolate(e.unref(l))}</p></div>`):s("\x3c!----\x3e"),s(`<div class="flex gap-3 pt-4 border-t border-[#5550F2]/30"><button type="button" class="flex-1 px-6 py-3 bg-white border border-[#5550F2]/30 text-[#2D3748] rounded-lg hover:bg-[#5550F2]/10 transition-colors font-medium"${t.ssrIncludeBooleanAttr(e.unref(d))?" disabled":""}> Cancelar </button><button type="submit" class="flex-1 px-6 py-3 bg-purple-500 text-white rounded-lg hover:bg-purple-600 transition-colors font-medium disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2"${t.ssrIncludeBooleanAttr(e.unref(d))?" disabled":""}>`),e.unref(d)?s("<span>â³</span>"):s("<span>ğŸ”„</span>"),s(`<span>${t.ssrInterpolate(e.unref(d)?"Renovando...":"Confirmar RenovaciÃ³n")}</span></button></div></form></div></div></div>`)):s("\x3c!----\x3e")}}}),x=f.setup;f.setup=(t,a)=>{const o=e.useSSRContext();return(o.modules||(o.modules=new Set)).add("components/ModalRenovacionBono.vue"),x?x(t,a):void 0};const g=Object.assign(f,{__name:"ModalRenovacionBono"}),h=e.defineComponent({__name:"bonos",__ssrInlineRender:!0,setup(o){const s=n(),{userProfile:i}=d();e.computed(()=>null),e.computed(()=>null);const{getBonosPorPaciente:c,calcularMetricas:u,puedeGestionarBonos:v}=a(),b=e.computed(()=>""),f=e.computed(()=>i.value?.id||""),x=e.ref(!0),h=e.ref(null),y=e.ref([]),w=e.ref(""),A=e.ref({total:0,activos:0,completados:0,vencidos:0,pendientes:0,proximosAVencer:0,pocasSesiones:0}),$=e.ref("todos"),D=e.ref("todos"),C=e.ref("reciente"),I=e.ref(!1),F=e.ref(!1),_=e.ref(!1),B=e.ref(null),V=e.computed(()=>{let e=[...y.value];return"todos"!==$.value&&(e=e.filter(e=>e.estado===$.value)),"todos"!==D.value&&(e=e.filter(e=>e.tipo===D.value)),"reciente"===C.value?e.sort((e,t)=>new Date(t.created_at).getTime()-new Date(e.created_at).getTime()):"antiguo"===C.value?e.sort((e,t)=>new Date(e.created_at).getTime()-new Date(t.created_at).getTime()):"vencimiento"===C.value&&e.sort((e,t)=>e.fecha_fin?t.fecha_fin?new Date(e.fecha_fin).getTime()-new Date(t.fecha_fin).getTime():-1:1),e}),R=e.computed(()=>A.value.proximosAVencer>0||A.value.pocasSesiones>0),cargarBonos=async()=>{try{x.value=!0,h.value=null;const{data:e,error:t}=await s.from("pacientes").select("nombre, email").eq("id",b.value).single();if(t)throw t;w.value=e?.nombre||e?.email||"Paciente",y.value=await c(b.value),A.value=await u(b.value)}catch(e){console.error("[BonosPage] Error al cargar bonos:",e),h.value=e.message||"Error al cargar los bonos"}finally{x.value=!1}},limpiarFiltros=()=>{$.value="todos",D.value="todos",C.value="reciente"},abrirModalNuevoBono=()=>{I.value=!0},cerrarModalNuevoBono=()=>{I.value=!1},onBonoCreado=async()=>{await cargarBonos()},abrirModalPagos=e=>{B.value=e,F.value=!0},cerrarModalPagos=()=>{F.value=!1,B.value=null},onPagosActualizados=async()=>{await cargarBonos()},abrirModalRenovacion=e=>{B.value=e,_.value=!0},cerrarModalRenovacion=()=>{_.value=!1,B.value=null},onBonoRenovado=async()=>{await cargarBonos()},editarBono=e=>{console.log("Editar bono:",e),alert("FunciÃ³n de ediciÃ³n en desarrollo")};return(a,o,s,n)=>{const d=l,i=p,c=r,u=m,N=g;o(`<div${t.ssrRenderAttrs(e.mergeProps({class:"bonos-container pb-20"},n))} data-v-dd12cc0e><button class="mb-6 flex items-center gap-2 text-[#5D4A44] hover:text-[#D8AFA0] transition-colors" data-v-dd12cc0e><span data-v-dd12cc0e>â†</span><span data-v-dd12cc0e>Volver a ficha del paciente</span></button><header class="mb-6" data-v-dd12cc0e><div class="flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4" data-v-dd12cc0e><div data-v-dd12cc0e><h1 class="text-3xl font-[&#39;Lora&#39;] font-bold text-[#5D4A44] mb-2 flex items-center gap-3" data-v-dd12cc0e><span class="text-4xl" data-v-dd12cc0e>ğŸ«</span> Bonos de ${t.ssrInterpolate(e.unref(w))}</h1><p class="text-[#5D4A44]/60" data-v-dd12cc0e> Gestiona los bonos, pagos y renovaciones del paciente </p></div>`),e.unref(v)?o('<button class="px-6 py-3 bg-[#D8AFA0] text-white rounded-lg hover:bg-[#C89B8A] transition-colors font-medium flex items-center gap-2 shadow-lg" data-v-dd12cc0e><span class="text-xl" data-v-dd12cc0e>+</span><span data-v-dd12cc0e>Nuevo Bono</span></button>'):o("\x3c!----\x3e"),o("</div></header>"),e.unref(x)?o('<div class="text-center py-16" data-v-dd12cc0e><div class="animate-spin w-16 h-16 border-4 border-[#D8AFA0] border-t-transparent rounded-full mx-auto mb-4" data-v-dd12cc0e></div><p class="text-[#5D4A44]/60" data-v-dd12cc0e>Cargando bonos...</p></div>'):e.unref(h)?(o('<div class="text-center py-16" data-v-dd12cc0e>'),o(t.ssrRenderComponent(d,null,{default:e.withCtx((a,o,s,r)=>{if(!o)return[e.createVNode("span",{class:"text-7xl mb-4 block"},"âŒ"),e.createVNode("h3",{class:"text-xl font-['Lora'] font-semibold text-[#5D4A44] mb-2"}," Error al cargar bonos "),e.createVNode("p",{class:"text-[#5D4A44]/60 mb-4"},e.toDisplayString(e.unref(h)),1),e.createVNode("button",{onClick:cargarBonos,class:"px-6 py-3 bg-[#D8AFA0] text-white rounded-lg hover:bg-[#C89B8A] transition-colors"}," Intentar de nuevo ")];o(`<span class="text-7xl mb-4 block" data-v-dd12cc0e${r}>âŒ</span><h3 class="text-xl font-[&#39;Lora&#39;] font-semibold text-[#5D4A44] mb-2" data-v-dd12cc0e${r}> Error al cargar bonos </h3><p class="text-[#5D4A44]/60 mb-4" data-v-dd12cc0e${r}>${t.ssrInterpolate(e.unref(h))}</p><button class="px-6 py-3 bg-[#D8AFA0] text-white rounded-lg hover:bg-[#C89B8A] transition-colors" data-v-dd12cc0e${r}> Intentar de nuevo </button>`)}),_:1},s)),o("</div>")):(o('<div data-v-dd12cc0e><section class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-8" data-v-dd12cc0e>'),o(t.ssrRenderComponent(d,{class:"bg-gradient-to-br from-purple-50 to-indigo-50 border-2 border-purple-200"},{default:e.withCtx((a,o,s,r)=>{if(!o)return[e.createVNode("div",{class:"flex items-center justify-between"},[e.createVNode("div",null,[e.createVNode("p",{class:"text-sm text-purple-600 font-medium mb-1"},"Total Bonos"),e.createVNode("p",{class:"text-3xl font-bold text-purple-700"},e.toDisplayString(e.unref(A).total),1)]),e.createVNode("span",{class:"text-4xl"},"ğŸ«")])];o(`<div class="flex items-center justify-between" data-v-dd12cc0e${r}><div data-v-dd12cc0e${r}><p class="text-sm text-purple-600 font-medium mb-1" data-v-dd12cc0e${r}>Total Bonos</p><p class="text-3xl font-bold text-purple-700" data-v-dd12cc0e${r}>${t.ssrInterpolate(e.unref(A).total)}</p></div><span class="text-4xl" data-v-dd12cc0e${r}>ğŸ«</span></div>`)}),_:1},s)),o(t.ssrRenderComponent(d,{class:"bg-gradient-to-br from-green-50 to-emerald-50 border-2 border-green-200"},{default:e.withCtx((a,o,s,r)=>{if(!o)return[e.createVNode("div",{class:"flex items-center justify-between"},[e.createVNode("div",null,[e.createVNode("p",{class:"text-sm text-green-600 font-medium mb-1"},"Activos"),e.createVNode("p",{class:"text-3xl font-bold text-green-700"},e.toDisplayString(e.unref(A).activos),1)]),e.createVNode("span",{class:"text-4xl"},"âœ…")])];o(`<div class="flex items-center justify-between" data-v-dd12cc0e${r}><div data-v-dd12cc0e${r}><p class="text-sm text-green-600 font-medium mb-1" data-v-dd12cc0e${r}>Activos</p><p class="text-3xl font-bold text-green-700" data-v-dd12cc0e${r}>${t.ssrInterpolate(e.unref(A).activos)}</p></div><span class="text-4xl" data-v-dd12cc0e${r}>âœ…</span></div>`)}),_:1},s)),o(t.ssrRenderComponent(d,{class:"bg-gradient-to-br from-orange-50 to-amber-50 border-2 border-orange-200"},{default:e.withCtx((a,o,s,r)=>{if(!o)return[e.createVNode("div",{class:"flex items-center justify-between"},[e.createVNode("div",null,[e.createVNode("p",{class:"text-sm text-orange-600 font-medium mb-1"},"Por Vencer"),e.createVNode("p",{class:"text-3xl font-bold text-orange-700"},e.toDisplayString(e.unref(A).proximosAVencer),1)]),e.createVNode("span",{class:"text-4xl"},"âš ï¸")])];o(`<div class="flex items-center justify-between" data-v-dd12cc0e${r}><div data-v-dd12cc0e${r}><p class="text-sm text-orange-600 font-medium mb-1" data-v-dd12cc0e${r}>Por Vencer</p><p class="text-3xl font-bold text-orange-700" data-v-dd12cc0e${r}>${t.ssrInterpolate(e.unref(A).proximosAVencer)}</p></div><span class="text-4xl" data-v-dd12cc0e${r}>âš ï¸</span></div>`)}),_:1},s)),o(t.ssrRenderComponent(d,{class:"bg-gradient-to-br from-yellow-50 to-amber-50 border-2 border-yellow-200"},{default:e.withCtx((a,o,s,r)=>{if(!o)return[e.createVNode("div",{class:"flex items-center justify-between"},[e.createVNode("div",null,[e.createVNode("p",{class:"text-sm text-yellow-600 font-medium mb-1"},"Pendientes"),e.createVNode("p",{class:"text-3xl font-bold text-yellow-700"},e.toDisplayString(e.unref(A).pendientes),1)]),e.createVNode("span",{class:"text-4xl"},"â³")])];o(`<div class="flex items-center justify-between" data-v-dd12cc0e${r}><div data-v-dd12cc0e${r}><p class="text-sm text-yellow-600 font-medium mb-1" data-v-dd12cc0e${r}>Pendientes</p><p class="text-3xl font-bold text-yellow-700" data-v-dd12cc0e${r}>${t.ssrInterpolate(e.unref(A).pendientes)}</p></div><span class="text-4xl" data-v-dd12cc0e${r}>â³</span></div>`)}),_:1},s)),o('</section><section class="mb-6" data-v-dd12cc0e>'),o(t.ssrRenderComponent(d,null,{default:e.withCtx((a,o,s,r)=>{if(!o)return[e.createVNode("div",{class:"flex flex-col md:flex-row gap-4"},[e.createVNode("div",{class:"flex-1"},[e.createVNode("label",{class:"block text-sm font-medium text-[#5D4A44] mb-2"}," Filtrar por Estado "),e.withDirectives(e.createVNode("select",{"onUpdate:modelValue":t=>e.isRef($)?$.value=t:null,class:"w-full px-4 py-2 border border-[#D8AFA0]/30 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#D8AFA0] bg-white"},[e.createVNode("option",{value:"todos"},"Todos los estados"),e.createVNode("option",{value:"activo"},"âœ… Activos"),e.createVNode("option",{value:"pendiente"},"â³ Pendientes"),e.createVNode("option",{value:"completado"},"âœ”ï¸ Completados"),e.createVNode("option",{value:"vencido"},"âŒ Vencidos"),e.createVNode("option",{value:"cancelado"},"ğŸš« Cancelados")],8,["onUpdate:modelValue"]),[[e.vModelSelect,e.unref($)]])]),e.createVNode("div",{class:"flex-1"},[e.createVNode("label",{class:"block text-sm font-medium text-[#5D4A44] mb-2"}," Filtrar por Tipo "),e.withDirectives(e.createVNode("select",{"onUpdate:modelValue":t=>e.isRef(D)?D.value=t:null,class:"w-full px-4 py-2 border border-[#D8AFA0]/30 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#D8AFA0] bg-white"},[e.createVNode("option",{value:"todos"},"Todos los tipos"),e.createVNode("option",{value:"quincenal"},"Quincenal"),e.createVNode("option",{value:"mensual"},"Mensual"),e.createVNode("option",{value:"semestral"},"Semestral")],8,["onUpdate:modelValue"]),[[e.vModelSelect,e.unref(D)]])]),e.createVNode("div",{class:"flex-1"},[e.createVNode("label",{class:"block text-sm font-medium text-[#5D4A44] mb-2"}," Ordenar por "),e.withDirectives(e.createVNode("select",{"onUpdate:modelValue":t=>e.isRef(C)?C.value=t:null,class:"w-full px-4 py-2 border border-[#D8AFA0]/30 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#D8AFA0] bg-white"},[e.createVNode("option",{value:"reciente"},"MÃ¡s recientes"),e.createVNode("option",{value:"antiguo"},"MÃ¡s antiguos"),e.createVNode("option",{value:"vencimiento"},"Por vencimiento")],8,["onUpdate:modelValue"]),[[e.vModelSelect,e.unref(C)]])])])];o(`<div class="flex flex-col md:flex-row gap-4" data-v-dd12cc0e${r}><div class="flex-1" data-v-dd12cc0e${r}><label class="block text-sm font-medium text-[#5D4A44] mb-2" data-v-dd12cc0e${r}> Filtrar por Estado </label><select class="w-full px-4 py-2 border border-[#D8AFA0]/30 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#D8AFA0] bg-white" data-v-dd12cc0e${r}><option value="todos" data-v-dd12cc0e${t.ssrIncludeBooleanAttr(Array.isArray(e.unref($))?t.ssrLooseContain(e.unref($),"todos"):t.ssrLooseEqual(e.unref($),"todos"))?" selected":""}${r}>Todos los estados</option><option value="activo" data-v-dd12cc0e${t.ssrIncludeBooleanAttr(Array.isArray(e.unref($))?t.ssrLooseContain(e.unref($),"activo"):t.ssrLooseEqual(e.unref($),"activo"))?" selected":""}${r}>âœ… Activos</option><option value="pendiente" data-v-dd12cc0e${t.ssrIncludeBooleanAttr(Array.isArray(e.unref($))?t.ssrLooseContain(e.unref($),"pendiente"):t.ssrLooseEqual(e.unref($),"pendiente"))?" selected":""}${r}>â³ Pendientes</option><option value="completado" data-v-dd12cc0e${t.ssrIncludeBooleanAttr(Array.isArray(e.unref($))?t.ssrLooseContain(e.unref($),"completado"):t.ssrLooseEqual(e.unref($),"completado"))?" selected":""}${r}>âœ”ï¸ Completados</option><option value="vencido" data-v-dd12cc0e${t.ssrIncludeBooleanAttr(Array.isArray(e.unref($))?t.ssrLooseContain(e.unref($),"vencido"):t.ssrLooseEqual(e.unref($),"vencido"))?" selected":""}${r}>âŒ Vencidos</option><option value="cancelado" data-v-dd12cc0e${t.ssrIncludeBooleanAttr(Array.isArray(e.unref($))?t.ssrLooseContain(e.unref($),"cancelado"):t.ssrLooseEqual(e.unref($),"cancelado"))?" selected":""}${r}>ğŸš« Cancelados</option></select></div><div class="flex-1" data-v-dd12cc0e${r}><label class="block text-sm font-medium text-[#5D4A44] mb-2" data-v-dd12cc0e${r}> Filtrar por Tipo </label><select class="w-full px-4 py-2 border border-[#D8AFA0]/30 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#D8AFA0] bg-white" data-v-dd12cc0e${r}><option value="todos" data-v-dd12cc0e${t.ssrIncludeBooleanAttr(Array.isArray(e.unref(D))?t.ssrLooseContain(e.unref(D),"todos"):t.ssrLooseEqual(e.unref(D),"todos"))?" selected":""}${r}>Todos los tipos</option><option value="quincenal" data-v-dd12cc0e${t.ssrIncludeBooleanAttr(Array.isArray(e.unref(D))?t.ssrLooseContain(e.unref(D),"quincenal"):t.ssrLooseEqual(e.unref(D),"quincenal"))?" selected":""}${r}>Quincenal</option><option value="mensual" data-v-dd12cc0e${t.ssrIncludeBooleanAttr(Array.isArray(e.unref(D))?t.ssrLooseContain(e.unref(D),"mensual"):t.ssrLooseEqual(e.unref(D),"mensual"))?" selected":""}${r}>Mensual</option><option value="semestral" data-v-dd12cc0e${t.ssrIncludeBooleanAttr(Array.isArray(e.unref(D))?t.ssrLooseContain(e.unref(D),"semestral"):t.ssrLooseEqual(e.unref(D),"semestral"))?" selected":""}${r}>Semestral</option></select></div><div class="flex-1" data-v-dd12cc0e${r}><label class="block text-sm font-medium text-[#5D4A44] mb-2" data-v-dd12cc0e${r}> Ordenar por </label><select class="w-full px-4 py-2 border border-[#D8AFA0]/30 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#D8AFA0] bg-white" data-v-dd12cc0e${r}><option value="reciente" data-v-dd12cc0e${t.ssrIncludeBooleanAttr(Array.isArray(e.unref(C))?t.ssrLooseContain(e.unref(C),"reciente"):t.ssrLooseEqual(e.unref(C),"reciente"))?" selected":""}${r}>MÃ¡s recientes</option><option value="antiguo" data-v-dd12cc0e${t.ssrIncludeBooleanAttr(Array.isArray(e.unref(C))?t.ssrLooseContain(e.unref(C),"antiguo"):t.ssrLooseEqual(e.unref(C),"antiguo"))?" selected":""}${r}>MÃ¡s antiguos</option><option value="vencimiento" data-v-dd12cc0e${t.ssrIncludeBooleanAttr(Array.isArray(e.unref(C))?t.ssrLooseContain(e.unref(C),"vencimiento"):t.ssrLooseEqual(e.unref(C),"vencimiento"))?" selected":""}${r}>Por vencimiento</option></select></div></div>`)}),_:1},s)),o("</section>"),e.unref(V).length>0?(o('<section class="grid grid-cols-1 lg:grid-cols-2 gap-6" data-v-dd12cc0e>\x3c!--[--\x3e'),t.ssrRenderList(e.unref(V),e=>{o(t.ssrRenderComponent(i,{key:e.id,bono:e,onRenovar:abrirModalRenovacion,onVerPagos:abrirModalPagos,onEditar:editarBono},null,s))}),o("\x3c!--]--\x3e</section>")):(o('<section class="text-center py-16" data-v-dd12cc0e>'),o(t.ssrRenderComponent(d,null,{default:e.withCtx((a,o,s,r)=>{if(!o)return[e.createVNode("span",{class:"text-7xl mb-4 block opacity-40"},"ğŸ«"),e.createVNode("h3",{class:"text-xl font-['Lora'] font-semibold text-[#5D4A44] mb-2"},e.toDisplayString(0===e.unref(y).length?"No hay bonos registrados":"No hay bonos con estos filtros"),1),e.createVNode("p",{class:"text-[#5D4A44]/60 mb-6"},e.toDisplayString(0===e.unref(y).length?"Crea el primer bono para este paciente":"Intenta cambiar los filtros para ver mÃ¡s bonos"),1),0===e.unref(y).length&&e.unref(v)?(e.openBlock(),e.createBlock("button",{key:0,onClick:abrirModalNuevoBono,class:"px-8 py-3 bg-[#D8AFA0] text-white rounded-lg hover:bg-[#C89B8A] transition-colors font-medium"}," + Crear Primer Bono ")):(e.openBlock(),e.createBlock("button",{key:1,onClick:limpiarFiltros,class:"px-8 py-3 bg-[#5D4A44] text-white rounded-lg hover:bg-[#4A3A34] transition-colors font-medium"}," Limpiar Filtros "))];o(`<span class="text-7xl mb-4 block opacity-40" data-v-dd12cc0e${r}>ğŸ«</span><h3 class="text-xl font-[&#39;Lora&#39;] font-semibold text-[#5D4A44] mb-2" data-v-dd12cc0e${r}>${t.ssrInterpolate(0===e.unref(y).length?"No hay bonos registrados":"No hay bonos con estos filtros")}</h3><p class="text-[#5D4A44]/60 mb-6" data-v-dd12cc0e${r}>${t.ssrInterpolate(0===e.unref(y).length?"Crea el primer bono para este paciente":"Intenta cambiar los filtros para ver mÃ¡s bonos")}</p>`),0===e.unref(y).length&&e.unref(v)?o(`<button class="px-8 py-3 bg-[#D8AFA0] text-white rounded-lg hover:bg-[#C89B8A] transition-colors font-medium" data-v-dd12cc0e${r}> + Crear Primer Bono </button>`):o(`<button class="px-8 py-3 bg-[#5D4A44] text-white rounded-lg hover:bg-[#4A3A34] transition-colors font-medium" data-v-dd12cc0e${r}> Limpiar Filtros </button>`)}),_:1},s)),o("</section>")),e.unref(R)?(o('<section class="mt-8 space-y-3" data-v-dd12cc0e>'),e.unref(A).proximosAVencer>0?o(`<div class="p-4 bg-orange-50 border-2 border-orange-300 rounded-lg" data-v-dd12cc0e><div class="flex items-start gap-3" data-v-dd12cc0e><span class="text-2xl" data-v-dd12cc0e>âš ï¸</span><div class="flex-1" data-v-dd12cc0e><h4 class="font-medium text-orange-900 mb-1" data-v-dd12cc0e>${t.ssrInterpolate(e.unref(A).proximosAVencer)} bono(s) prÃ³ximo(s) a vencer </h4><p class="text-sm text-orange-700" data-v-dd12cc0e> Hay bonos que vencerÃ¡n en los prÃ³ximos 7 dÃ­as. Considera renovarlos. </p></div><button class="text-sm text-orange-700 hover:text-orange-900 underline" data-v-dd12cc0e> Ver bonos activos </button></div></div>`):o("\x3c!----\x3e"),e.unref(A).pocasSesiones>0?o(`<div class="p-4 bg-blue-50 border-2 border-blue-300 rounded-lg" data-v-dd12cc0e><div class="flex items-start gap-3" data-v-dd12cc0e><span class="text-2xl" data-v-dd12cc0e>ğŸ“Š</span><div class="flex-1" data-v-dd12cc0e><h4 class="font-medium text-blue-900 mb-1" data-v-dd12cc0e>${t.ssrInterpolate(e.unref(A).pocasSesiones)} bono(s) con pocas sesiones </h4><p class="text-sm text-blue-700" data-v-dd12cc0e> Algunos bonos tienen 2 o menos sesiones restantes. </p></div></div></div>`):o("\x3c!----\x3e"),o("</section>")):o("\x3c!----\x3e"),o("</div>")),o(t.ssrRenderComponent(c,{mostrar:e.unref(I),"paciente-id":e.unref(b),"paciente-nombre":e.unref(w),"psicologa-id":e.unref(f),onClose:cerrarModalNuevoBono,onCreated:onBonoCreado},null,s)),o(t.ssrRenderComponent(u,{mostrar:e.unref(F),bono:e.unref(B),onClose:cerrarModalPagos,onUpdated:onPagosActualizados},null,s)),o(t.ssrRenderComponent(N,{mostrar:e.unref(_),bono:e.unref(B),onClose:cerrarModalRenovacion,onRenovated:onBonoRenovado},null,s)),o("</div>")}}}),y=h.setup;h.setup=(t,a)=>{const o=e.useSSRContext();return(o.modules||(o.modules=new Set)).add("pages/terapeuta/pacientes/[id]/bonos.vue"),y?y(t,a):void 0};const w=s(h,[["__scopeId","data-v-dd12cc0e"]]);export{w as default};
//# sourceMappingURL=bonos-BEb6hO6M.mjs.map
