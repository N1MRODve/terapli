{"version":3,"file":"useNotificaciones-CrhSSwYp.mjs","sources":["../../../../../../composables/useNotificaciones.ts"],"sourcesContent":null,"names":["useNotificaciones","supabase","useSupabaseClient","user","useSupabaseUser","getUserId","useSupabase","notificaciones","ref","loading","error","canal","totalNoVistas","noLeidas","computed","value","filter","n","leido","urgentes","tipo","_a","metadata","urgencia","_b","sesiones_restantes","tieneUrgentes","length","marcarVista","async","notificacionId","data","rpcError","rpc","p_notificacion_id","map","id","leido_at","Date","toISOString","Math","max","e","console","marcarTodasVistas","success","marcadas","message","contarNoVistas","listar","limite","userId","warn","fetchError","from","select","eq","order","ascending","limit","code","includes","visto","crear","usuarioId","titulo","mensaje","referenciaId","insertError","insert","usuario_id","referencia_id","single","marcarComoLeida","marcarTodasComoLeidas","obtenerContador","eliminar","deleteError","delete","notificacionEliminada","find","eliminarVistas","suscribirse","channel","on","event","schema","table","payload","nuevaNotificacion","new","unshift","Notification","permission","body","icon","badge","notificacionActualizada","index","findIndex","subscribe","desuscribirse","removeChannel","solicitarPermisosNotificaciones","requestPermission"],"mappings":"wKA6BO,MAAMA,kBAAoB,KAC/B,MAAMC,EAAWC,IACXC,EAAOC,KACPC,UAAEA,GAAcC,IAEhBC,EAAiBC,EAAoB,IACrCC,EAAUD,GAAI,GACdE,EAAQF,EAAmB,MAC3BG,EAAQH,EAA4B,MACpCI,EAAgBJ,EAAI,GAGpBK,EAAWC,EAAS,IAAMP,EAAeQ,MAAMC,OAAOC,IAAMA,EAAEC,QAC9DC,EAAWL,EAAS,IACxBD,EAASE,MAAMC,OAAOC,YACpB,MAAW,SAAXA,EAAEG,OACwB,UAAzB,OAAAC,EAAAJ,EAAEK,eAAF,EAAAD,EAAYE,WAA0D,KAAnC,OAAAC,EAAAP,EAAEK,eAAF,EAAAE,EAAYC,wBAG9CC,EAAgBZ,EAAS,IAAMK,EAASJ,MAAMY,OAAS,GAuGvDC,YAAcC,MAAOC,IACzB,GAAK3B,EAAKY,MAEV,IACE,MAAMgB,KAAEA,EAAMrB,MAAOsB,SAAmB/B,EAASgC,IAAI,4BAA6B,CAChFC,kBAAmBJ,IAGrB,GAAIE,EAAU,MAAMA,EAGpBzB,EAAeQ,MAAQR,EAAeQ,MAAMoB,IAAIlB,GAC9CA,EAAEmB,KAAON,EAAiB,IAAKb,EAAGC,OAAO,EAAMmB,cAAcC,MAAOC,eAAkBtB,GAIxFL,EAAcG,MAAQyB,KAAKC,IAAI,EAAG7B,EAAcG,MAAQ,EAC1D,OAAS2B,GACPC,QAAQjC,MAAM,2CAA4CgC,EAC5D,GAWIE,kBAAoBf,UACxB,GAAK1B,EAAKY,MAEV,IACE,MAAMgB,KAAEA,EAAMrB,MAAOsB,SAAmB/B,EAASgC,IAAI,sCAErD,GAAID,EAAU,MAAMA,EAUpB,OAPAzB,EAAeQ,MAAQR,EAAeQ,MAAMoB,IAAIlB,IAAA,IAC3CA,EACHC,OAAO,EACPmB,SAAUpB,EAAEoB,WAAA,IAAgBC,MAAOC,iBAErC3B,EAAcG,MAAQ,EAEf,CAAE8B,SAAS,EAAMC,UAAU,MAAAf,OAAA,EAAAA,EAAMe,WAAY,EACtD,OAASJ,GAEP,OADAC,QAAQjC,MAAM,wDAAyDgC,GAChE,CAAEG,SAAS,EAAOnC,MAAOgC,EAAEK,QACpC,GAWIC,eAAiBnB,UACrB,IAAK1B,EAAKY,MAAO,OAAO,EAExB,IACE,MAAMgB,KAAEA,EAAMrB,MAAOsB,SAAmB/B,EAASgC,IAAI,mCAErD,GAAID,EAAU,MAAMA,EAGpB,OADApB,EAAcG,MAAQgB,GAAQ,EACvBA,GAAQ,CACjB,OAASW,GAEP,OADAC,QAAQjC,MAAM,4CAA6CgC,GACpD,CACT,GAuIF,MAAO,CAELnC,iBACAK,gBACAH,UACAC,QAGAG,WACAM,WACAO,gBAGAuB,OAhUapB,MAAOqB,EAAiB,YAErC,MAAMC,EAAS9C,IACf,IAAK8C,EAGH,OAFAR,QAAQS,KAAK,6CACb1C,EAAMK,MAAQ,yBACP,GAGTN,EAAQM,OAAQ,EAChBL,EAAMK,MAAQ,KAEd,IAEE,MAAMgB,KAAEA,EAAMrB,MAAO2C,SAAqBpD,EACvCqD,KAAK,kBACLC,OAAO,KACPC,GAAG,aAAcL,GACjBM,MAAM,aAAc,CAAEC,WAAW,IACjCC,MAAMT,GAET,GAAIG,EAAY,CAEd,GAAwB,aAApBA,EAAWO,MAAuBP,EAAWN,QAAQc,SAAS,kBAIhE,OAHAlB,QAAQS,KAAK,4DACb7C,EAAeQ,MAAQ,GACvBH,EAAcG,MAAQ,EACf,GAET,MAAMsC,CACR,CAOA,OALA9C,EAAeQ,MAASgB,GAAQ,GAGhCnB,EAAcG,OAAUgB,GAAQ,IAAuBf,OAAOC,IAAOA,EAAU6C,QAAU7C,EAAEC,OAAOS,OAE1FI,GAAQ,EAClB,OAASW,GAMP,OAJK,OAAArB,EAAAqB,EAAEK,cAAF,EAAA1B,EAAWwC,SAAS,qBACvBnD,EAAMK,MAAQ2B,EAAEK,SAAW,iCAC3BJ,QAAQjC,MAAM,kCAAmCgC,IAE5C,EACT,CAAA,QACEjC,EAAQM,OAAQ,CAClB,GAkRAgD,MA5QYlC,MACZmC,EACAC,EACAC,EACA9C,EAAe,UACf+C,KAEA,IAAKhE,EAAKY,MAER,OADAL,EAAMK,MAAQ,yBACP,KAGTN,EAAQM,OAAQ,EAChBL,EAAMK,MAAQ,KAEd,IAEE,MAAMgB,KAAEA,EAAMrB,MAAO0D,SAAsBnE,EACxCqD,KAAK,kBACLe,OAAO,CACNC,WAAYN,EACZC,SACAC,UACA9C,OACAmD,cAAeJ,GAAgB,KAC/BL,OAAO,IAERP,SACAiB,SAEH,GAAIJ,EAAa,MAAMA,EAEvB,OAAOrC,CACT,OAASW,GAGP,OAFAhC,EAAMK,MAAQ2B,EAAEK,SAAW,8BAC3BJ,QAAQjC,MAAM,+BAAgCgC,GACvC,IACT,CAAA,QACEjC,EAAQM,OAAQ,CAClB,GAsOAa,wBACA6C,gBAxMsB7C,YAyMtBgB,oCACA8B,sBA3K4B9B,kBA4K5BI,8BACA2B,gBArJsB3B,eAsJtB4B,SAjJe/C,MAAOC,IACtB,GAAK3B,EAAKY,MAEV,IAEE,MAAQL,MAAOmE,SAAsB5E,EAClCqD,KAAK,kBACLwB,SACAtB,GAAG,KAAM1B,GACT0B,GAAG,aAAcrD,EAAKY,MAAMqB,IAE/B,GAAIyC,EAAa,MAAMA,EAGvB,MAAME,EAAwBxE,EAAeQ,MAAMiE,KAAK/D,GAAKA,EAAEmB,KAAON,IAClEiD,GAA0BA,EAAsB7D,OAAW6D,EAA8BjB,QAC3FlD,EAAcG,MAAQyB,KAAKC,IAAI,EAAG7B,EAAcG,MAAQ,IAG1DR,EAAeQ,MAAQR,EAAeQ,MAAMC,OAAOC,GAAKA,EAAEmB,KAAON,EACnE,OAASY,GACPC,QAAQjC,MAAM,kCAAmCgC,EACnD,GA4HAuC,eAtHqBpD,UACrB,GAAK1B,EAAKY,MAEV,IAEE,MAAQL,MAAOmE,SAAsB5E,EAClCqD,KAAK,kBACLwB,SACAtB,GAAG,aAAcrD,EAAKY,MAAMqB,IAC5BoB,GAAG,SAAS,GAEf,GAAIqB,EAAa,MAAMA,EAGvBtE,EAAeQ,MAAQR,EAAeQ,MAAMC,OAAOC,IAAMA,EAAEC,MAC7D,OAASwB,GACPC,QAAQjC,MAAM,2CAA4CgC,EAC5D,GAsGAwC,YAhGkB,KACb/E,EAAKY,QAASJ,EAAMI,QAEzBJ,EAAMI,MAAQd,EACXkF,QAAQ,kBAAkBhF,EAAKY,MAAMqB,MACrCgD,GACC,mBACA,CACEC,MAAO,SACPC,OAAQ,SACRC,MAAO,iBACPvE,OAAQ,iBAAiBb,EAAKY,MAAMqB,MAErCoD,UACC,MAAMC,EAAoBD,EAAQE,IAClCnF,EAAeQ,MAAM4E,QAAQF,GAC7B7E,EAAcG,QAGV,sBAAkB,GAAsC,YAA5B6E,aAAaC,YAC3C,IAAID,aAAaH,EAAkBxB,OAAQ,CACzC6B,KAAML,EAAkBvB,QACxB6B,KAAM,yBACNC,MAAkC,SAA3BP,EAAkBrE,MAA4D,UAAzC,OAAAC,IAAkBC,eAAlB,EAAAD,EAA4BE,UACpE,KAAO,SAKlB6D,GACC,mBACA,CACEC,MAAO,SACPC,OAAQ,SACRC,MAAO,iBACPvE,OAAQ,iBAAiBb,EAAKY,MAAMqB,MAErCoD,IACC,MAAMS,EAA0BT,EAAQE,IAClCQ,EAAQ3F,EAAeQ,MAAMoF,aAAelF,EAAEmB,KAAO6D,EAAwB7D,KACrE,IAAV8D,IACF3F,EAAeQ,MAAMmF,GAASD,KAInCG,cAoDHC,cA9CoBxE,UAChBlB,EAAMI,cAEFd,EAASqG,cAAc3F,EAAMI,OACnCJ,EAAMI,MAAQ,OA2ChBwF,gCA/BsC1E,UAClC,sBAAkB,GAAsC,YAA5B+D,aAAaC,kBACrCD,aAAaY"}