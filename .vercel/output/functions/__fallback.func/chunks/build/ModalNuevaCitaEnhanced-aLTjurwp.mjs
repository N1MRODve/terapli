import{e,v as t,s as a}from"./server.mjs";import{a as o,u as l}from"./usePacientes-Cr4i6x1S.mjs";import{u as r}from"./useSupabaseClient-DykwVqLQ.mjs";import{_ as n}from"./_plugin-vue_export-helper-1tPrXgE0.mjs";function t$4(e){"function"==typeof queueMicrotask?queueMicrotask(e):Promise.resolve().then(e).catch(e=>setTimeout(()=>{throw e}))}function o$3(){let e=[],t={addEventListener:(e,a,o,l)=>(e.addEventListener(a,o,l),t.add(()=>e.removeEventListener(a,o,l))),requestAnimationFrame(...e){let a=requestAnimationFrame(...e);t.add(()=>cancelAnimationFrame(a))},nextFrame(...e){t.requestAnimationFrame(()=>{t.requestAnimationFrame(...e)})},setTimeout(...e){let a=setTimeout(...e);t.add(()=>clearTimeout(a))},microTask(...e){let a={current:!0};return t$4(()=>{a.current&&e[0]()}),t.add(()=>{a.current=!1})},style(e,t,a){let o=e.style.getPropertyValue(t);return Object.assign(e.style,{[t]:a}),this.add(()=>{Object.assign(e.style,{[t]:o})})},group(e){let t=o$3();return e(t),this.add(()=>t.dispose())},add:t=>(e.push(t),()=>{let a=e.indexOf(t);if(a>=0)for(let t of e.splice(a,1))t()}),dispose(){for(let t of e.splice(0))t()}};return t}var s;let i=Symbol("headlessui.useid"),d=0;const u=null!=(s=t.useId)?s:function(){return t.inject(i,()=>""+ ++d)()};function o$1(e){var t;if(null==e||null==e.value)return null;let a=null!=(t=e.value.$el)?t:e.value;return a instanceof Node?a:null}function u$5(e,t,...a){if(e in t){let o=t[e];return"function"==typeof o?o(...a):o}let o=new Error(`Tried to handle "${e}" but there is no handler defined. Only defined handlers are: ${Object.keys(t).map(e=>`"${e}"`).join(", ")}.`);throw Error.captureStackTrace&&Error.captureStackTrace(o,u$5),o}var p=Object.defineProperty,n$3=(e,t,a)=>(((e,t,a)=>{t in e?p(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a})(e,"symbol"!=typeof t?t+"":t,a),a);let v=new class{constructor(){n$3(this,"current",this.detect()),n$3(this,"currentId",0)}set(e){this.current!==e&&(this.currentId=0,this.current=e)}reset(){this.set(this.detect())}nextId(){return++this.currentId}get isServer(){return"server"===this.current}get isClient(){return"client"===this.current}detect(){return"server"}};function i$3(e){if(v.isServer)return null;if(e instanceof Node)return e.ownerDocument;if(null!=e&&e.hasOwnProperty("value")){let t=o$1(e);if(t)return t.ownerDocument}}let f=["[contentEditable=true]","[tabindex]","a[href]","area[href]","button:not([disabled])","iframe","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].map(e=>`${e}:not([tabindex='-1'])`).join(",");var x,h,k,y=((k=y||{})[k.First=1]="First",k[k.Previous=2]="Previous",k[k.Next=4]="Next",k[k.Last=8]="Last",k[k.WrapAround=16]="WrapAround",k[k.NoScroll=32]="NoScroll",k),w=((h=w||{})[h.Error=0]="Error",h[h.Overflow=1]="Overflow",h[h.Success=2]="Success",h[h.Underflow=3]="Underflow",h),V=((x=V||{})[x.Previous=-1]="Previous",x[x.Next=1]="Next",x);var N=(e=>(e[e.Strict=0]="Strict",e[e.Loose=1]="Loose",e))(N||{});var _=(e=>(e[e.Keyboard=0]="Keyboard",e[e.Mouse=1]="Mouse",e))(_||{});function S$1(e){null==e||e.focus({preventScroll:!0})}let C=["textarea","input"].join(",");function P(e,t,{sorted:a=!0,relativeTo:o=null,skipElements:l=[]}={}){var r;let n=null!=(r=Array.isArray(e)?e.length>0?e[0].ownerDocument:void 0:null==e?void 0:e.ownerDocument)?r:void 0,s=Array.isArray(e)?a?function(e,t=e=>e){return e.slice().sort((e,a)=>{let o=t(e),l=t(a);if(null===o||null===l)return 0;let r=o.compareDocumentPosition(l);return r&Node.DOCUMENT_POSITION_FOLLOWING?-1:r&Node.DOCUMENT_POSITION_PRECEDING?1:0})}(e):e:function(e=(void 0).body){return null==e?[]:Array.from(e.querySelectorAll(f)).sort((e,t)=>Math.sign((e.tabIndex||Number.MAX_SAFE_INTEGER)-(t.tabIndex||Number.MAX_SAFE_INTEGER)))}(e);l.length>0&&s.length>1&&(s=s.filter(e=>!l.includes(e))),o=null!=o?o:n.activeElement;let i,d=(()=>{if(5&t)return 1;if(10&t)return-1;throw new Error("Missing Focus.First, Focus.Previous, Focus.Next or Focus.Last")})(),u=(()=>{if(1&t)return 0;if(2&t)return Math.max(0,s.indexOf(o))-1;if(4&t)return Math.max(0,s.indexOf(o))+1;if(8&t)return s.length-1;throw new Error("Missing Focus.First, Focus.Previous, Focus.Next or Focus.Last")})(),p=32&t?{preventScroll:!0}:{},v=0,x=s.length;do{if(v>=x||v+x<=0)return 0;let e=u+v;if(16&t)e=(e+x)%x;else{if(e<0)return 3;if(e>=x)return 1}i=s[e],null==i||i.focus(p),v+=d}while(i!==n.activeElement);return 6&t&&function(e){var t,a;return null!=(a=null==(t=null==e?void 0:e.matches)?void 0:t.call(e,C))&&a}(i)&&i.select(),2}function t$3(){return/iPhone/gi.test((void 0).navigator.platform)||/Mac/gi.test((void 0).navigator.platform)&&(void 0).navigator.maxTouchPoints>0}function u$4(e,a,o){v.isServer||t.watchEffect(t=>{(void 0).addEventListener(e,a,o),t(()=>(void 0).removeEventListener(e,a,o))})}function w$3(e,a,o){v.isServer||t.watchEffect(t=>{(void 0).addEventListener(e,a,o),t(()=>(void 0).removeEventListener(e,a,o))})}function w$2(e,a,o=t.computed(()=>!0)){function a2(t,l){if(!o.value||t.defaultPrevented)return;let r=l(t);if(null===r||!r.getRootNode().contains(r))return;let n=function o2(e){return"function"==typeof e?o2(e()):Array.isArray(e)||e instanceof Set?e:[e]}(e);for(let e of n){if(null===e)continue;let a=e instanceof HTMLElement?e:o$1(e);if(null!=a&&a.contains(r)||t.composed&&t.composedPath().includes(a))return}return!function(e,t=0){var a;return e!==(null==(a=i$3(e))?void 0:a.body)&&u$5(t,{0:()=>e.matches(f),1(){let t=e;for(;null!==t;){if(t.matches(f))return!0;t=t.parentElement}return!1}})}(r,N.Loose)&&-1!==r.tabIndex&&t.preventDefault(),a(t,r)}let l=t.ref(null);u$4("pointerdown",e=>{var t,a;o.value&&(l.value=(null==(a=null==(t=e.composedPath)?void 0:t.call(e))?void 0:a[0])||e.target)},!0),u$4("mousedown",e=>{var t,a;o.value&&(l.value=(null==(a=null==(t=e.composedPath)?void 0:t.call(e))?void 0:a[0])||e.target)},!0),u$4("click",e=>{t$3()||/Android/gi.test((void 0).navigator.userAgent)||l.value&&(a2(e,()=>l.value),l.value=null)},!0),u$4("touchend",e=>a2(e,()=>e.target instanceof HTMLElement?e.target:null),!0),w$3("blur",e=>a2(e,()=>(void 0).document.activeElement instanceof HTMLIFrameElement?(void 0).document.activeElement:null),!0)}var $,S=(e=>(e[e.None=0]="None",e[e.RenderStrategy=1]="RenderStrategy",e[e.Static=2]="Static",e))(S||{}),D=(($=D||{})[$.Unmount=0]="Unmount",$[$.Hidden=1]="Hidden",$);function A$2({visible:e=!0,features:t=0,ourProps:a,theirProps:o,...l}){var r;let n=j(o,a),s=Object.assign(l,{props:n});if(e||2&t&&n.static)return y$1(s);if(1&t){return u$5(null==(r=n.unmount)||r?0:1,{0:()=>null,1:()=>y$1({...l,props:{...n,hidden:!0,style:{display:"none"}}})})}return y$1(s)}function y$1({props:e,attrs:a,slots:o,slot:l,name:r}){var n,s;let{as:i,...d}=T$1(e,["unmount","static"]),u=null==(n=o.default)?void 0:n.call(o,l),p={};if(l){let e=!1,t=[];for(let[a,o]of Object.entries(l))"boolean"==typeof o&&(e=!0),!0===o&&t.push(a);e&&(p["data-headlessui-state"]=t.join(" "))}if("template"===i){if(u=b(null!=u?u:[]),Object.keys(d).length>0||Object.keys(a).length>0){let[e,...o]=null!=u?u:[];if(!function(e){return null!=e&&("string"==typeof e.type||"object"==typeof e.type||"function"==typeof e.type)}(e)||o.length>0)throw new Error(['Passing props on "template"!',"",`The current component <${r} /> is rendering a "template".`,"However we need to passthrough the following props:",Object.keys(d).concat(Object.keys(a)).map(e=>e.trim()).filter((e,t,a)=>a.indexOf(e)===t).sort((e,t)=>e.localeCompare(t)).map(e=>`  - ${e}`).join("\n"),"","You can apply a few solutions:",['Add an `as="..."` prop, to ensure that we render an actual element instead of a "template".',"Render a single element as the child so that we can forward the props onto that element."].map(e=>`  - ${e}`).join("\n")].join("\n"));let l=j(null!=(s=e.props)?s:{},d,p),n=t.cloneVNode(e,l,!0);for(let e in l)e.startsWith("on")&&(n.props||(n.props={}),n.props[e]=l[e]);return n}return Array.isArray(u)&&1===u.length?u[0]:u}return t.h(i,Object.assign({},d,p),{default:()=>u})}function b(e){return e.flatMap(e=>e.type===t.Fragment?b(e.children):[e])}function j(...e){if(0===e.length)return{};if(1===e.length)return e[0];let t={},a={};for(let o of e)for(let e in o)e.startsWith("on")&&"function"==typeof o[e]?(null!=a[e]||(a[e]=[]),a[e].push(o[e])):t[e]=o[e];if(t.disabled||t["aria-disabled"])return Object.assign(t,Object.fromEntries(Object.keys(a).map(e=>[e,void 0])));for(let e in a)Object.assign(t,{[e](t,...o){let l=a[e];for(let e of l){if(t instanceof Event&&t.defaultPrevented)return;e(t,...o)}}});return t}function T$1(e,t=[]){let a=Object.assign({},e);for(let e of t)e in a&&delete a[e];return a}var z=(e=>(e[e.None=1]="None",e[e.Focusable=2]="Focusable",e[e.Hidden=4]="Hidden",e))(z||{});let A=t.defineComponent({name:"Hidden",props:{as:{type:[Object,String],default:"div"},features:{type:Number,default:1}},setup:(e,{slots:t,attrs:a})=>()=>{var o;let{features:l,...r}=e;return A$2({ourProps:{"aria-hidden":!(2&~l)||(null!=(o=r["aria-hidden"])?o:void 0),hidden:!(4&~l)||void 0,style:{position:"fixed",top:1,left:1,width:1,height:0,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0",...!(4&~l)&&!!(2&~l)&&{display:"none"}}},theirProps:r,slot:{},attrs:a,slots:t,name:"Hidden"})}}),H=Symbol("Context");var F=(e=>(e[e.Open=1]="Open",e[e.Closed=2]="Closed",e[e.Closing=4]="Closing",e[e.Opening=8]="Opening",e))(F||{});function l$1(){return t.inject(H,null)}var U,I=((U=I||{}).Space=" ",U.Enter="Enter",U.Escape="Escape",U.Backspace="Backspace",U.Delete="Delete",U.ArrowLeft="ArrowLeft",U.ArrowUp="ArrowUp",U.ArrowRight="ArrowRight",U.ArrowDown="ArrowDown",U.Home="Home",U.End="End",U.PageUp="PageUp",U.PageDown="PageDown",U.Tab="Tab",U);let R=[];function E$1(e,a,o,l){v.isServer||t.watchEffect(t=>{(e=null!=e?e:void 0).addEventListener(a,o,l),t(()=>e.removeEventListener(a,o,l))})}var O=(e=>(e[e.Forwards=0]="Forwards",e[e.Backwards=1]="Backwards",e))(O||{});function B(e){if(!e)return new Set;if("function"==typeof e)return new Set(e());let t=new Set;for(let a of e.value){let e=o$1(a);e instanceof HTMLElement&&t.add(e)}return t}var q=(e=>(e[e.None=1]="None",e[e.InitialFocus=2]="InitialFocus",e[e.TabLock=4]="TabLock",e[e.FocusLock=8]="FocusLock",e[e.RestoreFocus=16]="RestoreFocus",e[e.All=30]="All",e))(q||{});let G=Object.assign(t.defineComponent({name:"FocusTrap",props:{as:{type:[Object,String],default:"div"},initialFocus:{type:Object,default:null},features:{type:Number,default:30},containers:{type:[Object,Function],default:t.ref(new Set)}},inheritAttrs:!1,setup(e,{attrs:a,slots:o,expose:l}){let r=t.ref(null);l({el:r,$el:r});let n=t.computed(()=>i$3(r)),s=t.ref(!1);!function({ownerDocument:e},a){!function(e){let a=t.ref(R.slice());t.watch([e],([e],[t])=>{!0===t&&!1===e?t$4(()=>{a.value.splice(0)}):!1===t&&!0===e&&(a.value=R.slice())},{flush:"post"})}(a)}({ownerDocument:n},t.computed(()=>s.value&&Boolean(16&e.features)));let i=function({ownerDocument:e,container:a,initialFocus:o}){let l=t.ref(null);return t.ref(!1),l}({ownerDocument:n,container:r,initialFocus:t.computed(()=>e.initialFocus)},t.computed(()=>s.value&&Boolean(2&e.features)));!function({ownerDocument:e,container:t,containers:a,previousActiveElement:o},l){var r;E$1(null==(r=e.value)?void 0:r.defaultView,"focus",e=>{if(!l.value)return;let r=B(a);o$1(t)instanceof HTMLElement&&r.add(o$1(t));let n=o.value;if(!n)return;let s=e.target;s&&s instanceof HTMLElement?N$2(r,s)?(o.value=s,S$1(s)):(e.preventDefault(),e.stopPropagation(),S$1(n)):S$1(o.value)},!0)}({ownerDocument:n,container:r,containers:e.containers,previousActiveElement:i},t.computed(()=>s.value&&Boolean(8&e.features)));let d=function(){let e=t.ref(0);return w$3("keydown",t=>{"Tab"===t.key&&(e.value=t.shiftKey?1:0)}),e}();function a2(e){let t=o$1(r);t&&u$5(d.value,{[O.Forwards]:()=>{P(t,y.First,{skipElements:[e.relatedTarget]})},[O.Backwards]:()=>{P(t,y.Last,{skipElements:[e.relatedTarget]})}})}let u=t.ref(!1);function F2(e){"Tab"===e.key&&(u.value=!0,requestAnimationFrame(()=>{u.value=!1}))}function H2(t){if(!s.value)return;let a=B(e.containers);o$1(r)instanceof HTMLElement&&a.add(o$1(r));let o=t.relatedTarget;o instanceof HTMLElement&&"true"!==o.dataset.headlessuiFocusGuard&&(N$2(a,o)||(u.value?P(o$1(r),u$5(d.value,{[O.Forwards]:()=>y.Next,[O.Backwards]:()=>y.Previous})|y.WrapAround,{relativeTo:t.target}):t.target instanceof HTMLElement&&S$1(t.target)))}return()=>{let l={ref:r,onKeydown:F2,onFocusout:H2},{features:n,initialFocus:s,containers:i,...d}=e;return t.h(t.Fragment,[Boolean(4&n)&&t.h(A,{as:"button",type:"button","data-headlessui-focus-guard":!0,onFocus:a2,features:z.Focusable}),A$2({ourProps:l,theirProps:{...a,...d},slot:{},attrs:a,slots:o,name:"FocusTrap"}),Boolean(4&n)&&t.h(A,{as:"button",type:"button","data-headlessui-focus-guard":!0,onFocus:a2,features:z.Focusable})])}}}),{features:q});function N$2(e,t){for(let a of e)if(a.contains(t))return!0;return!1}function c(){let e;return{before({doc:t}){var a;let o=t.documentElement;e=(null!=(a=t.defaultView)?a:void 0).innerWidth-o.clientWidth},after({doc:t,d:a}){let o=t.documentElement,l=o.clientWidth-o.offsetWidth,r=e-l;a.style(o,"paddingRight",`${r}px`)}}}function m(e){let t={};for(let a of e)Object.assign(t,a(t));return t}let Z=function(e,t){let a=e(),o=new Set;return{getSnapshot:()=>a,subscribe:e=>(o.add(e),()=>o.delete(e)),dispatch(e,...l){let r=t[e].call(a,...l);r&&(a=r,o.forEach(e=>e()))}}}(()=>new Map,{PUSH(e,t){var a;let o=null!=(a=this.get(e))?a:{doc:e,count:0,d:o$3(),meta:new Set};return o.count++,o.meta.add(t),this.set(e,o),this},POP(e,t){let a=this.get(e);return a&&(a.count--,a.meta.delete(t)),this},SCROLL_PREVENT({doc:e,d:t,meta:a}){let o={doc:e,d:t,meta:m(a)},l=[t$3()?{before({doc:e,d:t,meta:a}){function a2(e){return a.containers.flatMap(e=>e()).some(t=>t.contains(e))}t.microTask(()=>{var a;if("auto"!==(void 0).getComputedStyle(e.documentElement).scrollBehavior){let a=o$3();a.style(e.documentElement,"scrollBehavior","auto"),t.add(()=>t.microTask(()=>a.dispose()))}let o=null!=(a=(void 0).scrollY)?a:(void 0).pageYOffset,l=null;t.addEventListener(e,"click",t=>{if(t.target instanceof HTMLElement)try{let a=t.target.closest("a");if(!a)return;let{hash:o}=new URL(a.href),r=e.querySelector(o);r&&!a2(r)&&(l=r)}catch{}},!0),t.addEventListener(e,"touchstart",e=>{if(e.target instanceof HTMLElement)if(a2(e.target)){let a=e.target;for(;a.parentElement&&a2(a.parentElement);)a=a.parentElement;t.style(a,"overscrollBehavior","contain")}else t.style(e.target,"touchAction","none")}),t.addEventListener(e,"touchmove",e=>{if(e.target instanceof HTMLElement){if("INPUT"===e.target.tagName)return;if(a2(e.target)){let t=e.target;for(;t.parentElement&&""!==t.dataset.headlessuiPortal&&!(t.scrollHeight>t.clientHeight||t.scrollWidth>t.clientWidth);)t=t.parentElement;""===t.dataset.headlessuiPortal&&e.preventDefault()}else e.preventDefault()}},{passive:!1}),t.add(()=>{var e;let t=null!=(e=(void 0).scrollY)?e:(void 0).pageYOffset;o!==t&&(void 0).scrollTo(0,o),l&&l.isConnected&&(l.scrollIntoView({block:"nearest"}),l=null)})})}}:{},c(),{before({doc:e,d:t}){t.style(e.documentElement,"overflow","hidden")}}];l.forEach(({before:e})=>null==e?void 0:e(o)),l.forEach(({after:e})=>null==e?void 0:e(o))},SCROLL_ALLOW({d:e}){e.dispose()},TEARDOWN({doc:e}){this.delete(e)}});function d$1(e,a,o){let l=function(e){return t.shallowRef(e.getSnapshot())}(Z),r=t.computed(()=>{let t=e.value?l.value.get(e.value):void 0;return!!t&&t.count>0});return t.watch([e,a],([e,t],[a],l)=>{if(!e||!t)return;Z.dispatch("PUSH",e,o);let r=!1;l(()=>{r||(Z.dispatch("POP",null!=a?a:e,o),r=!0)})},{immediate:!0}),r}Z.subscribe(()=>{let e=Z.getSnapshot(),t=new Map;for(let[a]of e)t.set(a,a.documentElement.style.overflow);for(let a of e.values()){let e="hidden"===t.get(a.doc),o=0!==a.count;(o&&!e||!o&&e)&&Z.dispatch(a.count>0?"SCROLL_PREVENT":"SCROLL_ALLOW",a),0===a.count&&Z.dispatch("TEARDOWN",a)}});let W=new Map,Y=new Map;function E(e,a=t.ref(!0)){t.watchEffect(t=>{var o;if(!a.value)return;let l=o$1(e);if(!l)return;t(function(){var e;if(!l)return;let t=null!=(e=Y.get(l))?e:1;if(1===t?Y.delete(l):Y.set(l,t-1),1!==t)return;let a=W.get(l);a&&(null===a["aria-hidden"]?l.removeAttribute("aria-hidden"):l.setAttribute("aria-hidden",a["aria-hidden"]),l.inert=a.inert,W.delete(l))});let r=null!=(o=Y.get(l))?o:0;Y.set(l,r+1),0===r&&(W.set(l,{"aria-hidden":l.getAttribute("aria-hidden"),inert:l.inert}),l.setAttribute("aria-hidden","true"),l.inert=!0)})}let K=Symbol("ForcePortalRootContext");let X=t.defineComponent({name:"ForcePortalRoot",props:{as:{type:[Object,String],default:"template"},force:{type:Boolean,default:!1}},setup:(e,{slots:a,attrs:o})=>(t.provide(K,e.force),()=>{let{force:t,...l}=e;return A$2({theirProps:l,ourProps:{},slot:{},slots:a,attrs:o,name:"ForcePortalRoot"})})}),J=Symbol("StackContext");var ee=(e=>(e[e.Add=0]="Add",e[e.Remove=1]="Remove",e))(ee||{});function R$1({type:e,enabled:a,element:o,onUpdate:l}){let r=t.inject(J,()=>{});t.provide(J,function(...e){null==l||l(...e),r(...e)})}let te=Symbol("DescriptionContext");t.defineComponent({name:"Description",props:{as:{type:[Object,String],default:"p"},id:{type:String,default:null}},setup(e,{attrs:a,slots:o}){var l;let r=null!=(l=e.id)?l:`headlessui-description-${u()}`,n=function(){let e=t.inject(te,null);if(null===e)throw new Error("Missing parent");return e}();return()=>{let{name:l="Description",slot:s=t.ref({}),props:i={}}=n,{...d}=e;return A$2({ourProps:{...Object.entries(i).reduce((e,[a,o])=>Object.assign(e,{[a]:t.unref(o)}),{}),id:r},theirProps:d,slot:s.value,attrs:a,slots:o,name:l})}}});const ae=new WeakMap;function M(e,t){let a=t(function(e){var t;return null!=(t=ae.get(e))?t:0}(e));return a<=0?ae.delete(e):ae.set(e,a),a}let oe=t.defineComponent({name:"Portal",props:{as:{type:[Object,String],default:"div"}},setup(e,{slots:a,attrs:o}){let l=t.ref(null);t.computed(()=>i$3(l));let r=t.inject(K,!1),n=t.inject(re,null),s=t.ref(!0===r||null==n?function(e){let t=i$3(e);if(!t){if(null===e)return null;throw new Error(`[Headless UI]: Cannot find ownerDocument for contextElement: ${e}`)}let a=t.getElementById("headlessui-portal-root");if(a)return a;let o=t.createElement("div");return o.setAttribute("id","headlessui-portal-root"),t.body.appendChild(o)}(l.value):n.resolveTarget());s.value&&M(s.value,e=>e+1);let i=t.ref(!1);t.watchEffect(()=>{r||null!=n&&(s.value=n.resolveTarget())});let d=t.inject(le,null),u=!1;return t.getCurrentInstance(),t.watch(l,()=>{if(u||!d)return;o$1(l)&&(u=!0)}),()=>{if(!i.value||null===s.value)return null;let r={ref:l,"data-headlessui-portal":""};return t.h(t.Teleport,{to:s.value},A$2({ourProps:r,theirProps:e,slot:{},attrs:o,slots:a,name:"Portal"}))}}}),le=Symbol("PortalParentContext");let re=Symbol("PortalGroupContext"),ne=t.defineComponent({name:"PortalGroup",props:{as:{type:[Object,String],default:"template"},target:{type:Object,default:null}},setup(e,{attrs:a,slots:o}){let l=t.reactive({resolveTarget:()=>e.target});return t.provide(re,l),()=>{let{target:t,...l}=e;return A$2({theirProps:l,ourProps:{},slot:{},attrs:a,slots:o,name:"PortalGroup"})}}});var se,ie=((se=ie||{})[se.Open=0]="Open",se[se.Closed=1]="Closed",se);let ce=Symbol("DialogContext");function T(e){let a=t.inject(ce,null);if(null===a){let t=new Error(`<${e} /> is missing a parent <Dialog /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(t,T),t}return a}let de="DC8F892D-2EBD-447C-A4C8-A03058436FF4",ue=t.defineComponent({name:"Dialog",inheritAttrs:!1,props:{as:{type:[Object,String],default:"div"},static:{type:Boolean,default:!1},unmount:{type:Boolean,default:!0},open:{type:[Boolean,String],default:de},initialFocus:{type:Object,default:null},id:{type:String,default:null},role:{type:String,default:"dialog"}},emits:{close:e=>!0},setup(e,{emit:a,attrs:o,slots:l,expose:r}){var n,s;let i=null!=(n=e.id)?n:`headlessui-dialog-${u()}`,d=t.ref(!1),p=!1,v=t.computed(()=>"dialog"===e.role||"alertdialog"===e.role?e.role:(p||(p=!0,console.warn(`Invalid role [${v}] passed to <Dialog />. Only \`dialog\` and and \`alertdialog\` are supported. Using \`dialog\` instead.`)),"dialog")),f=t.ref(0),x=l$1(),h=t.computed(()=>e.open===de&&null!==x?(x.value&F.Open)===F.Open:e.open),k=t.ref(null),y=t.computed(()=>i$3(k));if(r({el:k,$el:k}),e.open===de&&null===x)throw new Error("You forgot to provide an `open` prop to the `Dialog`.");if("boolean"!=typeof h.value)throw new Error(`You provided an \`open\` prop to the \`Dialog\`, but the value is not a boolean. Received: ${h.value===de?void 0:e.open}`);let w=t.computed(()=>d.value&&h.value?0:1),V=t.computed(()=>0===w.value),N=t.computed(()=>f.value>1),_=null!==t.inject(ce,null),[C,$]=function(){let e=t.inject(le,null),a=t.ref([]);function r2(t){let o=a.value.indexOf(t);-1!==o&&a.value.splice(o,1),e&&e.unregister(t)}let o={register:function(t){return a.value.push(t),e&&e.register(t),()=>r2(t)},unregister:r2,portals:a};return[a,t.defineComponent({name:"PortalWrapper",setup:(e,{slots:a})=>(t.provide(le,o),()=>{var e;return null==(e=a.default)?void 0:e.call(a)})})]}(),{resolveContainers:D,mainTreeNodeRef:H,MainTreeNode:U}=function({defaultContainers:e=[],portals:a,mainTreeNodeRef:o}={}){let l=t.ref(null),r=i$3(l);function u2(){var t,o,n;let s=[];for(let t of e)null!==t&&(t instanceof HTMLElement?s.push(t):"value"in t&&t.value instanceof HTMLElement&&s.push(t.value));if(null!=a&&a.value)for(let e of a.value)s.push(e);for(let e of null!=(t=null==r?void 0:r.querySelectorAll("html > *, body > *"))?t:[])e!==(void 0).body&&e!==(void 0).head&&e instanceof HTMLElement&&"headlessui-portal-root"!==e.id&&(e.contains(o$1(l))||e.contains(null==(n=null==(o=o$1(l))?void 0:o.getRootNode())?void 0:n.host)||s.some(t=>e.contains(t))||s.push(e));return s}return{resolveContainers:u2,contains:e=>u2().some(t=>t.contains(e)),mainTreeNodeRef:l,MainTreeNode:()=>null!=o?null:t.h(A,{features:z.Hidden,ref:l})}}({portals:C,defaultContainers:[t.computed(()=>{var e;return null!=(e=ae.panelRef.value)?e:k.value})]}),R=t.computed(()=>N.value?"parent":"leaf"),O=t.computed(()=>null!==x&&(x.value&F.Closing)===F.Closing),q=t.computed(()=>!_&&!O.value&&V.value),Z=t.computed(()=>{var e,t,a;return null!=(a=Array.from(null!=(t=null==(e=y.value)?void 0:e.querySelectorAll("body > *"))?t:[]).find(e=>"headlessui-portal-root"!==e.id&&(e.contains(o$1(H))&&e instanceof HTMLElement)))?a:null});E(Z,q);let W=t.computed(()=>!!N.value||V.value),Y=t.computed(()=>{var e,t,a;return null!=(a=Array.from(null!=(t=null==(e=y.value)?void 0:e.querySelectorAll("[data-headlessui-portal]"))?t:[]).find(e=>e.contains(o$1(H))&&e instanceof HTMLElement))?a:null});E(Y,W),R$1({type:"Dialog",enabled:t.computed(()=>0===w.value),element:k,onUpdate:(e,t)=>{if("Dialog"===t)return u$5(e,{[ee.Add]:()=>f.value+=1,[ee.Remove]:()=>f.value-=1})}});let K=function({slot:e=t.ref({}),name:a="Description",props:o={}}={}){let l=t.ref([]);return t.provide(te,{register:function(e){return l.value.push(e),()=>{let t=l.value.indexOf(e);-1!==t&&l.value.splice(t,1)}},slot:e,name:a,props:o}),t.computed(()=>l.value.length>0?l.value.join(" "):void 0)}({name:"DialogDescription",slot:t.computed(()=>({open:h.value}))}),J=t.ref(null),ae={titleId:J,panelRef:t.ref(null),dialogState:w,setTitleId(e){J.value!==e&&(J.value=e)},close(){a("close",!1)}};t.provide(ce,ae);let re=t.computed(()=>!(!V.value||N.value));w$2(D,(e,a)=>{e.preventDefault(),ae.close(),t.nextTick(()=>null==a?void 0:a.focus())},re);let se=t.computed(()=>!(N.value||0!==w.value));E$1(null==(s=y.value)?void 0:s.defaultView,"keydown",e=>{se.value&&(e.defaultPrevented||e.key===I.Escape&&(e.preventDefault(),e.stopPropagation(),ae.close()))});let ie=t.computed(()=>!(O.value||0!==w.value||_));return d$1(y,ie,e=>{var t;return{containers:[...null!=(t=e.containers)?t:[],D]}}),t.watchEffect(e=>{if(0!==w.value)return;let t=o$1(k);if(!t)return;let a=new ResizeObserver(e=>{for(let t of e){let e=t.target.getBoundingClientRect();0===e.x&&0===e.y&&0===e.width&&0===e.height&&ae.close()}});a.observe(t),e(()=>a.disconnect())}),()=>{let{open:a,initialFocus:r,...n}=e,s={...o,ref:k,id:i,role:v.value,"aria-modal":0===w.value||void 0,"aria-labelledby":J.value,"aria-describedby":K.value},d={open:0===w.value};return t.h(X,{force:!0},()=>[t.h(oe,()=>t.h(ne,{target:k.value},()=>t.h(X,{force:!1},()=>t.h(G,{initialFocus:r,containers:D,features:V.value?u$5(R.value,{parent:G.features.RestoreFocus,leaf:G.features.All&~G.features.FocusLock}):G.features.None},()=>t.h($,{},()=>A$2({ourProps:s,theirProps:{...n,...o},slot:d,attrs:o,slots:l,visible:0===w.value,features:S.RenderStrategy|S.Static,name:"Dialog"})))))),t.h(U)])}}});t.defineComponent({name:"DialogOverlay",props:{as:{type:[Object,String],default:"div"},id:{type:String,default:null}},setup(e,{attrs:t,slots:a}){var o;let l=null!=(o=e.id)?o:`headlessui-dialog-overlay-${u()}`,r=T("DialogOverlay");function n2(e){e.target===e.currentTarget&&(e.preventDefault(),e.stopPropagation(),r.close())}return()=>{let{...o}=e;return A$2({ourProps:{id:l,"aria-hidden":!0,onClick:n2},theirProps:o,slot:{open:0===r.dialogState.value},attrs:t,slots:a,name:"DialogOverlay"})}}}),t.defineComponent({name:"DialogBackdrop",props:{as:{type:[Object,String],default:"div"},id:{type:String,default:null}},inheritAttrs:!1,setup(e,{attrs:a,slots:o,expose:l}){var r;let n=null!=(r=e.id)?r:`headlessui-dialog-backdrop-${u()}`,s=T("DialogBackdrop"),i=t.ref(null);return l({el:i,$el:i}),()=>{let{...l}=e,r={id:n,ref:i,"aria-hidden":!0};return t.h(X,{force:!0},()=>t.h(oe,()=>A$2({ourProps:r,theirProps:{...a,...l},slot:{open:0===s.dialogState.value},attrs:a,slots:o,name:"DialogBackdrop"})))}}});let pe=t.defineComponent({name:"DialogPanel",props:{as:{type:[Object,String],default:"div"},id:{type:String,default:null}},setup(e,{attrs:t,slots:a,expose:o}){var l;let r=null!=(l=e.id)?l:`headlessui-dialog-panel-${u()}`,n=T("DialogPanel");function u2(e){e.stopPropagation()}return o({el:n.panelRef,$el:n.panelRef}),()=>{let{...o}=e;return A$2({ourProps:{id:r,ref:n.panelRef,onClick:u2},theirProps:o,slot:{open:0===n.dialogState.value},attrs:t,slots:a,name:"DialogPanel"})}}}),ve=t.defineComponent({name:"DialogTitle",props:{as:{type:[Object,String],default:"h2"},id:{type:String,default:null}},setup(e,{attrs:t,slots:a}){var o;let l=null!=(o=e.id)?o:`headlessui-dialog-title-${u()}`,r=T("DialogTitle");return()=>{let{...o}=e;return A$2({ourProps:{id:l},theirProps:o,slot:{open:0===r.dialogState.value},attrs:t,slots:a,name:"DialogTitle"})}}});function g(e=""){return e.split(/\s+/).filter(e=>e.length>1)}let me=Symbol("TransitionContext");var fe,be=((fe=be||{}).Visible="visible",fe.Hidden="hidden",fe);let xe=Symbol("NestingContext");function L(e){return"children"in e?L(e.children):e.value.filter(({state:e})=>"visible"===e).length>0}function Q(e){let a=t.ref([]),o=t.ref(!1);function s3(t,l=D.Hidden){let r=a.value.findIndex(({id:e})=>e===t);-1!==r&&(u$5(l,{[D.Unmount](){a.value.splice(r,1)},[D.Hidden](){a.value[r].state="hidden"}}),!L(a)&&o.value&&(null==e||e()))}return{children:a,register:function(e){let t=a.value.find(({id:t})=>t===e);return t?"visible"!==t.state&&(t.state="visible"):a.value.push({id:e,state:"visible"}),()=>s3(e,D.Unmount)},unregister:s3}}let he=S.RenderStrategy,ge=t.defineComponent({props:{as:{type:[Object,String],default:"div"},show:{type:[Boolean],default:null},unmount:{type:[Boolean],default:!0},appear:{type:[Boolean],default:!1},enter:{type:[String],default:""},enterFrom:{type:[String],default:""},enterTo:{type:[String],default:""},entered:{type:[String],default:""},leave:{type:[String],default:""},leaveFrom:{type:[String],default:""},leaveTo:{type:[String],default:""}},emits:{beforeEnter:()=>!0,afterEnter:()=>!0,beforeLeave:()=>!0,afterLeave:()=>!0},setup(e,{emit:a,attrs:o,slots:l,expose:r}){let n=t.ref(0);function r2(){n.value|=F.Opening,a("beforeEnter")}function l2(){n.value&=~F.Opening,a("afterEnter")}function f2(){n.value|=F.Closing,a("beforeLeave")}function S$12(){n.value&=~F.Closing,a("afterLeave")}if(null===t.inject(me,null)&&null!==l$1())return()=>t.h(ye,{...e,onBeforeEnter:r2,onAfterEnter:l2,onBeforeLeave:f2,onAfterLeave:S$12},l);let s=t.ref(null),i=t.computed(()=>e.unmount?D.Unmount:D.Hidden);r({el:s,$el:s});let{show:d,appear:p}=function(){let e=t.inject(me,null);if(null===e)throw new Error("A <TransitionChild /> is used but it is missing a parent <TransitionRoot />.");return e}(),{register:f,unregister:x}=function(){let e=t.inject(xe,null);if(null===e)throw new Error("A <TransitionChild /> is used but it is missing a parent <TransitionRoot />.");return e}(),h=t.ref(d.value?"visible":"hidden"),k=u(),y=Q(()=>{"hidden"!==h.value&&(h.value="hidden",x(k),S$12())});t.watchEffect(()=>{if(i.value===D.Hidden&&k){if(d.value&&"visible"!==h.value)return void(h.value="visible");u$5(h.value,{hidden:()=>x(k),visible:()=>f(k)})}});let w=g(e.enter),V=g(e.enterFrom);return g(e.enterTo),g(e.entered),g(e.leave),g(e.leaveFrom),g(e.leaveTo),t.provide(xe,y),function(e){t.provide(H,e)}(t.computed(()=>u$5(h.value,{visible:F.Open,hidden:F.Closed})|n.value)),()=>{let{appear:a,show:r,enter:n,enterFrom:i,enterTo:u,entered:f,leave:x,leaveFrom:k,leaveTo:y,...N}=e,_={ref:s};return A$2({theirProps:{...N,...p.value&&d.value&&v.isServer?{class:t.normalizeClass([o.class,N.class,...w,...V])}:{}},ourProps:_,slot:{},slots:l,attrs:o,features:he,visible:"visible"===h.value,name:"TransitionChild"})}}}),ke=ge,ye=t.defineComponent({inheritAttrs:!1,props:{as:{type:[Object,String],default:"div"},show:{type:[Boolean],default:null},unmount:{type:[Boolean],default:!0},appear:{type:[Boolean],default:!1},enter:{type:[String],default:""},enterFrom:{type:[String],default:""},enterTo:{type:[String],default:""},entered:{type:[String],default:""},leave:{type:[String],default:""},leaveFrom:{type:[String],default:""},leaveTo:{type:[String],default:""}},emits:{beforeEnter:()=>!0,afterEnter:()=>!0,beforeLeave:()=>!0,afterLeave:()=>!0},setup(e,{emit:a,attrs:o,slots:l}){let r=l$1(),n=t.computed(()=>null===e.show&&null!==r?(r.value&F.Open)===F.Open:e.show);t.watchEffect(()=>{if(![!0,!1].includes(n.value))throw new Error('A <Transition /> is used but it is missing a `:show="true | false"` prop.')});let s=t.ref(n.value?"visible":"hidden"),i=Q(()=>{s.value="hidden"}),d=t.ref(!0),u={show:n,appear:t.computed(()=>e.appear||!d.value)};return t.provide(xe,i),t.provide(me,u),()=>{let r=T$1(e,["show","appear","unmount","onBeforeEnter","onBeforeLeave","onAfterEnter","onAfterLeave"]),n={unmount:e.unmount};return A$2({ourProps:{...n,as:"template"},theirProps:{},slot:{},slots:{...l,default:()=>[t.h(ke,{onBeforeEnter:()=>a("beforeEnter"),onAfterEnter:()=>a("afterEnter"),onBeforeLeave:()=>a("beforeLeave"),onAfterLeave:()=>a("afterLeave"),...o,...n,...r},l.default)]},attrs:{},features:he,visible:"visible"===s.value,name:"Transition"})}}});const we={pending:["confirmed","canceled"],confirmed:["completed","canceled"],completed:[],canceled:[]},Ve={pendiente:"pending",confirmada:"confirmed",realizada:"completed",completada:"completed",cancelada:"canceled"},Ne={pending:"pendiente",confirmed:"confirmada",completed:"realizada",canceled:"cancelada"};function formatValidationError(e){if(e.valid)return"";let t=e.error||"Error de validaciÃ³n desconocido";if(e.details){const a=e.details;if(a.conflictingAppointment){const e=a.conflictingAppointment;t+=`\n\nCita existente:\n- Hora: ${e.hora_inicio} - ${e.hora_fin}`}a.duration&&(t+=`\n\nDuraciÃ³n: ${a.duration} minutos`)}return t}function useAgendaEnhanced(){const a=r();e();const l=t.ref([]),n=t.ref(!1),s=t.ref(null),i=t.ref(null),d=t.ref(new Map);async function validateAppointment(e){try{o.debug("api_error","Validando cita",e);const t=await $fetch("/api/appointments/validate-conflict",{method:"POST",body:e});return t.valid?(o.info("api_error","ValidaciÃ³n exitosa"),{valid:!0}):(o.warn("conflict","ValidaciÃ³n fallida",t),t)}catch(e){return o.error("api_error","Error validando cita",e),{valid:!1,error:e.data?.message||e.message||"Error al validar cita",errorCode:"VALIDATION_ERROR"}}}async function updateAppointment(e){try{n.value=!0,s.value=null;const t=e.id,a=l.value.findIndex(e=>e.id===t);if(-1===a)throw new Error("Cita no encontrada");const r={...l.value[a]};d.value.set(t,r);const u={};e.fecha_cita&&(u.fecha_cita=e.fecha_cita),e.hora_inicio&&(u.hora_inicio=e.hora_inicio),e.hora_fin&&(u.hora_fin=e.hora_fin),e.estado&&(u.estado=e.estado),e.modalidad&&(u.modalidad=e.modalidad),l.value[a]={...l.value[a],...u},o.optimisticUpdate(t,"update");if(e.fecha_cita||e.hora_inicio||e.hora_fin){const n={id:t,fecha_cita:e.fecha_cita||r.fecha_cita,hora_inicio:e.hora_inicio||r.hora_inicio,hora_fin:e.hora_fin||r.hora_fin,terapeuta_id:r.terapeuta_id,estado:e.estado||r.estado,previous_estado:r.estado},i=await validateAppointment(n);if(!i.valid){l.value[a]=r,d.value.delete(t);const e=formatValidationError(i);return s.value=e,o.rollback(t,e),{success:!1,error:e}}}const p=await $fetch(`/api/appointments/${t}/update`,{method:"PATCH",body:e});if(!p.success)throw l.value[a]=r,d.value.delete(t),o.rollback(t,p.message||"Error desconocido"),new Error(p.message||"Error al actualizar cita");const v=p.data;return l.value[a]=v,d.value.delete(t),o.update(t,e),i.value=new Date,{success:!0,data:v}}catch(t){const a=t.data?.message||t.message||"Error al actualizar la cita";s.value=a,o.error("api_error",a,t);const r=e.id,n=d.value.get(r);if(n){const e=l.value.findIndex(e=>e.id===r);-1!==e&&(l.value[e]=n),d.value.delete(r),o.rollback(r,a)}return{success:!1,error:a}}finally{n.value=!1}}function mapViewDataToCita(e){return{id:e.cita_id,fecha_cita:e.fecha_cita,hora_inicio:e.hora_inicio,hora_fin:e.hora_fin,duracion_minutos:e.duracion_minutos||60,estado:e.estado,modalidad:e.modalidad,observaciones:e.observaciones,notas_terapeuta:e.notas_terapeuta,enlace_videollamada:e.enlace_videollamada,paciente_id:e.paciente_id,terapeuta_id:e.terapeuta_id,bono_id:e.bono_id,sesion_descontada:e.sesion_descontada||!1,consumo_registrado:e.consumo_registrado||!1,ubicacion:e.ubicacion,descontar_de_bono:e.descontar_de_bono,paciente:{id:e.paciente_id,nombre_completo:e.paciente_nombre||"Sin nombre",telefono:e.paciente_telefono,email:e.paciente_email},bono:e.bono_id?{id:e.bono_id,sesiones_restantes:e.bono_sesiones_restantes||0,sesiones_totales:e.bono_sesiones_totales||0,estado:e.bono_estado||"activo"}:void 0}}async function loadAppointmentsInRange(e,t){try{n.value=!0,s.value=null;const{data:r,error:d}=await a.from("vista_agenda_terapeutas").select("*").gte("fecha_cita",e).lte("fecha_cita",t).order("fecha_cita",{ascending:!0}).order("hora_inicio",{ascending:!0});if(d)throw d;l.value=(r||[]).map(mapViewDataToCita),o.loadRange(e,t,l.value.length),i.value=new Date}catch(e){const t=e.message||"Error al cargar citas";s.value=t,o.error("api_error",t,e)}finally{n.value=!1}}const u=t.computed(()=>null!==s.value),p=t.computed(()=>n.value),v=t.computed(()=>{if(!i.value)return null;const e=(new Date).getTime()-i.value.getTime(),t=Math.floor(e/1e3);if(t<60)return`Actualizado hace ${t}s`;const a=Math.floor(t/60);if(a<60)return`Actualizado hace ${a}m`;return`Actualizado hace ${Math.floor(a/60)}h`}),f=t.computed(()=>{const e=(new Date).toISOString().split("T")[0];return l.value.filter(t=>t.fecha_cita===e)}),x=t.computed(()=>l.value.filter(e=>"pendiente"===e.estado)),h=t.computed(()=>l.value.filter(e=>"completada"===e.estado||"realizada"===e.estado)),k=t.computed(()=>l.value.filter(e=>{if(!e.bono)return!1;const t=e.bono.sesiones_restantes||0;return t>0&&t<=2}));return{citas:l,loading:p,error:u,lastUpdateTime:v,citasDelDia:f,citasPendientes:x,citasCompletadas:h,citasConBonoProximoAgotar:k,validateAppointment:validateAppointment,createAppointment:async function(e){try{n.value=!0,s.value=null,o.clickCreate(e.fecha_cita,e.hora_inicio);const t=await validateAppointment(e);if(!t.valid){const e=formatValidationError(t);return s.value=e,{success:!1,error:e}}const a=await $fetch("/api/appointments/create",{method:"POST",body:e});if(!a.success)throw new Error(a.message||"Error al crear cita");const r=a.data;return l.value.push(r),o.create(r.id,e.fecha_cita,e.hora_inicio),i.value=new Date,{success:!0,data:r}}catch(e){const t=e.data?.message||e.message||"Error al crear la cita";return s.value=t,o.error("api_error",t,e),{success:!1,error:t}}finally{n.value=!1}},updateAppointment:updateAppointment,deleteAppointment:async function(e){try{n.value=!0,s.value=null,o.info("delete",`Eliminando cita ${e}`);const t=l.value.findIndex(t=>t.id===e);if(-1===t)throw new Error("Cita no encontrada");const r=l.value[t];if(r.bono_id&&r.sesion_descontada){const{error:t}=await a.rpc("reintegrar_sesion_bono",{p_cita_id:e});t&&o.warn("delete",`No se pudo reintegrar sesiÃ³n del bono: ${t.message}`)}const{error:d}=await a.from("citas").delete().eq("id",e);if(d)throw d;return l.value.splice(t,1),o.info("delete",`Cita ${e} eliminada correctamente`),i.value=new Date,{success:!0}}catch(e){const t=e.message||"Error al eliminar la cita";return s.value=t,o.error("api_error",t,e),{success:!1,error:t}}finally{n.value=!1}},moveAppointment:async function(e,t,a,r){const n=l.value.find(t=>t.id===e);if(!n)return{success:!1,error:"Cita no encontrada"};let s=r;if(!s){const[e,t]=n.hora_inicio.split(":").map(Number),[o,l]=n.hora_fin.split(":").map(Number),r=60*o+l-(60*e+t),[i,d]=a.split(":").map(Number),u=60*i+d+r,p=Math.floor(u/60),v=u%60;s=`${String(p).padStart(2,"0")}:${String(v).padStart(2,"0")}`}o.dragStart(e,{date:n.fecha_cita,time:n.hora_inicio});const i=await updateAppointment({id:e,fecha_cita:t,hora_inicio:a,hora_fin:s});return o.dragEnd(e,{date:t,time:a},i.success),i.success&&o.move(e,{date:n.fecha_cita,time:n.hora_inicio},{date:t,time:a}),i},changeAppointmentStatus:async function(e,t){const a=l.value.find(t=>t.id===e);if(!a)return{success:!1,error:"Cita no encontrada"};const r=function(e,t){const a=Ve[t]||t,o=we[Ve[e]||e];if(!o)return{valid:!1,error:`Estado inicial invÃ¡lido: ${e}`,errorCode:"INVALID_INITIAL_STATE"};if(!o.includes(a))return{valid:!1,error:`No se puede cambiar de "${e}" a "${t}". Transiciones permitidas: ${o.map(e=>Ne[e]).join(", ")}`,errorCode:"INVALID_STATE_TRANSITION",details:{from:e,to:t,allowedTransitions:o}};return{valid:!0}}(a.estado,t);if(!r.valid){const e=r.error||"TransiciÃ³n de estado invÃ¡lida";return s.value=e,{success:!1,error:e}}return o.statusChange(e,a.estado,t),await updateAppointment({id:e,estado:t})},loadAppointmentsInRange:loadAppointmentsInRange,loadTerapeutaAppointments:async function(){try{n.value=!0,s.value=null;const{data:e,error:t}=await a.from("vista_agenda_terapeutas").select("*").order("fecha_cita",{ascending:!0}).order("hora_inicio",{ascending:!0});if(t)throw t;l.value=(e||[]).map(mapViewDataToCita),o.info("load_range",`Citas del terapeuta cargadas: ${l.value.length}`),i.value=new Date}catch(e){const t=e.message||"Error al cargar citas";s.value=t,o.error("api_error",t,e)}finally{n.value=!1}},loadAllAppointments:async function(){try{n.value=!0,s.value=null;const{data:e,error:t}=await a.from("vista_agenda_terapeutas").select("*").order("fecha_cita",{ascending:!0}).order("hora_inicio",{ascending:!0});if(t)throw t;l.value=(e||[]).map(mapViewDataToCita),o.info("load_range",`Todas las citas cargadas (coordinadora): ${l.value.length}`),i.value=new Date}catch(e){const t=e.message||"Error al cargar citas";s.value=t,o.error("api_error",t,e)}finally{n.value=!1}},refreshAppointments:async function(){if(0===l.value.length)return;const e=l.value.map(e=>e.fecha_cita),t=Math.min(...e.map(e=>new Date(e).getTime())),a=Math.max(...e.map(e=>new Date(e).getTime())),o=new Date(t).toISOString().split("T")[0],r=new Date(a).toISOString().split("T")[0];await loadAppointmentsInRange(o,r)},clearError:()=>{s.value=null}}}const Be=t.defineComponent({__name:"ModalNuevaCitaEnhanced",__ssrInlineRender:!0,props:{isOpen:{type:Boolean},fechaInicial:{},horaInicial:{},horaFinal:{}},emits:["close","created"],setup(e,{emit:r}){const n=e,s=r,{pacientes:i,loading:d,hasPacientes:u,searchQuery:p,createPaciente:v,loadAllPacientes:f,clearSearch:x}=l(),{createAppointment:h,validateAppointment:k}=useAgendaEnhanced(),y=t.ref(!1),w=t.ref(!1),V=t.ref(!1),N=t.ref(!1),_=t.ref(null),C=t.ref(null),$=t.ref(null),S=t.ref({paciente_id:"",fecha_cita:n.fechaInicial||"",hora_inicio:n.horaInicial||"",hora_fin:"",modalidad:"online",estado:"pendiente"}),D=t.ref({nombre_completo:"",email:"",telefono:"",fecha_nacimiento:""}),z=[{value:"presencial",label:"Presencial",icon:"ðŸ¢",descripcion:"En consultorio"},{value:"online",label:"Online",icon:"ðŸ’»",descripcion:"Videollamada"},{value:"telefonica",label:"TelÃ©fono",icon:"ðŸ“ž",descripcion:"Llamada de voz"}],A=t.ref(!1),H=t.ref(null);const F=t.computed(()=>S.value.fecha_cita?(S.value.fecha_cita,null):null),U=t.computed(()=>{if(!S.value.fecha_cita)return"";return["domingo","lunes","martes","miÃ©rcoles","jueves","viernes","sÃ¡bado"][new Date(S.value.fecha_cita).getDay()]}),I=[{emoji:"ðŸ†•",label:"Primera sesiÃ³n",texto:"Primera sesiÃ³n de evaluaciÃ³n"},{emoji:"ðŸ“‹",label:"Seguimiento",texto:"SesiÃ³n de seguimiento"},{emoji:"ðŸŽ¯",label:"Objetivos",texto:"RevisiÃ³n de objetivos terapÃ©uticos"},{emoji:"âš ï¸",label:"Urgente",texto:"SesiÃ³n de urgencia/crisis"},{emoji:"ðŸ‘¨â€ðŸ‘©â€ðŸ‘§",label:"Familiar",texto:"SesiÃ³n familiar"},{emoji:"ðŸ“",label:"EvaluaciÃ³n",texto:"AplicaciÃ³n de pruebas/evaluaciÃ³n"}],R=t.ref(!1),O=[{minutos:30,label:"30 min"},{minutos:45,label:"45 min"},{minutos:60,label:"1 hora"},{minutos:90,label:"1:30 h"}],q=t.computed(()=>(new Date).toISOString().split("T")[0]),G=t.computed(()=>{const e=new Date,t=new Date(e);t.setDate(e.getDate()+1);const a=new Date(e),o=(8-e.getDay())%7||7;a.setDate(e.getDate()+o);const l=new Date(e),r=(10-e.getDay())%7||7;return l.setDate(e.getDate()+r),[{label:"Hoy",fecha:e.toISOString().split("T")[0]},{label:"MaÃ±ana",fecha:t.toISOString().split("T")[0]},{label:"PrÃ³x. lunes",fecha:a.toISOString().split("T")[0]},{label:"PrÃ³x. miÃ©rcoles",fecha:l.toISOString().split("T")[0]}]}),Z=t.computed(()=>{const e=[];for(let t=9;t<=20;t++)for(let a=0;a<60;a+=30){const o=`${t.toString().padStart(2,"0")}:${a.toString().padStart(2,"0")}`,l=`${t}:${a.toString().padStart(2,"0")}`;e.push({value:o,label:l})}return e}),W=t.computed(()=>{if(!S.value.hora_inicio)return Z.value;const[e,t]=S.value.hora_inicio.split(":").map(Number),a=60*e+t;return Z.value.filter(e=>{const[t,o]=e.value.split(":").map(Number);return 60*t+o>a})}),Y=t.computed(()=>{if(!S.value.hora_inicio||!S.value.hora_fin)return"";const e=calcularDuracionMinutos();if(e<=0)return"";if(e<60)return`${e} min`;const t=Math.floor(e/60),a=e%60;return a>0?`${t}h ${a}m`:`${t}h`});function calcularDuracionMinutos(){if(!S.value.hora_inicio||!S.value.hora_fin)return 0;const[e,t]=S.value.hora_inicio.split(":").map(Number),[a,o]=S.value.hora_fin.split(":").map(Number);return 60*a+o-(60*e+t)}const K=t.computed(()=>{const e=S.value.enlace_videollamada?.toLowerCase()||"";return e?e.includes("meet.google.com")||e.includes("meet.google")?"meet":e.includes("zoom.us")||e.includes("zoom.com")?"zoom":e.includes("teams.microsoft.com")||e.includes("teams.live.com")?"teams":null:null}),X=t.computed(()=>K.value?{meet:"Google Meet",zoom:"Zoom",teams:"Microsoft Teams"}[K.value]:""),J=t.computed(()=>{const e=S.value.enlace_videollamada?.trim()||"";if(!e)return null;try{new URL(e)}catch{return!1}return null!==K.value});function seleccionarModalidad(e){S.value.modalidad=e,"online"!==e&&(S.value.enlace_videollamada=""),"presencial"!==e&&(S.value.ubicacion="")}function aplicarTemplateObservacion(e){const t=S.value.observaciones||"";t.includes(e)?S.value.observaciones=t.replace(e,"").replace(/\s*[,.]\s*[,.]/g,",").replace(/^[,.\s]+|[,.\s]+$/g,"").trim():t.trim().length>0?S.value.observaciones=`${t.trim()}. ${e}`:S.value.observaciones=e,S.value.observaciones&&S.value.observaciones.length>0&&(R.value=!0)}function aplicarShortcutFecha(e){S.value.fecha_cita=e.fecha,validateInRealTime()}function onHoraInicioChange(){if(S.value.hora_inicio){const[e,t]=S.value.hora_inicio.split(":").map(Number),a=e+1;a<=21&&(S.value.hora_fin=`${a.toString().padStart(2,"0")}:${t.toString().padStart(2,"0")}`)}validateInRealTime()}function aplicarDuracion(e){if(!S.value.hora_inicio)return;const[t,a]=S.value.hora_inicio.split(":").map(Number),o=60*t+a+e,l=Math.floor(o/60),r=o%60;l<=21&&(S.value.hora_fin=`${l.toString().padStart(2,"0")}:${r.toString().padStart(2,"0")}`,validateInRealTime())}function formatearFechaCompleta(e){if(!e)return"";return new Date(e+"T00:00:00").toLocaleDateString("es-ES",{weekday:"long",day:"numeric",month:"long",year:"numeric"})}const ee=t.computed(()=>S.value.paciente_id&&S.value.fecha_cita&&S.value.hora_inicio&&S.value.hora_fin&&S.value.modalidad&&!N.value);function handleClose(){S.value={paciente_id:"",fecha_cita:n.fechaInicial||"",hora_inicio:n.horaInicial||"",hora_fin:"",modalidad:"online",estado:"pendiente"},_.value=null,x(),y.value=!1,w.value=!1,C.value=null,R.value=!1,s("close")}function selectPaciente(e){_.value=e,S.value.paciente_id=e.id,p.value=e.nombre_completo,y.value=!1,e.bono_activo?(S.value.bono_id=e.bono_activo.id,S.value.descontar_de_bono=!0):(S.value.bono_id=void 0,S.value.descontar_de_bono=!1),o.debug("patient_select",`Paciente seleccionado: ${e.nombre_completo}`,{tiene_bono:!!e.bono_activo,bono_id:e.bono_activo?.id})}function formatDate(e){if(!e)return"";return new Date(e).toLocaleDateString("es-ES",{day:"numeric",month:"long",year:"numeric"})}function formatRelativeDate(e){if(!e)return"";const t=new Date(e),a=(new Date).getTime()-t.getTime(),o=Math.floor(a/864e5);return 0===o?"hoy":1===o?"ayer":o<7?`hace ${o} dÃ­as`:o<14?"hace 1 sem.":o<30?`hace ${Math.floor(o/7)} sem.`:o<60?"hace 1 mes":`hace ${Math.floor(o/30)} meses`}function limpiarSeleccion(){_.value=null,S.value.paciente_id="",S.value.bono_id=void 0,S.value.descontar_de_bono=!1,p.value=""}function handleBlur(){setTimeout(()=>{y.value=!1},200)}function activarModoCrearPaciente(){w.value=!0,y.value=!1,p.value.trim().length>0&&!p.value.includes("@")&&(D.value.nombre_completo=p.value.trim())}function cancelarCrearPaciente(){w.value=!1,D.value={nombre_completo:"",email:"",telefono:"",fecha_nacimiento:""}}async function crearPacienteYSeleccionar(){V.value=!0;try{const e=await v(D.value);e.success&&e.data?(selectPaciente(e.data),w.value=!1,D.value={nombre_completo:"",email:"",telefono:"",fecha_nacimiento:""},C.value={type:"success",text:`Paciente "${e.data.nombre_completo}" creado exitosamente`},setTimeout(()=>{C.value=null},3e3)):C.value={type:"error",text:e.error||"Error al crear paciente"}}catch(e){C.value={type:"error",text:e.message||"Error inesperado al crear paciente"}}finally{V.value=!1}}async function validateInRealTime(){$.value&&clearTimeout($.value),S.value.fecha_cita&&S.value.hora_inicio&&S.value.hora_fin?$.value=setTimeout(async()=>{try{const e=await k({paciente_id:S.value.paciente_id||"temp",fecha_cita:S.value.fecha_cita,hora_inicio:S.value.hora_inicio,hora_fin:S.value.hora_fin});e.valid?C.value={type:"success",text:"Horario disponible âœ“"}:C.value={type:"error",text:e.error||"Conflicto detectado"}}catch(e){o.error("validation","Error en validaciÃ³n en tiempo real",e)}},500):C.value=null}async function handleSubmit(e=!1){if(ee.value){N.value=!0,C.value=null;try{o.clickCreate(S.value.fecha_cita,S.value.hora_inicio);const t=await h(S.value);t.success&&t.data?(o.create(t.data.id,S.value.fecha_cita,S.value.hora_inicio),S.value.fecha_cita,S.value.modalidad,S.value.paciente_id&&S.value.hora_inicio&&(S.value.paciente_id,S.value.hora_inicio),A.value=!1,s("created",t.data),e?(!function(){const e=_.value,t=S.value.bono_id;S.value={paciente_id:e?.id||"",fecha_cita:"",hora_inicio:"",hora_fin:"",modalidad:"online",estado:"pendiente",bono_id:t,descontar_de_bono:!!t},R.value=!1}(),C.value={type:"success",text:`Cita creada para ${_.value?.nombre_completo||"paciente"}. Puedes crear otra.`},setTimeout(()=>{C.value=null},4e3)):handleClose()):C.value={type:"error",text:t.error||"Error al crear la cita"}}catch(e){C.value={type:"error",text:e.message||"Error inesperado"},o.error("api_error","Error en handleSubmit",e)}finally{N.value=!1}}}async function handleSubmitAndNew(){await handleSubmit(!0)}return t.watch(()=>S.value.hora_inicio,e=>{if(e){const[t,a]=e.split(":").map(Number),o=60*t+a+60,l=Math.floor(o/60),r=o%60;S.value.hora_fin=`${String(l).padStart(2,"0")}:${String(r).padStart(2,"0")}`}}),t.watch(()=>n.isOpen,e=>{e&&(f(),n.fechaInicial||n.horaInicial,n.fechaInicial&&(S.value.fecha_cita=n.fechaInicial),n.horaInicial&&(S.value.hora_inicio=n.horaInicial),n.horaFinal&&(S.value.hora_fin=n.horaFinal))}),t.watch(()=>[S.value.paciente_id,S.value.fecha_cita,S.value.hora_inicio,S.value.modalidad,S.value.observaciones],()=>{},{deep:!0}),t.watch(()=>S.value.paciente_id,e=>{H.value=null}),t.watch(()=>S.value.fecha_cita,e=>{e&&A.value}),(o,l,r,n)=>{l(a.ssrRenderComponent(t.unref(ye),t.mergeProps({appear:"",show:e.isOpen,as:"template"},n),{default:t.withCtx((e,o,l,r)=>{if(!o)return[t.createVNode(t.unref(ue),{as:"div",class:"relative z-50",onClose:handleClose},{default:t.withCtx(()=>[t.createVNode(t.unref(ge),{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0","enter-to":"opacity-100",leave:"duration-200 ease-in","leave-from":"opacity-100","leave-to":"opacity-0"},{default:t.withCtx(()=>[t.createVNode("div",{class:"fixed inset-0 bg-black/30 backdrop-blur-sm"})]),_:1}),t.createVNode("div",{class:"fixed inset-0 overflow-y-auto"},[t.createVNode("div",{class:"flex min-h-full items-center justify-center p-4 text-center"},[t.createVNode(t.unref(ge),{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0 scale-95","enter-to":"opacity-100 scale-100",leave:"duration-200 ease-in","leave-from":"opacity-100 scale-100","leave-to":"opacity-0 scale-95"},{default:t.withCtx(()=>[t.createVNode(t.unref(pe),{class:"w-full max-w-2xl transform overflow-hidden rounded-3xl bg-white p-6 sm:p-8 text-left align-middle shadow-2xl transition-all max-h-[90vh] overflow-y-auto",role:"dialog","aria-modal":"true","aria-labelledby":"modal-title"},{default:t.withCtx(()=>[t.createVNode(t.unref(ve),{as:"h3",id:"modal-title",class:"text-xl sm:text-2xl font-bold text-neutral-900 mb-4 sm:mb-6 flex items-center gap-3"},{default:t.withCtx(()=>[t.createVNode("div",{class:"w-9 h-9 sm:w-10 sm:h-10 rounded-xl bg-gradient-to-br from-[#027368] to-[#025951] flex items-center justify-center text-white flex-shrink-0"},[(t.openBlock(),t.createBlock("svg",{class:"w-4 h-4 sm:w-5 sm:h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true"},[t.createVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})]))]),t.createTextVNode(" Nueva Cita ")]),_:1}),t.createVNode("form",{onSubmit:t.withModifiers(handleSubmit,["prevent"]),class:"space-y-6"},[t.createVNode("section",{class:"space-y-3"},[t.createVNode("div",{class:"flex items-center gap-2 pb-2 border-b border-neutral-100"},[t.createVNode("div",{class:"w-6 h-6 rounded-lg bg-emerald-100 flex items-center justify-center"},[(t.openBlock(),t.createBlock("svg",{class:"w-3.5 h-3.5 text-emerald-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t.createVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})]))]),t.createVNode("h4",{class:"text-sm font-semibold text-neutral-700"},"Paciente"),t.createVNode("span",{class:"text-xs text-red-500"},"*")]),t.createVNode("div",{class:"relative"},[w.value?(t.openBlock(),t.createBlock("div",{key:1,class:"space-y-4 p-4 bg-blue-50 border-2 border-blue-200 rounded-xl"},[t.createVNode("div",{class:"flex items-center justify-between mb-3"},[t.createVNode("h4",{class:"font-semibold text-neutral-900 flex items-center gap-2"},[(t.openBlock(),t.createBlock("svg",{class:"w-5 h-5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t.createVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M18 9v3m0 0v3m0-3h3m-3 0h-3m-2-5a4 4 0 11-8 0 4 4 0 018 0zM3 20a6 6 0 0112 0v1H3v-1z"})])),t.createTextVNode(" Crear Nuevo Paciente ")]),t.createVNode("button",{type:"button",onClick:cancelarCrearPaciente,class:"text-sm text-neutral-600 hover:text-neutral-900"}," Cancelar ")]),t.createVNode("div",{class:"grid grid-cols-2 gap-3"},[t.createVNode("div",{class:"col-span-2"},[t.withDirectives(t.createVNode("input",{"onUpdate:modelValue":e=>D.value.nombre_completo=e,type:"text",placeholder:"Nombre completo *",class:"w-full px-3 py-2 border-2 border-neutral-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"},null,8,["onUpdate:modelValue"]),[[t.vModelText,D.value.nombre_completo]])]),t.createVNode("div",{class:"col-span-2"},[t.withDirectives(t.createVNode("input",{"onUpdate:modelValue":e=>D.value.email=e,type:"email",placeholder:"Email *",class:"w-full px-3 py-2 border-2 border-neutral-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"},null,8,["onUpdate:modelValue"]),[[t.vModelText,D.value.email]])]),t.createVNode("div",null,[t.withDirectives(t.createVNode("input",{"onUpdate:modelValue":e=>D.value.telefono=e,type:"tel",placeholder:"TelÃ©fono",class:"w-full px-3 py-2 border-2 border-neutral-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"},null,8,["onUpdate:modelValue"]),[[t.vModelText,D.value.telefono]])]),t.createVNode("div",null,[t.withDirectives(t.createVNode("input",{"onUpdate:modelValue":e=>D.value.fecha_nacimiento=e,type:"date",placeholder:"Fecha de nacimiento",class:"w-full px-3 py-2 border-2 border-neutral-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"},null,8,["onUpdate:modelValue"]),[[t.vModelText,D.value.fecha_nacimiento]])])]),t.createVNode("button",{type:"button",onClick:crearPacienteYSeleccionar,disabled:!D.value.nombre_completo||!D.value.email||V.value,class:"w-full px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed font-medium flex items-center justify-center gap-2"},[V.value?(t.openBlock(),t.createBlock("svg",{key:0,class:"animate-spin h-5 w-5",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[t.createVNode("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),t.createVNode("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})])):t.createCommentVNode("",!0),t.createTextVNode(" "+t.toDisplayString(V.value?"Creando...":"Crear Paciente"),1)],8,["disabled"])])):(t.openBlock(),t.createBlock("div",{key:0,class:"space-y-2"},[t.createVNode("div",{class:"relative"},[t.createVNode("label",{for:"patient-search",class:"sr-only"},"Buscar paciente"),t.withDirectives(t.createVNode("input",{id:"patient-search","onUpdate:modelValue":e=>t.isRef(p)?p.value=e:null,type:"text",placeholder:"Buscar por nombre, email o telÃ©fono...",autocomplete:"off","aria-describedby":"patient-search-hint","aria-expanded":"showDropdown","aria-haspopup":"listbox",class:"w-full px-4 py-3 pr-10 border-2 border-neutral-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-[#027368] focus:border-transparent transition-all",onFocus:e=>y.value=!0,onBlur:handleBlur},null,40,["onUpdate:modelValue","onFocus"]),[[t.vModelText,t.unref(p)]]),t.createVNode("span",{id:"patient-search-hint",class:"sr-only"},"Escribe para buscar pacientes existentes o crear uno nuevo"),t.createVNode("div",{class:"absolute right-3 top-1/2 -translate-y-1/2"},[t.unref(d)?(t.openBlock(),t.createBlock("svg",{key:0,class:"animate-spin h-5 w-5 text-[#027368]",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[t.createVNode("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),t.createVNode("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})])):(t.openBlock(),t.createBlock("svg",{key:1,class:"h-5 w-5 text-neutral-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t.createVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})]))])]),y.value&&(t.unref(u)||t.unref(p).trim().length>0)?(t.openBlock(),t.createBlock("div",{key:0,class:"absolute z-10 w-full mt-1 bg-white border-2 border-neutral-200 rounded-xl shadow-xl max-h-80 overflow-y-auto",role:"listbox","aria-label":"Resultados de bÃºsqueda de pacientes"},[t.unref(u)?(t.openBlock(),t.createBlock("div",{key:0,class:"px-3 py-1.5 bg-neutral-50 border-b border-neutral-100"},[t.createVNode("span",{class:"text-[10px] text-neutral-400 uppercase tracking-wider"},"Pacientes frecuentes")])):t.createCommentVNode("",!0),(t.openBlock(!0),t.createBlock(t.Fragment,null,t.renderList(t.unref(i),e=>(t.openBlock(),t.createBlock("button",{key:e.id,type:"button",class:"w-full px-3 py-2.5 text-left hover:bg-[#027368]/5 transition-colors border-b border-neutral-100 last:border-0 group",onClick:t=>selectPaciente(e)},[t.createVNode("div",{class:"flex items-center gap-3"},[t.createVNode("div",{class:"w-9 h-9 rounded-full bg-gradient-to-br from-[#027368] to-[#025951] text-white flex items-center justify-center font-bold text-sm flex-shrink-0"},t.toDisplayString(e.nombre_completo.charAt(0).toUpperCase()),1),t.createVNode("div",{class:"flex-1 min-w-0"},[t.createVNode("div",{class:"flex items-center gap-2"},[t.createVNode("p",{class:"font-semibold text-neutral-900 truncate"},t.toDisplayString(e.nombre_completo),1),e.prioridad_score>=100?(t.openBlock(),t.createBlock("span",{key:0,class:"flex-shrink-0 w-2 h-2 rounded-full bg-emerald-500",title:"Cita reciente"})):t.createCommentVNode("",!0)]),t.createVNode("div",{class:"flex items-center gap-2 text-xs text-neutral-500"},[e.total_citas>0?(t.openBlock(),t.createBlock("span",{key:0},t.toDisplayString(e.total_citas)+" citas",1)):t.createCommentVNode("",!0),e.ultima_cita?(t.openBlock(),t.createBlock("span",{key:1,class:"text-neutral-400"},"Â·")):t.createCommentVNode("",!0),e.ultima_cita?(t.openBlock(),t.createBlock("span",{key:2,class:"text-neutral-400"}," Ãšltima: "+t.toDisplayString(formatRelativeDate(e.ultima_cita)),1)):t.createCommentVNode("",!0)])]),e.sesiones_restantes_total>0?(t.openBlock(),t.createBlock("div",{key:0,class:"flex-shrink-0 px-2.5 py-1 bg-emerald-100 text-emerald-700 rounded-full text-xs font-bold"},[t.createTextVNode(t.toDisplayString(e.sesiones_restantes_total)+" ",1),t.createVNode("span",{class:"font-medium"},"ses.")])):(t.openBlock(),t.createBlock("div",{key:1,class:"flex-shrink-0 px-2 py-1 bg-neutral-100 text-neutral-500 rounded-full text-xs"}," Sin bono "))])],8,["onClick"]))),128)),t.createVNode("button",{type:"button",class:"w-full px-3 py-3 text-left bg-gradient-to-r from-[#027368]/5 to-transparent hover:from-[#027368]/10 transition-colors border-t-2 border-[#027368]/20 font-medium text-[#027368] flex items-center gap-2",onClick:activarModoCrearPaciente},[t.createVNode("div",{class:"w-9 h-9 rounded-full bg-[#027368]/10 flex items-center justify-center"},[(t.openBlock(),t.createBlock("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t.createVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})]))]),t.createVNode("div",null,[t.createVNode("p",{class:"font-semibold"},"Crear nuevo paciente"),t.unref(p).trim().length>0?(t.openBlock(),t.createBlock("p",{key:0,class:"text-xs text-neutral-500"},' "'+t.toDisplayString(t.unref(p).trim())+'" ',1)):t.createCommentVNode("",!0)])]),!t.unref(u)&&!t.unref(d)&&t.unref(p).trim().length>0?(t.openBlock(),t.createBlock("div",{key:1,class:"px-4 py-6 text-center text-neutral-500"},[(t.openBlock(),t.createBlock("svg",{class:"w-10 h-10 mx-auto mb-2 text-neutral-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t.createVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})])),t.createVNode("p",{class:"font-medium text-sm"},'No se encontrÃ³ "'+t.toDisplayString(t.unref(p))+'"',1),t.createVNode("p",{class:"text-xs mt-1"},"Prueba con otro nombre o crea un nuevo paciente")])):t.createCommentVNode("",!0)])):t.createCommentVNode("",!0),S.value.paciente_id&&_.value?(t.openBlock(),t.createBlock("div",{key:1,class:"space-y-3"},[t.createVNode("div",{class:"bg-gradient-to-r from-emerald-50 to-teal-50 border-2 border-emerald-200 rounded-xl overflow-hidden"},[0!==_.value.total_citas&&_.value.bono_activo?t.createCommentVNode("",!0):(t.openBlock(),t.createBlock("div",{key:0,class:["px-3 py-1.5 text-xs font-medium flex items-center gap-2",0===_.value.total_citas?"bg-blue-100 text-blue-700":"bg-amber-100 text-amber-700"]},[(t.openBlock(),t.createBlock("svg",{class:"w-3.5 h-3.5",fill:"currentColor",viewBox:"0 0 20 20"},[0===_.value.total_citas?(t.openBlock(),t.createBlock("path",{key:0,"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm1-11a1 1 0 10-2 0v2H7a1 1 0 100 2h2v2a1 1 0 102 0v-2h2a1 1 0 100-2h-2V7z","clip-rule":"evenodd"})):(t.openBlock(),t.createBlock("path",{key:1,"fill-rule":"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z","clip-rule":"evenodd"}))])),t.createTextVNode(" "+t.toDisplayString(0===_.value.total_citas?"Paciente nuevo - Primera cita":"Sin bono activo"),1)],2)),t.createVNode("div",{class:"px-4 py-3"},[t.createVNode("div",{class:"flex items-center justify-between"},[t.createVNode("div",{class:"flex items-center gap-3"},[t.createVNode("div",{class:"w-11 h-11 rounded-full bg-gradient-to-br from-emerald-500 to-teal-600 text-white flex items-center justify-center font-bold text-lg shadow-sm"},t.toDisplayString(_.value.nombre_completo.charAt(0).toUpperCase()),1),t.createVNode("div",null,[t.createVNode("p",{class:"font-semibold text-neutral-900"},t.toDisplayString(_.value.nombre_completo),1),t.createVNode("p",{class:"text-xs text-neutral-500"},t.toDisplayString(_.value.email),1)])]),t.createVNode("div",{class:"flex items-center gap-2"},[t.createVNode("a",{href:`/terapeuta/pacientes/${_.value.id}`,target:"_blank",class:"p-2 text-neutral-400 hover:text-[#027368] hover:bg-white rounded-lg transition-colors",title:"Ver perfil completo"},[(t.openBlock(),t.createBlock("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t.createVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})]))],8,["href"]),t.createVNode("button",{type:"button",onClick:limpiarSeleccion,class:"p-2 hover:bg-white rounded-lg transition-colors text-neutral-400 hover:text-red-500",title:"Cambiar paciente"},[(t.openBlock(),t.createBlock("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t.createVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})]))])])]),t.createVNode("div",{class:"mt-3 grid grid-cols-3 gap-2 text-center"},[t.createVNode("div",{class:"bg-white/60 rounded-lg px-2 py-1.5"},[t.createVNode("p",{class:"text-xs text-neutral-500"},"Ãšltima cita"),t.createVNode("p",{class:"text-sm font-semibold text-neutral-700"},t.toDisplayString(_.value.ultima_cita?formatRelativeDate(_.value.ultima_cita):"Nunca"),1)]),t.createVNode("div",{class:"bg-white/60 rounded-lg px-2 py-1.5"},[t.createVNode("p",{class:"text-xs text-neutral-500"},"Total citas"),t.createVNode("p",{class:"text-sm font-semibold text-neutral-700"},t.toDisplayString(_.value.total_citas||0),1)]),t.createVNode("div",{class:"bg-white/60 rounded-lg px-2 py-1.5"},[t.createVNode("p",{class:"text-xs text-neutral-500"},"Sesiones"),t.createVNode("p",{class:["text-sm font-semibold",_.value.sesiones_restantes_total>0?"text-emerald-600":"text-neutral-400"]},t.toDisplayString(_.value.sesiones_restantes_total||0)+" disp. ",3)])])])]),_.value.bono_activo?(t.openBlock(),t.createBlock("div",{key:0,class:"px-4 py-3 bg-violet-50 border-2 border-violet-200 rounded-xl"},[t.createVNode("div",{class:"flex items-start justify-between"},[t.createVNode("div",{class:"flex items-center gap-2"},[t.createVNode("div",{class:"w-8 h-8 rounded-lg bg-violet-600 text-white flex items-center justify-center"},[(t.openBlock(),t.createBlock("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t.createVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 5v2m0 4v2m0 4v2M5 5a2 2 0 00-2 2v3a2 2 0 110 4v3a2 2 0 002 2h14a2 2 0 002-2v-3a2 2 0 110-4V7a2 2 0 00-2-2H5z"})]))]),t.createVNode("div",null,[t.createVNode("p",{class:"font-semibold text-violet-900"},t.toDisplayString(_.value.bono_activo.tipo),1),t.createVNode("p",{class:"text-sm text-violet-700"},t.toDisplayString(_.value.bono_activo.sesiones_restantes)+" de "+t.toDisplayString(_.value.bono_activo.sesiones_totales)+" sesiones disponibles ",1)])]),t.createVNode("div",{class:"flex items-center gap-1"},[(t.openBlock(!0),t.createBlock(t.Fragment,null,t.renderList(Math.min(_.value.bono_activo.sesiones_totales,10),e=>(t.openBlock(),t.createBlock("div",{key:e,class:["w-3 h-3 rounded-full",e<=_.value.bono_activo.sesiones_usadas?"bg-violet-600":"bg-violet-200"],title:e<=_.value.bono_activo.sesiones_usadas?"SesiÃ³n usada":"SesiÃ³n disponible"},null,10,["title"]))),128)),_.value.bono_activo.sesiones_totales>10?(t.openBlock(),t.createBlock("span",{key:0,class:"text-xs text-violet-500 ml-1"}," +"+t.toDisplayString(_.value.bono_activo.sesiones_totales-10),1)):t.createCommentVNode("",!0)])]),t.createVNode("div",{class:"mt-3 p-2 bg-amber-50 border border-amber-200 rounded-lg"},[t.createVNode("p",{class:"text-xs text-amber-800 flex items-start gap-2"},[(t.openBlock(),t.createBlock("svg",{class:"w-4 h-4 flex-shrink-0 mt-0.5",fill:"currentColor",viewBox:"0 0 20 20"},[t.createVNode("path",{"fill-rule":"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z","clip-rule":"evenodd"})])),t.createVNode("span",null,[t.createTextVNode(" Esta serÃ¡ la sesiÃ³n "),t.createVNode("strong",null,t.toDisplayString(_.value.bono_activo.sesiones_usadas+1)+"/"+t.toDisplayString(_.value.bono_activo.sesiones_totales),1),t.createTextVNode(" del bono. Se descontarÃ¡ automÃ¡ticamente cuando la cita sea "),t.createVNode("strong",null,"confirmada"),t.createTextVNode(". ")])])]),_.value.bono_activo.fecha_fin?(t.openBlock(),t.createBlock("p",{key:0,class:"mt-2 text-xs text-violet-600"}," Vence: "+t.toDisplayString(formatDate(_.value.bono_activo.fecha_fin)),1)):t.createCommentVNode("",!0)])):(t.openBlock(),t.createBlock("div",{key:1,class:"px-4 py-3 bg-amber-50 border-2 border-amber-200 rounded-xl"},[t.createVNode("div",{class:"flex items-start gap-3"},[t.createVNode("div",{class:"w-8 h-8 rounded-lg bg-amber-200 text-amber-700 flex items-center justify-center flex-shrink-0"},[(t.openBlock(),t.createBlock("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t.createVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})]))]),t.createVNode("div",null,[t.createVNode("p",{class:"font-medium text-amber-800 text-sm"},"Sin bono activo"),t.createVNode("p",{class:"text-xs text-amber-600 mt-0.5"},"Esta sesiÃ³n se facturarÃ¡ de forma individual.")])])])),_.value.bonos&&_.value.bonos.length>1?(t.openBlock(),t.createBlock("div",{key:2,class:"mt-2"},[t.createVNode("label",{class:"block text-sm font-medium text-neutral-700 mb-1"}," Seleccionar bono a usar "),t.withDirectives(t.createVNode("select",{"onUpdate:modelValue":e=>S.value.bono_id=e,class:"w-full px-3 py-2 border-2 border-neutral-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-violet-500 focus:border-transparent text-sm"},[(t.openBlock(!0),t.createBlock(t.Fragment,null,t.renderList(_.value.bonos,e=>(t.openBlock(),t.createBlock("option",{key:e.id,value:e.id},t.toDisplayString(e.tipo)+" - "+t.toDisplayString(e.sesiones_restantes)+"/"+t.toDisplayString(e.sesiones_totales)+" sesiones ",9,["value"]))),128))],8,["onUpdate:modelValue"]),[[t.vModelSelect,S.value.bono_id]])])):t.createCommentVNode("",!0)])):t.createCommentVNode("",!0)]))])]),t.createVNode("section",{class:"space-y-4 pt-2"},[t.createVNode("div",{class:"flex items-center gap-2 pb-2 border-b border-neutral-100"},[t.createVNode("div",{class:"w-6 h-6 rounded-lg bg-blue-100 flex items-center justify-center"},[(t.openBlock(),t.createBlock("svg",{class:"w-3.5 h-3.5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t.createVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})]))]),t.createVNode("h4",{class:"text-sm font-semibold text-neutral-700"},"Fecha y Hora"),t.createVNode("span",{class:"text-xs text-red-500"},"*")]),t.createVNode("div",null,[t.createVNode("label",{for:"fecha-cita",class:"sr-only"},"Fecha de la cita"),t.createVNode("div",{class:"flex flex-wrap gap-2 mb-2",role:"group","aria-label":"Fechas rÃ¡pidas"},[(t.openBlock(!0),t.createBlock(t.Fragment,null,t.renderList(G.value,e=>(t.openBlock(),t.createBlock("button",{key:e.label,type:"button",onClick:t=>aplicarShortcutFecha(e),class:["px-3 py-1.5 text-xs font-medium rounded-lg transition-all focus:outline-none focus:ring-2 focus:ring-[#027368] focus:ring-offset-1",S.value.fecha_cita===e.fecha?"bg-[#027368] text-white":"bg-neutral-100 text-neutral-600 hover:bg-neutral-200"],"aria-pressed":S.value.fecha_cita===e.fecha},t.toDisplayString(e.label),11,["onClick","aria-pressed"]))),128))]),t.withDirectives(t.createVNode("input",{id:"fecha-cita","onUpdate:modelValue":e=>S.value.fecha_cita=e,type:"date",required:"",min:q.value,"aria-required":"true",class:"w-full px-4 py-3 border-2 border-neutral-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-[#027368] focus:border-transparent transition-all",onChange:validateInRealTime},null,40,["onUpdate:modelValue","min"]),[[t.vModelText,S.value.fecha_cita]]),S.value.fecha_cita?(t.openBlock(),t.createBlock("p",{key:0,class:"mt-1 text-xs text-neutral-500"},t.toDisplayString(formatearFechaCompleta(S.value.fecha_cita)),1)):t.createCommentVNode("",!0)]),H.value&&!S.value.hora_inicio?(t.openBlock(),t.createBlock("div",{key:0,class:"px-3 py-2 bg-violet-50 border border-violet-200 rounded-lg flex items-center justify-between"},[t.createVNode("div",{class:"flex items-center gap-2 text-violet-700 text-sm"},[(t.openBlock(),t.createBlock("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true"},[t.createVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})])),t.createVNode("span",null,t.toDisplayString(H.value.razon),1)]),t.createVNode("button",{type:"button",onClick:e=>S.value.hora_inicio=H.value.hora,class:"px-2 py-1 bg-violet-600 text-white text-xs font-medium rounded hover:bg-violet-700 transition-colors"}," Usar "+t.toDisplayString(H.value.hora),9,["onClick"])])):t.createCommentVNode("",!0),t.createVNode("div",{class:"grid grid-cols-2 gap-4"},[t.createVNode("div",null,[t.createVNode("label",{class:"block text-sm font-semibold text-neutral-700 mb-2"}," Hora inicio * "),t.withDirectives(t.createVNode("select",{"onUpdate:modelValue":e=>S.value.hora_inicio=e,required:"",class:"w-full px-4 py-3 border-2 border-neutral-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-[#027368] focus:border-transparent transition-all bg-white appearance-none cursor-pointer",onChange:onHoraInicioChange},[t.createVNode("option",{value:"",disabled:""},"Seleccionar hora"),(t.openBlock(!0),t.createBlock(t.Fragment,null,t.renderList(Z.value,e=>(t.openBlock(),t.createBlock("option",{key:e.value,value:e.value},t.toDisplayString(e.label),9,["value"]))),128))],40,["onUpdate:modelValue"]),[[t.vModelSelect,S.value.hora_inicio]])]),t.createVNode("div",null,[t.createVNode("label",{class:"block text-sm font-semibold text-neutral-700 mb-2"},[t.createTextVNode(" Hora fin * "),t.createVNode("span",{class:"font-normal text-neutral-400"},"("+t.toDisplayString(Y.value)+")",1)]),t.withDirectives(t.createVNode("select",{"onUpdate:modelValue":e=>S.value.hora_fin=e,required:"",class:"w-full px-4 py-3 border-2 border-neutral-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-[#027368] focus:border-transparent transition-all bg-white appearance-none cursor-pointer",onChange:validateInRealTime},[t.createVNode("option",{value:"",disabled:""},"Seleccionar hora"),(t.openBlock(!0),t.createBlock(t.Fragment,null,t.renderList(W.value,e=>(t.openBlock(),t.createBlock("option",{key:e.value,value:e.value},t.toDisplayString(e.label),9,["value"]))),128))],40,["onUpdate:modelValue"]),[[t.vModelSelect,S.value.hora_fin]])])]),t.createVNode("div",{class:"flex items-center gap-2"},[t.createVNode("span",{class:"text-xs text-neutral-500"},"DuraciÃ³n rÃ¡pida:"),(t.openBlock(),t.createBlock(t.Fragment,null,t.renderList(O,e=>t.createVNode("button",{key:e.minutos,type:"button",onClick:t=>aplicarDuracion(e.minutos),class:["px-2 py-1 text-xs rounded-md transition-all",calcularDuracionMinutos()===e.minutos?"bg-[#027368]/10 text-[#027368] font-medium":"bg-neutral-100 text-neutral-500 hover:bg-neutral-200"]},t.toDisplayString(e.label),11,["onClick"])),64))]),C.value?(t.openBlock(),t.createBlock("div",{key:1,class:["px-4 py-3 rounded-xl flex items-start gap-3",{"bg-red-50 border-2 border-red-200":"error"===C.value.type,"bg-yellow-50 border-2 border-yellow-200":"warning"===C.value.type,"bg-emerald-50 border-2 border-emerald-200":"success"===C.value.type}]},[(t.openBlock(),t.createBlock("svg",{class:["w-5 h-5 mt-0.5 flex-shrink-0",{"text-red-600":"error"===C.value.type,"text-yellow-600":"warning"===C.value.type,"text-emerald-600":"success"===C.value.type}],fill:"currentColor",viewBox:"0 0 20 20"},["error"===C.value.type?(t.openBlock(),t.createBlock("path",{key:0,"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z","clip-rule":"evenodd"})):"success"===C.value.type?(t.openBlock(),t.createBlock("path",{key:1,"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z","clip-rule":"evenodd"})):(t.openBlock(),t.createBlock("path",{key:2,"fill-rule":"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z","clip-rule":"evenodd"}))],2)),t.createVNode("p",{class:["text-sm font-medium flex-1",{"text-red-800":"error"===C.value.type,"text-yellow-800":"warning"===C.value.type,"text-emerald-800":"success"===C.value.type}]},t.toDisplayString(C.value.text),3)],2)):t.createCommentVNode("",!0)]),t.createVNode("section",{class:"space-y-4 pt-2"},[t.createVNode("div",{class:"flex items-center gap-2 pb-2 border-b border-neutral-100"},[t.createVNode("div",{class:"w-6 h-6 rounded-lg bg-violet-100 flex items-center justify-center"},[(t.openBlock(),t.createBlock("svg",{class:"w-3.5 h-3.5 text-violet-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t.createVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"})]))]),t.createVNode("h4",{class:"text-sm font-semibold text-neutral-700"},"Modalidad"),t.createVNode("span",{class:"text-xs text-red-500"},"*"),F.value&&S.value.modalidad!==F.value?(t.openBlock(),t.createBlock("span",{key:0,class:"ml-auto text-[10px] px-2 py-0.5 bg-amber-100 text-amber-700 rounded-full flex items-center gap-1 cursor-pointer hover:bg-amber-200 transition-colors",onClick:e=>seleccionarModalidad(F.value),title:`Normalmente usas ${F.value} los ${U.value}`},[(t.openBlock(),t.createBlock("svg",{class:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true"},[t.createVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})])),t.createTextVNode(" "+t.toDisplayString(z.find(e=>e.value===F.value)?.label)+" los "+t.toDisplayString(U.value),1)],8,["onClick","title"])):t.createCommentVNode("",!0)]),t.createVNode("div",{class:"grid grid-cols-3 gap-3"},[(t.openBlock(),t.createBlock(t.Fragment,null,t.renderList(z,e=>t.createVNode("button",{key:e.value,type:"button",onClick:t=>seleccionarModalidad(e.value),class:["relative px-4 py-4 rounded-xl border-2 transition-all font-medium flex flex-col items-center gap-2 group",S.value.modalidad===e.value?"border-[#027368] bg-gradient-to-br from-[#027368]/10 to-[#027368]/5 text-[#027368] shadow-md":"border-neutral-200 text-neutral-600 hover:border-neutral-300 hover:bg-neutral-50"]},[S.value.modalidad===e.value?(t.openBlock(),t.createBlock("div",{key:0,class:"absolute top-2 right-2 w-5 h-5 bg-[#027368] rounded-full flex items-center justify-center"},[(t.openBlock(),t.createBlock("svg",{class:"w-3 h-3 text-white",fill:"currentColor",viewBox:"0 0 20 20"},[t.createVNode("path",{"fill-rule":"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z","clip-rule":"evenodd"})]))])):t.createCommentVNode("",!0),t.createVNode("span",{class:"text-2xl"},t.toDisplayString(e.icon),1),t.createVNode("span",{class:"text-sm font-semibold"},t.toDisplayString(e.label),1),t.createVNode("span",{class:"text-[10px] text-neutral-400 group-hover:text-neutral-500"},t.toDisplayString(e.descripcion),1)],10,["onClick"])),64))]),"presencial"===S.value.modalidad?(t.openBlock(),t.createBlock("div",{key:0,class:"space-y-2"},[t.createVNode("label",{id:"ubicacion-label",class:"block text-sm font-semibold text-neutral-700"},[t.createTextVNode(" Sala / Consultorio "),t.createVNode("span",{class:"font-normal text-neutral-400"},"(opcional)")]),t.createVNode("div",{class:"relative"},[t.createVNode("div",{class:"absolute left-3 top-1/2 -translate-y-1/2 text-neutral-400"},[(t.openBlock(),t.createBlock("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true"},[t.createVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})]))]),t.withDirectives(t.createVNode("input",{"onUpdate:modelValue":e=>S.value.ubicacion=e,type:"text","aria-labelledby":"ubicacion-label",placeholder:"Ej: Consultorio 3, Sala de terapia...",class:"w-full pl-10 pr-4 py-3 border-2 border-neutral-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-[#027368] focus:border-transparent transition-all"},null,8,["onUpdate:modelValue"]),[[t.vModelText,S.value.ubicacion]])])])):t.createCommentVNode("",!0),"online"===S.value.modalidad?(t.openBlock(),t.createBlock("div",{key:1,class:"space-y-2"},[t.createVNode("label",{id:"enlace-label",class:"block text-sm font-semibold text-neutral-700"},[t.createTextVNode(" Enlace de videollamada "),t.createVNode("span",{class:"font-normal text-neutral-400"},"(opcional)")]),t.createVNode("div",{class:"relative"},[t.createVNode("div",{class:"absolute left-3 top-1/2 -translate-y-1/2"},["meet"===K.value?(t.openBlock(),t.createBlock("img",{key:0,src:"https://www.gstatic.com/meet/google_meet_horizontal_wordmark_2020q4_1x_icon_124_40_2373e79660dabbf194273d27aa7ee1f5.png",alt:"Google Meet",class:"w-5 h-5 object-contain"})):"zoom"===K.value?(t.openBlock(),t.createBlock("img",{key:1,src:"https://st1.zoom.us/zoom.ico",alt:"Zoom",class:"w-5 h-5 object-contain"})):"teams"===K.value?(t.openBlock(),t.createBlock("img",{key:2,src:"https://cdn-icons-png.flaticon.com/512/906/906349.png",alt:"Teams",class:"w-5 h-5 object-contain"})):(t.openBlock(),t.createBlock("svg",{key:3,class:"w-5 h-5 text-neutral-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true"},[t.createVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"})]))]),t.withDirectives(t.createVNode("input",{"onUpdate:modelValue":e=>S.value.enlace_videollamada=e,type:"url","aria-labelledby":"enlace-label","aria-invalid":!1===J.value,placeholder:"Pega el enlace de Meet, Zoom o Teams...",class:["w-full pl-10 pr-4 py-3 border-2 rounded-xl focus:outline-none focus:ring-2 focus:ring-[#027368] focus:border-transparent transition-all",!1===J.value?"border-red-300 bg-red-50":!0===J.value?"border-emerald-300 bg-emerald-50":"border-neutral-200"]},null,10,["onUpdate:modelValue","aria-invalid"]),[[t.vModelText,S.value.enlace_videollamada]]),K.value&&J.value?(t.openBlock(),t.createBlock("div",{key:0,class:"absolute right-3 top-1/2 -translate-y-1/2 px-2 py-0.5 bg-emerald-100 text-emerald-700 rounded text-xs font-medium"},t.toDisplayString(X.value),1)):t.createCommentVNode("",!0)]),S.value.enlace_videollamada&&!1===J.value?(t.openBlock(),t.createBlock("p",{key:0,class:"text-xs text-red-600",role:"alert"}," Enlace no reconocido. Usa Google Meet, Zoom o Microsoft Teams. ")):S.value.enlace_videollamada?t.createCommentVNode("",!0):(t.openBlock(),t.createBlock("p",{key:1,class:"text-xs text-neutral-400"}," Compatible con Google Meet, Zoom y Microsoft Teams "))])):t.createCommentVNode("",!0),"telefonica"===S.value.modalidad?(t.openBlock(),t.createBlock("div",{key:2,class:"px-4 py-3 bg-blue-50 border border-blue-200 rounded-xl",role:"note"},[t.createVNode("div",{class:"flex items-start gap-2 text-blue-700"},[(t.openBlock(),t.createBlock("svg",{class:"w-5 h-5 mt-0.5 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true"},[t.createVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})])),t.createVNode("div",{class:"text-sm"},[t.createVNode("p",{class:"font-medium"},"SesiÃ³n por telÃ©fono"),t.createVNode("p",{class:"text-blue-600 text-xs mt-0.5"},"Se utilizarÃ¡ el nÃºmero de contacto del paciente para la llamada.")])])])):t.createCommentVNode("",!0)]),t.createVNode("section",{class:"space-y-3 pt-2"},[t.createVNode("div",{class:"flex items-center gap-2 pb-2 border-b border-neutral-100"},[t.createVNode("div",{class:"w-6 h-6 rounded-lg bg-amber-100 flex items-center justify-center"},[(t.openBlock(),t.createBlock("svg",{class:"w-3.5 h-3.5 text-amber-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t.createVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})]))]),t.createVNode("h4",{class:"text-sm font-semibold text-neutral-700"},"Observaciones"),t.createVNode("span",{class:"text-xs text-neutral-400"},"(opcional)"),S.value.observaciones?(t.openBlock(),t.createBlock("span",{key:0,class:["ml-auto text-xs",(S.value.observaciones?.length||0)>450?"text-amber-600":"text-neutral-400"]},t.toDisplayString(S.value.observaciones?.length||0)+"/500 ",3)):t.createCommentVNode("",!0)]),t.createVNode("div",{class:"flex flex-wrap gap-1.5",role:"group","aria-label":"Plantillas rÃ¡pidas de observaciÃ³n"},[(t.openBlock(),t.createBlock(t.Fragment,null,t.renderList(I,e=>t.createVNode("button",{key:e.texto,type:"button",onClick:t=>aplicarTemplateObservacion(e.texto),class:["px-2.5 py-1 text-xs rounded-lg transition-all flex items-center gap-1 focus:outline-none focus:ring-2 focus:ring-[#027368] focus:ring-offset-1",S.value.observaciones?.includes(e.texto)?"bg-[#027368]/10 text-[#027368] font-medium":"bg-neutral-100 text-neutral-600 hover:bg-neutral-200"],"aria-pressed":S.value.observaciones?.includes(e.texto)},[t.createVNode("span",{"aria-hidden":"true"},t.toDisplayString(e.emoji),1),t.createVNode("span",null,t.toDisplayString(e.label),1)],10,["onClick","aria-pressed"])),64))]),t.createVNode("div",{class:"relative"},[t.withDirectives(t.createVNode("textarea",{id:"observaciones-textarea","onUpdate:modelValue":e=>S.value.observaciones=e,rows:R.value?5:2,maxlength:"500","aria-label":"Observaciones","aria-describedby":"observaciones-hint",placeholder:"Ej: Primera sesiÃ³n de evaluaciÃ³n, seguimiento ansiedad, revisiÃ³n de objetivos terapÃ©uticos...",class:"w-full px-4 py-3 border-2 border-neutral-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-[#027368] focus:border-transparent transition-all resize-none",onFocus:e=>R.value=!0,onBlur:e=>R.value=S.value.observaciones?.length>0},null,40,["onUpdate:modelValue","rows","onFocus","onBlur"]),[[t.vModelText,S.value.observaciones]]),t.createVNode("span",{id:"observaciones-hint",class:"sr-only"},"MÃ¡ximo 500 caracteres. Usa las plantillas rÃ¡pidas para aÃ±adir texto predefinido."),R.value||S.value.observaciones?t.createCommentVNode("",!0):(t.openBlock(),t.createBlock("button",{key:0,type:"button",onClick:e=>R.value=!0,class:"absolute bottom-2 right-2 text-xs text-neutral-400 hover:text-neutral-600 flex items-center gap-1 focus:outline-none focus:text-[#027368]","aria-label":"Expandir campo de observaciones"},[(t.openBlock(),t.createBlock("svg",{class:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true"},[t.createVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"})])),t.createTextVNode(" Expandir ")],8,["onClick"]))])]),t.createVNode("div",{class:"space-y-3 pt-6 border-t border-neutral-100"},[t.createVNode("div",{class:"flex flex-col sm:flex-row gap-3"},[t.createVNode("button",{type:"button",onClick:handleClose,class:"order-3 sm:order-1 px-6 py-3 bg-neutral-100 text-neutral-700 rounded-xl hover:bg-neutral-200 transition-all font-semibold focus:outline-none focus:ring-2 focus:ring-neutral-400 focus:ring-offset-2"}," Cancelar "),t.createVNode("button",{type:"button",onClick:handleSubmitAndNew,disabled:N.value||!ee.value,class:"order-2 flex-1 px-4 py-3 border-2 border-[#027368] text-[#027368] rounded-xl hover:bg-[#027368]/5 transition-all font-semibold disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2 focus:outline-none focus:ring-2 focus:ring-[#027368] focus:ring-offset-2"},[(t.openBlock(),t.createBlock("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true"},[t.createVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})])),t.createVNode("span",{class:"hidden sm:inline"},"Crear y agendar otra"),t.createVNode("span",{class:"sm:hidden"},"+ Otra")],8,["disabled"]),t.createVNode("button",{type:"submit",disabled:N.value||!ee.value,class:"order-1 sm:order-3 flex-1 px-6 py-3 bg-gradient-to-r from-[#027368] to-[#025951] text-white rounded-xl hover:shadow-lg hover:shadow-[#027368]/25 transition-all font-semibold disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2 focus:outline-none focus:ring-2 focus:ring-[#027368] focus:ring-offset-2"},[N.value?(t.openBlock(),t.createBlock("svg",{key:0,class:"animate-spin h-5 w-5",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","aria-hidden":"true"},[t.createVNode("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),t.createVNode("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})])):(t.openBlock(),t.createBlock("svg",{key:1,class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true"},[t.createVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})])),t.createTextVNode(" "+t.toDisplayString(N.value?"Creando...":"Crear Cita"),1)],8,["disabled"])]),t.createVNode("div",{class:"hidden md:flex items-center justify-end gap-4 text-xs text-neutral-400"},[t.createVNode("span",{class:"flex items-center gap-1"},[t.createVNode("kbd",{class:"px-1.5 py-0.5 bg-neutral-100 rounded text-neutral-500 font-mono"},"Esc"),t.createVNode("span",null,"Cancelar")]),t.createVNode("span",{class:"flex items-center gap-1"},[t.createVNode("kbd",{class:"px-1.5 py-0.5 bg-neutral-100 rounded text-neutral-500 font-mono"},"Ctrl"),t.createVNode("span",null,"+"),t.createVNode("kbd",{class:"px-1.5 py-0.5 bg-neutral-100 rounded text-neutral-500 font-mono"},"Enter"),t.createVNode("span",null,"Crear")])])])],32)]),_:1})]),_:1})])])]),_:1})];o(a.ssrRenderComponent(t.unref(ue),{as:"div",class:"relative z-50",onClose:handleClose},{default:t.withCtx((e,o,l,r)=>{if(!o)return[t.createVNode(t.unref(ge),{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0","enter-to":"opacity-100",leave:"duration-200 ease-in","leave-from":"opacity-100","leave-to":"opacity-0"},{default:t.withCtx(()=>[t.createVNode("div",{class:"fixed inset-0 bg-black/30 backdrop-blur-sm"})]),_:1}),t.createVNode("div",{class:"fixed inset-0 overflow-y-auto"},[t.createVNode("div",{class:"flex min-h-full items-center justify-center p-4 text-center"},[t.createVNode(t.unref(ge),{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0 scale-95","enter-to":"opacity-100 scale-100",leave:"duration-200 ease-in","leave-from":"opacity-100 scale-100","leave-to":"opacity-0 scale-95"},{default:t.withCtx(()=>[t.createVNode(t.unref(pe),{class:"w-full max-w-2xl transform overflow-hidden rounded-3xl bg-white p-6 sm:p-8 text-left align-middle shadow-2xl transition-all max-h-[90vh] overflow-y-auto",role:"dialog","aria-modal":"true","aria-labelledby":"modal-title"},{default:t.withCtx(()=>[t.createVNode(t.unref(ve),{as:"h3",id:"modal-title",class:"text-xl sm:text-2xl font-bold text-neutral-900 mb-4 sm:mb-6 flex items-center gap-3"},{default:t.withCtx(()=>[t.createVNode("div",{class:"w-9 h-9 sm:w-10 sm:h-10 rounded-xl bg-gradient-to-br from-[#027368] to-[#025951] flex items-center justify-center text-white flex-shrink-0"},[(t.openBlock(),t.createBlock("svg",{class:"w-4 h-4 sm:w-5 sm:h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true"},[t.createVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})]))]),t.createTextVNode(" Nueva Cita ")]),_:1}),t.createVNode("form",{onSubmit:t.withModifiers(handleSubmit,["prevent"]),class:"space-y-6"},[t.createVNode("section",{class:"space-y-3"},[t.createVNode("div",{class:"flex items-center gap-2 pb-2 border-b border-neutral-100"},[t.createVNode("div",{class:"w-6 h-6 rounded-lg bg-emerald-100 flex items-center justify-center"},[(t.openBlock(),t.createBlock("svg",{class:"w-3.5 h-3.5 text-emerald-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t.createVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})]))]),t.createVNode("h4",{class:"text-sm font-semibold text-neutral-700"},"Paciente"),t.createVNode("span",{class:"text-xs text-red-500"},"*")]),t.createVNode("div",{class:"relative"},[w.value?(t.openBlock(),t.createBlock("div",{key:1,class:"space-y-4 p-4 bg-blue-50 border-2 border-blue-200 rounded-xl"},[t.createVNode("div",{class:"flex items-center justify-between mb-3"},[t.createVNode("h4",{class:"font-semibold text-neutral-900 flex items-center gap-2"},[(t.openBlock(),t.createBlock("svg",{class:"w-5 h-5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t.createVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M18 9v3m0 0v3m0-3h3m-3 0h-3m-2-5a4 4 0 11-8 0 4 4 0 018 0zM3 20a6 6 0 0112 0v1H3v-1z"})])),t.createTextVNode(" Crear Nuevo Paciente ")]),t.createVNode("button",{type:"button",onClick:cancelarCrearPaciente,class:"text-sm text-neutral-600 hover:text-neutral-900"}," Cancelar ")]),t.createVNode("div",{class:"grid grid-cols-2 gap-3"},[t.createVNode("div",{class:"col-span-2"},[t.withDirectives(t.createVNode("input",{"onUpdate:modelValue":e=>D.value.nombre_completo=e,type:"text",placeholder:"Nombre completo *",class:"w-full px-3 py-2 border-2 border-neutral-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"},null,8,["onUpdate:modelValue"]),[[t.vModelText,D.value.nombre_completo]])]),t.createVNode("div",{class:"col-span-2"},[t.withDirectives(t.createVNode("input",{"onUpdate:modelValue":e=>D.value.email=e,type:"email",placeholder:"Email *",class:"w-full px-3 py-2 border-2 border-neutral-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"},null,8,["onUpdate:modelValue"]),[[t.vModelText,D.value.email]])]),t.createVNode("div",null,[t.withDirectives(t.createVNode("input",{"onUpdate:modelValue":e=>D.value.telefono=e,type:"tel",placeholder:"TelÃ©fono",class:"w-full px-3 py-2 border-2 border-neutral-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"},null,8,["onUpdate:modelValue"]),[[t.vModelText,D.value.telefono]])]),t.createVNode("div",null,[t.withDirectives(t.createVNode("input",{"onUpdate:modelValue":e=>D.value.fecha_nacimiento=e,type:"date",placeholder:"Fecha de nacimiento",class:"w-full px-3 py-2 border-2 border-neutral-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"},null,8,["onUpdate:modelValue"]),[[t.vModelText,D.value.fecha_nacimiento]])])]),t.createVNode("button",{type:"button",onClick:crearPacienteYSeleccionar,disabled:!D.value.nombre_completo||!D.value.email||V.value,class:"w-full px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed font-medium flex items-center justify-center gap-2"},[V.value?(t.openBlock(),t.createBlock("svg",{key:0,class:"animate-spin h-5 w-5",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[t.createVNode("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),t.createVNode("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})])):t.createCommentVNode("",!0),t.createTextVNode(" "+t.toDisplayString(V.value?"Creando...":"Crear Paciente"),1)],8,["disabled"])])):(t.openBlock(),t.createBlock("div",{key:0,class:"space-y-2"},[t.createVNode("div",{class:"relative"},[t.createVNode("label",{for:"patient-search",class:"sr-only"},"Buscar paciente"),t.withDirectives(t.createVNode("input",{id:"patient-search","onUpdate:modelValue":e=>t.isRef(p)?p.value=e:null,type:"text",placeholder:"Buscar por nombre, email o telÃ©fono...",autocomplete:"off","aria-describedby":"patient-search-hint","aria-expanded":"showDropdown","aria-haspopup":"listbox",class:"w-full px-4 py-3 pr-10 border-2 border-neutral-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-[#027368] focus:border-transparent transition-all",onFocus:e=>y.value=!0,onBlur:handleBlur},null,40,["onUpdate:modelValue","onFocus"]),[[t.vModelText,t.unref(p)]]),t.createVNode("span",{id:"patient-search-hint",class:"sr-only"},"Escribe para buscar pacientes existentes o crear uno nuevo"),t.createVNode("div",{class:"absolute right-3 top-1/2 -translate-y-1/2"},[t.unref(d)?(t.openBlock(),t.createBlock("svg",{key:0,class:"animate-spin h-5 w-5 text-[#027368]",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[t.createVNode("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),t.createVNode("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})])):(t.openBlock(),t.createBlock("svg",{key:1,class:"h-5 w-5 text-neutral-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t.createVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})]))])]),y.value&&(t.unref(u)||t.unref(p).trim().length>0)?(t.openBlock(),t.createBlock("div",{key:0,class:"absolute z-10 w-full mt-1 bg-white border-2 border-neutral-200 rounded-xl shadow-xl max-h-80 overflow-y-auto",role:"listbox","aria-label":"Resultados de bÃºsqueda de pacientes"},[t.unref(u)?(t.openBlock(),t.createBlock("div",{key:0,class:"px-3 py-1.5 bg-neutral-50 border-b border-neutral-100"},[t.createVNode("span",{class:"text-[10px] text-neutral-400 uppercase tracking-wider"},"Pacientes frecuentes")])):t.createCommentVNode("",!0),(t.openBlock(!0),t.createBlock(t.Fragment,null,t.renderList(t.unref(i),e=>(t.openBlock(),t.createBlock("button",{key:e.id,type:"button",class:"w-full px-3 py-2.5 text-left hover:bg-[#027368]/5 transition-colors border-b border-neutral-100 last:border-0 group",onClick:t=>selectPaciente(e)},[t.createVNode("div",{class:"flex items-center gap-3"},[t.createVNode("div",{class:"w-9 h-9 rounded-full bg-gradient-to-br from-[#027368] to-[#025951] text-white flex items-center justify-center font-bold text-sm flex-shrink-0"},t.toDisplayString(e.nombre_completo.charAt(0).toUpperCase()),1),t.createVNode("div",{class:"flex-1 min-w-0"},[t.createVNode("div",{class:"flex items-center gap-2"},[t.createVNode("p",{class:"font-semibold text-neutral-900 truncate"},t.toDisplayString(e.nombre_completo),1),e.prioridad_score>=100?(t.openBlock(),t.createBlock("span",{key:0,class:"flex-shrink-0 w-2 h-2 rounded-full bg-emerald-500",title:"Cita reciente"})):t.createCommentVNode("",!0)]),t.createVNode("div",{class:"flex items-center gap-2 text-xs text-neutral-500"},[e.total_citas>0?(t.openBlock(),t.createBlock("span",{key:0},t.toDisplayString(e.total_citas)+" citas",1)):t.createCommentVNode("",!0),e.ultima_cita?(t.openBlock(),t.createBlock("span",{key:1,class:"text-neutral-400"},"Â·")):t.createCommentVNode("",!0),e.ultima_cita?(t.openBlock(),t.createBlock("span",{key:2,class:"text-neutral-400"}," Ãšltima: "+t.toDisplayString(formatRelativeDate(e.ultima_cita)),1)):t.createCommentVNode("",!0)])]),e.sesiones_restantes_total>0?(t.openBlock(),t.createBlock("div",{key:0,class:"flex-shrink-0 px-2.5 py-1 bg-emerald-100 text-emerald-700 rounded-full text-xs font-bold"},[t.createTextVNode(t.toDisplayString(e.sesiones_restantes_total)+" ",1),t.createVNode("span",{class:"font-medium"},"ses.")])):(t.openBlock(),t.createBlock("div",{key:1,class:"flex-shrink-0 px-2 py-1 bg-neutral-100 text-neutral-500 rounded-full text-xs"}," Sin bono "))])],8,["onClick"]))),128)),t.createVNode("button",{type:"button",class:"w-full px-3 py-3 text-left bg-gradient-to-r from-[#027368]/5 to-transparent hover:from-[#027368]/10 transition-colors border-t-2 border-[#027368]/20 font-medium text-[#027368] flex items-center gap-2",onClick:activarModoCrearPaciente},[t.createVNode("div",{class:"w-9 h-9 rounded-full bg-[#027368]/10 flex items-center justify-center"},[(t.openBlock(),t.createBlock("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t.createVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})]))]),t.createVNode("div",null,[t.createVNode("p",{class:"font-semibold"},"Crear nuevo paciente"),t.unref(p).trim().length>0?(t.openBlock(),t.createBlock("p",{key:0,class:"text-xs text-neutral-500"},' "'+t.toDisplayString(t.unref(p).trim())+'" ',1)):t.createCommentVNode("",!0)])]),!t.unref(u)&&!t.unref(d)&&t.unref(p).trim().length>0?(t.openBlock(),t.createBlock("div",{key:1,class:"px-4 py-6 text-center text-neutral-500"},[(t.openBlock(),t.createBlock("svg",{class:"w-10 h-10 mx-auto mb-2 text-neutral-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t.createVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})])),t.createVNode("p",{class:"font-medium text-sm"},'No se encontrÃ³ "'+t.toDisplayString(t.unref(p))+'"',1),t.createVNode("p",{class:"text-xs mt-1"},"Prueba con otro nombre o crea un nuevo paciente")])):t.createCommentVNode("",!0)])):t.createCommentVNode("",!0),S.value.paciente_id&&_.value?(t.openBlock(),t.createBlock("div",{key:1,class:"space-y-3"},[t.createVNode("div",{class:"bg-gradient-to-r from-emerald-50 to-teal-50 border-2 border-emerald-200 rounded-xl overflow-hidden"},[0!==_.value.total_citas&&_.value.bono_activo?t.createCommentVNode("",!0):(t.openBlock(),t.createBlock("div",{key:0,class:["px-3 py-1.5 text-xs font-medium flex items-center gap-2",0===_.value.total_citas?"bg-blue-100 text-blue-700":"bg-amber-100 text-amber-700"]},[(t.openBlock(),t.createBlock("svg",{class:"w-3.5 h-3.5",fill:"currentColor",viewBox:"0 0 20 20"},[0===_.value.total_citas?(t.openBlock(),t.createBlock("path",{key:0,"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm1-11a1 1 0 10-2 0v2H7a1 1 0 100 2h2v2a1 1 0 102 0v-2h2a1 1 0 100-2h-2V7z","clip-rule":"evenodd"})):(t.openBlock(),t.createBlock("path",{key:1,"fill-rule":"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z","clip-rule":"evenodd"}))])),t.createTextVNode(" "+t.toDisplayString(0===_.value.total_citas?"Paciente nuevo - Primera cita":"Sin bono activo"),1)],2)),t.createVNode("div",{class:"px-4 py-3"},[t.createVNode("div",{class:"flex items-center justify-between"},[t.createVNode("div",{class:"flex items-center gap-3"},[t.createVNode("div",{class:"w-11 h-11 rounded-full bg-gradient-to-br from-emerald-500 to-teal-600 text-white flex items-center justify-center font-bold text-lg shadow-sm"},t.toDisplayString(_.value.nombre_completo.charAt(0).toUpperCase()),1),t.createVNode("div",null,[t.createVNode("p",{class:"font-semibold text-neutral-900"},t.toDisplayString(_.value.nombre_completo),1),t.createVNode("p",{class:"text-xs text-neutral-500"},t.toDisplayString(_.value.email),1)])]),t.createVNode("div",{class:"flex items-center gap-2"},[t.createVNode("a",{href:`/terapeuta/pacientes/${_.value.id}`,target:"_blank",class:"p-2 text-neutral-400 hover:text-[#027368] hover:bg-white rounded-lg transition-colors",title:"Ver perfil completo"},[(t.openBlock(),t.createBlock("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t.createVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})]))],8,["href"]),t.createVNode("button",{type:"button",onClick:limpiarSeleccion,class:"p-2 hover:bg-white rounded-lg transition-colors text-neutral-400 hover:text-red-500",title:"Cambiar paciente"},[(t.openBlock(),t.createBlock("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t.createVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})]))])])]),t.createVNode("div",{class:"mt-3 grid grid-cols-3 gap-2 text-center"},[t.createVNode("div",{class:"bg-white/60 rounded-lg px-2 py-1.5"},[t.createVNode("p",{class:"text-xs text-neutral-500"},"Ãšltima cita"),t.createVNode("p",{class:"text-sm font-semibold text-neutral-700"},t.toDisplayString(_.value.ultima_cita?formatRelativeDate(_.value.ultima_cita):"Nunca"),1)]),t.createVNode("div",{class:"bg-white/60 rounded-lg px-2 py-1.5"},[t.createVNode("p",{class:"text-xs text-neutral-500"},"Total citas"),t.createVNode("p",{class:"text-sm font-semibold text-neutral-700"},t.toDisplayString(_.value.total_citas||0),1)]),t.createVNode("div",{class:"bg-white/60 rounded-lg px-2 py-1.5"},[t.createVNode("p",{class:"text-xs text-neutral-500"},"Sesiones"),t.createVNode("p",{class:["text-sm font-semibold",_.value.sesiones_restantes_total>0?"text-emerald-600":"text-neutral-400"]},t.toDisplayString(_.value.sesiones_restantes_total||0)+" disp. ",3)])])])]),_.value.bono_activo?(t.openBlock(),t.createBlock("div",{key:0,class:"px-4 py-3 bg-violet-50 border-2 border-violet-200 rounded-xl"},[t.createVNode("div",{class:"flex items-start justify-between"},[t.createVNode("div",{class:"flex items-center gap-2"},[t.createVNode("div",{class:"w-8 h-8 rounded-lg bg-violet-600 text-white flex items-center justify-center"},[(t.openBlock(),t.createBlock("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t.createVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 5v2m0 4v2m0 4v2M5 5a2 2 0 00-2 2v3a2 2 0 110 4v3a2 2 0 002 2h14a2 2 0 002-2v-3a2 2 0 110-4V7a2 2 0 00-2-2H5z"})]))]),t.createVNode("div",null,[t.createVNode("p",{class:"font-semibold text-violet-900"},t.toDisplayString(_.value.bono_activo.tipo),1),t.createVNode("p",{class:"text-sm text-violet-700"},t.toDisplayString(_.value.bono_activo.sesiones_restantes)+" de "+t.toDisplayString(_.value.bono_activo.sesiones_totales)+" sesiones disponibles ",1)])]),t.createVNode("div",{class:"flex items-center gap-1"},[(t.openBlock(!0),t.createBlock(t.Fragment,null,t.renderList(Math.min(_.value.bono_activo.sesiones_totales,10),e=>(t.openBlock(),t.createBlock("div",{key:e,class:["w-3 h-3 rounded-full",e<=_.value.bono_activo.sesiones_usadas?"bg-violet-600":"bg-violet-200"],title:e<=_.value.bono_activo.sesiones_usadas?"SesiÃ³n usada":"SesiÃ³n disponible"},null,10,["title"]))),128)),_.value.bono_activo.sesiones_totales>10?(t.openBlock(),t.createBlock("span",{key:0,class:"text-xs text-violet-500 ml-1"}," +"+t.toDisplayString(_.value.bono_activo.sesiones_totales-10),1)):t.createCommentVNode("",!0)])]),t.createVNode("div",{class:"mt-3 p-2 bg-amber-50 border border-amber-200 rounded-lg"},[t.createVNode("p",{class:"text-xs text-amber-800 flex items-start gap-2"},[(t.openBlock(),t.createBlock("svg",{class:"w-4 h-4 flex-shrink-0 mt-0.5",fill:"currentColor",viewBox:"0 0 20 20"},[t.createVNode("path",{"fill-rule":"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z","clip-rule":"evenodd"})])),t.createVNode("span",null,[t.createTextVNode(" Esta serÃ¡ la sesiÃ³n "),t.createVNode("strong",null,t.toDisplayString(_.value.bono_activo.sesiones_usadas+1)+"/"+t.toDisplayString(_.value.bono_activo.sesiones_totales),1),t.createTextVNode(" del bono. Se descontarÃ¡ automÃ¡ticamente cuando la cita sea "),t.createVNode("strong",null,"confirmada"),t.createTextVNode(". ")])])]),_.value.bono_activo.fecha_fin?(t.openBlock(),t.createBlock("p",{key:0,class:"mt-2 text-xs text-violet-600"}," Vence: "+t.toDisplayString(formatDate(_.value.bono_activo.fecha_fin)),1)):t.createCommentVNode("",!0)])):(t.openBlock(),t.createBlock("div",{key:1,class:"px-4 py-3 bg-amber-50 border-2 border-amber-200 rounded-xl"},[t.createVNode("div",{class:"flex items-start gap-3"},[t.createVNode("div",{class:"w-8 h-8 rounded-lg bg-amber-200 text-amber-700 flex items-center justify-center flex-shrink-0"},[(t.openBlock(),t.createBlock("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t.createVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})]))]),t.createVNode("div",null,[t.createVNode("p",{class:"font-medium text-amber-800 text-sm"},"Sin bono activo"),t.createVNode("p",{class:"text-xs text-amber-600 mt-0.5"},"Esta sesiÃ³n se facturarÃ¡ de forma individual.")])])])),_.value.bonos&&_.value.bonos.length>1?(t.openBlock(),t.createBlock("div",{key:2,class:"mt-2"},[t.createVNode("label",{class:"block text-sm font-medium text-neutral-700 mb-1"}," Seleccionar bono a usar "),t.withDirectives(t.createVNode("select",{"onUpdate:modelValue":e=>S.value.bono_id=e,class:"w-full px-3 py-2 border-2 border-neutral-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-violet-500 focus:border-transparent text-sm"},[(t.openBlock(!0),t.createBlock(t.Fragment,null,t.renderList(_.value.bonos,e=>(t.openBlock(),t.createBlock("option",{key:e.id,value:e.id},t.toDisplayString(e.tipo)+" - "+t.toDisplayString(e.sesiones_restantes)+"/"+t.toDisplayString(e.sesiones_totales)+" sesiones ",9,["value"]))),128))],8,["onUpdate:modelValue"]),[[t.vModelSelect,S.value.bono_id]])])):t.createCommentVNode("",!0)])):t.createCommentVNode("",!0)]))])]),t.createVNode("section",{class:"space-y-4 pt-2"},[t.createVNode("div",{class:"flex items-center gap-2 pb-2 border-b border-neutral-100"},[t.createVNode("div",{class:"w-6 h-6 rounded-lg bg-blue-100 flex items-center justify-center"},[(t.openBlock(),t.createBlock("svg",{class:"w-3.5 h-3.5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t.createVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})]))]),t.createVNode("h4",{class:"text-sm font-semibold text-neutral-700"},"Fecha y Hora"),t.createVNode("span",{class:"text-xs text-red-500"},"*")]),t.createVNode("div",null,[t.createVNode("label",{for:"fecha-cita",class:"sr-only"},"Fecha de la cita"),t.createVNode("div",{class:"flex flex-wrap gap-2 mb-2",role:"group","aria-label":"Fechas rÃ¡pidas"},[(t.openBlock(!0),t.createBlock(t.Fragment,null,t.renderList(G.value,e=>(t.openBlock(),t.createBlock("button",{key:e.label,type:"button",onClick:t=>aplicarShortcutFecha(e),class:["px-3 py-1.5 text-xs font-medium rounded-lg transition-all focus:outline-none focus:ring-2 focus:ring-[#027368] focus:ring-offset-1",S.value.fecha_cita===e.fecha?"bg-[#027368] text-white":"bg-neutral-100 text-neutral-600 hover:bg-neutral-200"],"aria-pressed":S.value.fecha_cita===e.fecha},t.toDisplayString(e.label),11,["onClick","aria-pressed"]))),128))]),t.withDirectives(t.createVNode("input",{id:"fecha-cita","onUpdate:modelValue":e=>S.value.fecha_cita=e,type:"date",required:"",min:q.value,"aria-required":"true",class:"w-full px-4 py-3 border-2 border-neutral-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-[#027368] focus:border-transparent transition-all",onChange:validateInRealTime},null,40,["onUpdate:modelValue","min"]),[[t.vModelText,S.value.fecha_cita]]),S.value.fecha_cita?(t.openBlock(),t.createBlock("p",{key:0,class:"mt-1 text-xs text-neutral-500"},t.toDisplayString(formatearFechaCompleta(S.value.fecha_cita)),1)):t.createCommentVNode("",!0)]),H.value&&!S.value.hora_inicio?(t.openBlock(),t.createBlock("div",{key:0,class:"px-3 py-2 bg-violet-50 border border-violet-200 rounded-lg flex items-center justify-between"},[t.createVNode("div",{class:"flex items-center gap-2 text-violet-700 text-sm"},[(t.openBlock(),t.createBlock("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true"},[t.createVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})])),t.createVNode("span",null,t.toDisplayString(H.value.razon),1)]),t.createVNode("button",{type:"button",onClick:e=>S.value.hora_inicio=H.value.hora,class:"px-2 py-1 bg-violet-600 text-white text-xs font-medium rounded hover:bg-violet-700 transition-colors"}," Usar "+t.toDisplayString(H.value.hora),9,["onClick"])])):t.createCommentVNode("",!0),t.createVNode("div",{class:"grid grid-cols-2 gap-4"},[t.createVNode("div",null,[t.createVNode("label",{class:"block text-sm font-semibold text-neutral-700 mb-2"}," Hora inicio * "),t.withDirectives(t.createVNode("select",{"onUpdate:modelValue":e=>S.value.hora_inicio=e,required:"",class:"w-full px-4 py-3 border-2 border-neutral-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-[#027368] focus:border-transparent transition-all bg-white appearance-none cursor-pointer",onChange:onHoraInicioChange},[t.createVNode("option",{value:"",disabled:""},"Seleccionar hora"),(t.openBlock(!0),t.createBlock(t.Fragment,null,t.renderList(Z.value,e=>(t.openBlock(),t.createBlock("option",{key:e.value,value:e.value},t.toDisplayString(e.label),9,["value"]))),128))],40,["onUpdate:modelValue"]),[[t.vModelSelect,S.value.hora_inicio]])]),t.createVNode("div",null,[t.createVNode("label",{class:"block text-sm font-semibold text-neutral-700 mb-2"},[t.createTextVNode(" Hora fin * "),t.createVNode("span",{class:"font-normal text-neutral-400"},"("+t.toDisplayString(Y.value)+")",1)]),t.withDirectives(t.createVNode("select",{"onUpdate:modelValue":e=>S.value.hora_fin=e,required:"",class:"w-full px-4 py-3 border-2 border-neutral-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-[#027368] focus:border-transparent transition-all bg-white appearance-none cursor-pointer",onChange:validateInRealTime},[t.createVNode("option",{value:"",disabled:""},"Seleccionar hora"),(t.openBlock(!0),t.createBlock(t.Fragment,null,t.renderList(W.value,e=>(t.openBlock(),t.createBlock("option",{key:e.value,value:e.value},t.toDisplayString(e.label),9,["value"]))),128))],40,["onUpdate:modelValue"]),[[t.vModelSelect,S.value.hora_fin]])])]),t.createVNode("div",{class:"flex items-center gap-2"},[t.createVNode("span",{class:"text-xs text-neutral-500"},"DuraciÃ³n rÃ¡pida:"),(t.openBlock(),t.createBlock(t.Fragment,null,t.renderList(O,e=>t.createVNode("button",{key:e.minutos,type:"button",onClick:t=>aplicarDuracion(e.minutos),class:["px-2 py-1 text-xs rounded-md transition-all",calcularDuracionMinutos()===e.minutos?"bg-[#027368]/10 text-[#027368] font-medium":"bg-neutral-100 text-neutral-500 hover:bg-neutral-200"]},t.toDisplayString(e.label),11,["onClick"])),64))]),C.value?(t.openBlock(),t.createBlock("div",{key:1,class:["px-4 py-3 rounded-xl flex items-start gap-3",{"bg-red-50 border-2 border-red-200":"error"===C.value.type,"bg-yellow-50 border-2 border-yellow-200":"warning"===C.value.type,"bg-emerald-50 border-2 border-emerald-200":"success"===C.value.type}]},[(t.openBlock(),t.createBlock("svg",{class:["w-5 h-5 mt-0.5 flex-shrink-0",{"text-red-600":"error"===C.value.type,"text-yellow-600":"warning"===C.value.type,"text-emerald-600":"success"===C.value.type}],fill:"currentColor",viewBox:"0 0 20 20"},["error"===C.value.type?(t.openBlock(),t.createBlock("path",{key:0,"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z","clip-rule":"evenodd"})):"success"===C.value.type?(t.openBlock(),t.createBlock("path",{key:1,"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z","clip-rule":"evenodd"})):(t.openBlock(),t.createBlock("path",{key:2,"fill-rule":"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z","clip-rule":"evenodd"}))],2)),t.createVNode("p",{class:["text-sm font-medium flex-1",{"text-red-800":"error"===C.value.type,"text-yellow-800":"warning"===C.value.type,"text-emerald-800":"success"===C.value.type}]},t.toDisplayString(C.value.text),3)],2)):t.createCommentVNode("",!0)]),t.createVNode("section",{class:"space-y-4 pt-2"},[t.createVNode("div",{class:"flex items-center gap-2 pb-2 border-b border-neutral-100"},[t.createVNode("div",{class:"w-6 h-6 rounded-lg bg-violet-100 flex items-center justify-center"},[(t.openBlock(),t.createBlock("svg",{class:"w-3.5 h-3.5 text-violet-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t.createVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"})]))]),t.createVNode("h4",{class:"text-sm font-semibold text-neutral-700"},"Modalidad"),t.createVNode("span",{class:"text-xs text-red-500"},"*"),F.value&&S.value.modalidad!==F.value?(t.openBlock(),t.createBlock("span",{key:0,class:"ml-auto text-[10px] px-2 py-0.5 bg-amber-100 text-amber-700 rounded-full flex items-center gap-1 cursor-pointer hover:bg-amber-200 transition-colors",onClick:e=>seleccionarModalidad(F.value),title:`Normalmente usas ${F.value} los ${U.value}`},[(t.openBlock(),t.createBlock("svg",{class:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true"},[t.createVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})])),t.createTextVNode(" "+t.toDisplayString(z.find(e=>e.value===F.value)?.label)+" los "+t.toDisplayString(U.value),1)],8,["onClick","title"])):t.createCommentVNode("",!0)]),t.createVNode("div",{class:"grid grid-cols-3 gap-3"},[(t.openBlock(),t.createBlock(t.Fragment,null,t.renderList(z,e=>t.createVNode("button",{key:e.value,type:"button",onClick:t=>seleccionarModalidad(e.value),class:["relative px-4 py-4 rounded-xl border-2 transition-all font-medium flex flex-col items-center gap-2 group",S.value.modalidad===e.value?"border-[#027368] bg-gradient-to-br from-[#027368]/10 to-[#027368]/5 text-[#027368] shadow-md":"border-neutral-200 text-neutral-600 hover:border-neutral-300 hover:bg-neutral-50"]},[S.value.modalidad===e.value?(t.openBlock(),t.createBlock("div",{key:0,class:"absolute top-2 right-2 w-5 h-5 bg-[#027368] rounded-full flex items-center justify-center"},[(t.openBlock(),t.createBlock("svg",{class:"w-3 h-3 text-white",fill:"currentColor",viewBox:"0 0 20 20"},[t.createVNode("path",{"fill-rule":"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z","clip-rule":"evenodd"})]))])):t.createCommentVNode("",!0),t.createVNode("span",{class:"text-2xl"},t.toDisplayString(e.icon),1),t.createVNode("span",{class:"text-sm font-semibold"},t.toDisplayString(e.label),1),t.createVNode("span",{class:"text-[10px] text-neutral-400 group-hover:text-neutral-500"},t.toDisplayString(e.descripcion),1)],10,["onClick"])),64))]),"presencial"===S.value.modalidad?(t.openBlock(),t.createBlock("div",{key:0,class:"space-y-2"},[t.createVNode("label",{id:"ubicacion-label",class:"block text-sm font-semibold text-neutral-700"},[t.createTextVNode(" Sala / Consultorio "),t.createVNode("span",{class:"font-normal text-neutral-400"},"(opcional)")]),t.createVNode("div",{class:"relative"},[t.createVNode("div",{class:"absolute left-3 top-1/2 -translate-y-1/2 text-neutral-400"},[(t.openBlock(),t.createBlock("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true"},[t.createVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})]))]),t.withDirectives(t.createVNode("input",{"onUpdate:modelValue":e=>S.value.ubicacion=e,type:"text","aria-labelledby":"ubicacion-label",placeholder:"Ej: Consultorio 3, Sala de terapia...",class:"w-full pl-10 pr-4 py-3 border-2 border-neutral-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-[#027368] focus:border-transparent transition-all"},null,8,["onUpdate:modelValue"]),[[t.vModelText,S.value.ubicacion]])])])):t.createCommentVNode("",!0),"online"===S.value.modalidad?(t.openBlock(),t.createBlock("div",{key:1,class:"space-y-2"},[t.createVNode("label",{id:"enlace-label",class:"block text-sm font-semibold text-neutral-700"},[t.createTextVNode(" Enlace de videollamada "),t.createVNode("span",{class:"font-normal text-neutral-400"},"(opcional)")]),t.createVNode("div",{class:"relative"},[t.createVNode("div",{class:"absolute left-3 top-1/2 -translate-y-1/2"},["meet"===K.value?(t.openBlock(),t.createBlock("img",{key:0,src:"https://www.gstatic.com/meet/google_meet_horizontal_wordmark_2020q4_1x_icon_124_40_2373e79660dabbf194273d27aa7ee1f5.png",alt:"Google Meet",class:"w-5 h-5 object-contain"})):"zoom"===K.value?(t.openBlock(),t.createBlock("img",{key:1,src:"https://st1.zoom.us/zoom.ico",alt:"Zoom",class:"w-5 h-5 object-contain"})):"teams"===K.value?(t.openBlock(),t.createBlock("img",{key:2,src:"https://cdn-icons-png.flaticon.com/512/906/906349.png",alt:"Teams",class:"w-5 h-5 object-contain"})):(t.openBlock(),t.createBlock("svg",{key:3,class:"w-5 h-5 text-neutral-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true"},[t.createVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"})]))]),t.withDirectives(t.createVNode("input",{"onUpdate:modelValue":e=>S.value.enlace_videollamada=e,type:"url","aria-labelledby":"enlace-label","aria-invalid":!1===J.value,placeholder:"Pega el enlace de Meet, Zoom o Teams...",class:["w-full pl-10 pr-4 py-3 border-2 rounded-xl focus:outline-none focus:ring-2 focus:ring-[#027368] focus:border-transparent transition-all",!1===J.value?"border-red-300 bg-red-50":!0===J.value?"border-emerald-300 bg-emerald-50":"border-neutral-200"]},null,10,["onUpdate:modelValue","aria-invalid"]),[[t.vModelText,S.value.enlace_videollamada]]),K.value&&J.value?(t.openBlock(),t.createBlock("div",{key:0,class:"absolute right-3 top-1/2 -translate-y-1/2 px-2 py-0.5 bg-emerald-100 text-emerald-700 rounded text-xs font-medium"},t.toDisplayString(X.value),1)):t.createCommentVNode("",!0)]),S.value.enlace_videollamada&&!1===J.value?(t.openBlock(),t.createBlock("p",{key:0,class:"text-xs text-red-600",role:"alert"}," Enlace no reconocido. Usa Google Meet, Zoom o Microsoft Teams. ")):S.value.enlace_videollamada?t.createCommentVNode("",!0):(t.openBlock(),t.createBlock("p",{key:1,class:"text-xs text-neutral-400"}," Compatible con Google Meet, Zoom y Microsoft Teams "))])):t.createCommentVNode("",!0),"telefonica"===S.value.modalidad?(t.openBlock(),t.createBlock("div",{key:2,class:"px-4 py-3 bg-blue-50 border border-blue-200 rounded-xl",role:"note"},[t.createVNode("div",{class:"flex items-start gap-2 text-blue-700"},[(t.openBlock(),t.createBlock("svg",{class:"w-5 h-5 mt-0.5 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true"},[t.createVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})])),t.createVNode("div",{class:"text-sm"},[t.createVNode("p",{class:"font-medium"},"SesiÃ³n por telÃ©fono"),t.createVNode("p",{class:"text-blue-600 text-xs mt-0.5"},"Se utilizarÃ¡ el nÃºmero de contacto del paciente para la llamada.")])])])):t.createCommentVNode("",!0)]),t.createVNode("section",{class:"space-y-3 pt-2"},[t.createVNode("div",{class:"flex items-center gap-2 pb-2 border-b border-neutral-100"},[t.createVNode("div",{class:"w-6 h-6 rounded-lg bg-amber-100 flex items-center justify-center"},[(t.openBlock(),t.createBlock("svg",{class:"w-3.5 h-3.5 text-amber-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t.createVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})]))]),t.createVNode("h4",{class:"text-sm font-semibold text-neutral-700"},"Observaciones"),t.createVNode("span",{class:"text-xs text-neutral-400"},"(opcional)"),S.value.observaciones?(t.openBlock(),t.createBlock("span",{key:0,class:["ml-auto text-xs",(S.value.observaciones?.length||0)>450?"text-amber-600":"text-neutral-400"]},t.toDisplayString(S.value.observaciones?.length||0)+"/500 ",3)):t.createCommentVNode("",!0)]),t.createVNode("div",{class:"flex flex-wrap gap-1.5",role:"group","aria-label":"Plantillas rÃ¡pidas de observaciÃ³n"},[(t.openBlock(),t.createBlock(t.Fragment,null,t.renderList(I,e=>t.createVNode("button",{key:e.texto,type:"button",onClick:t=>aplicarTemplateObservacion(e.texto),class:["px-2.5 py-1 text-xs rounded-lg transition-all flex items-center gap-1 focus:outline-none focus:ring-2 focus:ring-[#027368] focus:ring-offset-1",S.value.observaciones?.includes(e.texto)?"bg-[#027368]/10 text-[#027368] font-medium":"bg-neutral-100 text-neutral-600 hover:bg-neutral-200"],"aria-pressed":S.value.observaciones?.includes(e.texto)},[t.createVNode("span",{"aria-hidden":"true"},t.toDisplayString(e.emoji),1),t.createVNode("span",null,t.toDisplayString(e.label),1)],10,["onClick","aria-pressed"])),64))]),t.createVNode("div",{class:"relative"},[t.withDirectives(t.createVNode("textarea",{id:"observaciones-textarea","onUpdate:modelValue":e=>S.value.observaciones=e,rows:R.value?5:2,maxlength:"500","aria-label":"Observaciones","aria-describedby":"observaciones-hint",placeholder:"Ej: Primera sesiÃ³n de evaluaciÃ³n, seguimiento ansiedad, revisiÃ³n de objetivos terapÃ©uticos...",class:"w-full px-4 py-3 border-2 border-neutral-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-[#027368] focus:border-transparent transition-all resize-none",onFocus:e=>R.value=!0,onBlur:e=>R.value=S.value.observaciones?.length>0},null,40,["onUpdate:modelValue","rows","onFocus","onBlur"]),[[t.vModelText,S.value.observaciones]]),t.createVNode("span",{id:"observaciones-hint",class:"sr-only"},"MÃ¡ximo 500 caracteres. Usa las plantillas rÃ¡pidas para aÃ±adir texto predefinido."),R.value||S.value.observaciones?t.createCommentVNode("",!0):(t.openBlock(),t.createBlock("button",{key:0,type:"button",onClick:e=>R.value=!0,class:"absolute bottom-2 right-2 text-xs text-neutral-400 hover:text-neutral-600 flex items-center gap-1 focus:outline-none focus:text-[#027368]","aria-label":"Expandir campo de observaciones"},[(t.openBlock(),t.createBlock("svg",{class:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true"},[t.createVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"})])),t.createTextVNode(" Expandir ")],8,["onClick"]))])]),t.createVNode("div",{class:"space-y-3 pt-6 border-t border-neutral-100"},[t.createVNode("div",{class:"flex flex-col sm:flex-row gap-3"},[t.createVNode("button",{type:"button",onClick:handleClose,class:"order-3 sm:order-1 px-6 py-3 bg-neutral-100 text-neutral-700 rounded-xl hover:bg-neutral-200 transition-all font-semibold focus:outline-none focus:ring-2 focus:ring-neutral-400 focus:ring-offset-2"}," Cancelar "),t.createVNode("button",{type:"button",onClick:handleSubmitAndNew,disabled:N.value||!ee.value,class:"order-2 flex-1 px-4 py-3 border-2 border-[#027368] text-[#027368] rounded-xl hover:bg-[#027368]/5 transition-all font-semibold disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2 focus:outline-none focus:ring-2 focus:ring-[#027368] focus:ring-offset-2"},[(t.openBlock(),t.createBlock("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true"},[t.createVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})])),t.createVNode("span",{class:"hidden sm:inline"},"Crear y agendar otra"),t.createVNode("span",{class:"sm:hidden"},"+ Otra")],8,["disabled"]),t.createVNode("button",{type:"submit",disabled:N.value||!ee.value,class:"order-1 sm:order-3 flex-1 px-6 py-3 bg-gradient-to-r from-[#027368] to-[#025951] text-white rounded-xl hover:shadow-lg hover:shadow-[#027368]/25 transition-all font-semibold disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2 focus:outline-none focus:ring-2 focus:ring-[#027368] focus:ring-offset-2"},[N.value?(t.openBlock(),t.createBlock("svg",{key:0,class:"animate-spin h-5 w-5",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","aria-hidden":"true"},[t.createVNode("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),t.createVNode("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})])):(t.openBlock(),t.createBlock("svg",{key:1,class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true"},[t.createVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})])),t.createTextVNode(" "+t.toDisplayString(N.value?"Creando...":"Crear Cita"),1)],8,["disabled"])]),t.createVNode("div",{class:"hidden md:flex items-center justify-end gap-4 text-xs text-neutral-400"},[t.createVNode("span",{class:"flex items-center gap-1"},[t.createVNode("kbd",{class:"px-1.5 py-0.5 bg-neutral-100 rounded text-neutral-500 font-mono"},"Esc"),t.createVNode("span",null,"Cancelar")]),t.createVNode("span",{class:"flex items-center gap-1"},[t.createVNode("kbd",{class:"px-1.5 py-0.5 bg-neutral-100 rounded text-neutral-500 font-mono"},"Ctrl"),t.createVNode("span",null,"+"),t.createVNode("kbd",{class:"px-1.5 py-0.5 bg-neutral-100 rounded text-neutral-500 font-mono"},"Enter"),t.createVNode("span",null,"Crear")])])])],32)]),_:1})]),_:1})])])];o(a.ssrRenderComponent(t.unref(ge),{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0","enter-to":"opacity-100",leave:"duration-200 ease-in","leave-from":"opacity-100","leave-to":"opacity-0"},{default:t.withCtx((e,a,o,l)=>{if(!a)return[t.createVNode("div",{class:"fixed inset-0 bg-black/30 backdrop-blur-sm"})];a(`<div class="fixed inset-0 bg-black/30 backdrop-blur-sm" data-v-97295d59${l}></div>`)}),_:1},l,r)),o(`<div class="fixed inset-0 overflow-y-auto" data-v-97295d59${r}><div class="flex min-h-full items-center justify-center p-4 text-center" data-v-97295d59${r}>`),o(a.ssrRenderComponent(t.unref(ge),{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0 scale-95","enter-to":"opacity-100 scale-100",leave:"duration-200 ease-in","leave-from":"opacity-100 scale-100","leave-to":"opacity-0 scale-95"},{default:t.withCtx((e,o,l,r)=>{if(!o)return[t.createVNode(t.unref(pe),{class:"w-full max-w-2xl transform overflow-hidden rounded-3xl bg-white p-6 sm:p-8 text-left align-middle shadow-2xl transition-all max-h-[90vh] overflow-y-auto",role:"dialog","aria-modal":"true","aria-labelledby":"modal-title"},{default:t.withCtx(()=>[t.createVNode(t.unref(ve),{as:"h3",id:"modal-title",class:"text-xl sm:text-2xl font-bold text-neutral-900 mb-4 sm:mb-6 flex items-center gap-3"},{default:t.withCtx(()=>[t.createVNode("div",{class:"w-9 h-9 sm:w-10 sm:h-10 rounded-xl bg-gradient-to-br from-[#027368] to-[#025951] flex items-center justify-center text-white flex-shrink-0"},[(t.openBlock(),t.createBlock("svg",{class:"w-4 h-4 sm:w-5 sm:h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true"},[t.createVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})]))]),t.createTextVNode(" Nueva Cita ")]),_:1}),t.createVNode("form",{onSubmit:t.withModifiers(handleSubmit,["prevent"]),class:"space-y-6"},[t.createVNode("section",{class:"space-y-3"},[t.createVNode("div",{class:"flex items-center gap-2 pb-2 border-b border-neutral-100"},[t.createVNode("div",{class:"w-6 h-6 rounded-lg bg-emerald-100 flex items-center justify-center"},[(t.openBlock(),t.createBlock("svg",{class:"w-3.5 h-3.5 text-emerald-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t.createVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})]))]),t.createVNode("h4",{class:"text-sm font-semibold text-neutral-700"},"Paciente"),t.createVNode("span",{class:"text-xs text-red-500"},"*")]),t.createVNode("div",{class:"relative"},[w.value?(t.openBlock(),t.createBlock("div",{key:1,class:"space-y-4 p-4 bg-blue-50 border-2 border-blue-200 rounded-xl"},[t.createVNode("div",{class:"flex items-center justify-between mb-3"},[t.createVNode("h4",{class:"font-semibold text-neutral-900 flex items-center gap-2"},[(t.openBlock(),t.createBlock("svg",{class:"w-5 h-5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t.createVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M18 9v3m0 0v3m0-3h3m-3 0h-3m-2-5a4 4 0 11-8 0 4 4 0 018 0zM3 20a6 6 0 0112 0v1H3v-1z"})])),t.createTextVNode(" Crear Nuevo Paciente ")]),t.createVNode("button",{type:"button",onClick:cancelarCrearPaciente,class:"text-sm text-neutral-600 hover:text-neutral-900"}," Cancelar ")]),t.createVNode("div",{class:"grid grid-cols-2 gap-3"},[t.createVNode("div",{class:"col-span-2"},[t.withDirectives(t.createVNode("input",{"onUpdate:modelValue":e=>D.value.nombre_completo=e,type:"text",placeholder:"Nombre completo *",class:"w-full px-3 py-2 border-2 border-neutral-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"},null,8,["onUpdate:modelValue"]),[[t.vModelText,D.value.nombre_completo]])]),t.createVNode("div",{class:"col-span-2"},[t.withDirectives(t.createVNode("input",{"onUpdate:modelValue":e=>D.value.email=e,type:"email",placeholder:"Email *",class:"w-full px-3 py-2 border-2 border-neutral-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"},null,8,["onUpdate:modelValue"]),[[t.vModelText,D.value.email]])]),t.createVNode("div",null,[t.withDirectives(t.createVNode("input",{"onUpdate:modelValue":e=>D.value.telefono=e,type:"tel",placeholder:"TelÃ©fono",class:"w-full px-3 py-2 border-2 border-neutral-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"},null,8,["onUpdate:modelValue"]),[[t.vModelText,D.value.telefono]])]),t.createVNode("div",null,[t.withDirectives(t.createVNode("input",{"onUpdate:modelValue":e=>D.value.fecha_nacimiento=e,type:"date",placeholder:"Fecha de nacimiento",class:"w-full px-3 py-2 border-2 border-neutral-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"},null,8,["onUpdate:modelValue"]),[[t.vModelText,D.value.fecha_nacimiento]])])]),t.createVNode("button",{type:"button",onClick:crearPacienteYSeleccionar,disabled:!D.value.nombre_completo||!D.value.email||V.value,class:"w-full px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed font-medium flex items-center justify-center gap-2"},[V.value?(t.openBlock(),t.createBlock("svg",{key:0,class:"animate-spin h-5 w-5",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[t.createVNode("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),t.createVNode("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})])):t.createCommentVNode("",!0),t.createTextVNode(" "+t.toDisplayString(V.value?"Creando...":"Crear Paciente"),1)],8,["disabled"])])):(t.openBlock(),t.createBlock("div",{key:0,class:"space-y-2"},[t.createVNode("div",{class:"relative"},[t.createVNode("label",{for:"patient-search",class:"sr-only"},"Buscar paciente"),t.withDirectives(t.createVNode("input",{id:"patient-search","onUpdate:modelValue":e=>t.isRef(p)?p.value=e:null,type:"text",placeholder:"Buscar por nombre, email o telÃ©fono...",autocomplete:"off","aria-describedby":"patient-search-hint","aria-expanded":"showDropdown","aria-haspopup":"listbox",class:"w-full px-4 py-3 pr-10 border-2 border-neutral-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-[#027368] focus:border-transparent transition-all",onFocus:e=>y.value=!0,onBlur:handleBlur},null,40,["onUpdate:modelValue","onFocus"]),[[t.vModelText,t.unref(p)]]),t.createVNode("span",{id:"patient-search-hint",class:"sr-only"},"Escribe para buscar pacientes existentes o crear uno nuevo"),t.createVNode("div",{class:"absolute right-3 top-1/2 -translate-y-1/2"},[t.unref(d)?(t.openBlock(),t.createBlock("svg",{key:0,class:"animate-spin h-5 w-5 text-[#027368]",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[t.createVNode("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),t.createVNode("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})])):(t.openBlock(),t.createBlock("svg",{key:1,class:"h-5 w-5 text-neutral-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t.createVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})]))])]),y.value&&(t.unref(u)||t.unref(p).trim().length>0)?(t.openBlock(),t.createBlock("div",{key:0,class:"absolute z-10 w-full mt-1 bg-white border-2 border-neutral-200 rounded-xl shadow-xl max-h-80 overflow-y-auto",role:"listbox","aria-label":"Resultados de bÃºsqueda de pacientes"},[t.unref(u)?(t.openBlock(),t.createBlock("div",{key:0,class:"px-3 py-1.5 bg-neutral-50 border-b border-neutral-100"},[t.createVNode("span",{class:"text-[10px] text-neutral-400 uppercase tracking-wider"},"Pacientes frecuentes")])):t.createCommentVNode("",!0),(t.openBlock(!0),t.createBlock(t.Fragment,null,t.renderList(t.unref(i),e=>(t.openBlock(),t.createBlock("button",{key:e.id,type:"button",class:"w-full px-3 py-2.5 text-left hover:bg-[#027368]/5 transition-colors border-b border-neutral-100 last:border-0 group",onClick:t=>selectPaciente(e)},[t.createVNode("div",{class:"flex items-center gap-3"},[t.createVNode("div",{class:"w-9 h-9 rounded-full bg-gradient-to-br from-[#027368] to-[#025951] text-white flex items-center justify-center font-bold text-sm flex-shrink-0"},t.toDisplayString(e.nombre_completo.charAt(0).toUpperCase()),1),t.createVNode("div",{class:"flex-1 min-w-0"},[t.createVNode("div",{class:"flex items-center gap-2"},[t.createVNode("p",{class:"font-semibold text-neutral-900 truncate"},t.toDisplayString(e.nombre_completo),1),e.prioridad_score>=100?(t.openBlock(),t.createBlock("span",{key:0,class:"flex-shrink-0 w-2 h-2 rounded-full bg-emerald-500",title:"Cita reciente"})):t.createCommentVNode("",!0)]),t.createVNode("div",{class:"flex items-center gap-2 text-xs text-neutral-500"},[e.total_citas>0?(t.openBlock(),t.createBlock("span",{key:0},t.toDisplayString(e.total_citas)+" citas",1)):t.createCommentVNode("",!0),e.ultima_cita?(t.openBlock(),t.createBlock("span",{key:1,class:"text-neutral-400"},"Â·")):t.createCommentVNode("",!0),e.ultima_cita?(t.openBlock(),t.createBlock("span",{key:2,class:"text-neutral-400"}," Ãšltima: "+t.toDisplayString(formatRelativeDate(e.ultima_cita)),1)):t.createCommentVNode("",!0)])]),e.sesiones_restantes_total>0?(t.openBlock(),t.createBlock("div",{key:0,class:"flex-shrink-0 px-2.5 py-1 bg-emerald-100 text-emerald-700 rounded-full text-xs font-bold"},[t.createTextVNode(t.toDisplayString(e.sesiones_restantes_total)+" ",1),t.createVNode("span",{class:"font-medium"},"ses.")])):(t.openBlock(),t.createBlock("div",{key:1,class:"flex-shrink-0 px-2 py-1 bg-neutral-100 text-neutral-500 rounded-full text-xs"}," Sin bono "))])],8,["onClick"]))),128)),t.createVNode("button",{type:"button",class:"w-full px-3 py-3 text-left bg-gradient-to-r from-[#027368]/5 to-transparent hover:from-[#027368]/10 transition-colors border-t-2 border-[#027368]/20 font-medium text-[#027368] flex items-center gap-2",onClick:activarModoCrearPaciente},[t.createVNode("div",{class:"w-9 h-9 rounded-full bg-[#027368]/10 flex items-center justify-center"},[(t.openBlock(),t.createBlock("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t.createVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})]))]),t.createVNode("div",null,[t.createVNode("p",{class:"font-semibold"},"Crear nuevo paciente"),t.unref(p).trim().length>0?(t.openBlock(),t.createBlock("p",{key:0,class:"text-xs text-neutral-500"},' "'+t.toDisplayString(t.unref(p).trim())+'" ',1)):t.createCommentVNode("",!0)])]),!t.unref(u)&&!t.unref(d)&&t.unref(p).trim().length>0?(t.openBlock(),t.createBlock("div",{key:1,class:"px-4 py-6 text-center text-neutral-500"},[(t.openBlock(),t.createBlock("svg",{class:"w-10 h-10 mx-auto mb-2 text-neutral-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t.createVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})])),t.createVNode("p",{class:"font-medium text-sm"},'No se encontrÃ³ "'+t.toDisplayString(t.unref(p))+'"',1),t.createVNode("p",{class:"text-xs mt-1"},"Prueba con otro nombre o crea un nuevo paciente")])):t.createCommentVNode("",!0)])):t.createCommentVNode("",!0),S.value.paciente_id&&_.value?(t.openBlock(),t.createBlock("div",{key:1,class:"space-y-3"},[t.createVNode("div",{class:"bg-gradient-to-r from-emerald-50 to-teal-50 border-2 border-emerald-200 rounded-xl overflow-hidden"},[0!==_.value.total_citas&&_.value.bono_activo?t.createCommentVNode("",!0):(t.openBlock(),t.createBlock("div",{key:0,class:["px-3 py-1.5 text-xs font-medium flex items-center gap-2",0===_.value.total_citas?"bg-blue-100 text-blue-700":"bg-amber-100 text-amber-700"]},[(t.openBlock(),t.createBlock("svg",{class:"w-3.5 h-3.5",fill:"currentColor",viewBox:"0 0 20 20"},[0===_.value.total_citas?(t.openBlock(),t.createBlock("path",{key:0,"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm1-11a1 1 0 10-2 0v2H7a1 1 0 100 2h2v2a1 1 0 102 0v-2h2a1 1 0 100-2h-2V7z","clip-rule":"evenodd"})):(t.openBlock(),t.createBlock("path",{key:1,"fill-rule":"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z","clip-rule":"evenodd"}))])),t.createTextVNode(" "+t.toDisplayString(0===_.value.total_citas?"Paciente nuevo - Primera cita":"Sin bono activo"),1)],2)),t.createVNode("div",{class:"px-4 py-3"},[t.createVNode("div",{class:"flex items-center justify-between"},[t.createVNode("div",{class:"flex items-center gap-3"},[t.createVNode("div",{class:"w-11 h-11 rounded-full bg-gradient-to-br from-emerald-500 to-teal-600 text-white flex items-center justify-center font-bold text-lg shadow-sm"},t.toDisplayString(_.value.nombre_completo.charAt(0).toUpperCase()),1),t.createVNode("div",null,[t.createVNode("p",{class:"font-semibold text-neutral-900"},t.toDisplayString(_.value.nombre_completo),1),t.createVNode("p",{class:"text-xs text-neutral-500"},t.toDisplayString(_.value.email),1)])]),t.createVNode("div",{class:"flex items-center gap-2"},[t.createVNode("a",{href:`/terapeuta/pacientes/${_.value.id}`,target:"_blank",class:"p-2 text-neutral-400 hover:text-[#027368] hover:bg-white rounded-lg transition-colors",title:"Ver perfil completo"},[(t.openBlock(),t.createBlock("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t.createVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})]))],8,["href"]),t.createVNode("button",{type:"button",onClick:limpiarSeleccion,class:"p-2 hover:bg-white rounded-lg transition-colors text-neutral-400 hover:text-red-500",title:"Cambiar paciente"},[(t.openBlock(),t.createBlock("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t.createVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})]))])])]),t.createVNode("div",{class:"mt-3 grid grid-cols-3 gap-2 text-center"},[t.createVNode("div",{class:"bg-white/60 rounded-lg px-2 py-1.5"},[t.createVNode("p",{class:"text-xs text-neutral-500"},"Ãšltima cita"),t.createVNode("p",{class:"text-sm font-semibold text-neutral-700"},t.toDisplayString(_.value.ultima_cita?formatRelativeDate(_.value.ultima_cita):"Nunca"),1)]),t.createVNode("div",{class:"bg-white/60 rounded-lg px-2 py-1.5"},[t.createVNode("p",{class:"text-xs text-neutral-500"},"Total citas"),t.createVNode("p",{class:"text-sm font-semibold text-neutral-700"},t.toDisplayString(_.value.total_citas||0),1)]),t.createVNode("div",{class:"bg-white/60 rounded-lg px-2 py-1.5"},[t.createVNode("p",{class:"text-xs text-neutral-500"},"Sesiones"),t.createVNode("p",{class:["text-sm font-semibold",_.value.sesiones_restantes_total>0?"text-emerald-600":"text-neutral-400"]},t.toDisplayString(_.value.sesiones_restantes_total||0)+" disp. ",3)])])])]),_.value.bono_activo?(t.openBlock(),t.createBlock("div",{key:0,class:"px-4 py-3 bg-violet-50 border-2 border-violet-200 rounded-xl"},[t.createVNode("div",{class:"flex items-start justify-between"},[t.createVNode("div",{class:"flex items-center gap-2"},[t.createVNode("div",{class:"w-8 h-8 rounded-lg bg-violet-600 text-white flex items-center justify-center"},[(t.openBlock(),t.createBlock("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t.createVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 5v2m0 4v2m0 4v2M5 5a2 2 0 00-2 2v3a2 2 0 110 4v3a2 2 0 002 2h14a2 2 0 002-2v-3a2 2 0 110-4V7a2 2 0 00-2-2H5z"})]))]),t.createVNode("div",null,[t.createVNode("p",{class:"font-semibold text-violet-900"},t.toDisplayString(_.value.bono_activo.tipo),1),t.createVNode("p",{class:"text-sm text-violet-700"},t.toDisplayString(_.value.bono_activo.sesiones_restantes)+" de "+t.toDisplayString(_.value.bono_activo.sesiones_totales)+" sesiones disponibles ",1)])]),t.createVNode("div",{class:"flex items-center gap-1"},[(t.openBlock(!0),t.createBlock(t.Fragment,null,t.renderList(Math.min(_.value.bono_activo.sesiones_totales,10),e=>(t.openBlock(),t.createBlock("div",{key:e,class:["w-3 h-3 rounded-full",e<=_.value.bono_activo.sesiones_usadas?"bg-violet-600":"bg-violet-200"],title:e<=_.value.bono_activo.sesiones_usadas?"SesiÃ³n usada":"SesiÃ³n disponible"},null,10,["title"]))),128)),_.value.bono_activo.sesiones_totales>10?(t.openBlock(),t.createBlock("span",{key:0,class:"text-xs text-violet-500 ml-1"}," +"+t.toDisplayString(_.value.bono_activo.sesiones_totales-10),1)):t.createCommentVNode("",!0)])]),t.createVNode("div",{class:"mt-3 p-2 bg-amber-50 border border-amber-200 rounded-lg"},[t.createVNode("p",{class:"text-xs text-amber-800 flex items-start gap-2"},[(t.openBlock(),t.createBlock("svg",{class:"w-4 h-4 flex-shrink-0 mt-0.5",fill:"currentColor",viewBox:"0 0 20 20"},[t.createVNode("path",{"fill-rule":"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z","clip-rule":"evenodd"})])),t.createVNode("span",null,[t.createTextVNode(" Esta serÃ¡ la sesiÃ³n "),t.createVNode("strong",null,t.toDisplayString(_.value.bono_activo.sesiones_usadas+1)+"/"+t.toDisplayString(_.value.bono_activo.sesiones_totales),1),t.createTextVNode(" del bono. Se descontarÃ¡ automÃ¡ticamente cuando la cita sea "),t.createVNode("strong",null,"confirmada"),t.createTextVNode(". ")])])]),_.value.bono_activo.fecha_fin?(t.openBlock(),t.createBlock("p",{key:0,class:"mt-2 text-xs text-violet-600"}," Vence: "+t.toDisplayString(formatDate(_.value.bono_activo.fecha_fin)),1)):t.createCommentVNode("",!0)])):(t.openBlock(),t.createBlock("div",{key:1,class:"px-4 py-3 bg-amber-50 border-2 border-amber-200 rounded-xl"},[t.createVNode("div",{class:"flex items-start gap-3"},[t.createVNode("div",{class:"w-8 h-8 rounded-lg bg-amber-200 text-amber-700 flex items-center justify-center flex-shrink-0"},[(t.openBlock(),t.createBlock("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t.createVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})]))]),t.createVNode("div",null,[t.createVNode("p",{class:"font-medium text-amber-800 text-sm"},"Sin bono activo"),t.createVNode("p",{class:"text-xs text-amber-600 mt-0.5"},"Esta sesiÃ³n se facturarÃ¡ de forma individual.")])])])),_.value.bonos&&_.value.bonos.length>1?(t.openBlock(),t.createBlock("div",{key:2,class:"mt-2"},[t.createVNode("label",{class:"block text-sm font-medium text-neutral-700 mb-1"}," Seleccionar bono a usar "),t.withDirectives(t.createVNode("select",{"onUpdate:modelValue":e=>S.value.bono_id=e,class:"w-full px-3 py-2 border-2 border-neutral-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-violet-500 focus:border-transparent text-sm"},[(t.openBlock(!0),t.createBlock(t.Fragment,null,t.renderList(_.value.bonos,e=>(t.openBlock(),t.createBlock("option",{key:e.id,value:e.id},t.toDisplayString(e.tipo)+" - "+t.toDisplayString(e.sesiones_restantes)+"/"+t.toDisplayString(e.sesiones_totales)+" sesiones ",9,["value"]))),128))],8,["onUpdate:modelValue"]),[[t.vModelSelect,S.value.bono_id]])])):t.createCommentVNode("",!0)])):t.createCommentVNode("",!0)]))])]),t.createVNode("section",{class:"space-y-4 pt-2"},[t.createVNode("div",{class:"flex items-center gap-2 pb-2 border-b border-neutral-100"},[t.createVNode("div",{class:"w-6 h-6 rounded-lg bg-blue-100 flex items-center justify-center"},[(t.openBlock(),t.createBlock("svg",{class:"w-3.5 h-3.5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t.createVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})]))]),t.createVNode("h4",{class:"text-sm font-semibold text-neutral-700"},"Fecha y Hora"),t.createVNode("span",{class:"text-xs text-red-500"},"*")]),t.createVNode("div",null,[t.createVNode("label",{for:"fecha-cita",class:"sr-only"},"Fecha de la cita"),t.createVNode("div",{class:"flex flex-wrap gap-2 mb-2",role:"group","aria-label":"Fechas rÃ¡pidas"},[(t.openBlock(!0),t.createBlock(t.Fragment,null,t.renderList(G.value,e=>(t.openBlock(),t.createBlock("button",{key:e.label,type:"button",onClick:t=>aplicarShortcutFecha(e),class:["px-3 py-1.5 text-xs font-medium rounded-lg transition-all focus:outline-none focus:ring-2 focus:ring-[#027368] focus:ring-offset-1",S.value.fecha_cita===e.fecha?"bg-[#027368] text-white":"bg-neutral-100 text-neutral-600 hover:bg-neutral-200"],"aria-pressed":S.value.fecha_cita===e.fecha},t.toDisplayString(e.label),11,["onClick","aria-pressed"]))),128))]),t.withDirectives(t.createVNode("input",{id:"fecha-cita","onUpdate:modelValue":e=>S.value.fecha_cita=e,type:"date",required:"",min:q.value,"aria-required":"true",class:"w-full px-4 py-3 border-2 border-neutral-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-[#027368] focus:border-transparent transition-all",onChange:validateInRealTime},null,40,["onUpdate:modelValue","min"]),[[t.vModelText,S.value.fecha_cita]]),S.value.fecha_cita?(t.openBlock(),t.createBlock("p",{key:0,class:"mt-1 text-xs text-neutral-500"},t.toDisplayString(formatearFechaCompleta(S.value.fecha_cita)),1)):t.createCommentVNode("",!0)]),H.value&&!S.value.hora_inicio?(t.openBlock(),t.createBlock("div",{key:0,class:"px-3 py-2 bg-violet-50 border border-violet-200 rounded-lg flex items-center justify-between"},[t.createVNode("div",{class:"flex items-center gap-2 text-violet-700 text-sm"},[(t.openBlock(),t.createBlock("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true"},[t.createVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})])),t.createVNode("span",null,t.toDisplayString(H.value.razon),1)]),t.createVNode("button",{type:"button",onClick:e=>S.value.hora_inicio=H.value.hora,class:"px-2 py-1 bg-violet-600 text-white text-xs font-medium rounded hover:bg-violet-700 transition-colors"}," Usar "+t.toDisplayString(H.value.hora),9,["onClick"])])):t.createCommentVNode("",!0),t.createVNode("div",{class:"grid grid-cols-2 gap-4"},[t.createVNode("div",null,[t.createVNode("label",{class:"block text-sm font-semibold text-neutral-700 mb-2"}," Hora inicio * "),t.withDirectives(t.createVNode("select",{"onUpdate:modelValue":e=>S.value.hora_inicio=e,required:"",class:"w-full px-4 py-3 border-2 border-neutral-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-[#027368] focus:border-transparent transition-all bg-white appearance-none cursor-pointer",onChange:onHoraInicioChange},[t.createVNode("option",{value:"",disabled:""},"Seleccionar hora"),(t.openBlock(!0),t.createBlock(t.Fragment,null,t.renderList(Z.value,e=>(t.openBlock(),t.createBlock("option",{key:e.value,value:e.value},t.toDisplayString(e.label),9,["value"]))),128))],40,["onUpdate:modelValue"]),[[t.vModelSelect,S.value.hora_inicio]])]),t.createVNode("div",null,[t.createVNode("label",{class:"block text-sm font-semibold text-neutral-700 mb-2"},[t.createTextVNode(" Hora fin * "),t.createVNode("span",{class:"font-normal text-neutral-400"},"("+t.toDisplayString(Y.value)+")",1)]),t.withDirectives(t.createVNode("select",{"onUpdate:modelValue":e=>S.value.hora_fin=e,required:"",class:"w-full px-4 py-3 border-2 border-neutral-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-[#027368] focus:border-transparent transition-all bg-white appearance-none cursor-pointer",onChange:validateInRealTime},[t.createVNode("option",{value:"",disabled:""},"Seleccionar hora"),(t.openBlock(!0),t.createBlock(t.Fragment,null,t.renderList(W.value,e=>(t.openBlock(),t.createBlock("option",{key:e.value,value:e.value},t.toDisplayString(e.label),9,["value"]))),128))],40,["onUpdate:modelValue"]),[[t.vModelSelect,S.value.hora_fin]])])]),t.createVNode("div",{class:"flex items-center gap-2"},[t.createVNode("span",{class:"text-xs text-neutral-500"},"DuraciÃ³n rÃ¡pida:"),(t.openBlock(),t.createBlock(t.Fragment,null,t.renderList(O,e=>t.createVNode("button",{key:e.minutos,type:"button",onClick:t=>aplicarDuracion(e.minutos),class:["px-2 py-1 text-xs rounded-md transition-all",calcularDuracionMinutos()===e.minutos?"bg-[#027368]/10 text-[#027368] font-medium":"bg-neutral-100 text-neutral-500 hover:bg-neutral-200"]},t.toDisplayString(e.label),11,["onClick"])),64))]),C.value?(t.openBlock(),t.createBlock("div",{key:1,class:["px-4 py-3 rounded-xl flex items-start gap-3",{"bg-red-50 border-2 border-red-200":"error"===C.value.type,"bg-yellow-50 border-2 border-yellow-200":"warning"===C.value.type,"bg-emerald-50 border-2 border-emerald-200":"success"===C.value.type}]},[(t.openBlock(),t.createBlock("svg",{class:["w-5 h-5 mt-0.5 flex-shrink-0",{"text-red-600":"error"===C.value.type,"text-yellow-600":"warning"===C.value.type,"text-emerald-600":"success"===C.value.type}],fill:"currentColor",viewBox:"0 0 20 20"},["error"===C.value.type?(t.openBlock(),t.createBlock("path",{key:0,"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z","clip-rule":"evenodd"})):"success"===C.value.type?(t.openBlock(),t.createBlock("path",{key:1,"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z","clip-rule":"evenodd"})):(t.openBlock(),t.createBlock("path",{key:2,"fill-rule":"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z","clip-rule":"evenodd"}))],2)),t.createVNode("p",{class:["text-sm font-medium flex-1",{"text-red-800":"error"===C.value.type,"text-yellow-800":"warning"===C.value.type,"text-emerald-800":"success"===C.value.type}]},t.toDisplayString(C.value.text),3)],2)):t.createCommentVNode("",!0)]),t.createVNode("section",{class:"space-y-4 pt-2"},[t.createVNode("div",{class:"flex items-center gap-2 pb-2 border-b border-neutral-100"},[t.createVNode("div",{class:"w-6 h-6 rounded-lg bg-violet-100 flex items-center justify-center"},[(t.openBlock(),t.createBlock("svg",{class:"w-3.5 h-3.5 text-violet-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t.createVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"})]))]),t.createVNode("h4",{class:"text-sm font-semibold text-neutral-700"},"Modalidad"),t.createVNode("span",{class:"text-xs text-red-500"},"*"),F.value&&S.value.modalidad!==F.value?(t.openBlock(),t.createBlock("span",{key:0,class:"ml-auto text-[10px] px-2 py-0.5 bg-amber-100 text-amber-700 rounded-full flex items-center gap-1 cursor-pointer hover:bg-amber-200 transition-colors",onClick:e=>seleccionarModalidad(F.value),title:`Normalmente usas ${F.value} los ${U.value}`},[(t.openBlock(),t.createBlock("svg",{class:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true"},[t.createVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})])),t.createTextVNode(" "+t.toDisplayString(z.find(e=>e.value===F.value)?.label)+" los "+t.toDisplayString(U.value),1)],8,["onClick","title"])):t.createCommentVNode("",!0)]),t.createVNode("div",{class:"grid grid-cols-3 gap-3"},[(t.openBlock(),t.createBlock(t.Fragment,null,t.renderList(z,e=>t.createVNode("button",{key:e.value,type:"button",onClick:t=>seleccionarModalidad(e.value),class:["relative px-4 py-4 rounded-xl border-2 transition-all font-medium flex flex-col items-center gap-2 group",S.value.modalidad===e.value?"border-[#027368] bg-gradient-to-br from-[#027368]/10 to-[#027368]/5 text-[#027368] shadow-md":"border-neutral-200 text-neutral-600 hover:border-neutral-300 hover:bg-neutral-50"]},[S.value.modalidad===e.value?(t.openBlock(),t.createBlock("div",{key:0,class:"absolute top-2 right-2 w-5 h-5 bg-[#027368] rounded-full flex items-center justify-center"},[(t.openBlock(),t.createBlock("svg",{class:"w-3 h-3 text-white",fill:"currentColor",viewBox:"0 0 20 20"},[t.createVNode("path",{"fill-rule":"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z","clip-rule":"evenodd"})]))])):t.createCommentVNode("",!0),t.createVNode("span",{class:"text-2xl"},t.toDisplayString(e.icon),1),t.createVNode("span",{class:"text-sm font-semibold"},t.toDisplayString(e.label),1),t.createVNode("span",{class:"text-[10px] text-neutral-400 group-hover:text-neutral-500"},t.toDisplayString(e.descripcion),1)],10,["onClick"])),64))]),"presencial"===S.value.modalidad?(t.openBlock(),t.createBlock("div",{key:0,class:"space-y-2"},[t.createVNode("label",{id:"ubicacion-label",class:"block text-sm font-semibold text-neutral-700"},[t.createTextVNode(" Sala / Consultorio "),t.createVNode("span",{class:"font-normal text-neutral-400"},"(opcional)")]),t.createVNode("div",{class:"relative"},[t.createVNode("div",{class:"absolute left-3 top-1/2 -translate-y-1/2 text-neutral-400"},[(t.openBlock(),t.createBlock("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true"},[t.createVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})]))]),t.withDirectives(t.createVNode("input",{"onUpdate:modelValue":e=>S.value.ubicacion=e,type:"text","aria-labelledby":"ubicacion-label",placeholder:"Ej: Consultorio 3, Sala de terapia...",class:"w-full pl-10 pr-4 py-3 border-2 border-neutral-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-[#027368] focus:border-transparent transition-all"},null,8,["onUpdate:modelValue"]),[[t.vModelText,S.value.ubicacion]])])])):t.createCommentVNode("",!0),"online"===S.value.modalidad?(t.openBlock(),t.createBlock("div",{key:1,class:"space-y-2"},[t.createVNode("label",{id:"enlace-label",class:"block text-sm font-semibold text-neutral-700"},[t.createTextVNode(" Enlace de videollamada "),t.createVNode("span",{class:"font-normal text-neutral-400"},"(opcional)")]),t.createVNode("div",{class:"relative"},[t.createVNode("div",{class:"absolute left-3 top-1/2 -translate-y-1/2"},["meet"===K.value?(t.openBlock(),t.createBlock("img",{key:0,src:"https://www.gstatic.com/meet/google_meet_horizontal_wordmark_2020q4_1x_icon_124_40_2373e79660dabbf194273d27aa7ee1f5.png",alt:"Google Meet",class:"w-5 h-5 object-contain"})):"zoom"===K.value?(t.openBlock(),t.createBlock("img",{key:1,src:"https://st1.zoom.us/zoom.ico",alt:"Zoom",class:"w-5 h-5 object-contain"})):"teams"===K.value?(t.openBlock(),t.createBlock("img",{key:2,src:"https://cdn-icons-png.flaticon.com/512/906/906349.png",alt:"Teams",class:"w-5 h-5 object-contain"})):(t.openBlock(),t.createBlock("svg",{key:3,class:"w-5 h-5 text-neutral-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true"},[t.createVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"})]))]),t.withDirectives(t.createVNode("input",{"onUpdate:modelValue":e=>S.value.enlace_videollamada=e,type:"url","aria-labelledby":"enlace-label","aria-invalid":!1===J.value,placeholder:"Pega el enlace de Meet, Zoom o Teams...",class:["w-full pl-10 pr-4 py-3 border-2 rounded-xl focus:outline-none focus:ring-2 focus:ring-[#027368] focus:border-transparent transition-all",!1===J.value?"border-red-300 bg-red-50":!0===J.value?"border-emerald-300 bg-emerald-50":"border-neutral-200"]},null,10,["onUpdate:modelValue","aria-invalid"]),[[t.vModelText,S.value.enlace_videollamada]]),K.value&&J.value?(t.openBlock(),t.createBlock("div",{key:0,class:"absolute right-3 top-1/2 -translate-y-1/2 px-2 py-0.5 bg-emerald-100 text-emerald-700 rounded text-xs font-medium"},t.toDisplayString(X.value),1)):t.createCommentVNode("",!0)]),S.value.enlace_videollamada&&!1===J.value?(t.openBlock(),t.createBlock("p",{key:0,class:"text-xs text-red-600",role:"alert"}," Enlace no reconocido. Usa Google Meet, Zoom o Microsoft Teams. ")):S.value.enlace_videollamada?t.createCommentVNode("",!0):(t.openBlock(),t.createBlock("p",{key:1,class:"text-xs text-neutral-400"}," Compatible con Google Meet, Zoom y Microsoft Teams "))])):t.createCommentVNode("",!0),"telefonica"===S.value.modalidad?(t.openBlock(),t.createBlock("div",{key:2,class:"px-4 py-3 bg-blue-50 border border-blue-200 rounded-xl",role:"note"},[t.createVNode("div",{class:"flex items-start gap-2 text-blue-700"},[(t.openBlock(),t.createBlock("svg",{class:"w-5 h-5 mt-0.5 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true"},[t.createVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})])),t.createVNode("div",{class:"text-sm"},[t.createVNode("p",{class:"font-medium"},"SesiÃ³n por telÃ©fono"),t.createVNode("p",{class:"text-blue-600 text-xs mt-0.5"},"Se utilizarÃ¡ el nÃºmero de contacto del paciente para la llamada.")])])])):t.createCommentVNode("",!0)]),t.createVNode("section",{class:"space-y-3 pt-2"},[t.createVNode("div",{class:"flex items-center gap-2 pb-2 border-b border-neutral-100"},[t.createVNode("div",{class:"w-6 h-6 rounded-lg bg-amber-100 flex items-center justify-center"},[(t.openBlock(),t.createBlock("svg",{class:"w-3.5 h-3.5 text-amber-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t.createVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})]))]),t.createVNode("h4",{class:"text-sm font-semibold text-neutral-700"},"Observaciones"),t.createVNode("span",{class:"text-xs text-neutral-400"},"(opcional)"),S.value.observaciones?(t.openBlock(),t.createBlock("span",{key:0,class:["ml-auto text-xs",(S.value.observaciones?.length||0)>450?"text-amber-600":"text-neutral-400"]},t.toDisplayString(S.value.observaciones?.length||0)+"/500 ",3)):t.createCommentVNode("",!0)]),t.createVNode("div",{class:"flex flex-wrap gap-1.5",role:"group","aria-label":"Plantillas rÃ¡pidas de observaciÃ³n"},[(t.openBlock(),t.createBlock(t.Fragment,null,t.renderList(I,e=>t.createVNode("button",{key:e.texto,type:"button",onClick:t=>aplicarTemplateObservacion(e.texto),class:["px-2.5 py-1 text-xs rounded-lg transition-all flex items-center gap-1 focus:outline-none focus:ring-2 focus:ring-[#027368] focus:ring-offset-1",S.value.observaciones?.includes(e.texto)?"bg-[#027368]/10 text-[#027368] font-medium":"bg-neutral-100 text-neutral-600 hover:bg-neutral-200"],"aria-pressed":S.value.observaciones?.includes(e.texto)},[t.createVNode("span",{"aria-hidden":"true"},t.toDisplayString(e.emoji),1),t.createVNode("span",null,t.toDisplayString(e.label),1)],10,["onClick","aria-pressed"])),64))]),t.createVNode("div",{class:"relative"},[t.withDirectives(t.createVNode("textarea",{id:"observaciones-textarea","onUpdate:modelValue":e=>S.value.observaciones=e,rows:R.value?5:2,maxlength:"500","aria-label":"Observaciones","aria-describedby":"observaciones-hint",placeholder:"Ej: Primera sesiÃ³n de evaluaciÃ³n, seguimiento ansiedad, revisiÃ³n de objetivos terapÃ©uticos...",class:"w-full px-4 py-3 border-2 border-neutral-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-[#027368] focus:border-transparent transition-all resize-none",onFocus:e=>R.value=!0,onBlur:e=>R.value=S.value.observaciones?.length>0},null,40,["onUpdate:modelValue","rows","onFocus","onBlur"]),[[t.vModelText,S.value.observaciones]]),t.createVNode("span",{id:"observaciones-hint",class:"sr-only"},"MÃ¡ximo 500 caracteres. Usa las plantillas rÃ¡pidas para aÃ±adir texto predefinido."),R.value||S.value.observaciones?t.createCommentVNode("",!0):(t.openBlock(),t.createBlock("button",{key:0,type:"button",onClick:e=>R.value=!0,class:"absolute bottom-2 right-2 text-xs text-neutral-400 hover:text-neutral-600 flex items-center gap-1 focus:outline-none focus:text-[#027368]","aria-label":"Expandir campo de observaciones"},[(t.openBlock(),t.createBlock("svg",{class:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true"},[t.createVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"})])),t.createTextVNode(" Expandir ")],8,["onClick"]))])]),t.createVNode("div",{class:"space-y-3 pt-6 border-t border-neutral-100"},[t.createVNode("div",{class:"flex flex-col sm:flex-row gap-3"},[t.createVNode("button",{type:"button",onClick:handleClose,class:"order-3 sm:order-1 px-6 py-3 bg-neutral-100 text-neutral-700 rounded-xl hover:bg-neutral-200 transition-all font-semibold focus:outline-none focus:ring-2 focus:ring-neutral-400 focus:ring-offset-2"}," Cancelar "),t.createVNode("button",{type:"button",onClick:handleSubmitAndNew,disabled:N.value||!ee.value,class:"order-2 flex-1 px-4 py-3 border-2 border-[#027368] text-[#027368] rounded-xl hover:bg-[#027368]/5 transition-all font-semibold disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2 focus:outline-none focus:ring-2 focus:ring-[#027368] focus:ring-offset-2"},[(t.openBlock(),t.createBlock("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true"},[t.createVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})])),t.createVNode("span",{class:"hidden sm:inline"},"Crear y agendar otra"),t.createVNode("span",{class:"sm:hidden"},"+ Otra")],8,["disabled"]),t.createVNode("button",{type:"submit",disabled:N.value||!ee.value,class:"order-1 sm:order-3 flex-1 px-6 py-3 bg-gradient-to-r from-[#027368] to-[#025951] text-white rounded-xl hover:shadow-lg hover:shadow-[#027368]/25 transition-all font-semibold disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2 focus:outline-none focus:ring-2 focus:ring-[#027368] focus:ring-offset-2"},[N.value?(t.openBlock(),t.createBlock("svg",{key:0,class:"animate-spin h-5 w-5",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","aria-hidden":"true"},[t.createVNode("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),t.createVNode("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})])):(t.openBlock(),t.createBlock("svg",{key:1,class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true"},[t.createVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})])),t.createTextVNode(" "+t.toDisplayString(N.value?"Creando...":"Crear Cita"),1)],8,["disabled"])]),t.createVNode("div",{class:"hidden md:flex items-center justify-end gap-4 text-xs text-neutral-400"},[t.createVNode("span",{class:"flex items-center gap-1"},[t.createVNode("kbd",{class:"px-1.5 py-0.5 bg-neutral-100 rounded text-neutral-500 font-mono"},"Esc"),t.createVNode("span",null,"Cancelar")]),t.createVNode("span",{class:"flex items-center gap-1"},[t.createVNode("kbd",{class:"px-1.5 py-0.5 bg-neutral-100 rounded text-neutral-500 font-mono"},"Ctrl"),t.createVNode("span",null,"+"),t.createVNode("kbd",{class:"px-1.5 py-0.5 bg-neutral-100 rounded text-neutral-500 font-mono"},"Enter"),t.createVNode("span",null,"Crear")])])])],32)]),_:1})];o(a.ssrRenderComponent(t.unref(pe),{class:"w-full max-w-2xl transform overflow-hidden rounded-3xl bg-white p-6 sm:p-8 text-left align-middle shadow-2xl transition-all max-h-[90vh] overflow-y-auto",role:"dialog","aria-modal":"true","aria-labelledby":"modal-title"},{default:t.withCtx((e,o,l,r)=>{if(!o)return[t.createVNode(t.unref(ve),{as:"h3",id:"modal-title",class:"text-xl sm:text-2xl font-bold text-neutral-900 mb-4 sm:mb-6 flex items-center gap-3"},{default:t.withCtx(()=>[t.createVNode("div",{class:"w-9 h-9 sm:w-10 sm:h-10 rounded-xl bg-gradient-to-br from-[#027368] to-[#025951] flex items-center justify-center text-white flex-shrink-0"},[(t.openBlock(),t.createBlock("svg",{class:"w-4 h-4 sm:w-5 sm:h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true"},[t.createVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})]))]),t.createTextVNode(" Nueva Cita ")]),_:1}),t.createVNode("form",{onSubmit:t.withModifiers(handleSubmit,["prevent"]),class:"space-y-6"},[t.createVNode("section",{class:"space-y-3"},[t.createVNode("div",{class:"flex items-center gap-2 pb-2 border-b border-neutral-100"},[t.createVNode("div",{class:"w-6 h-6 rounded-lg bg-emerald-100 flex items-center justify-center"},[(t.openBlock(),t.createBlock("svg",{class:"w-3.5 h-3.5 text-emerald-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t.createVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})]))]),t.createVNode("h4",{class:"text-sm font-semibold text-neutral-700"},"Paciente"),t.createVNode("span",{class:"text-xs text-red-500"},"*")]),t.createVNode("div",{class:"relative"},[w.value?(t.openBlock(),t.createBlock("div",{key:1,class:"space-y-4 p-4 bg-blue-50 border-2 border-blue-200 rounded-xl"},[t.createVNode("div",{class:"flex items-center justify-between mb-3"},[t.createVNode("h4",{class:"font-semibold text-neutral-900 flex items-center gap-2"},[(t.openBlock(),t.createBlock("svg",{class:"w-5 h-5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t.createVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M18 9v3m0 0v3m0-3h3m-3 0h-3m-2-5a4 4 0 11-8 0 4 4 0 018 0zM3 20a6 6 0 0112 0v1H3v-1z"})])),t.createTextVNode(" Crear Nuevo Paciente ")]),t.createVNode("button",{type:"button",onClick:cancelarCrearPaciente,class:"text-sm text-neutral-600 hover:text-neutral-900"}," Cancelar ")]),t.createVNode("div",{class:"grid grid-cols-2 gap-3"},[t.createVNode("div",{class:"col-span-2"},[t.withDirectives(t.createVNode("input",{"onUpdate:modelValue":e=>D.value.nombre_completo=e,type:"text",placeholder:"Nombre completo *",class:"w-full px-3 py-2 border-2 border-neutral-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"},null,8,["onUpdate:modelValue"]),[[t.vModelText,D.value.nombre_completo]])]),t.createVNode("div",{class:"col-span-2"},[t.withDirectives(t.createVNode("input",{"onUpdate:modelValue":e=>D.value.email=e,type:"email",placeholder:"Email *",class:"w-full px-3 py-2 border-2 border-neutral-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"},null,8,["onUpdate:modelValue"]),[[t.vModelText,D.value.email]])]),t.createVNode("div",null,[t.withDirectives(t.createVNode("input",{"onUpdate:modelValue":e=>D.value.telefono=e,type:"tel",placeholder:"TelÃ©fono",class:"w-full px-3 py-2 border-2 border-neutral-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"},null,8,["onUpdate:modelValue"]),[[t.vModelText,D.value.telefono]])]),t.createVNode("div",null,[t.withDirectives(t.createVNode("input",{"onUpdate:modelValue":e=>D.value.fecha_nacimiento=e,type:"date",placeholder:"Fecha de nacimiento",class:"w-full px-3 py-2 border-2 border-neutral-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"},null,8,["onUpdate:modelValue"]),[[t.vModelText,D.value.fecha_nacimiento]])])]),t.createVNode("button",{type:"button",onClick:crearPacienteYSeleccionar,disabled:!D.value.nombre_completo||!D.value.email||V.value,class:"w-full px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed font-medium flex items-center justify-center gap-2"},[V.value?(t.openBlock(),t.createBlock("svg",{key:0,class:"animate-spin h-5 w-5",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[t.createVNode("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),t.createVNode("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})])):t.createCommentVNode("",!0),t.createTextVNode(" "+t.toDisplayString(V.value?"Creando...":"Crear Paciente"),1)],8,["disabled"])])):(t.openBlock(),t.createBlock("div",{key:0,class:"space-y-2"},[t.createVNode("div",{class:"relative"},[t.createVNode("label",{for:"patient-search",class:"sr-only"},"Buscar paciente"),t.withDirectives(t.createVNode("input",{id:"patient-search","onUpdate:modelValue":e=>t.isRef(p)?p.value=e:null,type:"text",placeholder:"Buscar por nombre, email o telÃ©fono...",autocomplete:"off","aria-describedby":"patient-search-hint","aria-expanded":"showDropdown","aria-haspopup":"listbox",class:"w-full px-4 py-3 pr-10 border-2 border-neutral-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-[#027368] focus:border-transparent transition-all",onFocus:e=>y.value=!0,onBlur:handleBlur},null,40,["onUpdate:modelValue","onFocus"]),[[t.vModelText,t.unref(p)]]),t.createVNode("span",{id:"patient-search-hint",class:"sr-only"},"Escribe para buscar pacientes existentes o crear uno nuevo"),t.createVNode("div",{class:"absolute right-3 top-1/2 -translate-y-1/2"},[t.unref(d)?(t.openBlock(),t.createBlock("svg",{key:0,class:"animate-spin h-5 w-5 text-[#027368]",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[t.createVNode("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),t.createVNode("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})])):(t.openBlock(),t.createBlock("svg",{key:1,class:"h-5 w-5 text-neutral-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t.createVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})]))])]),y.value&&(t.unref(u)||t.unref(p).trim().length>0)?(t.openBlock(),t.createBlock("div",{key:0,class:"absolute z-10 w-full mt-1 bg-white border-2 border-neutral-200 rounded-xl shadow-xl max-h-80 overflow-y-auto",role:"listbox","aria-label":"Resultados de bÃºsqueda de pacientes"},[t.unref(u)?(t.openBlock(),t.createBlock("div",{key:0,class:"px-3 py-1.5 bg-neutral-50 border-b border-neutral-100"},[t.createVNode("span",{class:"text-[10px] text-neutral-400 uppercase tracking-wider"},"Pacientes frecuentes")])):t.createCommentVNode("",!0),(t.openBlock(!0),t.createBlock(t.Fragment,null,t.renderList(t.unref(i),e=>(t.openBlock(),t.createBlock("button",{key:e.id,type:"button",class:"w-full px-3 py-2.5 text-left hover:bg-[#027368]/5 transition-colors border-b border-neutral-100 last:border-0 group",onClick:t=>selectPaciente(e)},[t.createVNode("div",{class:"flex items-center gap-3"},[t.createVNode("div",{class:"w-9 h-9 rounded-full bg-gradient-to-br from-[#027368] to-[#025951] text-white flex items-center justify-center font-bold text-sm flex-shrink-0"},t.toDisplayString(e.nombre_completo.charAt(0).toUpperCase()),1),t.createVNode("div",{class:"flex-1 min-w-0"},[t.createVNode("div",{class:"flex items-center gap-2"},[t.createVNode("p",{class:"font-semibold text-neutral-900 truncate"},t.toDisplayString(e.nombre_completo),1),e.prioridad_score>=100?(t.openBlock(),t.createBlock("span",{key:0,class:"flex-shrink-0 w-2 h-2 rounded-full bg-emerald-500",title:"Cita reciente"})):t.createCommentVNode("",!0)]),t.createVNode("div",{class:"flex items-center gap-2 text-xs text-neutral-500"},[e.total_citas>0?(t.openBlock(),t.createBlock("span",{key:0},t.toDisplayString(e.total_citas)+" citas",1)):t.createCommentVNode("",!0),e.ultima_cita?(t.openBlock(),t.createBlock("span",{key:1,class:"text-neutral-400"},"Â·")):t.createCommentVNode("",!0),e.ultima_cita?(t.openBlock(),t.createBlock("span",{key:2,class:"text-neutral-400"}," Ãšltima: "+t.toDisplayString(formatRelativeDate(e.ultima_cita)),1)):t.createCommentVNode("",!0)])]),e.sesiones_restantes_total>0?(t.openBlock(),t.createBlock("div",{key:0,class:"flex-shrink-0 px-2.5 py-1 bg-emerald-100 text-emerald-700 rounded-full text-xs font-bold"},[t.createTextVNode(t.toDisplayString(e.sesiones_restantes_total)+" ",1),t.createVNode("span",{class:"font-medium"},"ses.")])):(t.openBlock(),t.createBlock("div",{key:1,class:"flex-shrink-0 px-2 py-1 bg-neutral-100 text-neutral-500 rounded-full text-xs"}," Sin bono "))])],8,["onClick"]))),128)),t.createVNode("button",{type:"button",class:"w-full px-3 py-3 text-left bg-gradient-to-r from-[#027368]/5 to-transparent hover:from-[#027368]/10 transition-colors border-t-2 border-[#027368]/20 font-medium text-[#027368] flex items-center gap-2",onClick:activarModoCrearPaciente},[t.createVNode("div",{class:"w-9 h-9 rounded-full bg-[#027368]/10 flex items-center justify-center"},[(t.openBlock(),t.createBlock("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t.createVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})]))]),t.createVNode("div",null,[t.createVNode("p",{class:"font-semibold"},"Crear nuevo paciente"),t.unref(p).trim().length>0?(t.openBlock(),t.createBlock("p",{key:0,class:"text-xs text-neutral-500"},' "'+t.toDisplayString(t.unref(p).trim())+'" ',1)):t.createCommentVNode("",!0)])]),!t.unref(u)&&!t.unref(d)&&t.unref(p).trim().length>0?(t.openBlock(),t.createBlock("div",{key:1,class:"px-4 py-6 text-center text-neutral-500"},[(t.openBlock(),t.createBlock("svg",{class:"w-10 h-10 mx-auto mb-2 text-neutral-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t.createVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})])),t.createVNode("p",{class:"font-medium text-sm"},'No se encontrÃ³ "'+t.toDisplayString(t.unref(p))+'"',1),t.createVNode("p",{class:"text-xs mt-1"},"Prueba con otro nombre o crea un nuevo paciente")])):t.createCommentVNode("",!0)])):t.createCommentVNode("",!0),S.value.paciente_id&&_.value?(t.openBlock(),t.createBlock("div",{key:1,class:"space-y-3"},[t.createVNode("div",{class:"bg-gradient-to-r from-emerald-50 to-teal-50 border-2 border-emerald-200 rounded-xl overflow-hidden"},[0!==_.value.total_citas&&_.value.bono_activo?t.createCommentVNode("",!0):(t.openBlock(),t.createBlock("div",{key:0,class:["px-3 py-1.5 text-xs font-medium flex items-center gap-2",0===_.value.total_citas?"bg-blue-100 text-blue-700":"bg-amber-100 text-amber-700"]},[(t.openBlock(),t.createBlock("svg",{class:"w-3.5 h-3.5",fill:"currentColor",viewBox:"0 0 20 20"},[0===_.value.total_citas?(t.openBlock(),t.createBlock("path",{key:0,"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm1-11a1 1 0 10-2 0v2H7a1 1 0 100 2h2v2a1 1 0 102 0v-2h2a1 1 0 100-2h-2V7z","clip-rule":"evenodd"})):(t.openBlock(),t.createBlock("path",{key:1,"fill-rule":"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z","clip-rule":"evenodd"}))])),t.createTextVNode(" "+t.toDisplayString(0===_.value.total_citas?"Paciente nuevo - Primera cita":"Sin bono activo"),1)],2)),t.createVNode("div",{class:"px-4 py-3"},[t.createVNode("div",{class:"flex items-center justify-between"},[t.createVNode("div",{class:"flex items-center gap-3"},[t.createVNode("div",{class:"w-11 h-11 rounded-full bg-gradient-to-br from-emerald-500 to-teal-600 text-white flex items-center justify-center font-bold text-lg shadow-sm"},t.toDisplayString(_.value.nombre_completo.charAt(0).toUpperCase()),1),t.createVNode("div",null,[t.createVNode("p",{class:"font-semibold text-neutral-900"},t.toDisplayString(_.value.nombre_completo),1),t.createVNode("p",{class:"text-xs text-neutral-500"},t.toDisplayString(_.value.email),1)])]),t.createVNode("div",{class:"flex items-center gap-2"},[t.createVNode("a",{href:`/terapeuta/pacientes/${_.value.id}`,target:"_blank",class:"p-2 text-neutral-400 hover:text-[#027368] hover:bg-white rounded-lg transition-colors",title:"Ver perfil completo"},[(t.openBlock(),t.createBlock("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t.createVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})]))],8,["href"]),t.createVNode("button",{type:"button",onClick:limpiarSeleccion,class:"p-2 hover:bg-white rounded-lg transition-colors text-neutral-400 hover:text-red-500",title:"Cambiar paciente"},[(t.openBlock(),t.createBlock("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t.createVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})]))])])]),t.createVNode("div",{class:"mt-3 grid grid-cols-3 gap-2 text-center"},[t.createVNode("div",{class:"bg-white/60 rounded-lg px-2 py-1.5"},[t.createVNode("p",{class:"text-xs text-neutral-500"},"Ãšltima cita"),t.createVNode("p",{class:"text-sm font-semibold text-neutral-700"},t.toDisplayString(_.value.ultima_cita?formatRelativeDate(_.value.ultima_cita):"Nunca"),1)]),t.createVNode("div",{class:"bg-white/60 rounded-lg px-2 py-1.5"},[t.createVNode("p",{class:"text-xs text-neutral-500"},"Total citas"),t.createVNode("p",{class:"text-sm font-semibold text-neutral-700"},t.toDisplayString(_.value.total_citas||0),1)]),t.createVNode("div",{class:"bg-white/60 rounded-lg px-2 py-1.5"},[t.createVNode("p",{class:"text-xs text-neutral-500"},"Sesiones"),t.createVNode("p",{class:["text-sm font-semibold",_.value.sesiones_restantes_total>0?"text-emerald-600":"text-neutral-400"]},t.toDisplayString(_.value.sesiones_restantes_total||0)+" disp. ",3)])])])]),_.value.bono_activo?(t.openBlock(),t.createBlock("div",{key:0,class:"px-4 py-3 bg-violet-50 border-2 border-violet-200 rounded-xl"},[t.createVNode("div",{class:"flex items-start justify-between"},[t.createVNode("div",{class:"flex items-center gap-2"},[t.createVNode("div",{class:"w-8 h-8 rounded-lg bg-violet-600 text-white flex items-center justify-center"},[(t.openBlock(),t.createBlock("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t.createVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 5v2m0 4v2m0 4v2M5 5a2 2 0 00-2 2v3a2 2 0 110 4v3a2 2 0 002 2h14a2 2 0 002-2v-3a2 2 0 110-4V7a2 2 0 00-2-2H5z"})]))]),t.createVNode("div",null,[t.createVNode("p",{class:"font-semibold text-violet-900"},t.toDisplayString(_.value.bono_activo.tipo),1),t.createVNode("p",{class:"text-sm text-violet-700"},t.toDisplayString(_.value.bono_activo.sesiones_restantes)+" de "+t.toDisplayString(_.value.bono_activo.sesiones_totales)+" sesiones disponibles ",1)])]),t.createVNode("div",{class:"flex items-center gap-1"},[(t.openBlock(!0),t.createBlock(t.Fragment,null,t.renderList(Math.min(_.value.bono_activo.sesiones_totales,10),e=>(t.openBlock(),t.createBlock("div",{key:e,class:["w-3 h-3 rounded-full",e<=_.value.bono_activo.sesiones_usadas?"bg-violet-600":"bg-violet-200"],title:e<=_.value.bono_activo.sesiones_usadas?"SesiÃ³n usada":"SesiÃ³n disponible"},null,10,["title"]))),128)),_.value.bono_activo.sesiones_totales>10?(t.openBlock(),t.createBlock("span",{key:0,class:"text-xs text-violet-500 ml-1"}," +"+t.toDisplayString(_.value.bono_activo.sesiones_totales-10),1)):t.createCommentVNode("",!0)])]),t.createVNode("div",{class:"mt-3 p-2 bg-amber-50 border border-amber-200 rounded-lg"},[t.createVNode("p",{class:"text-xs text-amber-800 flex items-start gap-2"},[(t.openBlock(),t.createBlock("svg",{class:"w-4 h-4 flex-shrink-0 mt-0.5",fill:"currentColor",viewBox:"0 0 20 20"},[t.createVNode("path",{"fill-rule":"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z","clip-rule":"evenodd"})])),t.createVNode("span",null,[t.createTextVNode(" Esta serÃ¡ la sesiÃ³n "),t.createVNode("strong",null,t.toDisplayString(_.value.bono_activo.sesiones_usadas+1)+"/"+t.toDisplayString(_.value.bono_activo.sesiones_totales),1),t.createTextVNode(" del bono. Se descontarÃ¡ automÃ¡ticamente cuando la cita sea "),t.createVNode("strong",null,"confirmada"),t.createTextVNode(". ")])])]),_.value.bono_activo.fecha_fin?(t.openBlock(),t.createBlock("p",{key:0,class:"mt-2 text-xs text-violet-600"}," Vence: "+t.toDisplayString(formatDate(_.value.bono_activo.fecha_fin)),1)):t.createCommentVNode("",!0)])):(t.openBlock(),t.createBlock("div",{key:1,class:"px-4 py-3 bg-amber-50 border-2 border-amber-200 rounded-xl"},[t.createVNode("div",{class:"flex items-start gap-3"},[t.createVNode("div",{class:"w-8 h-8 rounded-lg bg-amber-200 text-amber-700 flex items-center justify-center flex-shrink-0"},[(t.openBlock(),t.createBlock("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t.createVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})]))]),t.createVNode("div",null,[t.createVNode("p",{class:"font-medium text-amber-800 text-sm"},"Sin bono activo"),t.createVNode("p",{class:"text-xs text-amber-600 mt-0.5"},"Esta sesiÃ³n se facturarÃ¡ de forma individual.")])])])),_.value.bonos&&_.value.bonos.length>1?(t.openBlock(),t.createBlock("div",{key:2,class:"mt-2"},[t.createVNode("label",{class:"block text-sm font-medium text-neutral-700 mb-1"}," Seleccionar bono a usar "),t.withDirectives(t.createVNode("select",{"onUpdate:modelValue":e=>S.value.bono_id=e,class:"w-full px-3 py-2 border-2 border-neutral-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-violet-500 focus:border-transparent text-sm"},[(t.openBlock(!0),t.createBlock(t.Fragment,null,t.renderList(_.value.bonos,e=>(t.openBlock(),t.createBlock("option",{key:e.id,value:e.id},t.toDisplayString(e.tipo)+" - "+t.toDisplayString(e.sesiones_restantes)+"/"+t.toDisplayString(e.sesiones_totales)+" sesiones ",9,["value"]))),128))],8,["onUpdate:modelValue"]),[[t.vModelSelect,S.value.bono_id]])])):t.createCommentVNode("",!0)])):t.createCommentVNode("",!0)]))])]),t.createVNode("section",{class:"space-y-4 pt-2"},[t.createVNode("div",{class:"flex items-center gap-2 pb-2 border-b border-neutral-100"},[t.createVNode("div",{class:"w-6 h-6 rounded-lg bg-blue-100 flex items-center justify-center"},[(t.openBlock(),t.createBlock("svg",{class:"w-3.5 h-3.5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t.createVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})]))]),t.createVNode("h4",{class:"text-sm font-semibold text-neutral-700"},"Fecha y Hora"),t.createVNode("span",{class:"text-xs text-red-500"},"*")]),t.createVNode("div",null,[t.createVNode("label",{for:"fecha-cita",class:"sr-only"},"Fecha de la cita"),t.createVNode("div",{class:"flex flex-wrap gap-2 mb-2",role:"group","aria-label":"Fechas rÃ¡pidas"},[(t.openBlock(!0),t.createBlock(t.Fragment,null,t.renderList(G.value,e=>(t.openBlock(),t.createBlock("button",{key:e.label,type:"button",onClick:t=>aplicarShortcutFecha(e),class:["px-3 py-1.5 text-xs font-medium rounded-lg transition-all focus:outline-none focus:ring-2 focus:ring-[#027368] focus:ring-offset-1",S.value.fecha_cita===e.fecha?"bg-[#027368] text-white":"bg-neutral-100 text-neutral-600 hover:bg-neutral-200"],"aria-pressed":S.value.fecha_cita===e.fecha},t.toDisplayString(e.label),11,["onClick","aria-pressed"]))),128))]),t.withDirectives(t.createVNode("input",{id:"fecha-cita","onUpdate:modelValue":e=>S.value.fecha_cita=e,type:"date",required:"",min:q.value,"aria-required":"true",class:"w-full px-4 py-3 border-2 border-neutral-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-[#027368] focus:border-transparent transition-all",onChange:validateInRealTime},null,40,["onUpdate:modelValue","min"]),[[t.vModelText,S.value.fecha_cita]]),S.value.fecha_cita?(t.openBlock(),t.createBlock("p",{key:0,class:"mt-1 text-xs text-neutral-500"},t.toDisplayString(formatearFechaCompleta(S.value.fecha_cita)),1)):t.createCommentVNode("",!0)]),H.value&&!S.value.hora_inicio?(t.openBlock(),t.createBlock("div",{key:0,class:"px-3 py-2 bg-violet-50 border border-violet-200 rounded-lg flex items-center justify-between"},[t.createVNode("div",{class:"flex items-center gap-2 text-violet-700 text-sm"},[(t.openBlock(),t.createBlock("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true"},[t.createVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})])),t.createVNode("span",null,t.toDisplayString(H.value.razon),1)]),t.createVNode("button",{type:"button",onClick:e=>S.value.hora_inicio=H.value.hora,class:"px-2 py-1 bg-violet-600 text-white text-xs font-medium rounded hover:bg-violet-700 transition-colors"}," Usar "+t.toDisplayString(H.value.hora),9,["onClick"])])):t.createCommentVNode("",!0),t.createVNode("div",{class:"grid grid-cols-2 gap-4"},[t.createVNode("div",null,[t.createVNode("label",{class:"block text-sm font-semibold text-neutral-700 mb-2"}," Hora inicio * "),t.withDirectives(t.createVNode("select",{"onUpdate:modelValue":e=>S.value.hora_inicio=e,required:"",class:"w-full px-4 py-3 border-2 border-neutral-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-[#027368] focus:border-transparent transition-all bg-white appearance-none cursor-pointer",onChange:onHoraInicioChange},[t.createVNode("option",{value:"",disabled:""},"Seleccionar hora"),(t.openBlock(!0),t.createBlock(t.Fragment,null,t.renderList(Z.value,e=>(t.openBlock(),t.createBlock("option",{key:e.value,value:e.value},t.toDisplayString(e.label),9,["value"]))),128))],40,["onUpdate:modelValue"]),[[t.vModelSelect,S.value.hora_inicio]])]),t.createVNode("div",null,[t.createVNode("label",{class:"block text-sm font-semibold text-neutral-700 mb-2"},[t.createTextVNode(" Hora fin * "),t.createVNode("span",{class:"font-normal text-neutral-400"},"("+t.toDisplayString(Y.value)+")",1)]),t.withDirectives(t.createVNode("select",{"onUpdate:modelValue":e=>S.value.hora_fin=e,required:"",class:"w-full px-4 py-3 border-2 border-neutral-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-[#027368] focus:border-transparent transition-all bg-white appearance-none cursor-pointer",onChange:validateInRealTime},[t.createVNode("option",{value:"",disabled:""},"Seleccionar hora"),(t.openBlock(!0),t.createBlock(t.Fragment,null,t.renderList(W.value,e=>(t.openBlock(),t.createBlock("option",{key:e.value,value:e.value},t.toDisplayString(e.label),9,["value"]))),128))],40,["onUpdate:modelValue"]),[[t.vModelSelect,S.value.hora_fin]])])]),t.createVNode("div",{class:"flex items-center gap-2"},[t.createVNode("span",{class:"text-xs text-neutral-500"},"DuraciÃ³n rÃ¡pida:"),(t.openBlock(),t.createBlock(t.Fragment,null,t.renderList(O,e=>t.createVNode("button",{key:e.minutos,type:"button",onClick:t=>aplicarDuracion(e.minutos),class:["px-2 py-1 text-xs rounded-md transition-all",calcularDuracionMinutos()===e.minutos?"bg-[#027368]/10 text-[#027368] font-medium":"bg-neutral-100 text-neutral-500 hover:bg-neutral-200"]},t.toDisplayString(e.label),11,["onClick"])),64))]),C.value?(t.openBlock(),t.createBlock("div",{key:1,class:["px-4 py-3 rounded-xl flex items-start gap-3",{"bg-red-50 border-2 border-red-200":"error"===C.value.type,"bg-yellow-50 border-2 border-yellow-200":"warning"===C.value.type,"bg-emerald-50 border-2 border-emerald-200":"success"===C.value.type}]},[(t.openBlock(),t.createBlock("svg",{class:["w-5 h-5 mt-0.5 flex-shrink-0",{"text-red-600":"error"===C.value.type,"text-yellow-600":"warning"===C.value.type,"text-emerald-600":"success"===C.value.type}],fill:"currentColor",viewBox:"0 0 20 20"},["error"===C.value.type?(t.openBlock(),t.createBlock("path",{key:0,"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z","clip-rule":"evenodd"})):"success"===C.value.type?(t.openBlock(),t.createBlock("path",{key:1,"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z","clip-rule":"evenodd"})):(t.openBlock(),t.createBlock("path",{key:2,"fill-rule":"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z","clip-rule":"evenodd"}))],2)),t.createVNode("p",{class:["text-sm font-medium flex-1",{"text-red-800":"error"===C.value.type,"text-yellow-800":"warning"===C.value.type,"text-emerald-800":"success"===C.value.type}]},t.toDisplayString(C.value.text),3)],2)):t.createCommentVNode("",!0)]),t.createVNode("section",{class:"space-y-4 pt-2"},[t.createVNode("div",{class:"flex items-center gap-2 pb-2 border-b border-neutral-100"},[t.createVNode("div",{class:"w-6 h-6 rounded-lg bg-violet-100 flex items-center justify-center"},[(t.openBlock(),t.createBlock("svg",{class:"w-3.5 h-3.5 text-violet-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t.createVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"})]))]),t.createVNode("h4",{class:"text-sm font-semibold text-neutral-700"},"Modalidad"),t.createVNode("span",{class:"text-xs text-red-500"},"*"),F.value&&S.value.modalidad!==F.value?(t.openBlock(),t.createBlock("span",{key:0,class:"ml-auto text-[10px] px-2 py-0.5 bg-amber-100 text-amber-700 rounded-full flex items-center gap-1 cursor-pointer hover:bg-amber-200 transition-colors",onClick:e=>seleccionarModalidad(F.value),title:`Normalmente usas ${F.value} los ${U.value}`},[(t.openBlock(),t.createBlock("svg",{class:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true"},[t.createVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})])),t.createTextVNode(" "+t.toDisplayString(z.find(e=>e.value===F.value)?.label)+" los "+t.toDisplayString(U.value),1)],8,["onClick","title"])):t.createCommentVNode("",!0)]),t.createVNode("div",{class:"grid grid-cols-3 gap-3"},[(t.openBlock(),t.createBlock(t.Fragment,null,t.renderList(z,e=>t.createVNode("button",{key:e.value,type:"button",onClick:t=>seleccionarModalidad(e.value),class:["relative px-4 py-4 rounded-xl border-2 transition-all font-medium flex flex-col items-center gap-2 group",S.value.modalidad===e.value?"border-[#027368] bg-gradient-to-br from-[#027368]/10 to-[#027368]/5 text-[#027368] shadow-md":"border-neutral-200 text-neutral-600 hover:border-neutral-300 hover:bg-neutral-50"]},[S.value.modalidad===e.value?(t.openBlock(),t.createBlock("div",{key:0,class:"absolute top-2 right-2 w-5 h-5 bg-[#027368] rounded-full flex items-center justify-center"},[(t.openBlock(),t.createBlock("svg",{class:"w-3 h-3 text-white",fill:"currentColor",viewBox:"0 0 20 20"},[t.createVNode("path",{"fill-rule":"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z","clip-rule":"evenodd"})]))])):t.createCommentVNode("",!0),t.createVNode("span",{class:"text-2xl"},t.toDisplayString(e.icon),1),t.createVNode("span",{class:"text-sm font-semibold"},t.toDisplayString(e.label),1),t.createVNode("span",{class:"text-[10px] text-neutral-400 group-hover:text-neutral-500"},t.toDisplayString(e.descripcion),1)],10,["onClick"])),64))]),"presencial"===S.value.modalidad?(t.openBlock(),t.createBlock("div",{key:0,class:"space-y-2"},[t.createVNode("label",{id:"ubicacion-label",class:"block text-sm font-semibold text-neutral-700"},[t.createTextVNode(" Sala / Consultorio "),t.createVNode("span",{class:"font-normal text-neutral-400"},"(opcional)")]),t.createVNode("div",{class:"relative"},[t.createVNode("div",{class:"absolute left-3 top-1/2 -translate-y-1/2 text-neutral-400"},[(t.openBlock(),t.createBlock("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true"},[t.createVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})]))]),t.withDirectives(t.createVNode("input",{"onUpdate:modelValue":e=>S.value.ubicacion=e,type:"text","aria-labelledby":"ubicacion-label",placeholder:"Ej: Consultorio 3, Sala de terapia...",class:"w-full pl-10 pr-4 py-3 border-2 border-neutral-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-[#027368] focus:border-transparent transition-all"},null,8,["onUpdate:modelValue"]),[[t.vModelText,S.value.ubicacion]])])])):t.createCommentVNode("",!0),"online"===S.value.modalidad?(t.openBlock(),t.createBlock("div",{key:1,class:"space-y-2"},[t.createVNode("label",{id:"enlace-label",class:"block text-sm font-semibold text-neutral-700"},[t.createTextVNode(" Enlace de videollamada "),t.createVNode("span",{class:"font-normal text-neutral-400"},"(opcional)")]),t.createVNode("div",{class:"relative"},[t.createVNode("div",{class:"absolute left-3 top-1/2 -translate-y-1/2"},["meet"===K.value?(t.openBlock(),t.createBlock("img",{key:0,src:"https://www.gstatic.com/meet/google_meet_horizontal_wordmark_2020q4_1x_icon_124_40_2373e79660dabbf194273d27aa7ee1f5.png",alt:"Google Meet",class:"w-5 h-5 object-contain"})):"zoom"===K.value?(t.openBlock(),t.createBlock("img",{key:1,src:"https://st1.zoom.us/zoom.ico",alt:"Zoom",class:"w-5 h-5 object-contain"})):"teams"===K.value?(t.openBlock(),t.createBlock("img",{key:2,src:"https://cdn-icons-png.flaticon.com/512/906/906349.png",alt:"Teams",class:"w-5 h-5 object-contain"})):(t.openBlock(),t.createBlock("svg",{key:3,class:"w-5 h-5 text-neutral-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true"},[t.createVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"})]))]),t.withDirectives(t.createVNode("input",{"onUpdate:modelValue":e=>S.value.enlace_videollamada=e,type:"url","aria-labelledby":"enlace-label","aria-invalid":!1===J.value,placeholder:"Pega el enlace de Meet, Zoom o Teams...",class:["w-full pl-10 pr-4 py-3 border-2 rounded-xl focus:outline-none focus:ring-2 focus:ring-[#027368] focus:border-transparent transition-all",!1===J.value?"border-red-300 bg-red-50":!0===J.value?"border-emerald-300 bg-emerald-50":"border-neutral-200"]},null,10,["onUpdate:modelValue","aria-invalid"]),[[t.vModelText,S.value.enlace_videollamada]]),K.value&&J.value?(t.openBlock(),t.createBlock("div",{key:0,class:"absolute right-3 top-1/2 -translate-y-1/2 px-2 py-0.5 bg-emerald-100 text-emerald-700 rounded text-xs font-medium"},t.toDisplayString(X.value),1)):t.createCommentVNode("",!0)]),S.value.enlace_videollamada&&!1===J.value?(t.openBlock(),t.createBlock("p",{key:0,class:"text-xs text-red-600",role:"alert"}," Enlace no reconocido. Usa Google Meet, Zoom o Microsoft Teams. ")):S.value.enlace_videollamada?t.createCommentVNode("",!0):(t.openBlock(),t.createBlock("p",{key:1,class:"text-xs text-neutral-400"}," Compatible con Google Meet, Zoom y Microsoft Teams "))])):t.createCommentVNode("",!0),"telefonica"===S.value.modalidad?(t.openBlock(),t.createBlock("div",{key:2,class:"px-4 py-3 bg-blue-50 border border-blue-200 rounded-xl",role:"note"},[t.createVNode("div",{class:"flex items-start gap-2 text-blue-700"},[(t.openBlock(),t.createBlock("svg",{class:"w-5 h-5 mt-0.5 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true"},[t.createVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})])),t.createVNode("div",{class:"text-sm"},[t.createVNode("p",{class:"font-medium"},"SesiÃ³n por telÃ©fono"),t.createVNode("p",{class:"text-blue-600 text-xs mt-0.5"},"Se utilizarÃ¡ el nÃºmero de contacto del paciente para la llamada.")])])])):t.createCommentVNode("",!0)]),t.createVNode("section",{class:"space-y-3 pt-2"},[t.createVNode("div",{class:"flex items-center gap-2 pb-2 border-b border-neutral-100"},[t.createVNode("div",{class:"w-6 h-6 rounded-lg bg-amber-100 flex items-center justify-center"},[(t.openBlock(),t.createBlock("svg",{class:"w-3.5 h-3.5 text-amber-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t.createVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})]))]),t.createVNode("h4",{class:"text-sm font-semibold text-neutral-700"},"Observaciones"),t.createVNode("span",{class:"text-xs text-neutral-400"},"(opcional)"),S.value.observaciones?(t.openBlock(),t.createBlock("span",{key:0,class:["ml-auto text-xs",(S.value.observaciones?.length||0)>450?"text-amber-600":"text-neutral-400"]},t.toDisplayString(S.value.observaciones?.length||0)+"/500 ",3)):t.createCommentVNode("",!0)]),t.createVNode("div",{class:"flex flex-wrap gap-1.5",role:"group","aria-label":"Plantillas rÃ¡pidas de observaciÃ³n"},[(t.openBlock(),t.createBlock(t.Fragment,null,t.renderList(I,e=>t.createVNode("button",{key:e.texto,type:"button",onClick:t=>aplicarTemplateObservacion(e.texto),class:["px-2.5 py-1 text-xs rounded-lg transition-all flex items-center gap-1 focus:outline-none focus:ring-2 focus:ring-[#027368] focus:ring-offset-1",S.value.observaciones?.includes(e.texto)?"bg-[#027368]/10 text-[#027368] font-medium":"bg-neutral-100 text-neutral-600 hover:bg-neutral-200"],"aria-pressed":S.value.observaciones?.includes(e.texto)},[t.createVNode("span",{"aria-hidden":"true"},t.toDisplayString(e.emoji),1),t.createVNode("span",null,t.toDisplayString(e.label),1)],10,["onClick","aria-pressed"])),64))]),t.createVNode("div",{class:"relative"},[t.withDirectives(t.createVNode("textarea",{id:"observaciones-textarea","onUpdate:modelValue":e=>S.value.observaciones=e,rows:R.value?5:2,maxlength:"500","aria-label":"Observaciones","aria-describedby":"observaciones-hint",placeholder:"Ej: Primera sesiÃ³n de evaluaciÃ³n, seguimiento ansiedad, revisiÃ³n de objetivos terapÃ©uticos...",class:"w-full px-4 py-3 border-2 border-neutral-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-[#027368] focus:border-transparent transition-all resize-none",onFocus:e=>R.value=!0,onBlur:e=>R.value=S.value.observaciones?.length>0},null,40,["onUpdate:modelValue","rows","onFocus","onBlur"]),[[t.vModelText,S.value.observaciones]]),t.createVNode("span",{id:"observaciones-hint",class:"sr-only"},"MÃ¡ximo 500 caracteres. Usa las plantillas rÃ¡pidas para aÃ±adir texto predefinido."),R.value||S.value.observaciones?t.createCommentVNode("",!0):(t.openBlock(),t.createBlock("button",{key:0,type:"button",onClick:e=>R.value=!0,class:"absolute bottom-2 right-2 text-xs text-neutral-400 hover:text-neutral-600 flex items-center gap-1 focus:outline-none focus:text-[#027368]","aria-label":"Expandir campo de observaciones"},[(t.openBlock(),t.createBlock("svg",{class:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true"},[t.createVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"})])),t.createTextVNode(" Expandir ")],8,["onClick"]))])]),t.createVNode("div",{class:"space-y-3 pt-6 border-t border-neutral-100"},[t.createVNode("div",{class:"flex flex-col sm:flex-row gap-3"},[t.createVNode("button",{type:"button",onClick:handleClose,class:"order-3 sm:order-1 px-6 py-3 bg-neutral-100 text-neutral-700 rounded-xl hover:bg-neutral-200 transition-all font-semibold focus:outline-none focus:ring-2 focus:ring-neutral-400 focus:ring-offset-2"}," Cancelar "),t.createVNode("button",{type:"button",onClick:handleSubmitAndNew,disabled:N.value||!ee.value,class:"order-2 flex-1 px-4 py-3 border-2 border-[#027368] text-[#027368] rounded-xl hover:bg-[#027368]/5 transition-all font-semibold disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2 focus:outline-none focus:ring-2 focus:ring-[#027368] focus:ring-offset-2"},[(t.openBlock(),t.createBlock("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true"},[t.createVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})])),t.createVNode("span",{class:"hidden sm:inline"},"Crear y agendar otra"),t.createVNode("span",{class:"sm:hidden"},"+ Otra")],8,["disabled"]),t.createVNode("button",{type:"submit",disabled:N.value||!ee.value,class:"order-1 sm:order-3 flex-1 px-6 py-3 bg-gradient-to-r from-[#027368] to-[#025951] text-white rounded-xl hover:shadow-lg hover:shadow-[#027368]/25 transition-all font-semibold disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2 focus:outline-none focus:ring-2 focus:ring-[#027368] focus:ring-offset-2"},[N.value?(t.openBlock(),t.createBlock("svg",{key:0,class:"animate-spin h-5 w-5",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","aria-hidden":"true"},[t.createVNode("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),t.createVNode("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})])):(t.openBlock(),t.createBlock("svg",{key:1,class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true"},[t.createVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})])),t.createTextVNode(" "+t.toDisplayString(N.value?"Creando...":"Crear Cita"),1)],8,["disabled"])]),t.createVNode("div",{class:"hidden md:flex items-center justify-end gap-4 text-xs text-neutral-400"},[t.createVNode("span",{class:"flex items-center gap-1"},[t.createVNode("kbd",{class:"px-1.5 py-0.5 bg-neutral-100 rounded text-neutral-500 font-mono"},"Esc"),t.createVNode("span",null,"Cancelar")]),t.createVNode("span",{class:"flex items-center gap-1"},[t.createVNode("kbd",{class:"px-1.5 py-0.5 bg-neutral-100 rounded text-neutral-500 font-mono"},"Ctrl"),t.createVNode("span",null,"+"),t.createVNode("kbd",{class:"px-1.5 py-0.5 bg-neutral-100 rounded text-neutral-500 font-mono"},"Enter"),t.createVNode("span",null,"Crear")])])])],32)];o(a.ssrRenderComponent(t.unref(ve),{as:"h3",id:"modal-title",class:"text-xl sm:text-2xl font-bold text-neutral-900 mb-4 sm:mb-6 flex items-center gap-3"},{default:t.withCtx((e,a,o,l)=>{if(!a)return[t.createVNode("div",{class:"w-9 h-9 sm:w-10 sm:h-10 rounded-xl bg-gradient-to-br from-[#027368] to-[#025951] flex items-center justify-center text-white flex-shrink-0"},[(t.openBlock(),t.createBlock("svg",{class:"w-4 h-4 sm:w-5 sm:h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true"},[t.createVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})]))]),t.createTextVNode(" Nueva Cita ")];a(`<div class="w-9 h-9 sm:w-10 sm:h-10 rounded-xl bg-gradient-to-br from-[#027368] to-[#025951] flex items-center justify-center text-white flex-shrink-0" data-v-97295d59${l}><svg class="w-4 h-4 sm:w-5 sm:h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true" data-v-97295d59${l}><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" data-v-97295d59${l}></path></svg></div> Nueva Cita `)}),_:1},l,r)),o(`<form class="space-y-6" data-v-97295d59${r}><section class="space-y-3" data-v-97295d59${r}><div class="flex items-center gap-2 pb-2 border-b border-neutral-100" data-v-97295d59${r}><div class="w-6 h-6 rounded-lg bg-emerald-100 flex items-center justify-center" data-v-97295d59${r}><svg class="w-3.5 h-3.5 text-emerald-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-97295d59${r}><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" data-v-97295d59${r}></path></svg></div><h4 class="text-sm font-semibold text-neutral-700" data-v-97295d59${r}>Paciente</h4><span class="text-xs text-red-500" data-v-97295d59${r}>*</span></div><div class="relative" data-v-97295d59${r}>`),w.value?(o(`<div class="space-y-4 p-4 bg-blue-50 border-2 border-blue-200 rounded-xl" data-v-97295d59${r}><div class="flex items-center justify-between mb-3" data-v-97295d59${r}><h4 class="font-semibold text-neutral-900 flex items-center gap-2" data-v-97295d59${r}><svg class="w-5 h-5 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-97295d59${r}><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M18 9v3m0 0v3m0-3h3m-3 0h-3m-2-5a4 4 0 11-8 0 4 4 0 018 0zM3 20a6 6 0 0112 0v1H3v-1z" data-v-97295d59${r}></path></svg> Crear Nuevo Paciente </h4><button type="button" class="text-sm text-neutral-600 hover:text-neutral-900" data-v-97295d59${r}> Cancelar </button></div><div class="grid grid-cols-2 gap-3" data-v-97295d59${r}><div class="col-span-2" data-v-97295d59${r}><input${a.ssrRenderAttr("value",D.value.nombre_completo)} type="text" placeholder="Nombre completo *" class="w-full px-3 py-2 border-2 border-neutral-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent" data-v-97295d59${r}></div><div class="col-span-2" data-v-97295d59${r}><input${a.ssrRenderAttr("value",D.value.email)} type="email" placeholder="Email *" class="w-full px-3 py-2 border-2 border-neutral-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent" data-v-97295d59${r}></div><div data-v-97295d59${r}><input${a.ssrRenderAttr("value",D.value.telefono)} type="tel" placeholder="TelÃ©fono" class="w-full px-3 py-2 border-2 border-neutral-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent" data-v-97295d59${r}></div><div data-v-97295d59${r}><input${a.ssrRenderAttr("value",D.value.fecha_nacimiento)} type="date" placeholder="Fecha de nacimiento" class="w-full px-3 py-2 border-2 border-neutral-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent" data-v-97295d59${r}></div></div><button type="button"${a.ssrIncludeBooleanAttr(!D.value.nombre_completo||!D.value.email||V.value)?" disabled":""} class="w-full px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed font-medium flex items-center justify-center gap-2" data-v-97295d59${r}>`),V.value?o(`<svg class="animate-spin h-5 w-5" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" data-v-97295d59${r}><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4" data-v-97295d59${r}></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z" data-v-97295d59${r}></path></svg>`):o("\x3c!----\x3e"),o(` ${a.ssrInterpolate(V.value?"Creando...":"Crear Paciente")}</button></div>`)):(o(`<div class="space-y-2" data-v-97295d59${r}><div class="relative" data-v-97295d59${r}><label for="patient-search" class="sr-only" data-v-97295d59${r}>Buscar paciente</label><input id="patient-search"${a.ssrRenderAttr("value",t.unref(p))} type="text" placeholder="Buscar por nombre, email o telÃ©fono..." autocomplete="off" aria-describedby="patient-search-hint" aria-expanded="showDropdown" aria-haspopup="listbox" class="w-full px-4 py-3 pr-10 border-2 border-neutral-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-[#027368] focus:border-transparent transition-all" data-v-97295d59${r}><span id="patient-search-hint" class="sr-only" data-v-97295d59${r}>Escribe para buscar pacientes existentes o crear uno nuevo</span><div class="absolute right-3 top-1/2 -translate-y-1/2" data-v-97295d59${r}>`),t.unref(d)?o(`<svg class="animate-spin h-5 w-5 text-[#027368]" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" data-v-97295d59${r}><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4" data-v-97295d59${r}></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z" data-v-97295d59${r}></path></svg>`):o(`<svg class="h-5 w-5 text-neutral-400" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-97295d59${r}><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" data-v-97295d59${r}></path></svg>`),o("</div></div>"),y.value&&(t.unref(u)||t.unref(p).trim().length>0)?(o(`<div class="absolute z-10 w-full mt-1 bg-white border-2 border-neutral-200 rounded-xl shadow-xl max-h-80 overflow-y-auto" role="listbox" aria-label="Resultados de bÃºsqueda de pacientes" data-v-97295d59${r}>`),t.unref(u)?o(`<div class="px-3 py-1.5 bg-neutral-50 border-b border-neutral-100" data-v-97295d59${r}><span class="text-[10px] text-neutral-400 uppercase tracking-wider" data-v-97295d59${r}>Pacientes frecuentes</span></div>`):o("\x3c!----\x3e"),o("\x3c!--[--\x3e"),a.ssrRenderList(t.unref(i),e=>{o(`<button type="button" class="w-full px-3 py-2.5 text-left hover:bg-[#027368]/5 transition-colors border-b border-neutral-100 last:border-0 group" data-v-97295d59${r}><div class="flex items-center gap-3" data-v-97295d59${r}><div class="w-9 h-9 rounded-full bg-gradient-to-br from-[#027368] to-[#025951] text-white flex items-center justify-center font-bold text-sm flex-shrink-0" data-v-97295d59${r}>${a.ssrInterpolate(e.nombre_completo.charAt(0).toUpperCase())}</div><div class="flex-1 min-w-0" data-v-97295d59${r}><div class="flex items-center gap-2" data-v-97295d59${r}><p class="font-semibold text-neutral-900 truncate" data-v-97295d59${r}>${a.ssrInterpolate(e.nombre_completo)}</p>`),e.prioridad_score>=100?o(`<span class="flex-shrink-0 w-2 h-2 rounded-full bg-emerald-500" title="Cita reciente" data-v-97295d59${r}></span>`):o("\x3c!----\x3e"),o(`</div><div class="flex items-center gap-2 text-xs text-neutral-500" data-v-97295d59${r}>`),e.total_citas>0?o(`<span data-v-97295d59${r}>${a.ssrInterpolate(e.total_citas)} citas</span>`):o("\x3c!----\x3e"),e.ultima_cita?o(`<span class="text-neutral-400" data-v-97295d59${r}>Â·</span>`):o("\x3c!----\x3e"),e.ultima_cita?o(`<span class="text-neutral-400" data-v-97295d59${r}> Ãšltima: ${a.ssrInterpolate(formatRelativeDate(e.ultima_cita))}</span>`):o("\x3c!----\x3e"),o("</div></div>"),e.sesiones_restantes_total>0?o(`<div class="flex-shrink-0 px-2.5 py-1 bg-emerald-100 text-emerald-700 rounded-full text-xs font-bold" data-v-97295d59${r}>${a.ssrInterpolate(e.sesiones_restantes_total)} <span class="font-medium" data-v-97295d59${r}>ses.</span></div>`):o(`<div class="flex-shrink-0 px-2 py-1 bg-neutral-100 text-neutral-500 rounded-full text-xs" data-v-97295d59${r}> Sin bono </div>`),o("</div></button>")}),o(`\x3c!--]--\x3e<button type="button" class="w-full px-3 py-3 text-left bg-gradient-to-r from-[#027368]/5 to-transparent hover:from-[#027368]/10 transition-colors border-t-2 border-[#027368]/20 font-medium text-[#027368] flex items-center gap-2" data-v-97295d59${r}><div class="w-9 h-9 rounded-full bg-[#027368]/10 flex items-center justify-center" data-v-97295d59${r}><svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-97295d59${r}><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" data-v-97295d59${r}></path></svg></div><div data-v-97295d59${r}><p class="font-semibold" data-v-97295d59${r}>Crear nuevo paciente</p>`),t.unref(p).trim().length>0?o(`<p class="text-xs text-neutral-500" data-v-97295d59${r}> &quot;${a.ssrInterpolate(t.unref(p).trim())}&quot; </p>`):o("\x3c!----\x3e"),o("</div></button>"),!t.unref(u)&&!t.unref(d)&&t.unref(p).trim().length>0?o(`<div class="px-4 py-6 text-center text-neutral-500" data-v-97295d59${r}><svg class="w-10 h-10 mx-auto mb-2 text-neutral-300" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-97295d59${r}><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" data-v-97295d59${r}></path></svg><p class="font-medium text-sm" data-v-97295d59${r}>No se encontrÃ³ &quot;${a.ssrInterpolate(t.unref(p))}&quot;</p><p class="text-xs mt-1" data-v-97295d59${r}>Prueba con otro nombre o crea un nuevo paciente</p></div>`):o("\x3c!----\x3e"),o("</div>")):o("\x3c!----\x3e"),S.value.paciente_id&&_.value?(o(`<div class="space-y-3" data-v-97295d59${r}><div class="bg-gradient-to-r from-emerald-50 to-teal-50 border-2 border-emerald-200 rounded-xl overflow-hidden" data-v-97295d59${r}>`),0!==_.value.total_citas&&_.value.bono_activo?o("\x3c!----\x3e"):(o(`<div class="${a.ssrRenderClass([0===_.value.total_citas?"bg-blue-100 text-blue-700":"bg-amber-100 text-amber-700","px-3 py-1.5 text-xs font-medium flex items-center gap-2"])}" data-v-97295d59${r}><svg class="w-3.5 h-3.5" fill="currentColor" viewBox="0 0 20 20" data-v-97295d59${r}>`),0===_.value.total_citas?o(`<path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-11a1 1 0 10-2 0v2H7a1 1 0 100 2h2v2a1 1 0 102 0v-2h2a1 1 0 100-2h-2V7z" clip-rule="evenodd" data-v-97295d59${r}></path>`):o(`<path fill-rule="evenodd" d="M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z" clip-rule="evenodd" data-v-97295d59${r}></path>`),o(`</svg> ${a.ssrInterpolate(0===_.value.total_citas?"Paciente nuevo - Primera cita":"Sin bono activo")}</div>`)),o(`<div class="px-4 py-3" data-v-97295d59${r}><div class="flex items-center justify-between" data-v-97295d59${r}><div class="flex items-center gap-3" data-v-97295d59${r}><div class="w-11 h-11 rounded-full bg-gradient-to-br from-emerald-500 to-teal-600 text-white flex items-center justify-center font-bold text-lg shadow-sm" data-v-97295d59${r}>${a.ssrInterpolate(_.value.nombre_completo.charAt(0).toUpperCase())}</div><div data-v-97295d59${r}><p class="font-semibold text-neutral-900" data-v-97295d59${r}>${a.ssrInterpolate(_.value.nombre_completo)}</p><p class="text-xs text-neutral-500" data-v-97295d59${r}>${a.ssrInterpolate(_.value.email)}</p></div></div><div class="flex items-center gap-2" data-v-97295d59${r}><a${a.ssrRenderAttr("href",`/terapeuta/pacientes/${_.value.id}`)} target="_blank" class="p-2 text-neutral-400 hover:text-[#027368] hover:bg-white rounded-lg transition-colors" title="Ver perfil completo" data-v-97295d59${r}><svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-97295d59${r}><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14" data-v-97295d59${r}></path></svg></a><button type="button" class="p-2 hover:bg-white rounded-lg transition-colors text-neutral-400 hover:text-red-500" title="Cambiar paciente" data-v-97295d59${r}><svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-97295d59${r}><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" data-v-97295d59${r}></path></svg></button></div></div><div class="mt-3 grid grid-cols-3 gap-2 text-center" data-v-97295d59${r}><div class="bg-white/60 rounded-lg px-2 py-1.5" data-v-97295d59${r}><p class="text-xs text-neutral-500" data-v-97295d59${r}>Ãšltima cita</p><p class="text-sm font-semibold text-neutral-700" data-v-97295d59${r}>${a.ssrInterpolate(_.value.ultima_cita?formatRelativeDate(_.value.ultima_cita):"Nunca")}</p></div><div class="bg-white/60 rounded-lg px-2 py-1.5" data-v-97295d59${r}><p class="text-xs text-neutral-500" data-v-97295d59${r}>Total citas</p><p class="text-sm font-semibold text-neutral-700" data-v-97295d59${r}>${a.ssrInterpolate(_.value.total_citas||0)}</p></div><div class="bg-white/60 rounded-lg px-2 py-1.5" data-v-97295d59${r}><p class="text-xs text-neutral-500" data-v-97295d59${r}>Sesiones</p><p class="${a.ssrRenderClass([_.value.sesiones_restantes_total>0?"text-emerald-600":"text-neutral-400","text-sm font-semibold"])}" data-v-97295d59${r}>${a.ssrInterpolate(_.value.sesiones_restantes_total||0)} disp. </p></div></div></div></div>`),_.value.bono_activo?(o(`<div class="px-4 py-3 bg-violet-50 border-2 border-violet-200 rounded-xl" data-v-97295d59${r}><div class="flex items-start justify-between" data-v-97295d59${r}><div class="flex items-center gap-2" data-v-97295d59${r}><div class="w-8 h-8 rounded-lg bg-violet-600 text-white flex items-center justify-center" data-v-97295d59${r}><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-97295d59${r}><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 5v2m0 4v2m0 4v2M5 5a2 2 0 00-2 2v3a2 2 0 110 4v3a2 2 0 002 2h14a2 2 0 002-2v-3a2 2 0 110-4V7a2 2 0 00-2-2H5z" data-v-97295d59${r}></path></svg></div><div data-v-97295d59${r}><p class="font-semibold text-violet-900" data-v-97295d59${r}>${a.ssrInterpolate(_.value.bono_activo.tipo)}</p><p class="text-sm text-violet-700" data-v-97295d59${r}>${a.ssrInterpolate(_.value.bono_activo.sesiones_restantes)} de ${a.ssrInterpolate(_.value.bono_activo.sesiones_totales)} sesiones disponibles </p></div></div><div class="flex items-center gap-1" data-v-97295d59${r}>\x3c!--[--\x3e`),a.ssrRenderList(Math.min(_.value.bono_activo.sesiones_totales,10),e=>{o(`<div class="${a.ssrRenderClass([e<=_.value.bono_activo.sesiones_usadas?"bg-violet-600":"bg-violet-200","w-3 h-3 rounded-full"])}"${a.ssrRenderAttr("title",e<=_.value.bono_activo.sesiones_usadas?"SesiÃ³n usada":"SesiÃ³n disponible")} data-v-97295d59${r}></div>`)}),o("\x3c!--]--\x3e"),_.value.bono_activo.sesiones_totales>10?o(`<span class="text-xs text-violet-500 ml-1" data-v-97295d59${r}> +${a.ssrInterpolate(_.value.bono_activo.sesiones_totales-10)}</span>`):o("\x3c!----\x3e"),o(`</div></div><div class="mt-3 p-2 bg-amber-50 border border-amber-200 rounded-lg" data-v-97295d59${r}><p class="text-xs text-amber-800 flex items-start gap-2" data-v-97295d59${r}><svg class="w-4 h-4 flex-shrink-0 mt-0.5" fill="currentColor" viewBox="0 0 20 20" data-v-97295d59${r}><path fill-rule="evenodd" d="M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z" clip-rule="evenodd" data-v-97295d59${r}></path></svg><span data-v-97295d59${r}> Esta serÃ¡ la sesiÃ³n <strong data-v-97295d59${r}>${a.ssrInterpolate(_.value.bono_activo.sesiones_usadas+1)}/${a.ssrInterpolate(_.value.bono_activo.sesiones_totales)}</strong> del bono. Se descontarÃ¡ automÃ¡ticamente cuando la cita sea <strong data-v-97295d59${r}>confirmada</strong>. </span></p></div>`),_.value.bono_activo.fecha_fin?o(`<p class="mt-2 text-xs text-violet-600" data-v-97295d59${r}> Vence: ${a.ssrInterpolate(formatDate(_.value.bono_activo.fecha_fin))}</p>`):o("\x3c!----\x3e"),o("</div>")):o(`<div class="px-4 py-3 bg-amber-50 border-2 border-amber-200 rounded-xl" data-v-97295d59${r}><div class="flex items-start gap-3" data-v-97295d59${r}><div class="w-8 h-8 rounded-lg bg-amber-200 text-amber-700 flex items-center justify-center flex-shrink-0" data-v-97295d59${r}><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-97295d59${r}><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" data-v-97295d59${r}></path></svg></div><div data-v-97295d59${r}><p class="font-medium text-amber-800 text-sm" data-v-97295d59${r}>Sin bono activo</p><p class="text-xs text-amber-600 mt-0.5" data-v-97295d59${r}>Esta sesiÃ³n se facturarÃ¡ de forma individual.</p></div></div></div>`),_.value.bonos&&_.value.bonos.length>1?(o(`<div class="mt-2" data-v-97295d59${r}><label class="block text-sm font-medium text-neutral-700 mb-1" data-v-97295d59${r}> Seleccionar bono a usar </label><select class="w-full px-3 py-2 border-2 border-neutral-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-violet-500 focus:border-transparent text-sm" data-v-97295d59${r}>\x3c!--[--\x3e`),a.ssrRenderList(_.value.bonos,e=>{o(`<option${a.ssrRenderAttr("value",e.id)} data-v-97295d59${a.ssrIncludeBooleanAttr(Array.isArray(S.value.bono_id)?a.ssrLooseContain(S.value.bono_id,e.id):a.ssrLooseEqual(S.value.bono_id,e.id))?" selected":""}${r}>${a.ssrInterpolate(e.tipo)} - ${a.ssrInterpolate(e.sesiones_restantes)}/${a.ssrInterpolate(e.sesiones_totales)} sesiones </option>`)}),o("\x3c!--]--\x3e</select></div>")):o("\x3c!----\x3e"),o("</div>")):o("\x3c!----\x3e"),o("</div>")),o(`</div></section><section class="space-y-4 pt-2" data-v-97295d59${r}><div class="flex items-center gap-2 pb-2 border-b border-neutral-100" data-v-97295d59${r}><div class="w-6 h-6 rounded-lg bg-blue-100 flex items-center justify-center" data-v-97295d59${r}><svg class="w-3.5 h-3.5 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-97295d59${r}><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" data-v-97295d59${r}></path></svg></div><h4 class="text-sm font-semibold text-neutral-700" data-v-97295d59${r}>Fecha y Hora</h4><span class="text-xs text-red-500" data-v-97295d59${r}>*</span></div><div data-v-97295d59${r}><label for="fecha-cita" class="sr-only" data-v-97295d59${r}>Fecha de la cita</label><div class="flex flex-wrap gap-2 mb-2" role="group" aria-label="Fechas rÃ¡pidas" data-v-97295d59${r}>\x3c!--[--\x3e`),a.ssrRenderList(G.value,e=>{o(`<button type="button" class="${a.ssrRenderClass([S.value.fecha_cita===e.fecha?"bg-[#027368] text-white":"bg-neutral-100 text-neutral-600 hover:bg-neutral-200","px-3 py-1.5 text-xs font-medium rounded-lg transition-all focus:outline-none focus:ring-2 focus:ring-[#027368] focus:ring-offset-1"])}"${a.ssrRenderAttr("aria-pressed",S.value.fecha_cita===e.fecha)} data-v-97295d59${r}>${a.ssrInterpolate(e.label)}</button>`)}),o(`\x3c!--]--\x3e</div><input id="fecha-cita"${a.ssrRenderAttr("value",S.value.fecha_cita)} type="date" required${a.ssrRenderAttr("min",q.value)} aria-required="true" class="w-full px-4 py-3 border-2 border-neutral-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-[#027368] focus:border-transparent transition-all" data-v-97295d59${r}>`),S.value.fecha_cita?o(`<p class="mt-1 text-xs text-neutral-500" data-v-97295d59${r}>${a.ssrInterpolate(formatearFechaCompleta(S.value.fecha_cita))}</p>`):o("\x3c!----\x3e"),o("</div>"),H.value&&!S.value.hora_inicio?o(`<div class="px-3 py-2 bg-violet-50 border border-violet-200 rounded-lg flex items-center justify-between" data-v-97295d59${r}><div class="flex items-center gap-2 text-violet-700 text-sm" data-v-97295d59${r}><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true" data-v-97295d59${r}><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z" data-v-97295d59${r}></path></svg><span data-v-97295d59${r}>${a.ssrInterpolate(H.value.razon)}</span></div><button type="button" class="px-2 py-1 bg-violet-600 text-white text-xs font-medium rounded hover:bg-violet-700 transition-colors" data-v-97295d59${r}> Usar ${a.ssrInterpolate(H.value.hora)}</button></div>`):o("\x3c!----\x3e"),o(`<div class="grid grid-cols-2 gap-4" data-v-97295d59${r}><div data-v-97295d59${r}><label class="block text-sm font-semibold text-neutral-700 mb-2" data-v-97295d59${r}> Hora inicio * </label><select required class="w-full px-4 py-3 border-2 border-neutral-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-[#027368] focus:border-transparent transition-all bg-white appearance-none cursor-pointer" data-v-97295d59${r}><option value="" disabled data-v-97295d59${a.ssrIncludeBooleanAttr(Array.isArray(S.value.hora_inicio)?a.ssrLooseContain(S.value.hora_inicio,""):a.ssrLooseEqual(S.value.hora_inicio,""))?" selected":""}${r}>Seleccionar hora</option>\x3c!--[--\x3e`),a.ssrRenderList(Z.value,e=>{o(`<option${a.ssrRenderAttr("value",e.value)} data-v-97295d59${a.ssrIncludeBooleanAttr(Array.isArray(S.value.hora_inicio)?a.ssrLooseContain(S.value.hora_inicio,e.value):a.ssrLooseEqual(S.value.hora_inicio,e.value))?" selected":""}${r}>${a.ssrInterpolate(e.label)}</option>`)}),o(`\x3c!--]--\x3e</select></div><div data-v-97295d59${r}><label class="block text-sm font-semibold text-neutral-700 mb-2" data-v-97295d59${r}> Hora fin * <span class="font-normal text-neutral-400" data-v-97295d59${r}>(${a.ssrInterpolate(Y.value)})</span></label><select required class="w-full px-4 py-3 border-2 border-neutral-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-[#027368] focus:border-transparent transition-all bg-white appearance-none cursor-pointer" data-v-97295d59${r}><option value="" disabled data-v-97295d59${a.ssrIncludeBooleanAttr(Array.isArray(S.value.hora_fin)?a.ssrLooseContain(S.value.hora_fin,""):a.ssrLooseEqual(S.value.hora_fin,""))?" selected":""}${r}>Seleccionar hora</option>\x3c!--[--\x3e`),a.ssrRenderList(W.value,e=>{o(`<option${a.ssrRenderAttr("value",e.value)} data-v-97295d59${a.ssrIncludeBooleanAttr(Array.isArray(S.value.hora_fin)?a.ssrLooseContain(S.value.hora_fin,e.value):a.ssrLooseEqual(S.value.hora_fin,e.value))?" selected":""}${r}>${a.ssrInterpolate(e.label)}</option>`)}),o(`\x3c!--]--\x3e</select></div></div><div class="flex items-center gap-2" data-v-97295d59${r}><span class="text-xs text-neutral-500" data-v-97295d59${r}>DuraciÃ³n rÃ¡pida:</span>\x3c!--[--\x3e`),a.ssrRenderList(O,e=>{o(`<button type="button" class="${a.ssrRenderClass([calcularDuracionMinutos()===e.minutos?"bg-[#027368]/10 text-[#027368] font-medium":"bg-neutral-100 text-neutral-500 hover:bg-neutral-200","px-2 py-1 text-xs rounded-md transition-all"])}" data-v-97295d59${r}>${a.ssrInterpolate(e.label)}</button>`)}),o("\x3c!--]--\x3e</div>"),C.value?(o(`<div class="${a.ssrRenderClass([{"bg-red-50 border-2 border-red-200":"error"===C.value.type,"bg-yellow-50 border-2 border-yellow-200":"warning"===C.value.type,"bg-emerald-50 border-2 border-emerald-200":"success"===C.value.type},"px-4 py-3 rounded-xl flex items-start gap-3"])}" data-v-97295d59${r}><svg class="${a.ssrRenderClass([{"text-red-600":"error"===C.value.type,"text-yellow-600":"warning"===C.value.type,"text-emerald-600":"success"===C.value.type},"w-5 h-5 mt-0.5 flex-shrink-0"])}" fill="currentColor" viewBox="0 0 20 20" data-v-97295d59${r}>`),"error"===C.value.type?o(`<path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clip-rule="evenodd" data-v-97295d59${r}></path>`):"success"===C.value.type?o(`<path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd" data-v-97295d59${r}></path>`):o(`<path fill-rule="evenodd" d="M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z" clip-rule="evenodd" data-v-97295d59${r}></path>`),o(`</svg><p class="${a.ssrRenderClass([{"text-red-800":"error"===C.value.type,"text-yellow-800":"warning"===C.value.type,"text-emerald-800":"success"===C.value.type},"text-sm font-medium flex-1"])}" data-v-97295d59${r}>${a.ssrInterpolate(C.value.text)}</p></div>`)):o("\x3c!----\x3e"),o(`</section><section class="space-y-4 pt-2" data-v-97295d59${r}><div class="flex items-center gap-2 pb-2 border-b border-neutral-100" data-v-97295d59${r}><div class="w-6 h-6 rounded-lg bg-violet-100 flex items-center justify-center" data-v-97295d59${r}><svg class="w-3.5 h-3.5 text-violet-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-97295d59${r}><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z" data-v-97295d59${r}></path></svg></div><h4 class="text-sm font-semibold text-neutral-700" data-v-97295d59${r}>Modalidad</h4><span class="text-xs text-red-500" data-v-97295d59${r}>*</span>`),F.value&&S.value.modalidad!==F.value?o(`<span class="ml-auto text-[10px] px-2 py-0.5 bg-amber-100 text-amber-700 rounded-full flex items-center gap-1 cursor-pointer hover:bg-amber-200 transition-colors"${a.ssrRenderAttr("title",`Normalmente usas ${F.value} los ${U.value}`)} data-v-97295d59${r}><svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true" data-v-97295d59${r}><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z" data-v-97295d59${r}></path></svg> ${a.ssrInterpolate(z.find(e=>e.value===F.value)?.label)} los ${a.ssrInterpolate(U.value)}</span>`):o("\x3c!----\x3e"),o(`</div><div class="grid grid-cols-3 gap-3" data-v-97295d59${r}>\x3c!--[--\x3e`),a.ssrRenderList(z,e=>{o(`<button type="button" class="${a.ssrRenderClass([S.value.modalidad===e.value?"border-[#027368] bg-gradient-to-br from-[#027368]/10 to-[#027368]/5 text-[#027368] shadow-md":"border-neutral-200 text-neutral-600 hover:border-neutral-300 hover:bg-neutral-50","relative px-4 py-4 rounded-xl border-2 transition-all font-medium flex flex-col items-center gap-2 group"])}" data-v-97295d59${r}>`),S.value.modalidad===e.value?o(`<div class="absolute top-2 right-2 w-5 h-5 bg-[#027368] rounded-full flex items-center justify-center" data-v-97295d59${r}><svg class="w-3 h-3 text-white" fill="currentColor" viewBox="0 0 20 20" data-v-97295d59${r}><path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" data-v-97295d59${r}></path></svg></div>`):o("\x3c!----\x3e"),o(`<span class="text-2xl" data-v-97295d59${r}>${a.ssrInterpolate(e.icon)}</span><span class="text-sm font-semibold" data-v-97295d59${r}>${a.ssrInterpolate(e.label)}</span><span class="text-[10px] text-neutral-400 group-hover:text-neutral-500" data-v-97295d59${r}>${a.ssrInterpolate(e.descripcion)}</span></button>`)}),o("\x3c!--]--\x3e</div>"),"presencial"===S.value.modalidad?o(`<div class="space-y-2" data-v-97295d59${r}><label id="ubicacion-label" class="block text-sm font-semibold text-neutral-700" data-v-97295d59${r}> Sala / Consultorio <span class="font-normal text-neutral-400" data-v-97295d59${r}>(opcional)</span></label><div class="relative" data-v-97295d59${r}><div class="absolute left-3 top-1/2 -translate-y-1/2 text-neutral-400" data-v-97295d59${r}><svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true" data-v-97295d59${r}><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4" data-v-97295d59${r}></path></svg></div><input${a.ssrRenderAttr("value",S.value.ubicacion)} type="text" aria-labelledby="ubicacion-label" placeholder="Ej: Consultorio 3, Sala de terapia..." class="w-full pl-10 pr-4 py-3 border-2 border-neutral-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-[#027368] focus:border-transparent transition-all" data-v-97295d59${r}></div></div>`):o("\x3c!----\x3e"),"online"===S.value.modalidad?(o(`<div class="space-y-2" data-v-97295d59${r}><label id="enlace-label" class="block text-sm font-semibold text-neutral-700" data-v-97295d59${r}> Enlace de videollamada <span class="font-normal text-neutral-400" data-v-97295d59${r}>(opcional)</span></label><div class="relative" data-v-97295d59${r}><div class="absolute left-3 top-1/2 -translate-y-1/2" data-v-97295d59${r}>`),"meet"===K.value?o(`<img src="https://www.gstatic.com/meet/google_meet_horizontal_wordmark_2020q4_1x_icon_124_40_2373e79660dabbf194273d27aa7ee1f5.png" alt="Google Meet" class="w-5 h-5 object-contain" data-v-97295d59${r}>`):"zoom"===K.value?o(`<img src="https://st1.zoom.us/zoom.ico" alt="Zoom" class="w-5 h-5 object-contain" data-v-97295d59${r}>`):"teams"===K.value?o(`<img src="https://cdn-icons-png.flaticon.com/512/906/906349.png" alt="Teams" class="w-5 h-5 object-contain" data-v-97295d59${r}>`):o(`<svg class="w-5 h-5 text-neutral-400" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true" data-v-97295d59${r}><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z" data-v-97295d59${r}></path></svg>`),o(`</div><input${a.ssrRenderAttr("value",S.value.enlace_videollamada)} type="url" aria-labelledby="enlace-label"${a.ssrRenderAttr("aria-invalid",!1===J.value)} placeholder="Pega el enlace de Meet, Zoom o Teams..." class="${a.ssrRenderClass([!1===J.value?"border-red-300 bg-red-50":!0===J.value?"border-emerald-300 bg-emerald-50":"border-neutral-200","w-full pl-10 pr-4 py-3 border-2 rounded-xl focus:outline-none focus:ring-2 focus:ring-[#027368] focus:border-transparent transition-all"])}" data-v-97295d59${r}>`),K.value&&J.value?o(`<div class="absolute right-3 top-1/2 -translate-y-1/2 px-2 py-0.5 bg-emerald-100 text-emerald-700 rounded text-xs font-medium" data-v-97295d59${r}>${a.ssrInterpolate(X.value)}</div>`):o("\x3c!----\x3e"),o("</div>"),S.value.enlace_videollamada&&!1===J.value?o(`<p class="text-xs text-red-600" role="alert" data-v-97295d59${r}> Enlace no reconocido. Usa Google Meet, Zoom o Microsoft Teams. </p>`):S.value.enlace_videollamada?o("\x3c!----\x3e"):o(`<p class="text-xs text-neutral-400" data-v-97295d59${r}> Compatible con Google Meet, Zoom y Microsoft Teams </p>`),o("</div>")):o("\x3c!----\x3e"),"telefonica"===S.value.modalidad?o(`<div class="px-4 py-3 bg-blue-50 border border-blue-200 rounded-xl" role="note" data-v-97295d59${r}><div class="flex items-start gap-2 text-blue-700" data-v-97295d59${r}><svg class="w-5 h-5 mt-0.5 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true" data-v-97295d59${r}><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" data-v-97295d59${r}></path></svg><div class="text-sm" data-v-97295d59${r}><p class="font-medium" data-v-97295d59${r}>SesiÃ³n por telÃ©fono</p><p class="text-blue-600 text-xs mt-0.5" data-v-97295d59${r}>Se utilizarÃ¡ el nÃºmero de contacto del paciente para la llamada.</p></div></div></div>`):o("\x3c!----\x3e"),o(`</section><section class="space-y-3 pt-2" data-v-97295d59${r}><div class="flex items-center gap-2 pb-2 border-b border-neutral-100" data-v-97295d59${r}><div class="w-6 h-6 rounded-lg bg-amber-100 flex items-center justify-center" data-v-97295d59${r}><svg class="w-3.5 h-3.5 text-amber-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-97295d59${r}><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z" data-v-97295d59${r}></path></svg></div><h4 class="text-sm font-semibold text-neutral-700" data-v-97295d59${r}>Observaciones</h4><span class="text-xs text-neutral-400" data-v-97295d59${r}>(opcional)</span>`),S.value.observaciones?o(`<span class="${a.ssrRenderClass([(S.value.observaciones?.length||0)>450?"text-amber-600":"text-neutral-400","ml-auto text-xs"])}" data-v-97295d59${r}>${a.ssrInterpolate(S.value.observaciones?.length||0)}/500 </span>`):o("\x3c!----\x3e"),o(`</div><div class="flex flex-wrap gap-1.5" role="group" aria-label="Plantillas rÃ¡pidas de observaciÃ³n" data-v-97295d59${r}>\x3c!--[--\x3e`),a.ssrRenderList(I,e=>{o(`<button type="button" class="${a.ssrRenderClass([S.value.observaciones?.includes(e.texto)?"bg-[#027368]/10 text-[#027368] font-medium":"bg-neutral-100 text-neutral-600 hover:bg-neutral-200","px-2.5 py-1 text-xs rounded-lg transition-all flex items-center gap-1 focus:outline-none focus:ring-2 focus:ring-[#027368] focus:ring-offset-1"])}"${a.ssrRenderAttr("aria-pressed",S.value.observaciones?.includes(e.texto))} data-v-97295d59${r}><span aria-hidden="true" data-v-97295d59${r}>${a.ssrInterpolate(e.emoji)}</span><span data-v-97295d59${r}>${a.ssrInterpolate(e.label)}</span></button>`)}),o(`\x3c!--]--\x3e</div><div class="relative" data-v-97295d59${r}><textarea id="observaciones-textarea"${a.ssrRenderAttr("rows",R.value?5:2)} maxlength="500" aria-label="Observaciones" aria-describedby="observaciones-hint" placeholder="Ej: Primera sesiÃ³n de evaluaciÃ³n, seguimiento ansiedad, revisiÃ³n de objetivos terapÃ©uticos..." class="w-full px-4 py-3 border-2 border-neutral-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-[#027368] focus:border-transparent transition-all resize-none" data-v-97295d59${r}>${a.ssrInterpolate(S.value.observaciones)}</textarea><span id="observaciones-hint" class="sr-only" data-v-97295d59${r}>MÃ¡ximo 500 caracteres. Usa las plantillas rÃ¡pidas para aÃ±adir texto predefinido.</span>`),R.value||S.value.observaciones?o("\x3c!----\x3e"):o(`<button type="button" class="absolute bottom-2 right-2 text-xs text-neutral-400 hover:text-neutral-600 flex items-center gap-1 focus:outline-none focus:text-[#027368]" aria-label="Expandir campo de observaciones" data-v-97295d59${r}><svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true" data-v-97295d59${r}><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" data-v-97295d59${r}></path></svg> Expandir </button>`),o(`</div></section><div class="space-y-3 pt-6 border-t border-neutral-100" data-v-97295d59${r}><div class="flex flex-col sm:flex-row gap-3" data-v-97295d59${r}><button type="button" class="order-3 sm:order-1 px-6 py-3 bg-neutral-100 text-neutral-700 rounded-xl hover:bg-neutral-200 transition-all font-semibold focus:outline-none focus:ring-2 focus:ring-neutral-400 focus:ring-offset-2" data-v-97295d59${r}> Cancelar </button><button type="button"${a.ssrIncludeBooleanAttr(N.value||!ee.value)?" disabled":""} class="order-2 flex-1 px-4 py-3 border-2 border-[#027368] text-[#027368] rounded-xl hover:bg-[#027368]/5 transition-all font-semibold disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2 focus:outline-none focus:ring-2 focus:ring-[#027368] focus:ring-offset-2" data-v-97295d59${r}><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true" data-v-97295d59${r}><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" data-v-97295d59${r}></path></svg><span class="hidden sm:inline" data-v-97295d59${r}>Crear y agendar otra</span><span class="sm:hidden" data-v-97295d59${r}>+ Otra</span></button><button type="submit"${a.ssrIncludeBooleanAttr(N.value||!ee.value)?" disabled":""} class="order-1 sm:order-3 flex-1 px-6 py-3 bg-gradient-to-r from-[#027368] to-[#025951] text-white rounded-xl hover:shadow-lg hover:shadow-[#027368]/25 transition-all font-semibold disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2 focus:outline-none focus:ring-2 focus:ring-[#027368] focus:ring-offset-2" data-v-97295d59${r}>`),N.value?o(`<svg class="animate-spin h-5 w-5" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" aria-hidden="true" data-v-97295d59${r}><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4" data-v-97295d59${r}></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z" data-v-97295d59${r}></path></svg>`):o(`<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true" data-v-97295d59${r}><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" data-v-97295d59${r}></path></svg>`),o(` ${a.ssrInterpolate(N.value?"Creando...":"Crear Cita")}</button></div><div class="hidden md:flex items-center justify-end gap-4 text-xs text-neutral-400" data-v-97295d59${r}><span class="flex items-center gap-1" data-v-97295d59${r}><kbd class="px-1.5 py-0.5 bg-neutral-100 rounded text-neutral-500 font-mono" data-v-97295d59${r}>Esc</kbd><span data-v-97295d59${r}>Cancelar</span></span><span class="flex items-center gap-1" data-v-97295d59${r}><kbd class="px-1.5 py-0.5 bg-neutral-100 rounded text-neutral-500 font-mono" data-v-97295d59${r}>Ctrl</kbd><span data-v-97295d59${r}>+</span><kbd class="px-1.5 py-0.5 bg-neutral-100 rounded text-neutral-500 font-mono" data-v-97295d59${r}>Enter</kbd><span data-v-97295d59${r}>Crear</span></span></div></div></form>`)}),_:1},l,r))}),_:1},l,r)),o("</div></div>")}),_:1},l,r))}),_:1},r))}}}),_e=Be.setup;Be.setup=(e,a)=>{const o=t.useSSRContext();return(o.modules||(o.modules=new Set)).add("components/ModalNuevaCitaEnhanced.vue"),_e?_e(e,a):void 0};const Ce=Object.assign(n(Be,[["__scopeId","data-v-97295d59"]]),{__name:"ModalNuevaCitaEnhanced"});export{Ce as _,useAgendaEnhanced as u};
//# sourceMappingURL=ModalNuevaCitaEnhanced-aLTjurwp.mjs.map
