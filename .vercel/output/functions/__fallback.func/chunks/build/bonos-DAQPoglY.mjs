import{_ as e}from"./DashboardCard-DLsboU2i.mjs";import{v as t,j as a,a as o,s}from"./server.mjs";import{u as r,a as n}from"./useBonos-BES-yO_A.mjs";import{_ as d}from"./_plugin-vue_export-helper-1tPrXgE0.mjs";import{u as l}from"./useSupabase-CA5R4uuJ.mjs";import{u as i}from"./useSupabaseClient-DykwVqLQ.mjs";import"../routes/renderer.mjs";import"../nitro/nitro.mjs";import"node:http";import"node:https";import"node:events";import"node:buffer";import"node:fs";import"node:path";import"node:crypto";import"../_/shared.cjs.prod.mjs";import"node:stream";import"@supabase/ssr";import"@vercel/analytics/nuxt";const c=t.defineComponent({__name:"BonoCard",__ssrInlineRender:!0,props:{bono:{}},emits:["renovar","verPagos","editar"],setup(e){const a=e,{getEstadoColor:o,getEstadoTexto:d,calcularPorcentajeUso:l,puedeGestionarBonos:i,puedeConfirmarPagos:c}=r(),{isCoordinadora:u}=n(),p=t.computed(()=>({quincenal:"Quincenal",mensual:"Mensual",semestral:"Semestral"}[a.bono.tipo]||a.bono.tipo||"EstÃ¡ndar")),v=t.computed(()=>o(a.bono.estado)),b=t.computed(()=>d(a.bono.estado)),f=t.computed(()=>({pendiente:"â³",activo:"âœ…",completado:"âœ”ï¸",vencido:"âŒ",cancelado:"ğŸš«"}[a.bono.estado]||"ğŸ“‹")),m=t.computed(()=>({pendiente:"border-yellow-300",activo:"border-green-300",completado:"border-gray-300",vencido:"border-red-300",cancelado:"border-gray-400"}[a.bono.estado]||"border-gray-300")),x=t.computed(()=>a.bono.sesiones_restantes??0),g=t.computed(()=>(a.bono.sesiones_totales||0)-x.value),A=t.computed(()=>l(a.bono)),y=t.computed(()=>{const e=A.value;return e>=90?"bg-red-500":e>=70?"bg-orange-500":e>=50?"bg-yellow-500":"bg-gradient-to-r from-[#D8AFA0] to-[#ECC8BA]"}),h=t.computed(()=>{if(!a.bono.fecha_fin)return null;const e=new Date,t=new Date(a.bono.fecha_fin);return Math.ceil((t.getTime()-e.getTime())/864e5)}),w=t.computed(()=>"activo"===a.bono.estado&&null!==h.value&&(h.value>=0&&h.value<=7)),D=t.computed(()=>"activo"===a.bono.estado&&x.value>0&&x.value<=2),$=t.computed(()=>i.value||c.value),C=t.computed(()=>i.value),F=t.computed(()=>u.value),formatearFecha=e=>{if(!e)return"";try{return new Date(e+"T00:00:00").toLocaleDateString("es-ES",{day:"numeric",month:"short",year:"numeric"})}catch{return e}};return(a,o,r,n)=>{var d;o(`<div${s.ssrRenderAttrs(t.mergeProps({class:["group bono-card bg-white/90 backdrop-blur-md border-2 rounded-2xl p-6 hover:shadow-xl transition-all duration-500 relative overflow-hidden hover:bg-white/95 hover:scale-[1.02]",[t.unref(m),{"opacity-60":"cancelado"===e.bono.estado}]]},n))} data-v-a85fab0a><div class="absolute inset-0 bg-gradient-to-br from-[#5550F2]/5 via-transparent to-[#04BF9D]/5 opacity-0 group-hover:opacity-100 transition-opacity duration-500" data-v-a85fab0a></div><div class="absolute -top-20 -right-20 w-40 h-40 bg-gradient-to-br from-[#F2B33D]/10 to-[#5550F2]/10 rounded-full blur-2xl opacity-0 group-hover:opacity-60 transition-all duration-700" data-v-a85fab0a></div><div class="relative flex items-start justify-between mb-6" data-v-a85fab0a><div class="flex-1" data-v-a85fab0a><div class="flex items-center gap-4 mb-3" data-v-a85fab0a><div class="w-12 h-12 rounded-xl bg-gradient-to-br from-[#5550F2] to-[#027368] shadow-lg flex items-center justify-center group-hover:scale-110 transition-transform duration-300" data-v-a85fab0a><span class="text-xl" data-v-a85fab0a>ğŸ«</span></div><h3 class="font-[&#39;Elms_Sans&#39;] text-xl font-bold bg-gradient-to-r from-[#5550F2] to-[#027368] bg-clip-text text-transparent" data-v-a85fab0a> Bono ${s.ssrInterpolate(t.unref(p))}</h3></div><div class="flex items-center gap-3 flex-wrap" data-v-a85fab0a><span class="${s.ssrRenderClass([t.unref(v),"inline-flex items-center px-4 py-2 rounded-xl text-xs font-['Lato'] font-semibold border backdrop-blur-sm shadow-sm"])}" data-v-a85fab0a>${s.ssrInterpolate(t.unref(f))} ${s.ssrInterpolate(t.unref(b))}</span>`),t.unref(w)?o('<span class="inline-flex items-center px-3 py-1.5 rounded-xl text-xs font-[&#39;Lato&#39;] font-semibold bg-gradient-to-r from-[#F2B33D]/20 to-[#F2B33D]/10 text-[#F2B33D] border border-[#F2B33D]/30 backdrop-blur-sm shadow-sm" data-v-a85fab0a> âš ï¸ Vence pronto </span>'):o("\x3c!----\x3e"),t.unref(D)?o('<span class="inline-flex items-center px-3 py-1.5 rounded-xl text-xs font-[&#39;Lato&#39;] font-semibold bg-gradient-to-r from-[#04BF9D]/20 to-[#027368]/10 text-[#027368] border border-[#04BF9D]/30 backdrop-blur-sm shadow-sm" data-v-a85fab0a> ğŸ“Š Pocas sesiones </span>'):o("\x3c!----\x3e"),o('</div></div><div class="flex gap-3" data-v-a85fab0a>'),t.unref($)?o('<button class="p-3 hover:bg-gradient-to-br from-[#5550F2]/10 to-[#027368]/10 rounded-xl transition-all duration-300 backdrop-blur-sm border border-white/50 hover:shadow-lg hover:scale-110 group/btn" title="Ver pagos" data-v-a85fab0a><span class="text-lg group-hover/btn:scale-110 transition-transform duration-300" data-v-a85fab0a>ğŸ’°</span></button>'):o("\x3c!----\x3e"),t.unref(C)?o('<button class="p-3 hover:bg-gradient-to-br from-[#04BF9D]/10 to-[#F2B33D]/10 rounded-xl transition-all duration-300 backdrop-blur-sm border border-white/50 hover:shadow-lg hover:scale-110 group/btn" title="Renovar bono" data-v-a85fab0a><span class="text-lg group-hover/btn:scale-110 transition-transform duration-300" data-v-a85fab0a>ğŸ”„</span></button>'):o("\x3c!----\x3e"),o(`</div></div><div class="relative mb-6" data-v-a85fab0a><div class="flex items-center justify-between mb-3" data-v-a85fab0a><span class="text-sm font-[&#39;Lato&#39;] text-gray-600 font-medium" data-v-a85fab0a>Sesiones</span><span class="text-sm font-[&#39;Lato&#39;] font-semibold bg-gradient-to-r from-[#5550F2] to-[#027368] bg-clip-text text-transparent" data-v-a85fab0a>${s.ssrInterpolate(t.unref(x))} / ${s.ssrInterpolate(e.bono.sesiones_totales)} disponibles </span></div><div class="relative w-full bg-gradient-to-r from-gray-100 to-gray-50 rounded-full h-4 overflow-hidden shadow-inner" data-v-a85fab0a><div class="${s.ssrRenderClass([t.unref(y),"h-4 rounded-full transition-all duration-700 ease-out shadow-lg relative overflow-hidden"])}" style="${s.ssrRenderStyle({width:t.unref(A)+"%"})}" data-v-a85fab0a><div class="absolute inset-0 bg-gradient-to-r from-white/30 to-transparent" data-v-a85fab0a></div><div class="absolute inset-0 bg-gradient-to-r from-transparent via-white/20 to-transparent animate-pulse" data-v-a85fab0a></div></div></div><div class="flex justify-between mt-2 text-xs font-[&#39;Lato&#39;] text-gray-600" data-v-a85fab0a><span data-v-a85fab0a>${s.ssrInterpolate(t.unref(g))} usadas</span><span class="font-semibold" data-v-a85fab0a>${s.ssrInterpolate(t.unref(A))}% completado</span></div></div><div class="relative grid grid-cols-2 gap-4 mb-6" data-v-a85fab0a><div class="p-4 bg-white/70 backdrop-blur-sm rounded-xl border border-white/50 shadow-sm group-hover:shadow-md transition-all duration-300" data-v-a85fab0a><div class="text-xs font-[&#39;Lato&#39;] text-gray-500 uppercase tracking-wider mb-2" data-v-a85fab0a>Tipo</div><div class="text-sm font-[&#39;Lato&#39;] font-semibold text-gray-800 capitalize" data-v-a85fab0a>${s.ssrInterpolate(e.bono.tipo||"EstÃ¡ndar")}</div></div><div class="p-4 bg-white/70 backdrop-blur-sm rounded-xl border border-white/50 shadow-sm group-hover:shadow-md transition-all duration-300" data-v-a85fab0a><div class="text-xs font-[&#39;Lato&#39;] text-gray-500 uppercase tracking-wider mb-2" data-v-a85fab0a>Frecuencia</div><div class="text-sm font-[&#39;Lato&#39;] font-semibold text-gray-800 capitalize" data-v-a85fab0a>${s.ssrInterpolate(e.bono.frecuencia||"Semanal")}</div></div><div class="p-3 bg-white rounded-lg border border-[#D8AFA0]/20" data-v-a85fab0a><div class="text-xs text-[#5D4A44]/60 mb-1" data-v-a85fab0a>Monto</div><div class="text-sm font-medium text-[#5D4A44]" data-v-a85fab0a>${s.ssrInterpolate((d=e.bono.monto,d?new Intl.NumberFormat("es-ES",{style:"currency",currency:"EUR"}).format(d):"$ 0"))}</div></div><div class="p-3 bg-white rounded-lg border border-[#D8AFA0]/20" data-v-a85fab0a><div class="text-xs text-[#5D4A44]/60 mb-1" data-v-a85fab0a>Pago</div><div class="${s.ssrRenderClass([e.bono.pagado?"text-green-600":"text-orange-600","text-sm font-medium flex items-center gap-1"])}" data-v-a85fab0a>${s.ssrInterpolate(e.bono.pagado?"âœ“ Pagado":"â³ Pendiente")}</div></div></div>`),e.bono.fecha_inicio||e.bono.fecha_fin?(o('<div class="mb-4 p-3 bg-gradient-to-r from-[#D8AFA0]/10 to-[#ECC8BA]/10 rounded-lg" data-v-a85fab0a><div class="flex items-center justify-between text-sm" data-v-a85fab0a>'),e.bono.fecha_inicio?o(`<div data-v-a85fab0a><span class="text-[#5D4A44]/60" data-v-a85fab0a>Inicio:</span><span class="font-medium text-[#5D4A44] ml-1" data-v-a85fab0a>${s.ssrInterpolate(formatearFecha(e.bono.fecha_inicio))}</span></div>`):o("\x3c!----\x3e"),e.bono.fecha_fin?o(`<div data-v-a85fab0a><span class="text-[#5D4A44]/60" data-v-a85fab0a>Vence:</span><span class="${s.ssrRenderClass([t.unref(w)?"text-orange-600":"text-[#5D4A44]","font-medium ml-1"])}" data-v-a85fab0a>${s.ssrInterpolate(formatearFecha(e.bono.fecha_fin))}</span></div>`):o("\x3c!----\x3e"),o("</div>"),null!==t.unref(h)&&"activo"===e.bono.estado?o(`<div class="mt-2 text-xs text-center text-[#5D4A44]/60" data-v-a85fab0a>${s.ssrInterpolate(t.unref(h)>0?`${t.unref(h)} dÃ­as restantes`:"Vencido")}</div>`):o("\x3c!----\x3e"),o("</div>")):o("\x3c!----\x3e"),e.bono.renovacion_automatica?o('<div class="flex items-center gap-2 mb-4 p-2 bg-purple-50 border border-purple-200 rounded-lg" data-v-a85fab0a><span class="text-sm" data-v-a85fab0a>ğŸ”„</span><span class="text-xs text-purple-700 font-medium" data-v-a85fab0a>RenovaciÃ³n automÃ¡tica activada</span></div>'):o("\x3c!----\x3e"),e.bono.notas?o(`<div class="mb-4" data-v-a85fab0a><div class="text-xs text-[#5D4A44]/60 mb-1" data-v-a85fab0a>Notas</div><div class="text-sm text-[#5D4A44]/80 p-2 bg-white rounded-lg border border-[#D8AFA0]/20" data-v-a85fab0a>${s.ssrInterpolate(e.bono.notas)}</div></div>`):o("\x3c!----\x3e"),o('<div class="flex gap-2 pt-3 border-t border-[#D8AFA0]/20" data-v-a85fab0a>'),t.unref($)?o('<button class="flex-1 px-4 py-2 bg-[#D8AFA0] text-white rounded-lg hover:bg-[#C89B8A] transition-colors text-sm font-medium flex items-center justify-center gap-2" data-v-a85fab0a><span data-v-a85fab0a>ğŸ’°</span><span data-v-a85fab0a>Ver Pagos</span></button>'):o("\x3c!----\x3e"),t.unref(C)&&"activo"!==e.bono.estado?o('<button class="flex-1 px-4 py-2 bg-purple-500 text-white rounded-lg hover:bg-purple-600 transition-colors text-sm font-medium flex items-center justify-center gap-2" data-v-a85fab0a><span data-v-a85fab0a>ğŸ”„</span><span data-v-a85fab0a>Renovar</span></button>'):o("\x3c!----\x3e"),t.unref(F)?o('<button class="px-4 py-2 bg-white border border-[#D8AFA0]/30 text-[#5D4A44] rounded-lg hover:bg-[#D8AFA0]/10 transition-colors text-sm font-medium" data-v-a85fab0a> âœï¸ </button>'):o("\x3c!----\x3e"),o("</div></div>")}}}),u=c.setup;c.setup=(e,a)=>{const o=t.useSSRContext();return(o.modules||(o.modules=new Set)).add("components/BonoCard.vue"),u?u(e,a):void 0};const p=Object.assign(d(c,[["__scopeId","data-v-a85fab0a"]]),{__name:"BonoCard"}),v=t.defineComponent({__name:"ModalNuevoBono",__ssrInlineRender:!0,props:{mostrar:{type:Boolean},pacienteId:{},pacienteNombre:{},psicologaId:{}},emits:["close","created"],setup(e,{emit:a}){r(),l();const o=t.ref({tipo:"mensual",frecuencia:"semanal",sesiones_totales:4,monto:0,fecha_inicio:(new Date).toISOString().split("T")[0],fecha_fin:"",estado:"pendiente",renovacion_automatica:!1,notas:""}),n=t.ref(!1),d=t.ref(""),i=t.computed(()=>o.value.tipo&&o.value.sesiones_totales&&o.value.monto),c=t.computed(()=>{if(!o.value.sesiones_totales||!o.value.monto)return"0.00";return(o.value.monto/o.value.sesiones_totales).toFixed(2)}),u=t.computed(()=>!!(o.value.tipo&&o.value.frecuencia&&o.value.sesiones_totales>0&&o.value.monto>0&&o.value.estado));return t.watch(()=>o.value.tipo,e=>{if(o.value.fecha_inicio&&e){const t=new Date(o.value.fecha_inicio);let a=new Date(t);switch(e){case"quincenal":a.setDate(a.getDate()+15);break;case"mensual":a.setMonth(a.getMonth()+1);break;case"semestral":a.setMonth(a.getMonth()+6)}o.value.fecha_fin=a?.toISOString().split("T")[0]||""}}),(a,r,l,p)=>{e.mostrar?(r(`<div${s.ssrRenderAttrs(t.mergeProps({class:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 p-4"},p))}><div class="bg-white/95 backdrop-blur-md rounded-3xl shadow-2xl border border-white/50 max-w-3xl w-full max-h-[90vh] overflow-hidden relative"><div class="absolute inset-0 bg-gradient-to-br from-[#5550F2]/5 via-transparent to-[#04BF9D]/5 pointer-events-none"></div><div class="absolute -top-20 -right-20 w-40 h-40 bg-gradient-to-br from-[#F2B33D]/20 to-[#5550F2]/20 rounded-full blur-2xl"></div><div class="relative max-h-[90vh] overflow-y-auto"><div class="sticky top-0 bg-white/90 backdrop-blur-md border-b border-gray-200/50 px-8 py-6 flex justify-between items-center z-10"><div class="flex items-center gap-4"><div class="w-14 h-14 rounded-2xl bg-gradient-to-br from-[#5550F2] to-[#027368] shadow-lg flex items-center justify-center"><span class="text-2xl">ğŸ«</span></div><div><h2 class="text-3xl font-[&#39;Elms_Sans&#39;] font-bold bg-gradient-to-r from-[#5550F2] to-[#027368] bg-clip-text text-transparent"> Nuevo Bono </h2><p class="text-sm font-[&#39;Lato&#39;] text-gray-600 mt-1"> Crea un nuevo bono para ${s.ssrInterpolate(e.pacienteNombre)}</p></div></div><button class="p-3 text-gray-500 hover:text-[#5550F2] hover:bg-gradient-to-br from-[#5550F2]/10 to-[#027368]/10 rounded-2xl transition-all duration-300 backdrop-blur-sm border border-white/50 hover:shadow-lg" aria-label="Cerrar modal"><svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button></div><form class="px-8 py-8 space-y-8"><div class="grid grid-cols-2 gap-6"><div><label class="block text-sm font-[&#39;Lato&#39;] font-semibold text-gray-700 mb-3"> Tipo de Bono <span class="text-[#F2B33D]">*</span></label><select required class="w-full px-4 py-3 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-[#5550F2]/20 focus:border-[#5550F2] bg-white/80 backdrop-blur-sm transition-all duration-300 font-[&#39;Lato&#39;] hover:bg-white shadow-sm hover:shadow-md"><option value=""${s.ssrIncludeBooleanAttr(Array.isArray(t.unref(o).tipo)?s.ssrLooseContain(t.unref(o).tipo,""):s.ssrLooseEqual(t.unref(o).tipo,""))?" selected":""}>Seleccionar tipo</option><option value="quincenal"${s.ssrIncludeBooleanAttr(Array.isArray(t.unref(o).tipo)?s.ssrLooseContain(t.unref(o).tipo,"quincenal"):s.ssrLooseEqual(t.unref(o).tipo,"quincenal"))?" selected":""}>Quincenal</option><option value="mensual"${s.ssrIncludeBooleanAttr(Array.isArray(t.unref(o).tipo)?s.ssrLooseContain(t.unref(o).tipo,"mensual"):s.ssrLooseEqual(t.unref(o).tipo,"mensual"))?" selected":""}>Mensual</option><option value="semestral"${s.ssrIncludeBooleanAttr(Array.isArray(t.unref(o).tipo)?s.ssrLooseContain(t.unref(o).tipo,"semestral"):s.ssrLooseEqual(t.unref(o).tipo,"semestral"))?" selected":""}>Semestral</option></select></div><div><label class="block text-sm font-medium text-[#5D4A44] mb-2"> Frecuencia Sugerida <span class="text-red-500">*</span></label><select required class="w-full px-4 py-2 border border-[#D8AFA0]/30 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#D8AFA0] bg-white"><option value=""${s.ssrIncludeBooleanAttr(Array.isArray(t.unref(o).frecuencia)?s.ssrLooseContain(t.unref(o).frecuencia,""):s.ssrLooseEqual(t.unref(o).frecuencia,""))?" selected":""}>Seleccionar frecuencia</option><option value="semanal"${s.ssrIncludeBooleanAttr(Array.isArray(t.unref(o).frecuencia)?s.ssrLooseContain(t.unref(o).frecuencia,"semanal"):s.ssrLooseEqual(t.unref(o).frecuencia,"semanal"))?" selected":""}>Semanal</option><option value="quincenal"${s.ssrIncludeBooleanAttr(Array.isArray(t.unref(o).frecuencia)?s.ssrLooseContain(t.unref(o).frecuencia,"quincenal"):s.ssrLooseEqual(t.unref(o).frecuencia,"quincenal"))?" selected":""}>Quincenal</option><option value="mensual"${s.ssrIncludeBooleanAttr(Array.isArray(t.unref(o).frecuencia)?s.ssrLooseContain(t.unref(o).frecuencia,"mensual"):s.ssrLooseEqual(t.unref(o).frecuencia,"mensual"))?" selected":""}>Mensual</option></select></div></div><div><label class="block text-sm font-medium text-[#5D4A44] mb-2"> Sesiones Totales <span class="text-red-500">*</span></label><input${s.ssrRenderAttr("value",t.unref(o).sesiones_totales)} type="number" min="1" max="100" required placeholder="Ej: 4, 8, 12..." class="w-full px-4 py-2 border border-[#D8AFA0]/30 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#D8AFA0]"><p class="text-xs text-[#5D4A44]/60 mt-1"> NÃºmero de sesiones incluidas en el bono </p></div><div><label class="block text-sm font-medium text-[#5D4A44] mb-2"> Monto Total <span class="text-red-500">*</span></label><div class="relative"><span class="absolute left-3 top-1/2 -translate-y-1/2 text-[#5D4A44]/60">â‚¬</span><input${s.ssrRenderAttr("value",t.unref(o).monto)} type="number" min="0" step="0.01" required placeholder="0.00" class="w-full pl-8 pr-4 py-2 border border-[#D8AFA0]/30 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#D8AFA0]"></div><p class="text-xs text-[#5D4A44]/60 mt-1"> Precio total del bono (todas las sesiones) </p></div><div class="grid grid-cols-2 gap-4"><div><label class="block text-sm font-medium text-[#5D4A44] mb-2"> Fecha de Inicio </label><input${s.ssrRenderAttr("value",t.unref(o).fecha_inicio)} type="date" class="w-full px-4 py-2 border border-[#D8AFA0]/30 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#D8AFA0]"></div><div><label class="block text-sm font-medium text-[#5D4A44] mb-2"> Fecha de Vencimiento </label><input${s.ssrRenderAttr("value",t.unref(o).fecha_fin)} type="date"${s.ssrRenderAttr("min",t.unref(o).fecha_inicio)} class="w-full px-4 py-2 border border-[#D8AFA0]/30 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#D8AFA0]"></div></div><div class="flex items-start gap-3 p-4 bg-purple-50 border border-purple-200 rounded-lg"><input${s.ssrIncludeBooleanAttr(Array.isArray(t.unref(o).renovacion_automatica)?s.ssrLooseContain(t.unref(o).renovacion_automatica,null):t.unref(o).renovacion_automatica)?" checked":""} type="checkbox" id="renovacion-auto" class="mt-1 w-4 h-4 text-purple-600 border-gray-300 rounded focus:ring-purple-500"><label for="renovacion-auto" class="flex-1 cursor-pointer"><div class="text-sm font-medium text-purple-900"> ğŸ”„ RenovaciÃ³n AutomÃ¡tica </div><div class="text-xs text-purple-700 mt-1"> El bono se renovarÃ¡ automÃ¡ticamente cuando se complete o venza </div></label></div><div><label class="block text-sm font-medium text-[#5D4A44] mb-2"> Estado Inicial </label><div class="grid grid-cols-2 gap-3"><label class="${s.ssrRenderClass(["pendiente"===t.unref(o).estado?"border-yellow-400 bg-yellow-50":"border-gray-300 hover:border-yellow-300","flex items-center gap-2 p-3 border-2 rounded-lg cursor-pointer transition-all"])}"><input${s.ssrIncludeBooleanAttr(s.ssrLooseEqual(t.unref(o).estado,"pendiente"))?" checked":""} type="radio" value="pendiente" class="w-4 h-4 text-yellow-600"><div><div class="text-sm font-medium text-[#5D4A44]">â³ Pendiente</div><div class="text-xs text-[#5D4A44]/60">Requiere pago</div></div></label><label class="${s.ssrRenderClass(["activo"===t.unref(o).estado?"border-green-400 bg-green-50":"border-gray-300 hover:border-green-300","flex items-center gap-2 p-3 border-2 rounded-lg cursor-pointer transition-all"])}"><input${s.ssrIncludeBooleanAttr(s.ssrLooseEqual(t.unref(o).estado,"activo"))?" checked":""} type="radio" value="activo" class="w-4 h-4 text-green-600"><div><div class="text-sm font-medium text-[#5D4A44]">âœ… Activo</div><div class="text-xs text-[#5D4A44]/60">Ya pagado</div></div></label></div></div><div><label class="block text-sm font-medium text-[#5D4A44] mb-2"> Notas (Opcional) </label><textarea rows="3" placeholder="InformaciÃ³n adicional sobre el bono..." class="w-full px-4 py-2 border border-[#D8AFA0]/30 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#D8AFA0] resize-none">${s.ssrInterpolate(t.unref(o).notas)}</textarea></div>`),t.unref(i)?r(`<div class="p-4 bg-gradient-to-r from-[#D8AFA0]/10 to-[#ECC8BA]/10 rounded-lg border border-[#D8AFA0]/30"><div class="font-medium text-[#5D4A44] mb-3 flex items-center gap-2"><span>ğŸ“‹</span> Resumen del Bono </div><div class="grid grid-cols-2 gap-3 text-sm"><div><span class="text-[#5D4A44]/60">Tipo:</span><span class="font-medium text-[#5D4A44] ml-1 capitalize">${s.ssrInterpolate(t.unref(o).tipo||"-")}</span></div><div><span class="text-[#5D4A44]/60">Frecuencia:</span><span class="font-medium text-[#5D4A44] ml-1 capitalize">${s.ssrInterpolate(t.unref(o).frecuencia||"-")}</span></div><div><span class="text-[#5D4A44]/60">Sesiones:</span><span class="font-medium text-[#5D4A44] ml-1">${s.ssrInterpolate(t.unref(o).sesiones_totales||0)}</span></div><div><span class="text-[#5D4A44]/60">Monto:</span><span class="font-medium text-[#5D4A44] ml-1">â‚¬${s.ssrInterpolate(t.unref(o).monto||0)}</span></div><div><span class="text-[#5D4A44]/60">Precio/sesiÃ³n:</span><span class="font-medium text-[#5D4A44] ml-1">â‚¬${s.ssrInterpolate(t.unref(c))}</span></div><div><span class="text-[#5D4A44]/60">Estado:</span><span class="${s.ssrRenderClass(["activo"===t.unref(o).estado?"text-green-600":"text-yellow-600","font-medium capitalize ml-1"])}">${s.ssrInterpolate(t.unref(o).estado||"-")}</span></div></div></div>`):r("\x3c!----\x3e"),t.unref(d)?r(`<div class="p-4 bg-red-50 border border-red-200 rounded-lg"><p class="text-sm text-red-700 flex items-center gap-2"><span>âŒ</span> ${s.ssrInterpolate(t.unref(d))}</p></div>`):r("\x3c!----\x3e"),r(`<div class="flex gap-3 pt-4 border-t border-[#D8AFA0]/30"><button type="button" class="flex-1 px-6 py-3 bg-white border border-[#D8AFA0]/30 text-[#5D4A44] rounded-lg hover:bg-[#D8AFA0]/10 transition-colors font-medium"${s.ssrIncludeBooleanAttr(t.unref(n))?" disabled":""}> Cancelar </button><button type="submit" class="flex-1 px-6 py-3 bg-[#D8AFA0] text-white rounded-lg hover:bg-[#C89B8A] transition-colors font-medium disabled:opacity-50 disabled:cursor-not-allowed"${s.ssrIncludeBooleanAttr(t.unref(n)||!t.unref(u))?" disabled":""}>${s.ssrInterpolate(t.unref(n)?"Creando...":"Crear Bono")}</button></div></form></div></div></div>`)):r("\x3c!----\x3e")}}}),b=v.setup;v.setup=(e,a)=>{const o=t.useSSRContext();return(o.modules||(o.modules=new Set)).add("components/ModalNuevoBono.vue"),b?b(e,a):void 0};const f=Object.assign(v,{__name:"ModalNuevoBono"}),m=t.defineComponent({__name:"ModalPagosBono",__ssrInlineRender:!0,props:{mostrar:{type:Boolean},bono:{}},emits:["close","updated"],setup(e,{emit:a}){const o=e,{getPagosPorBono:n,puedeGestionarBonos:d,puedeConfirmarPagos:l}=r(),i=t.ref([]),c=t.ref(!1),u=t.ref(!1),p=t.ref(!1),v=t.ref(null),b=t.ref(""),f=t.ref(""),m=t.ref({monto:0,metodo:"",confirmado:!1}),x=t.computed(()=>[...i.value].sort((e,t)=>new Date(t.fecha_pago).getTime()-new Date(e.fecha_pago).getTime())),g=t.computed(()=>i.value.filter(e=>e.confirmado).reduce((e,t)=>e+(t.monto||0),0)),A=t.computed(()=>{const e=o.bono?.monto||0;return Math.max(0,e-g.value)}),y=t.computed(()=>{const e=o.bono?.monto||0;return 0===e?0:Math.round(g.value/e*100)}),formatearFecha=e=>{if(!e)return"";try{return new Date(e).toLocaleDateString("es-ES",{day:"numeric",month:"short",year:"numeric"})}catch{return e}},formatearMonto=e=>e?new Intl.NumberFormat("es-ES",{style:"currency",currency:"EUR"}).format(e):"â‚¬ 0.00";return t.watch(()=>o.mostrar,e=>{e&&(async()=>{if(o.bono?.id)try{c.value=!0,b.value="",i.value=await n(o.bono.id)}catch(e){console.error("[ModalPagosBono] Error al cargar pagos:",e),b.value="Error al cargar los pagos"}finally{c.value=!1}})()},{immediate:!0}),(a,o,r,n)=>{e.mostrar?(o(`<div${s.ssrRenderAttrs(t.mergeProps({class:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 p-4"},n))} data-v-46056b94><div class="bg-white/95 backdrop-blur-md rounded-3xl shadow-2xl border border-white/50 max-w-4xl w-full max-h-[90vh] overflow-hidden relative" data-v-46056b94><div class="absolute inset-0 bg-gradient-to-br from-[#5550F2]/5 via-transparent to-[#04BF9D]/5 pointer-events-none" data-v-46056b94></div><div class="absolute -top-20 -right-20 w-40 h-40 bg-gradient-to-br from-[#F2B33D]/20 to-[#5550F2]/20 rounded-full blur-2xl" data-v-46056b94></div><div class="relative max-h-[90vh] overflow-y-auto" data-v-46056b94><div class="sticky top-0 bg-white/90 backdrop-blur-md border-b border-gray-200/50 px-8 py-6 z-10" data-v-46056b94><div class="flex justify-between items-start" data-v-46056b94><div class="flex-1" data-v-46056b94><div class="flex items-center gap-4 mb-3" data-v-46056b94><div class="w-14 h-14 rounded-2xl bg-gradient-to-br from-[#5550F2] to-[#027368] shadow-lg flex items-center justify-center" data-v-46056b94><span class="text-2xl" data-v-46056b94>ğŸ’°</span></div><h2 class="text-3xl font-[&#39;Elms_Sans&#39;] font-bold bg-gradient-to-r from-[#5550F2] to-[#027368] bg-clip-text text-transparent" data-v-46056b94> Pagos del Bono </h2></div><p class="text-sm font-[&#39;Lato&#39;] text-gray-600 ml-18" data-v-46056b94> Gestiona los pagos y confirma transacciones de forma segura </p></div><button class="p-3 text-gray-500 hover:text-[#5550F2] hover:bg-gradient-to-br from-[#5550F2]/10 to-[#027368]/10 rounded-2xl transition-all duration-300 backdrop-blur-sm border border-white/50 hover:shadow-lg" aria-label="Cerrar modal" data-v-46056b94><svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-46056b94><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" data-v-46056b94></path></svg></button></div>`),e.bono?o(`<div class="mt-6 p-6 bg-gradient-to-r from-[#5550F2]/5 via-[#027368]/5 to-[#04BF9D]/5 backdrop-blur-sm rounded-2xl border border-white/50 shadow-lg" data-v-46056b94><div class="grid grid-cols-3 gap-6 text-sm" data-v-46056b94><div class="text-center" data-v-46056b94><div class="text-xs font-[&#39;Lato&#39;] text-gray-500 uppercase tracking-wider mb-2" data-v-46056b94>Tipo</div><div class="font-[&#39;Lato&#39;] font-semibold text-gray-800 capitalize text-lg" data-v-46056b94>${s.ssrInterpolate(e.bono.tipo)}</div></div><div class="text-center" data-v-46056b94><div class="text-xs font-[&#39;Lato&#39;] text-gray-500 uppercase tracking-wider mb-2" data-v-46056b94>Monto Total</div><div class="font-[&#39;Elms_Sans&#39;] font-bold bg-gradient-to-r from-[#F2B33D] to-[#5550F2] bg-clip-text text-transparent text-2xl" data-v-46056b94>${s.ssrInterpolate(formatearMonto(e.bono.monto))}</div></div><div class="text-center" data-v-46056b94><div class="text-xs font-[&#39;Lato&#39;] text-gray-500 uppercase tracking-wider mb-2" data-v-46056b94>Estado</div><div class="${s.ssrRenderClass([e.bono.pagado?"text-[#04BF9D]":"text-[#F2B33D]","font-['Lato'] font-semibold text-lg capitalize"])}" data-v-46056b94>${s.ssrInterpolate(e.bono.pagado?"âœ“ Pagado":"â³ Pendiente")}</div></div></div></div>`):o("\x3c!----\x3e"),o(`</div><div class="px-6 py-6 space-y-6" data-v-46056b94><div class="p-4 bg-white border-2 border-[#D8AFA0]/30 rounded-xl" data-v-46056b94><div class="grid grid-cols-3 gap-4 text-center" data-v-46056b94><div data-v-46056b94><div class="text-2xl font-bold text-green-600" data-v-46056b94>${s.ssrInterpolate(formatearMonto(t.unref(g)))}</div><div class="text-xs text-[#5D4A44]/60 mt-1" data-v-46056b94>Total Pagado</div></div><div data-v-46056b94><div class="text-2xl font-bold text-orange-600" data-v-46056b94>${s.ssrInterpolate(formatearMonto(t.unref(A)))}</div><div class="text-xs text-[#5D4A44]/60 mt-1" data-v-46056b94>Pendiente</div></div><div data-v-46056b94><div class="text-2xl font-bold text-[#5D4A44]" data-v-46056b94>${s.ssrInterpolate(t.unref(i).length)}</div><div class="text-xs text-[#5D4A44]/60 mt-1" data-v-46056b94>Transacciones</div></div></div><div class="mt-4" data-v-46056b94><div class="flex justify-between text-xs text-[#5D4A44]/60 mb-1" data-v-46056b94><span data-v-46056b94>Progreso de pago</span><span data-v-46056b94>${s.ssrInterpolate(t.unref(y))}%</span></div><div class="w-full bg-gray-200 rounded-full h-2" data-v-46056b94><div class="${s.ssrRenderClass([t.unref(y)>=100?"bg-green-500":"bg-gradient-to-r from-[#D8AFA0] to-[#ECC8BA]","h-2 rounded-full transition-all duration-500"])}" style="${s.ssrRenderStyle({width:Math.min(t.unref(y),100)+"%"})}" data-v-46056b94></div></div></div></div>`),t.unref(d)?o(`<div class="flex justify-end" data-v-46056b94><button class="px-4 py-2 bg-[#D8AFA0] text-white rounded-lg hover:bg-[#C89B8A] transition-colors font-medium flex items-center gap-2" data-v-46056b94><span data-v-46056b94>${s.ssrInterpolate(t.unref(u)?"âœ•":"+")}</span><span data-v-46056b94>${s.ssrInterpolate(t.unref(u)?"Cancelar":"Registrar Pago")}</span></button></div>`):o("\x3c!----\x3e"),t.unref(u)?(o(`<div class="p-5 bg-green-50 border-2 border-green-300 rounded-xl" data-v-46056b94><h3 class="font-[&#39;Lora&#39;] text-lg font-semibold text-[#5D4A44] mb-4 flex items-center gap-2" data-v-46056b94><span data-v-46056b94>ğŸ’³</span> Registrar Nuevo Pago </h3><form class="space-y-4" data-v-46056b94><div class="grid grid-cols-2 gap-4" data-v-46056b94><div data-v-46056b94><label class="block text-sm font-medium text-[#5D4A44] mb-2" data-v-46056b94> Monto <span class="text-red-500" data-v-46056b94>*</span></label><div class="relative" data-v-46056b94><span class="absolute left-3 top-1/2 -translate-y-1/2 text-[#5D4A44]/60" data-v-46056b94>â‚¬</span><input${s.ssrRenderAttr("value",t.unref(m).monto)} type="number" min="0" step="0.01" required placeholder="0.00" class="w-full pl-8 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#D8AFA0] bg-white" data-v-46056b94></div></div><div data-v-46056b94><label class="block text-sm font-medium text-[#5D4A44] mb-2" data-v-46056b94> MÃ©todo de Pago <span class="text-red-500" data-v-46056b94>*</span></label><select required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#D8AFA0] bg-white" data-v-46056b94><option value="" data-v-46056b94${s.ssrIncludeBooleanAttr(Array.isArray(t.unref(m).metodo)?s.ssrLooseContain(t.unref(m).metodo,""):s.ssrLooseEqual(t.unref(m).metodo,""))?" selected":""}>Seleccionar mÃ©todo</option><option value="efectivo" data-v-46056b94${s.ssrIncludeBooleanAttr(Array.isArray(t.unref(m).metodo)?s.ssrLooseContain(t.unref(m).metodo,"efectivo"):s.ssrLooseEqual(t.unref(m).metodo,"efectivo"))?" selected":""}>ğŸ’µ Efectivo</option><option value="transferencia" data-v-46056b94${s.ssrIncludeBooleanAttr(Array.isArray(t.unref(m).metodo)?s.ssrLooseContain(t.unref(m).metodo,"transferencia"):s.ssrLooseEqual(t.unref(m).metodo,"transferencia"))?" selected":""}>ğŸ¦ Transferencia</option><option value="tarjeta" data-v-46056b94${s.ssrIncludeBooleanAttr(Array.isArray(t.unref(m).metodo)?s.ssrLooseContain(t.unref(m).metodo,"tarjeta"):s.ssrLooseEqual(t.unref(m).metodo,"tarjeta"))?" selected":""}>ğŸ’³ Tarjeta</option><option value="bizum" data-v-46056b94${s.ssrIncludeBooleanAttr(Array.isArray(t.unref(m).metodo)?s.ssrLooseContain(t.unref(m).metodo,"bizum"):s.ssrLooseEqual(t.unref(m).metodo,"bizum"))?" selected":""}>ğŸ“± Bizum</option><option value="paypal" data-v-46056b94${s.ssrIncludeBooleanAttr(Array.isArray(t.unref(m).metodo)?s.ssrLooseContain(t.unref(m).metodo,"paypal"):s.ssrLooseEqual(t.unref(m).metodo,"paypal"))?" selected":""}>ğŸ…¿ï¸ PayPal</option></select></div></div>`),t.unref(l)?o(`<div class="flex items-center gap-2 p-3 bg-white border border-green-300 rounded-lg" data-v-46056b94><input${s.ssrIncludeBooleanAttr(Array.isArray(t.unref(m).confirmado)?s.ssrLooseContain(t.unref(m).confirmado,null):t.unref(m).confirmado)?" checked":""} type="checkbox" id="confirmar-pago" class="w-4 h-4 text-green-600 border-gray-300 rounded focus:ring-green-500" data-v-46056b94><label for="confirmar-pago" class="text-sm text-[#5D4A44] cursor-pointer" data-v-46056b94> âœ“ Confirmar pago inmediatamente (ya verificado) </label></div>`):o("\x3c!----\x3e"),o(`<div class="flex gap-3" data-v-46056b94><button type="button" class="flex-1 px-4 py-2 bg-white border border-gray-300 text-[#5D4A44] rounded-lg hover:bg-gray-50 transition-colors" data-v-46056b94> Cancelar </button><button type="submit" class="flex-1 px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors font-medium disabled:opacity-50"${s.ssrIncludeBooleanAttr(t.unref(p))?" disabled":""} data-v-46056b94>${s.ssrInterpolate(t.unref(p)?"Registrando...":"Guardar Pago")}</button></div></form></div>`)):o("\x3c!----\x3e"),o(`<div data-v-46056b94><h3 class="font-[&#39;Lora&#39;] text-lg font-semibold text-[#5D4A44] mb-4 flex items-center gap-2" data-v-46056b94><span data-v-46056b94>ğŸ“œ</span> Historial de Pagos (${s.ssrInterpolate(t.unref(i).length)}) </h3>`),t.unref(c)?o('<div class="text-center py-8" data-v-46056b94><div class="animate-spin w-10 h-10 border-4 border-[#D8AFA0] border-t-transparent rounded-full mx-auto mb-3" data-v-46056b94></div><p class="text-[#5D4A44]/60" data-v-46056b94>Cargando pagos...</p></div>'):0===t.unref(i).length?o('<div class="text-center py-12" data-v-46056b94><span class="text-6xl mb-3 block opacity-40" data-v-46056b94>ğŸ’¸</span><p class="text-[#5D4A44]/60" data-v-46056b94>No hay pagos registrados aÃºn</p></div>'):(o('<div class="space-y-3" data-v-46056b94>\x3c!--[--\x3e'),s.ssrRenderList(t.unref(x),e=>{var a;o(`<div class="${s.ssrRenderClass([e.confirmado?"bg-green-50 border-green-300":"bg-yellow-50 border-yellow-300","p-4 border-2 rounded-lg transition-all"])}" data-v-46056b94><div class="flex items-start justify-between gap-4" data-v-46056b94><div class="flex-1" data-v-46056b94><div class="flex items-center gap-3 mb-2" data-v-46056b94><span class="${s.ssrRenderClass([e.confirmado?"text-green-600":"text-yellow-600","text-2xl font-bold"])}" data-v-46056b94>${s.ssrInterpolate(formatearMonto(e.monto))}</span><span class="${s.ssrRenderClass([e.confirmado?"bg-green-200 text-green-800":"bg-yellow-200 text-yellow-800","px-2 py-1 rounded-full text-xs font-medium capitalize"])}" data-v-46056b94>${s.ssrInterpolate(e.confirmado?"âœ“ Confirmado":"â³ Pendiente")}</span></div><div class="space-y-1 text-sm text-[#5D4A44]/70" data-v-46056b94><div class="flex items-center gap-2" data-v-46056b94><span data-v-46056b94>ğŸ’³</span><span class="capitalize" data-v-46056b94>${s.ssrInterpolate((a=e.metodo_pago,{efectivo:"Efectivo",transferencia:"Transferencia Bancaria",tarjeta:"Tarjeta de CrÃ©dito/DÃ©bito",bizum:"Bizum",paypal:"PayPal"}[a]||a))}</span></div><div class="flex items-center gap-2" data-v-46056b94><span data-v-46056b94>ğŸ“…</span><span data-v-46056b94>${s.ssrInterpolate(formatearFecha(e.fecha_pago))}</span></div>`),e.confirmado&&e.fecha_confirmacion?o(`<div class="flex items-center gap-2" data-v-46056b94><span data-v-46056b94>âœ…</span><span data-v-46056b94>Confirmado el ${s.ssrInterpolate(formatearFecha(e.fecha_confirmacion))}</span></div>`):o("\x3c!----\x3e"),o("</div></div>"),t.unref(l)&&!e.confirmado?o(`<div data-v-46056b94><button class="px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors text-sm font-medium"${s.ssrIncludeBooleanAttr(t.unref(v)===e.id)?" disabled":""} data-v-46056b94>${s.ssrInterpolate(t.unref(v)===e.id?"Confirmando...":"âœ“ Confirmar")}</button></div>`):o("\x3c!----\x3e"),o("</div></div>")}),o("\x3c!--]--\x3e</div>")),o("</div>"),t.unref(b)?o(`<div class="p-4 bg-red-50 border border-red-200 rounded-lg" data-v-46056b94><p class="text-sm text-red-700 flex items-center gap-2" data-v-46056b94><span data-v-46056b94>âŒ</span> ${s.ssrInterpolate(t.unref(b))}</p></div>`):o("\x3c!----\x3e"),t.unref(f)?o(`<div class="p-4 bg-green-50 border border-green-200 rounded-lg" data-v-46056b94><p class="text-sm text-green-700 flex items-center gap-2" data-v-46056b94><span data-v-46056b94>âœ…</span> ${s.ssrInterpolate(t.unref(f))}</p></div>`):o("\x3c!----\x3e"),o('</div><div class="sticky bottom-0 bg-[#F9F7F3] border-t border-[#D8AFA0]/30 px-6 py-4" data-v-46056b94><button class="w-full px-6 py-3 bg-[#5D4A44] text-white rounded-lg hover:bg-[#4A3A34] transition-colors font-medium" data-v-46056b94> Cerrar </button></div></div></div></div>')):o("\x3c!----\x3e")}}}),x=m.setup;m.setup=(e,a)=>{const o=t.useSSRContext();return(o.modules||(o.modules=new Set)).add("components/ModalPagosBono.vue"),x?x(e,a):void 0};const g=Object.assign(d(m,[["__scopeId","data-v-46056b94"]]),{__name:"ModalPagosBono"}),A=t.defineComponent({__name:"ModalRenovacionBono",__ssrInlineRender:!0,props:{mostrar:{type:Boolean},bono:{}},emits:["close","renovated"],setup(e,{emit:a}){const o=e;r();const n=t.ref(!0),d=t.ref(!1),l=t.ref(""),i=t.ref({sesiones_nuevas:o.bono?.sesiones_totales||0,monto_nuevo:o.bono?.monto||0,motivo:""}),c=t.computed(()=>({pendiente:"text-yellow-600",activo:"text-green-600",completado:"text-gray-600",vencido:"text-red-600",cancelado:"text-gray-500"}[o.bono?.estado]||"text-gray-600")),u=t.computed(()=>{if(!o.bono?.sesiones_totales||!o.bono?.monto)return"0.00";return(o.bono.monto/o.bono.sesiones_totales).toFixed(2)}),p=t.computed(()=>{if(!i.value.sesiones_nuevas||!i.value.monto_nuevo)return"0.00";return(i.value.monto_nuevo/i.value.sesiones_nuevas).toFixed(2)}),formatearMonto=e=>e?new Intl.NumberFormat("es-ES",{style:"currency",currency:"EUR"}).format(e):"â‚¬ 0.00";return t.watch(()=>o.bono,e=>{e&&(i.value.sesiones_nuevas=e.sesiones_totales||0,i.value.monto_nuevo=e.monto||0)},{immediate:!0}),(a,o,r,v)=>{e.mostrar?(o(`<div${s.ssrRenderAttrs(t.mergeProps({class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"},v))}><div class="bg-[#F9F7F3] rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto"><div class="sticky top-0 bg-[#F9F7F3] border-b border-[#D8AFA0]/30 px-6 py-4 flex justify-between items-center"><div><h2 class="text-2xl font-[&#39;Lora&#39;] text-[#5D4A44] font-semibold flex items-center gap-2"><span class="text-2xl">ğŸ”„</span> Renovar Bono </h2><p class="text-sm text-[#5D4A44]/60 mt-1"> Crea una nueva renovaciÃ³n basada en el bono actual </p></div><button class="text-[#5D4A44] hover:text-[#D8AFA0] transition-colors" aria-label="Cerrar modal"><svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button></div><div class="px-6 py-6 space-y-6"><div class="p-5 bg-gradient-to-r from-gray-100 to-gray-50 border-2 border-gray-300 rounded-xl"><h3 class="font-[&#39;Lora&#39;] text-lg font-semibold text-[#5D4A44] mb-4 flex items-center gap-2"><span>ğŸ“‹</span> Bono Actual </h3><div class="grid grid-cols-2 gap-4 text-sm"><div class="p-3 bg-white rounded-lg"><div class="text-[#5D4A44]/60 mb-1">Tipo</div><div class="font-medium text-[#5D4A44] capitalize">${s.ssrInterpolate(e.bono.tipo)}</div></div><div class="p-3 bg-white rounded-lg"><div class="text-[#5D4A44]/60 mb-1">Frecuencia</div><div class="font-medium text-[#5D4A44] capitalize">${s.ssrInterpolate(e.bono.frecuencia)}</div></div><div class="p-3 bg-white rounded-lg"><div class="text-[#5D4A44]/60 mb-1">Sesiones Totales</div><div class="font-medium text-[#5D4A44]">${s.ssrInterpolate(e.bono.sesiones_totales)}</div></div><div class="p-3 bg-white rounded-lg"><div class="text-[#5D4A44]/60 mb-1">Sesiones Restantes</div><div class="font-medium text-[#5D4A44]">${s.ssrInterpolate(e.bono.sesiones_restantes||0)}</div></div><div class="p-3 bg-white rounded-lg"><div class="text-[#5D4A44]/60 mb-1">Monto</div><div class="font-bold text-[#D8AFA0] text-lg">${s.ssrInterpolate(formatearMonto(e.bono.monto))}</div></div><div class="p-3 bg-white rounded-lg"><div class="text-[#5D4A44]/60 mb-1">Estado</div><div class="${s.ssrRenderClass([t.unref(c),"font-medium capitalize"])}">${s.ssrInterpolate(e.bono.estado)}</div></div></div></div><form class="space-y-5"><div class="p-5 bg-gradient-to-r from-purple-50 to-indigo-50 border-2 border-purple-300 rounded-xl"><h3 class="font-[&#39;Lora&#39;] text-lg font-semibold text-[#5D4A44] mb-4 flex items-center gap-2"><span>âœ¨</span> Datos del Nuevo Bono </h3><div class="mb-5 p-3 bg-white border border-purple-200 rounded-lg"><label class="flex items-center gap-3 cursor-pointer"><input${s.ssrIncludeBooleanAttr(Array.isArray(t.unref(n))?s.ssrLooseContain(t.unref(n),null):t.unref(n))?" checked":""} type="checkbox" class="w-5 h-5 text-purple-600 border-gray-300 rounded focus:ring-purple-500"><div><div class="text-sm font-medium text-[#5D4A44]"> Mantener los mismos valores del bono original </div><div class="text-xs text-[#5D4A44]/60 mt-1"> Si lo desmarcas, podrÃ¡s personalizar las sesiones y el monto </div></div></label></div>`),t.unref(n)?o(`<div class="p-4 bg-green-50 border border-green-300 rounded-lg"><p class="text-sm text-green-700 flex items-center gap-2"><span>âœ“</span> Se duplicarÃ¡n los valores originales: <strong>${s.ssrInterpolate(e.bono.sesiones_totales)} sesiones</strong> por <strong>${s.ssrInterpolate(formatearMonto(e.bono.monto))}</strong></p></div>`):o(`<div class="space-y-4"><div class="grid grid-cols-2 gap-4"><div><label class="block text-sm font-medium text-[#5D4A44] mb-2"> Sesiones Totales </label><input${s.ssrRenderAttr("value",t.unref(i).sesiones_nuevas)} type="number" min="1" max="100" required class="w-full px-4 py-2 border border-purple-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 bg-white"></div><div><label class="block text-sm font-medium text-[#5D4A44] mb-2"> Monto Total </label><div class="relative"><span class="absolute left-3 top-1/2 -translate-y-1/2 text-[#5D4A44]/60">â‚¬</span><input${s.ssrRenderAttr("value",t.unref(i).monto_nuevo)} type="number" min="0" step="0.01" required placeholder="0.00" class="w-full pl-8 pr-4 py-2 border border-purple-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 bg-white"></div></div></div><div class="p-3 bg-purple-100 rounded-lg text-sm"><div class="flex justify-between mb-1"><span class="text-[#5D4A44]/70">Precio por sesiÃ³n (nuevo):</span><span class="font-bold text-purple-700">â‚¬${s.ssrInterpolate(t.unref(p))}</span></div><div class="flex justify-between"><span class="text-[#5D4A44]/70">Precio por sesiÃ³n (original):</span><span class="font-medium text-[#5D4A44]/60">â‚¬${s.ssrInterpolate(t.unref(u))}</span></div></div></div>`),o(`</div><div><label class="block text-sm font-medium text-[#5D4A44] mb-2"> Motivo de la RenovaciÃ³n (Opcional) </label><textarea rows="3" placeholder="Explica por quÃ© se renueva este bono..." class="w-full px-4 py-2 border border-[#D8AFA0]/30 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#D8AFA0] resize-none">${s.ssrInterpolate(t.unref(i).motivo)}</textarea></div><div class="p-4 bg-blue-50 border-2 border-blue-300 rounded-lg"><h4 class="font-medium text-blue-900 mb-2 flex items-center gap-2"><span>â„¹ï¸</span> InformaciÃ³n Importante </h4><ul class="text-sm text-blue-800 space-y-1.5"><li class="flex items-start gap-2"><span class="mt-0.5">â€¢</span><span>El bono actual se marcarÃ¡ como <strong>completado</strong></span></li><li class="flex items-start gap-2"><span class="mt-0.5">â€¢</span><span>Se crearÃ¡ un <strong>nuevo bono</strong> con estado <strong>pendiente</strong> hasta que se confirme el pago</span></li><li class="flex items-start gap-2"><span class="mt-0.5">â€¢</span><span>La fecha de inicio serÃ¡ <strong>hoy</strong> y la de vencimiento se calcularÃ¡ automÃ¡ticamente</span></li><li class="flex items-start gap-2"><span class="mt-0.5">â€¢</span><span>Se guardarÃ¡ un registro en el historial de renovaciones</span></li></ul></div>`),t.unref(l)?o(`<div class="p-4 bg-red-50 border border-red-200 rounded-lg"><p class="text-sm text-red-700 flex items-center gap-2"><span>âŒ</span> ${s.ssrInterpolate(t.unref(l))}</p></div>`):o("\x3c!----\x3e"),o(`<div class="flex gap-3 pt-4 border-t border-[#D8AFA0]/30"><button type="button" class="flex-1 px-6 py-3 bg-white border border-[#D8AFA0]/30 text-[#5D4A44] rounded-lg hover:bg-[#D8AFA0]/10 transition-colors font-medium"${s.ssrIncludeBooleanAttr(t.unref(d))?" disabled":""}> Cancelar </button><button type="submit" class="flex-1 px-6 py-3 bg-purple-500 text-white rounded-lg hover:bg-purple-600 transition-colors font-medium disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2"${s.ssrIncludeBooleanAttr(t.unref(d))?" disabled":""}>`),t.unref(d)?o("<span>â³</span>"):o("<span>ğŸ”„</span>"),o(`<span>${s.ssrInterpolate(t.unref(d)?"Renovando...":"Confirmar RenovaciÃ³n")}</span></button></div></form></div></div></div>`)):o("\x3c!----\x3e")}}}),y=A.setup;A.setup=(e,a)=>{const o=t.useSSRContext();return(o.modules||(o.modules=new Set)).add("components/ModalRenovacionBono.vue"),y?y(e,a):void 0};const h=Object.assign(A,{__name:"ModalRenovacionBono"}),w=t.defineComponent({__name:"bonos",__ssrInlineRender:!0,setup(n){const d=a();o();const c=i(),{userProfile:u}=l(),{getBonosPorPaciente:v,calcularMetricas:b,puedeGestionarBonos:m}=r(),x=t.computed(()=>d.params.id),A=t.computed(()=>u.value?.id||""),y=t.ref(!0),w=t.ref(null),D=t.ref([]),$=t.ref(""),C=t.ref({total:0,activos:0,completados:0,vencidos:0,pendientes:0,proximosAVencer:0,pocasSesiones:0}),F=t.ref("todos"),I=t.ref("todos"),B=t.ref("reciente"),_=t.ref(!1),L=t.ref(!1),k=t.ref(!1),R=t.ref(null),V=t.computed(()=>{let e=[...D.value];return"todos"!==F.value&&(e=e.filter(e=>e.estado===F.value)),"todos"!==I.value&&(e=e.filter(e=>e.tipo===I.value)),"reciente"===B.value?e.sort((e,t)=>new Date(t.created_at).getTime()-new Date(e.created_at).getTime()):"antiguo"===B.value?e.sort((e,t)=>new Date(e.created_at).getTime()-new Date(t.created_at).getTime()):"vencimiento"===B.value&&e.sort((e,t)=>e.fecha_fin?t.fecha_fin?new Date(e.fecha_fin).getTime()-new Date(t.fecha_fin).getTime():-1:1),e}),E=t.computed(()=>C.value.proximosAVencer>0||C.value.pocasSesiones>0),cargarBonos=async()=>{try{y.value=!0,w.value=null;const{data:e,error:t}=await c.from("pacientes").select("nombre, email").eq("id",x.value).single();if(t)throw t;$.value=e?.nombre||e?.email||"Paciente",D.value=await v(x.value),C.value=await b(x.value)}catch(e){console.error("[BonosPage] Error al cargar bonos:",e),w.value=e.message||"Error al cargar los bonos"}finally{y.value=!1}},limpiarFiltros=()=>{F.value="todos",I.value="todos",B.value="reciente"},abrirModalNuevoBono=()=>{_.value=!0},cerrarModalNuevoBono=()=>{_.value=!1},onBonoCreado=async()=>{await cargarBonos()},abrirModalPagos=e=>{R.value=e,L.value=!0},cerrarModalPagos=()=>{L.value=!1,R.value=null},onPagosActualizados=async()=>{await cargarBonos()},abrirModalRenovacion=e=>{R.value=e,k.value=!0},cerrarModalRenovacion=()=>{k.value=!1,R.value=null},onBonoRenovado=async()=>{await cargarBonos()},editarBono=e=>{console.log("Editar bono:",e),alert("FunciÃ³n de ediciÃ³n en desarrollo")};return(a,o,r,n)=>{const d=e,l=p,i=f,c=g,u=h;o(`<div${s.ssrRenderAttrs(t.mergeProps({class:"bonos-container pb-20"},n))} data-v-64cfe15d><button class="mb-6 flex items-center gap-2 text-[#5D4A44] hover:text-[#D8AFA0] transition-colors" data-v-64cfe15d><span data-v-64cfe15d>â†</span><span data-v-64cfe15d>Volver a ficha del paciente</span></button><header class="mb-6" data-v-64cfe15d><div class="flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4" data-v-64cfe15d><div data-v-64cfe15d><h1 class="text-3xl font-[&#39;Lora&#39;] font-bold text-[#5D4A44] mb-2 flex items-center gap-3" data-v-64cfe15d><span class="text-4xl" data-v-64cfe15d>ğŸ«</span> Bonos de ${s.ssrInterpolate(t.unref($))}</h1><p class="text-[#5D4A44]/60" data-v-64cfe15d> Gestiona los bonos, pagos y renovaciones del paciente </p></div>`),t.unref(m)?o('<button class="px-6 py-3 bg-[#D8AFA0] text-white rounded-lg hover:bg-[#C89B8A] transition-colors font-medium flex items-center gap-2 shadow-lg" data-v-64cfe15d><span class="text-xl" data-v-64cfe15d>+</span><span data-v-64cfe15d>Nuevo Bono</span></button>'):o("\x3c!----\x3e"),o("</div></header>"),t.unref(y)?o('<div class="text-center py-16" data-v-64cfe15d><div class="animate-spin w-16 h-16 border-4 border-[#D8AFA0] border-t-transparent rounded-full mx-auto mb-4" data-v-64cfe15d></div><p class="text-[#5D4A44]/60" data-v-64cfe15d>Cargando bonos...</p></div>'):t.unref(w)?(o('<div class="text-center py-16" data-v-64cfe15d>'),o(s.ssrRenderComponent(d,null,{default:t.withCtx((e,a,o,r)=>{if(!a)return[t.createVNode("span",{class:"text-7xl mb-4 block"},"âŒ"),t.createVNode("h3",{class:"text-xl font-['Lora'] font-semibold text-[#5D4A44] mb-2"}," Error al cargar bonos "),t.createVNode("p",{class:"text-[#5D4A44]/60 mb-4"},t.toDisplayString(t.unref(w)),1),t.createVNode("button",{onClick:cargarBonos,class:"px-6 py-3 bg-[#D8AFA0] text-white rounded-lg hover:bg-[#C89B8A] transition-colors"}," Intentar de nuevo ")];a(`<span class="text-7xl mb-4 block" data-v-64cfe15d${r}>âŒ</span><h3 class="text-xl font-[&#39;Lora&#39;] font-semibold text-[#5D4A44] mb-2" data-v-64cfe15d${r}> Error al cargar bonos </h3><p class="text-[#5D4A44]/60 mb-4" data-v-64cfe15d${r}>${s.ssrInterpolate(t.unref(w))}</p><button class="px-6 py-3 bg-[#D8AFA0] text-white rounded-lg hover:bg-[#C89B8A] transition-colors" data-v-64cfe15d${r}> Intentar de nuevo </button>`)}),_:1},r)),o("</div>")):(o('<div data-v-64cfe15d><section class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-8" data-v-64cfe15d>'),o(s.ssrRenderComponent(d,{class:"bg-gradient-to-br from-purple-50 to-indigo-50 border-2 border-purple-200"},{default:t.withCtx((e,a,o,r)=>{if(!a)return[t.createVNode("div",{class:"flex items-center justify-between"},[t.createVNode("div",null,[t.createVNode("p",{class:"text-sm text-purple-600 font-medium mb-1"},"Total Bonos"),t.createVNode("p",{class:"text-3xl font-bold text-purple-700"},t.toDisplayString(t.unref(C).total),1)]),t.createVNode("span",{class:"text-4xl"},"ğŸ«")])];a(`<div class="flex items-center justify-between" data-v-64cfe15d${r}><div data-v-64cfe15d${r}><p class="text-sm text-purple-600 font-medium mb-1" data-v-64cfe15d${r}>Total Bonos</p><p class="text-3xl font-bold text-purple-700" data-v-64cfe15d${r}>${s.ssrInterpolate(t.unref(C).total)}</p></div><span class="text-4xl" data-v-64cfe15d${r}>ğŸ«</span></div>`)}),_:1},r)),o(s.ssrRenderComponent(d,{class:"bg-gradient-to-br from-green-50 to-emerald-50 border-2 border-green-200"},{default:t.withCtx((e,a,o,r)=>{if(!a)return[t.createVNode("div",{class:"flex items-center justify-between"},[t.createVNode("div",null,[t.createVNode("p",{class:"text-sm text-green-600 font-medium mb-1"},"Activos"),t.createVNode("p",{class:"text-3xl font-bold text-green-700"},t.toDisplayString(t.unref(C).activos),1)]),t.createVNode("span",{class:"text-4xl"},"âœ…")])];a(`<div class="flex items-center justify-between" data-v-64cfe15d${r}><div data-v-64cfe15d${r}><p class="text-sm text-green-600 font-medium mb-1" data-v-64cfe15d${r}>Activos</p><p class="text-3xl font-bold text-green-700" data-v-64cfe15d${r}>${s.ssrInterpolate(t.unref(C).activos)}</p></div><span class="text-4xl" data-v-64cfe15d${r}>âœ…</span></div>`)}),_:1},r)),o(s.ssrRenderComponent(d,{class:"bg-gradient-to-br from-orange-50 to-amber-50 border-2 border-orange-200"},{default:t.withCtx((e,a,o,r)=>{if(!a)return[t.createVNode("div",{class:"flex items-center justify-between"},[t.createVNode("div",null,[t.createVNode("p",{class:"text-sm text-orange-600 font-medium mb-1"},"Por Vencer"),t.createVNode("p",{class:"text-3xl font-bold text-orange-700"},t.toDisplayString(t.unref(C).proximosAVencer),1)]),t.createVNode("span",{class:"text-4xl"},"âš ï¸")])];a(`<div class="flex items-center justify-between" data-v-64cfe15d${r}><div data-v-64cfe15d${r}><p class="text-sm text-orange-600 font-medium mb-1" data-v-64cfe15d${r}>Por Vencer</p><p class="text-3xl font-bold text-orange-700" data-v-64cfe15d${r}>${s.ssrInterpolate(t.unref(C).proximosAVencer)}</p></div><span class="text-4xl" data-v-64cfe15d${r}>âš ï¸</span></div>`)}),_:1},r)),o(s.ssrRenderComponent(d,{class:"bg-gradient-to-br from-yellow-50 to-amber-50 border-2 border-yellow-200"},{default:t.withCtx((e,a,o,r)=>{if(!a)return[t.createVNode("div",{class:"flex items-center justify-between"},[t.createVNode("div",null,[t.createVNode("p",{class:"text-sm text-yellow-600 font-medium mb-1"},"Pendientes"),t.createVNode("p",{class:"text-3xl font-bold text-yellow-700"},t.toDisplayString(t.unref(C).pendientes),1)]),t.createVNode("span",{class:"text-4xl"},"â³")])];a(`<div class="flex items-center justify-between" data-v-64cfe15d${r}><div data-v-64cfe15d${r}><p class="text-sm text-yellow-600 font-medium mb-1" data-v-64cfe15d${r}>Pendientes</p><p class="text-3xl font-bold text-yellow-700" data-v-64cfe15d${r}>${s.ssrInterpolate(t.unref(C).pendientes)}</p></div><span class="text-4xl" data-v-64cfe15d${r}>â³</span></div>`)}),_:1},r)),o('</section><section class="mb-6" data-v-64cfe15d>'),o(s.ssrRenderComponent(d,null,{default:t.withCtx((e,a,o,r)=>{if(!a)return[t.createVNode("div",{class:"flex flex-col md:flex-row gap-4"},[t.createVNode("div",{class:"flex-1"},[t.createVNode("label",{class:"block text-sm font-medium text-[#5D4A44] mb-2"}," Filtrar por Estado "),t.withDirectives(t.createVNode("select",{"onUpdate:modelValue":e=>t.isRef(F)?F.value=e:null,class:"w-full px-4 py-2 border border-[#D8AFA0]/30 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#D8AFA0] bg-white"},[t.createVNode("option",{value:"todos"},"Todos los estados"),t.createVNode("option",{value:"activo"},"âœ… Activos"),t.createVNode("option",{value:"pendiente"},"â³ Pendientes"),t.createVNode("option",{value:"completado"},"âœ”ï¸ Completados"),t.createVNode("option",{value:"vencido"},"âŒ Vencidos"),t.createVNode("option",{value:"cancelado"},"ğŸš« Cancelados")],8,["onUpdate:modelValue"]),[[t.vModelSelect,t.unref(F)]])]),t.createVNode("div",{class:"flex-1"},[t.createVNode("label",{class:"block text-sm font-medium text-[#5D4A44] mb-2"}," Filtrar por Tipo "),t.withDirectives(t.createVNode("select",{"onUpdate:modelValue":e=>t.isRef(I)?I.value=e:null,class:"w-full px-4 py-2 border border-[#D8AFA0]/30 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#D8AFA0] bg-white"},[t.createVNode("option",{value:"todos"},"Todos los tipos"),t.createVNode("option",{value:"quincenal"},"Quincenal"),t.createVNode("option",{value:"mensual"},"Mensual"),t.createVNode("option",{value:"semestral"},"Semestral")],8,["onUpdate:modelValue"]),[[t.vModelSelect,t.unref(I)]])]),t.createVNode("div",{class:"flex-1"},[t.createVNode("label",{class:"block text-sm font-medium text-[#5D4A44] mb-2"}," Ordenar por "),t.withDirectives(t.createVNode("select",{"onUpdate:modelValue":e=>t.isRef(B)?B.value=e:null,class:"w-full px-4 py-2 border border-[#D8AFA0]/30 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#D8AFA0] bg-white"},[t.createVNode("option",{value:"reciente"},"MÃ¡s recientes"),t.createVNode("option",{value:"antiguo"},"MÃ¡s antiguos"),t.createVNode("option",{value:"vencimiento"},"Por vencimiento")],8,["onUpdate:modelValue"]),[[t.vModelSelect,t.unref(B)]])])])];a(`<div class="flex flex-col md:flex-row gap-4" data-v-64cfe15d${r}><div class="flex-1" data-v-64cfe15d${r}><label class="block text-sm font-medium text-[#5D4A44] mb-2" data-v-64cfe15d${r}> Filtrar por Estado </label><select class="w-full px-4 py-2 border border-[#D8AFA0]/30 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#D8AFA0] bg-white" data-v-64cfe15d${r}><option value="todos" data-v-64cfe15d${s.ssrIncludeBooleanAttr(Array.isArray(t.unref(F))?s.ssrLooseContain(t.unref(F),"todos"):s.ssrLooseEqual(t.unref(F),"todos"))?" selected":""}${r}>Todos los estados</option><option value="activo" data-v-64cfe15d${s.ssrIncludeBooleanAttr(Array.isArray(t.unref(F))?s.ssrLooseContain(t.unref(F),"activo"):s.ssrLooseEqual(t.unref(F),"activo"))?" selected":""}${r}>âœ… Activos</option><option value="pendiente" data-v-64cfe15d${s.ssrIncludeBooleanAttr(Array.isArray(t.unref(F))?s.ssrLooseContain(t.unref(F),"pendiente"):s.ssrLooseEqual(t.unref(F),"pendiente"))?" selected":""}${r}>â³ Pendientes</option><option value="completado" data-v-64cfe15d${s.ssrIncludeBooleanAttr(Array.isArray(t.unref(F))?s.ssrLooseContain(t.unref(F),"completado"):s.ssrLooseEqual(t.unref(F),"completado"))?" selected":""}${r}>âœ”ï¸ Completados</option><option value="vencido" data-v-64cfe15d${s.ssrIncludeBooleanAttr(Array.isArray(t.unref(F))?s.ssrLooseContain(t.unref(F),"vencido"):s.ssrLooseEqual(t.unref(F),"vencido"))?" selected":""}${r}>âŒ Vencidos</option><option value="cancelado" data-v-64cfe15d${s.ssrIncludeBooleanAttr(Array.isArray(t.unref(F))?s.ssrLooseContain(t.unref(F),"cancelado"):s.ssrLooseEqual(t.unref(F),"cancelado"))?" selected":""}${r}>ğŸš« Cancelados</option></select></div><div class="flex-1" data-v-64cfe15d${r}><label class="block text-sm font-medium text-[#5D4A44] mb-2" data-v-64cfe15d${r}> Filtrar por Tipo </label><select class="w-full px-4 py-2 border border-[#D8AFA0]/30 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#D8AFA0] bg-white" data-v-64cfe15d${r}><option value="todos" data-v-64cfe15d${s.ssrIncludeBooleanAttr(Array.isArray(t.unref(I))?s.ssrLooseContain(t.unref(I),"todos"):s.ssrLooseEqual(t.unref(I),"todos"))?" selected":""}${r}>Todos los tipos</option><option value="quincenal" data-v-64cfe15d${s.ssrIncludeBooleanAttr(Array.isArray(t.unref(I))?s.ssrLooseContain(t.unref(I),"quincenal"):s.ssrLooseEqual(t.unref(I),"quincenal"))?" selected":""}${r}>Quincenal</option><option value="mensual" data-v-64cfe15d${s.ssrIncludeBooleanAttr(Array.isArray(t.unref(I))?s.ssrLooseContain(t.unref(I),"mensual"):s.ssrLooseEqual(t.unref(I),"mensual"))?" selected":""}${r}>Mensual</option><option value="semestral" data-v-64cfe15d${s.ssrIncludeBooleanAttr(Array.isArray(t.unref(I))?s.ssrLooseContain(t.unref(I),"semestral"):s.ssrLooseEqual(t.unref(I),"semestral"))?" selected":""}${r}>Semestral</option></select></div><div class="flex-1" data-v-64cfe15d${r}><label class="block text-sm font-medium text-[#5D4A44] mb-2" data-v-64cfe15d${r}> Ordenar por </label><select class="w-full px-4 py-2 border border-[#D8AFA0]/30 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#D8AFA0] bg-white" data-v-64cfe15d${r}><option value="reciente" data-v-64cfe15d${s.ssrIncludeBooleanAttr(Array.isArray(t.unref(B))?s.ssrLooseContain(t.unref(B),"reciente"):s.ssrLooseEqual(t.unref(B),"reciente"))?" selected":""}${r}>MÃ¡s recientes</option><option value="antiguo" data-v-64cfe15d${s.ssrIncludeBooleanAttr(Array.isArray(t.unref(B))?s.ssrLooseContain(t.unref(B),"antiguo"):s.ssrLooseEqual(t.unref(B),"antiguo"))?" selected":""}${r}>MÃ¡s antiguos</option><option value="vencimiento" data-v-64cfe15d${s.ssrIncludeBooleanAttr(Array.isArray(t.unref(B))?s.ssrLooseContain(t.unref(B),"vencimiento"):s.ssrLooseEqual(t.unref(B),"vencimiento"))?" selected":""}${r}>Por vencimiento</option></select></div></div>`)}),_:1},r)),o("</section>"),t.unref(V).length>0?(o('<section class="grid grid-cols-1 lg:grid-cols-2 gap-6" data-v-64cfe15d>\x3c!--[--\x3e'),s.ssrRenderList(t.unref(V),e=>{o(s.ssrRenderComponent(l,{key:e.id,bono:e,onRenovar:abrirModalRenovacion,onVerPagos:abrirModalPagos,onEditar:editarBono},null,r))}),o("\x3c!--]--\x3e</section>")):(o('<section class="text-center py-16" data-v-64cfe15d>'),o(s.ssrRenderComponent(d,null,{default:t.withCtx((e,a,o,r)=>{if(!a)return[t.createVNode("span",{class:"text-7xl mb-4 block opacity-40"},"ğŸ«"),t.createVNode("h3",{class:"text-xl font-['Lora'] font-semibold text-[#5D4A44] mb-2"},t.toDisplayString(0===t.unref(D).length?"No hay bonos registrados":"No hay bonos con estos filtros"),1),t.createVNode("p",{class:"text-[#5D4A44]/60 mb-6"},t.toDisplayString(0===t.unref(D).length?"Crea el primer bono para este paciente":"Intenta cambiar los filtros para ver mÃ¡s bonos"),1),0===t.unref(D).length&&t.unref(m)?(t.openBlock(),t.createBlock("button",{key:0,onClick:abrirModalNuevoBono,class:"px-8 py-3 bg-[#D8AFA0] text-white rounded-lg hover:bg-[#C89B8A] transition-colors font-medium"}," + Crear Primer Bono ")):(t.openBlock(),t.createBlock("button",{key:1,onClick:limpiarFiltros,class:"px-8 py-3 bg-[#5D4A44] text-white rounded-lg hover:bg-[#4A3A34] transition-colors font-medium"}," Limpiar Filtros "))];a(`<span class="text-7xl mb-4 block opacity-40" data-v-64cfe15d${r}>ğŸ«</span><h3 class="text-xl font-[&#39;Lora&#39;] font-semibold text-[#5D4A44] mb-2" data-v-64cfe15d${r}>${s.ssrInterpolate(0===t.unref(D).length?"No hay bonos registrados":"No hay bonos con estos filtros")}</h3><p class="text-[#5D4A44]/60 mb-6" data-v-64cfe15d${r}>${s.ssrInterpolate(0===t.unref(D).length?"Crea el primer bono para este paciente":"Intenta cambiar los filtros para ver mÃ¡s bonos")}</p>`),0===t.unref(D).length&&t.unref(m)?a(`<button class="px-8 py-3 bg-[#D8AFA0] text-white rounded-lg hover:bg-[#C89B8A] transition-colors font-medium" data-v-64cfe15d${r}> + Crear Primer Bono </button>`):a(`<button class="px-8 py-3 bg-[#5D4A44] text-white rounded-lg hover:bg-[#4A3A34] transition-colors font-medium" data-v-64cfe15d${r}> Limpiar Filtros </button>`)}),_:1},r)),o("</section>")),t.unref(E)?(o('<section class="mt-8 space-y-3" data-v-64cfe15d>'),t.unref(C).proximosAVencer>0?o(`<div class="p-4 bg-orange-50 border-2 border-orange-300 rounded-lg" data-v-64cfe15d><div class="flex items-start gap-3" data-v-64cfe15d><span class="text-2xl" data-v-64cfe15d>âš ï¸</span><div class="flex-1" data-v-64cfe15d><h4 class="font-medium text-orange-900 mb-1" data-v-64cfe15d>${s.ssrInterpolate(t.unref(C).proximosAVencer)} bono(s) prÃ³ximo(s) a vencer </h4><p class="text-sm text-orange-700" data-v-64cfe15d> Hay bonos que vencerÃ¡n en los prÃ³ximos 7 dÃ­as. Considera renovarlos. </p></div><button class="text-sm text-orange-700 hover:text-orange-900 underline" data-v-64cfe15d> Ver bonos activos </button></div></div>`):o("\x3c!----\x3e"),t.unref(C).pocasSesiones>0?o(`<div class="p-4 bg-blue-50 border-2 border-blue-300 rounded-lg" data-v-64cfe15d><div class="flex items-start gap-3" data-v-64cfe15d><span class="text-2xl" data-v-64cfe15d>ğŸ“Š</span><div class="flex-1" data-v-64cfe15d><h4 class="font-medium text-blue-900 mb-1" data-v-64cfe15d>${s.ssrInterpolate(t.unref(C).pocasSesiones)} bono(s) con pocas sesiones </h4><p class="text-sm text-blue-700" data-v-64cfe15d> Algunos bonos tienen 2 o menos sesiones restantes. </p></div></div></div>`):o("\x3c!----\x3e"),o("</section>")):o("\x3c!----\x3e"),o("</div>")),o(s.ssrRenderComponent(i,{mostrar:t.unref(_),"paciente-id":t.unref(x),"paciente-nombre":t.unref($),"psicologa-id":t.unref(A),onClose:cerrarModalNuevoBono,onCreated:onBonoCreado},null,r)),o(s.ssrRenderComponent(c,{mostrar:t.unref(L),bono:t.unref(R),onClose:cerrarModalPagos,onUpdated:onPagosActualizados},null,r)),o(s.ssrRenderComponent(u,{mostrar:t.unref(k),bono:t.unref(R),onClose:cerrarModalRenovacion,onRenovated:onBonoRenovado},null,r)),o("</div>")}}}),D=w.setup;w.setup=(e,a)=>{const o=t.useSSRContext();return(o.modules||(o.modules=new Set)).add("pages/terapeuta/pacientes/[id]/bonos.vue"),D?D(e,a):void 0};const $=d(w,[["__scopeId","data-v-64cfe15d"]]);export{$ as default};
//# sourceMappingURL=bonos-DAQPoglY.mjs.map
