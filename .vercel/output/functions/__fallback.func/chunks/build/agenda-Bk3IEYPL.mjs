import{v as e,s as t,_ as a}from"./server.mjs";import{_ as r}from"./ModalNuevaCita-QWHLrbsw.mjs";import{u as o}from"./useCitas-DyEZH6RI.mjs";import{u as s}from"./useSupabaseClient-DykwVqLQ.mjs";import"../routes/renderer.mjs";import"../nitro/nitro.mjs";import"node:http";import"node:https";import"node:events";import"node:buffer";import"node:fs";import"node:path";import"node:crypto";import"../_/shared.cjs.prod.mjs";import"../virtual/_commonjsHelpers.mjs";import"node:stream";import"../_/index.mjs";import"@supabase/supabase-js";import"@vercel/analytics/nuxt";import"./useSupabase-CA5R4uuJ.mjs";import"./CheckCircleIcon-CT9fzVFs.mjs";import"./CalendarIcon-BrsGHJBC.mjs";import"./TicketIcon-zZdrc71S.mjs";import"./MagnifyingGlassIcon-GsbNDyPZ.mjs";import"./UserIcon-CrHYaeI9.mjs";import"./ExclamationTriangleIcon-DQdM2y0F.mjs";import"./UserGroupIcon-BhthmHUw.mjs";import"./ClockIcon-BxdFtPqx.mjs";import"./XCircleIcon-BCxujS_I.mjs";import"./_plugin-vue_export-helper-1tPrXgE0.mjs";const n=e.defineComponent({__name:"agenda",__ssrInlineRender:!0,setup(n){const{getCitasPorDia:i}=o(),l=s(),c=e.ref("dia"),d=e.ref(formatearFecha(new Date)),p=e.ref(""),u=e.ref(!1),m=e.ref([]),f=e.ref([]);e.ref(null);const b=e.ref(!1),g=e.ref(""),x=e.ref(""),v=[{id:"dia",nombre:"D√≠a",icono:"üìÖ"},{id:"semana",nombre:"Semana",icono:"üìÜ"},{id:"mes",nombre:"Mes",icono:"üóìÔ∏è"}];async function cargarCitasDelDia(){u.value=!0;try{if(p.value)m.value=await i(d.value,p.value);else{const{data:e,error:t}=await l.from("vista_agenda_terapeutas").select("*").eq("fecha_cita",d.value).neq("estado","cancelada").order("hora_inicio",{ascending:!0});t?(console.error("Error al cargar citas:",t),m.value=[]):m.value=e||[]}}finally{u.value=!1}}function cargarCitasSegunVista(){"dia"===c.value&&cargarCitasDelDia()}function cambiarDia(e){const t=new Date(d.value);t.setDate(t.getDate()+e),d.value=formatearFecha(t),cargarCitasDelDia()}function irHoy(){d.value=formatearFecha(new Date),cargarCitasDelDia()}function cerrarModalNuevaCita(){b.value=!1,g.value=""}function onCitaCreada(){cargarCitasDelDia()}function formatearFecha(e){return e.toISOString().split("T")[0]||""}function formatearFechaLegible(e){const t=new Date(e+"T00:00:00");return`${t.getDate()} de ${["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"][t.getMonth()]} de ${t.getFullYear()}`}function obtenerIconoTipo(e){return{presencial:"üè•",online:"üíª",telefonica:"üìû"}[e]||"üìÖ"}function obtenerColorEstado(e){return{confirmada:"border-green-400",pendiente:"border-yellow-400",cancelada:"border-red-400",realizada:"border-blue-400"}[e]||"border-gray-400"}function obtenerEstiloEstado(e){return{confirmada:"bg-green-100 text-green-700",pendiente:"bg-yellow-100 text-yellow-700",cancelada:"bg-red-100 text-red-700",realizada:"bg-blue-100 text-blue-700"}[e]||"bg-gray-100 text-gray-700"}return e.watch([c,d,p],()=>{cargarCitasSegunVista()}),(o,s,n,i)=>{const l=a,h=r;s(`<div${t.ssrRenderAttrs(i)}>`),s(t.ssrRenderComponent(l,{name:"coordinacion"},{default:e.withCtx((a,r,o,s)=>{if(!r)return[e.createVNode("div",{class:"mb-8"},[e.createVNode("h1",{class:"text-4xl font-serif font-bold text-cafe mb-2"}," Agenda Global "),e.createVNode("p",{class:"text-lg text-cafe/70"}," Gesti√≥n y coordinaci√≥n de todas las sesiones de terapeutas ")]),e.createVNode("div",{class:"mb-6 flex flex-wrap gap-3"},[e.withDirectives(e.createVNode("select",{"onUpdate:modelValue":t=>e.isRef(p)?p.value=t:null,class:"px-4 py-2 rounded-lg border border-[#EAD5D3]/40 bg-white text-cafe focus:ring-2 focus:ring-terracota focus:border-transparent",onChange:cargarCitasSegunVista},[e.createVNode("option",{value:""},"Todos los terapeutas"),(e.openBlock(!0),e.createBlock(e.Fragment,null,e.renderList(e.unref(f),t=>(e.openBlock(),e.createBlock("option",{key:t.id,value:t.id},e.toDisplayString(t.nombre_completo),9,["value"]))),128))],40,["onUpdate:modelValue"]),[[e.vModelSelect,e.unref(p)]]),(e.openBlock(),e.createBlock(e.Fragment,null,e.renderList(v,t=>e.createVNode("button",{key:t.id,onClick:e=>c.value=t.id,class:["px-5 py-2.5 rounded-lg font-medium transition-all",e.unref(c)===t.id?"bg-terracota text-white shadow-md":"bg-white text-cafe hover:bg-terracota/10 border border-[#EAD5D3]/40"]},[e.createVNode("span",{class:"mr-2"},e.toDisplayString(t.icono),1),e.createTextVNode(" "+e.toDisplayString(t.nombre),1)],10,["onClick"])),64)),e.createVNode("button",{onClick:e=>(g.value=d.value,void(b.value=!0)),class:"ml-auto px-5 py-2.5 rounded-lg font-medium bg-gradient-to-r from-terracota to-rosa text-white hover:from-terracota/90 hover:to-rosa/90 shadow-md transition-all"},[e.createVNode("span",{class:"mr-2"},"+"),e.createTextVNode(" Nueva Cita ")],8,["onClick"])]),"dia"===e.unref(c)?(e.openBlock(),e.createBlock("div",{key:0,class:"bg-white rounded-xl shadow-sm border border-[#EAD5D3]/40 p-6"},[e.createVNode("div",{class:"mb-6 flex items-center gap-4"},[e.createVNode("button",{onClick:e=>cambiarDia(-1),class:"p-2 hover:bg-terracota/10 rounded-lg transition-colors"}," ‚Üê Anterior ",8,["onClick"]),e.withDirectives(e.createVNode("input",{"onUpdate:modelValue":t=>e.isRef(d)?d.value=t:null,type:"date",class:"flex-1 px-4 py-2 bg-base-bg rounded-lg border border-transparent focus:border-terracota focus:outline-none focus:ring-2 focus:ring-terracota/20"},null,8,["onUpdate:modelValue"]),[[e.vModelText,e.unref(d)]]),e.createVNode("button",{onClick:irHoy,class:"px-4 py-2 bg-terracota/10 text-terracota rounded-lg hover:bg-terracota/20 transition-colors font-medium"}," Hoy "),e.createVNode("button",{onClick:e=>cambiarDia(1),class:"p-2 hover:bg-terracota/10 rounded-lg transition-colors"}," Siguiente ‚Üí ",8,["onClick"])]),e.createVNode("div",{class:"mb-6"},[e.createVNode("h2",{class:"text-2xl font-serif font-semibold text-cafe mb-1"},e.toDisplayString(formatearFechaLegible(e.unref(d))),1),e.createVNode("p",{class:"text-cafe/60"},e.toDisplayString(e.unref(m).length)+" cita"+e.toDisplayString(1!==e.unref(m).length?"s":"")+" programada"+e.toDisplayString(1!==e.unref(m).length?"s":""),1)]),e.unref(u)?(e.openBlock(),e.createBlock("div",{key:0,class:"text-center py-12"},[e.createVNode("div",{class:"inline-block animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-terracota"})])):0===e.unref(m).length?(e.openBlock(),e.createBlock("div",{key:1,class:"text-center py-12"},[e.createVNode("span",{class:"text-6xl mb-4 block"},"üìÖ"),e.createVNode("p",{class:"text-lg text-cafe font-medium mb-2"},"Sin citas programadas"),e.createVNode("p",{class:"text-cafe/60"},"No hay citas para "+e.toDisplayString(formatearFechaLegible(e.unref(d))),1)])):(e.openBlock(),e.createBlock("div",{key:2,class:"space-y-4"},[(e.openBlock(!0),e.createBlock(e.Fragment,null,e.renderList(e.unref(m),t=>(e.openBlock(),e.createBlock("div",{key:t.cita_id,class:["bg-gradient-to-r from-base-bg to-white rounded-lg p-5 border-l-4 hover:shadow-md transition-all",obtenerColorEstado(t.estado)]},[e.createVNode("div",{class:"flex items-start justify-between"},[e.createVNode("div",{class:"flex-1"},[e.createVNode("div",{class:"flex items-center gap-3 mb-2"},[e.createVNode("span",{class:"text-3xl"},e.toDisplayString(obtenerIconoTipo(t.modalidad)),1),e.createVNode("div",null,[e.createVNode("h3",{class:"text-lg font-semibold text-cafe"},e.toDisplayString(t.paciente_nombre),1),e.createVNode("p",{class:"text-sm text-cafe/60"},e.toDisplayString(t.hora_inicio)+" - "+e.toDisplayString(t.hora_fin)+" ¬∑ "+e.toDisplayString(t.terapeuta_nombre),1)])]),t.observaciones?(e.openBlock(),e.createBlock("div",{key:0,class:"mt-3 p-3 bg-white/50 rounded-lg"},[e.createVNode("p",{class:"text-sm text-cafe/70"},[e.createVNode("span",{class:"font-medium"},"Notas:"),e.createTextVNode(" "+e.toDisplayString(t.observaciones),1)])])):e.createCommentVNode("",!0)]),e.createVNode("div",{class:"flex flex-col gap-2"},[e.createVNode("span",{class:["px-3 py-1 rounded-full text-xs font-medium",obtenerEstiloEstado(t.estado)]},e.toDisplayString(t.estado),3)])])],2))),128))]))])):(e.openBlock(),e.createBlock("div",{key:1,class:"bg-white rounded-xl shadow-sm border border-[#EAD5D3]/40 p-6"},[e.createVNode("div",{class:"text-center py-12"},[e.createVNode("span",{class:"text-6xl mb-4 block"},"üóìÔ∏è"),e.createVNode("p",{class:"text-lg text-cafe font-medium mb-2"},"Vista en desarrollo"),e.createVNode("p",{class:"text-cafe/60"},"La vista "+e.toDisplayString(e.unref(c))+" estar√° disponible pronto",1)])])),e.createVNode(h,{mostrar:e.unref(b),"fecha-preseleccionada":e.unref(g),"hora-preseleccionada":e.unref(x),onCerrar:cerrarModalNuevaCita,onCitaCreada:onCitaCreada},null,8,["mostrar","fecha-preseleccionada","hora-preseleccionada"])];r(`<div class="mb-8"${s}><h1 class="text-4xl font-serif font-bold text-cafe mb-2"${s}> Agenda Global </h1><p class="text-lg text-cafe/70"${s}> Gesti√≥n y coordinaci√≥n de todas las sesiones de terapeutas </p></div><div class="mb-6 flex flex-wrap gap-3"${s}><select class="px-4 py-2 rounded-lg border border-[#EAD5D3]/40 bg-white text-cafe focus:ring-2 focus:ring-terracota focus:border-transparent"${s}><option value=""${t.ssrIncludeBooleanAttr(Array.isArray(e.unref(p))?t.ssrLooseContain(e.unref(p),""):t.ssrLooseEqual(e.unref(p),""))?" selected":""}${s}>Todos los terapeutas</option>\x3c!--[--\x3e`),t.ssrRenderList(e.unref(f),a=>{r(`<option${t.ssrRenderAttr("value",a.id)}${t.ssrIncludeBooleanAttr(Array.isArray(e.unref(p))?t.ssrLooseContain(e.unref(p),a.id):t.ssrLooseEqual(e.unref(p),a.id))?" selected":""}${s}>${t.ssrInterpolate(a.nombre_completo)}</option>`)}),r("\x3c!--]--\x3e</select>\x3c!--[--\x3e"),t.ssrRenderList(v,a=>{r(`<button class="${t.ssrRenderClass(["px-5 py-2.5 rounded-lg font-medium transition-all",e.unref(c)===a.id?"bg-terracota text-white shadow-md":"bg-white text-cafe hover:bg-terracota/10 border border-[#EAD5D3]/40"])}"${s}><span class="mr-2"${s}>${t.ssrInterpolate(a.icono)}</span> ${t.ssrInterpolate(a.nombre)}</button>`)}),r(`\x3c!--]--\x3e<button class="ml-auto px-5 py-2.5 rounded-lg font-medium bg-gradient-to-r from-terracota to-rosa text-white hover:from-terracota/90 hover:to-rosa/90 shadow-md transition-all"${s}><span class="mr-2"${s}>+</span> Nueva Cita </button></div>`),"dia"===e.unref(c)?(r(`<div class="bg-white rounded-xl shadow-sm border border-[#EAD5D3]/40 p-6"${s}><div class="mb-6 flex items-center gap-4"${s}><button class="p-2 hover:bg-terracota/10 rounded-lg transition-colors"${s}> ‚Üê Anterior </button><input${t.ssrRenderAttr("value",e.unref(d))} type="date" class="flex-1 px-4 py-2 bg-base-bg rounded-lg border border-transparent focus:border-terracota focus:outline-none focus:ring-2 focus:ring-terracota/20"${s}><button class="px-4 py-2 bg-terracota/10 text-terracota rounded-lg hover:bg-terracota/20 transition-colors font-medium"${s}> Hoy </button><button class="p-2 hover:bg-terracota/10 rounded-lg transition-colors"${s}> Siguiente ‚Üí </button></div><div class="mb-6"${s}><h2 class="text-2xl font-serif font-semibold text-cafe mb-1"${s}>${t.ssrInterpolate(formatearFechaLegible(e.unref(d)))}</h2><p class="text-cafe/60"${s}>${t.ssrInterpolate(e.unref(m).length)} cita${t.ssrInterpolate(1!==e.unref(m).length?"s":"")} programada${t.ssrInterpolate(1!==e.unref(m).length?"s":"")}</p></div>`),e.unref(u)?r(`<div class="text-center py-12"${s}><div class="inline-block animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-terracota"${s}></div></div>`):0===e.unref(m).length?r(`<div class="text-center py-12"${s}><span class="text-6xl mb-4 block"${s}>üìÖ</span><p class="text-lg text-cafe font-medium mb-2"${s}>Sin citas programadas</p><p class="text-cafe/60"${s}>No hay citas para ${t.ssrInterpolate(formatearFechaLegible(e.unref(d)))}</p></div>`):(r(`<div class="space-y-4"${s}>\x3c!--[--\x3e`),t.ssrRenderList(e.unref(m),e=>{r(`<div class="${t.ssrRenderClass([obtenerColorEstado(e.estado),"bg-gradient-to-r from-base-bg to-white rounded-lg p-5 border-l-4 hover:shadow-md transition-all"])}"${s}><div class="flex items-start justify-between"${s}><div class="flex-1"${s}><div class="flex items-center gap-3 mb-2"${s}><span class="text-3xl"${s}>${t.ssrInterpolate(obtenerIconoTipo(e.modalidad))}</span><div${s}><h3 class="text-lg font-semibold text-cafe"${s}>${t.ssrInterpolate(e.paciente_nombre)}</h3><p class="text-sm text-cafe/60"${s}>${t.ssrInterpolate(e.hora_inicio)} - ${t.ssrInterpolate(e.hora_fin)} ¬∑ ${t.ssrInterpolate(e.terapeuta_nombre)}</p></div></div>`),e.observaciones?r(`<div class="mt-3 p-3 bg-white/50 rounded-lg"${s}><p class="text-sm text-cafe/70"${s}><span class="font-medium"${s}>Notas:</span> ${t.ssrInterpolate(e.observaciones)}</p></div>`):r("\x3c!----\x3e"),r(`</div><div class="flex flex-col gap-2"${s}><span class="${t.ssrRenderClass(["px-3 py-1 rounded-full text-xs font-medium",obtenerEstiloEstado(e.estado)])}"${s}>${t.ssrInterpolate(e.estado)}</span></div></div></div>`)}),r("\x3c!--]--\x3e</div>")),r("</div>")):r(`<div class="bg-white rounded-xl shadow-sm border border-[#EAD5D3]/40 p-6"${s}><div class="text-center py-12"${s}><span class="text-6xl mb-4 block"${s}>üóìÔ∏è</span><p class="text-lg text-cafe font-medium mb-2"${s}>Vista en desarrollo</p><p class="text-cafe/60"${s}>La vista ${t.ssrInterpolate(e.unref(c))} estar√° disponible pronto</p></div></div>`),r(t.ssrRenderComponent(h,{mostrar:e.unref(b),"fecha-preseleccionada":e.unref(g),"hora-preseleccionada":e.unref(x),onCerrar:cerrarModalNuevaCita,onCitaCreada:onCitaCreada},null,o,s))}),_:1},n)),s("</div>")}}}),i=n.setup;n.setup=(t,a)=>{const r=e.useSSRContext();return(r.modules||(r.modules=new Set)).add("pages/coordinacion/agenda.vue"),i?i(t,a):void 0};export{n as default};
//# sourceMappingURL=agenda-Bk3IEYPL.mjs.map
