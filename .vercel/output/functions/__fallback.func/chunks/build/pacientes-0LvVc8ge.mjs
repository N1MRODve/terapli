import{a as e,e as a,v as t,s as r}from"./server.mjs";import{_ as o}from"./_plugin-vue_export-helper-1tPrXgE0.mjs";import{r as s}from"./CalendarIcon-BrsGHJBC.mjs";import{r as n}from"./ClockIcon-BxdFtPqx.mjs";import{r as l}from"./CheckCircleIcon-CT9fzVFs.mjs";import{r as d}from"./TicketIcon-zZdrc71S.mjs";import{r as i}from"./CurrencyDollarIcon-COwB3mCA.mjs";import{r as c}from"./ChartBarIcon-BEEST7f0.mjs";import{r as u}from"./ExclamationTriangleIcon-DQdM2y0F.mjs";import{r as p}from"./ExclamationCircleIcon-DhXgUVTW.mjs";import{r as v}from"./BellAlertIcon-DDdTQQDY.mjs";import{_ as m}from"./ModalNuevaCita-CXmg5Qpz.mjs";import{u as f}from"./useSupabase-DfFg84CY.mjs";import{u as b}from"./useBonos-B2-LOzOF.mjs";import{u as x}from"./useCitas-DyEZH6RI.mjs";import{u as g}from"./useSupabaseClient-DykwVqLQ.mjs";import{r as h}from"./PhoneIcon-DdGFuEYy.mjs";import{r as y}from"./XMarkIcon-DCLwyE-W.mjs";import{r as w,a as _}from"./ArrowUpTrayIcon-Cp2oWqDh.mjs";import{r as C}from"./XCircleIcon-BCxujS_I.mjs";import{r as $}from"./EyeIcon-CVap-E73.mjs";import{r as A}from"./MagnifyingGlassIcon-GsbNDyPZ.mjs";import{r as I}from"./CalendarDaysIcon-f8DhK37e.mjs";import{r as R}from"./ClipboardDocumentListIcon-tIc_vSd1.mjs";import{r as k}from"./UserGroupIcon-BhthmHUw.mjs";import"../routes/renderer.mjs";import"../nitro/nitro.mjs";import"node:http";import"node:https";import"node:events";import"node:buffer";import"node:fs";import"node:path";import"node:crypto";import"../_/shared.cjs.prod.mjs";import"../virtual/_commonjsHelpers.mjs";import"node:stream";import"../_/index2.mjs";import"@supabase/supabase-js";import"@vercel/analytics/nuxt";import"./UserIcon-CrHYaeI9.mjs";import"./CheckBadgeIcon-DjhxLc-3.mjs";function render$3(e,a){return t.openBlock(),t.createElementBlock("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[t.createElementVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M10.5 6h9.75M10.5 6a1.5 1.5 0 1 1-3 0m3 0a1.5 1.5 0 1 0-3 0M3.75 6H7.5m3 12h9.75m-9.75 0a1.5 1.5 0 0 1-3 0m3 0a1.5 1.5 0 0 0-3 0m-3.75 0H7.5m9-6h3.75m-3.75 0a1.5 1.5 0 0 1-3 0m3 0a1.5 1.5 0 0 0-3 0m-9.75 0h9.75"})])}function render$2(e,a){return t.openBlock(),t.createElementBlock("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[t.createElementVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M11.35 3.836c-.065.21-.1.433-.1.664 0 .414.336.75.75.75h4.5a.75.75 0 0 0 .75-.75 2.25 2.25 0 0 0-.1-.664m-5.8 0A2.251 2.251 0 0 1 13.5 2.25H15c1.012 0 1.867.668 2.15 1.586m-5.8 0c-.376.023-.75.05-1.124.08C9.095 4.01 8.25 4.973 8.25 6.108V8.25m8.9-4.414c.376.023.75.05 1.124.08 1.131.094 1.976 1.057 1.976 2.192V16.5A2.25 2.25 0 0 1 18 18.75h-2.25m-7.5-10.5H4.875c-.621 0-1.125.504-1.125 1.125v11.25c0 .621.504 1.125 1.125 1.125h9.75c.621 0 1.125-.504 1.125-1.125V18.75m-7.5-10.5h6.375c.621 0 1.125.504 1.125 1.125v9.375m-8.25-3 1.5 1.5 3-3.75"})])}function render$1(e,a){return t.openBlock(),t.createElementBlock("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[t.createElementVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m.75 12 3 3m0 0 3-3m-3 3v-6m-1.5-9H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"})])}function render(e,a){return t.openBlock(),t.createElementBlock("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[t.createElementVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M3.75 9.776c.112-.017.227-.026.344-.026h15.812c.117 0 .232.009.344.026m-16.5 0a2.25 2.25 0 0 0-1.883 2.542l.857 6a2.25 2.25 0 0 0 2.227 1.932H19.05a2.25 2.25 0 0 0 2.227-1.932l.857-6a2.25 2.25 0 0 0-1.883-2.542m-16.5 0V6A2.25 2.25 0 0 1 6 3.75h3.879a1.5 1.5 0 0 1 1.06.44l2.122 2.12a1.5 1.5 0 0 0 1.06.44H18A2.25 2.25 0 0 1 20.25 9v.776"})])}const E={__name:"PacienteCard",__ssrInlineRender:!0,props:{paciente:{type:Object,required:!0}},emits:["editar","eliminar","ver-citas","gestionar-bonos","editar-cita"],setup(e){const a=e,o=t.computed(()=>{const e=a.paciente.nombre||"Sin nombre";if("Sin nombre"===e)return"Sin nombre";const t=e.trim().split(" ");if(t.length>2){return`${t[0]} ${t[1]} ${t[t.length-1].charAt(0)}.`}return e}),m=t.computed(()=>{const e=a.paciente.nombre||"";if(!e)return"??";const t=e.trim().split(" ");return`${t[0]?.charAt(0).toUpperCase()||"?"}${t[1]?.charAt(0).toUpperCase()||""}`}),f=t.computed(()=>{const e=["#5550F2","#C89B8A","#B7C6B0","#A8C5B5","#D4A5A5","#C4B5A0"];return e[a.paciente.id.charCodeAt(0)%e.length]}),b=t.computed(()=>{const e=a.paciente.estado_emocional_promedio||3;return e>=4?"ÔøΩ":e>=3?"üòê":"ÔøΩ"}),x=t.computed(()=>{const e=a.paciente.estado_emocional_promedio||3;return e>=4?"Estado positivo":e>=3?"Estado neutro":"Requiere atenci√≥n"}),g=t.computed(()=>a.paciente.activo?a.paciente.en_pausa?"En pausa":"Activo":"Finalizado"),h=t.computed(()=>a.paciente.activo?a.paciente.en_pausa?"bg-yellow-100 text-yellow-700":"bg-green-100 text-green-700":"bg-gray-100 text-gray-600"),y=t.computed(()=>a.paciente.activo?a.paciente.en_pausa?"bg-yellow-500":"bg-green-500":"bg-gray-500"),w=t.computed(()=>a.paciente.area_de_acompanamiento||null),_=t.computed(()=>{if(!a.paciente.ultima_sesion)return"Sin registro";const e=new Date(a.paciente.ultima_sesion),t=new Date,r=Math.floor((t-e)/864e5);return 0===r?"Hoy":1===r?"Ayer":r<7?`Hace ${r} d√≠as`:r<30?`Hace ${Math.floor(r/7)} semanas`:e.toLocaleDateString("es-ES",{day:"numeric",month:"short"})}),C=t.computed(()=>{if(!a.paciente.proxima_sesion)return null;try{let e=a.paciente.proxima_sesion;e.includes("T")||(e+="T00:00:00");const t=new Date(e);return isNaN(t.getTime())?(console.warn("Fecha inv√°lida en pr√≥xima sesi√≥n:",a.paciente.proxima_sesion),null):t.toLocaleDateString("es-ES",{weekday:"short",day:"numeric",month:"short",hour:"2-digit",minute:"2-digit"})}catch(e){return console.error("Error al formatear pr√≥xima sesi√≥n:",e,a.paciente.proxima_sesion),null}}),$=t.computed(()=>a.paciente.total_sesiones||0),A=t.computed(()=>a.paciente.evolucion_porcentaje||50),I=t.computed(()=>{const e=A.value;return e>=70?"bg-green-500":e>=50?"bg-yellow-500":"bg-orange-500"}),R=t.computed(()=>{if(!a.paciente.ultima_sesion)return 0;const e=new Date(a.paciente.ultima_sesion),t=new Date;return Math.floor((t-e)/864e5)}),k=t.computed(()=>!(!a.paciente.activo||a.paciente.en_pausa)&&R.value>30),E=t.computed(()=>a.paciente.requiere_atencion||!1),D=t.computed(()=>a.paciente.bono_activo||null),L=t.computed(()=>{if(!D.value?.tipo)return"Sin tipo";return{otro:"A demanda",quincenal:"Quincenal",semanal:"Semanal",mensual:"Mensual",personalizado:"Personalizado"}[D.value.tipo]||D.value.tipo}),S=t.computed(()=>{if(!D.value?.tipo)return"bg-gray-100 text-gray-600";return{otro:"bg-blue-100 text-blue-700",quincenal:"bg-purple-100 text-purple-700",semanal:"bg-indigo-100 text-indigo-700",mensual:"bg-teal-100 text-teal-700",personalizado:"bg-pink-100 text-pink-700"}[D.value.tipo]||"bg-gray-100 text-gray-600"}),B=t.computed(()=>{if(!D.value?.estado)return"Sin estado";return{activo:"Activo",pendiente:"Pendiente",vencido:"Vencido",completado:"Completado"}[D.value.estado]||D.value.estado}),F=t.computed(()=>{if(!D.value?.estado)return"bg-gray-100 text-gray-600";return{activo:"bg-green-100 text-green-700",pendiente:"bg-yellow-100 text-yellow-700",vencido:"bg-red-100 text-red-700",completado:"bg-gray-100 text-gray-600"}[D.value.estado]||"bg-gray-100 text-gray-600"}),P=t.computed(()=>{if(!D.value?.fecha_fin)return"Sin fecha";try{return new Date(D.value.fecha_fin).toLocaleDateString("es-ES",{day:"numeric",month:"short",year:"numeric"})}catch(e){return"Fecha inv√°lida"}});t.computed(()=>{if(!D.value?.fecha_fin)return"text-cafe/60";const e=new Date(D.value.fecha_fin),a=new Date,t=Math.floor((e-a)/864e5);return t<0?"text-red-600 font-semibold":t<=7?"text-orange-600 font-semibold":t<=14?"text-amber-600":"text-cafe/80"});const q=t.computed(()=>D.value?D.value.sesiones_totales-D.value.sesiones_restantes:0),j=t.computed(()=>D.value?.sesiones_totales||0),M=t.computed(()=>{if(!D.value)return"text-purple-600";const e=D.value.sesiones_restantes;return 0===e?"text-red-600 font-bold":1===e?"text-red-600 font-semibold":2===e?"text-orange-600 font-semibold":"text-purple-600 font-semibold"}),z=t.computed(()=>{if(!D.value)return 0;const e=D.value.sesiones_totales,a=D.value.sesiones_restantes;if(0===e)return 0;const t=e-a;return Math.round(t/e*100)}),T=t.computed(()=>z.value.toString()),V=t.computed(()=>{if(!D.value)return"bg-gray-400";return{activo:"bg-green-500",pendiente:"bg-yellow-500",vencido:"bg-red-500",completado:"bg-gray-400"}[D.value.estado]||"bg-gray-400"}),N=t.computed(()=>!!D.value&&1===D.value.sesiones_restantes),O=t.computed(()=>!!D.value&&2===D.value.sesiones_restantes);return(e,a,H,U)=>{a(`<article${r.ssrRenderAttrs(t.mergeProps({class:"bg-white rounded-xl shadow-sm border border-gray-100 p-6 hover:shadow-lg hover:border-gray-200 transition-all duration-300 group relative cursor-pointer focus-within:ring-2 focus-within:ring-purple-600 focus-within:ring-offset-2",role:"article","aria-label":`Ficha de ${t.unref(o)}`,tabindex:"0"},U))} data-v-d022a747><div class="absolute top-4 right-4 flex gap-1.5 opacity-0 group-hover:opacity-100 group-focus-within:opacity-100 transition-all duration-200 z-10" role="toolbar" aria-label="Acciones del paciente" data-v-d022a747><button class="min-h-[44px] min-w-[44px] p-2.5 bg-purple-500 text-white rounded-lg hover:bg-purple-600 transition-colors shadow-md hover:shadow-lg focus:ring-2 focus:ring-purple-300 focus:outline-none"${r.ssrRenderAttr("aria-label",`Gestionar bonos de ${t.unref(o)}`)} data-v-d022a747><svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true" data-v-d022a747><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 5v2m0 4v2m0 4v2M5 5a2 2 0 00-2 2v3a2 2 0 110 4v3a2 2 0 002 2h14a2 2 0 002-2v-3a2 2 0 110-4V7a2 2 0 00-2-2H5z" data-v-d022a747></path></svg></button><button class="min-h-[44px] min-w-[44px] p-2.5 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors shadow-md hover:shadow-lg focus:ring-2 focus:ring-blue-300 focus:outline-none"${r.ssrRenderAttr("aria-label",`Editar informaci√≥n de ${t.unref(o)}`)} data-v-d022a747><svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true" data-v-d022a747><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z" data-v-d022a747></path></svg></button><button class="min-h-[44px] min-w-[44px] p-2.5 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors shadow-md hover:shadow-lg focus:ring-2 focus:ring-red-300 focus:outline-none"${r.ssrRenderAttr("aria-label",`Eliminar a ${t.unref(o)}`)} data-v-d022a747><svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true" data-v-d022a747><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" data-v-d022a747></path></svg></button></div><div class="flex items-start justify-between mb-5" data-v-d022a747><div class="flex items-center gap-3 flex-1" data-v-d022a747><div class="w-14 h-14 rounded-full flex items-center justify-center text-white font-bold text-xl flex-shrink-0 shadow-md" style="${r.ssrRenderStyle({backgroundColor:t.unref(f)})}"${r.ssrRenderAttr("aria-label",`Avatar de ${t.unref(o)}`)} data-v-d022a747>${r.ssrInterpolate(t.unref(m))}</div><div class="flex-1 min-w-0" data-v-d022a747><h3 class="font-serif text-lg font-semibold text-cafe group-hover:text-purple-600 transition-colors leading-tight truncate" data-v-d022a747>${r.ssrInterpolate(t.unref(o))}</h3><div class="flex items-center gap-2 mt-1.5 flex-wrap" data-v-d022a747><span class="text-xl leading-none"${r.ssrRenderAttr("title",t.unref(x))}${r.ssrRenderAttr("aria-label",`Estado emocional: ${t.unref(x)}`)} data-v-d022a747>${r.ssrInterpolate(t.unref(b))}</span><span class="text-xs text-gray-500 font-medium" data-v-d022a747>${r.ssrInterpolate(t.unref(x))}</span></div></div></div><span class="${r.ssrRenderClass([t.unref(h),"px-3 py-1.5 text-xs font-semibold rounded-full whitespace-nowrap flex items-center gap-1.5 flex-shrink-0"])}"${r.ssrRenderAttr("aria-label",`Estado del v√≠nculo: ${t.unref(g)}`)} data-v-d022a747><span class="${r.ssrRenderClass([t.unref(y),"w-1.5 h-1.5 rounded-full"])}" data-v-d022a747></span><span data-v-d022a747>${r.ssrInterpolate(t.unref(g))}</span></span></div>`),t.unref(w)?a(`<div class="mb-4 flex items-center gap-2" data-v-d022a747><span class="text-xs text-gray-400 uppercase tracking-wide" data-v-d022a747>√Årea:</span><span class="text-sm text-gray-700 font-medium" data-v-d022a747>${r.ssrInterpolate(t.unref(w))}</span></div>`):a("\x3c!----\x3e"),a('<div class="space-y-3 mb-5" data-v-d022a747><div class="flex items-center gap-2 text-sm text-gray-600" data-v-d022a747>'),a(r.ssrRenderComponent(t.unref(s),{class:"w-4 h-4 text-purple-600 flex-shrink-0"},null,H)),a(`<span data-v-d022a747>√öltima sesi√≥n: </span><span class="font-medium" data-v-d022a747>${r.ssrInterpolate(t.unref(_))}</span></div><div class="flex items-center gap-2 text-sm text-gray-600 flex-wrap" data-v-d022a747>`),a(r.ssrRenderComponent(t.unref(n),{class:"w-4 h-4 text-purple-600 flex-shrink-0","aria-hidden":"true"},null,H)),a("<span data-v-d022a747>Pr√≥xima: </span>"),t.unref(C)?a(`<button class="min-h-[44px] px-2 -mx-2 text-purple-600 hover:text-cafe font-medium hover:underline transition-colors flex-shrink-0 focus:outline-none focus:ring-2 focus:ring-purple-300 rounded"${r.ssrRenderAttr("aria-label",`Editar cita programada para ${t.unref(C)}`)} data-v-d022a747>${r.ssrInterpolate(t.unref(C))}</button>`):a('<span class="text-gray-400 font-medium" data-v-d022a747>No programada</span>'),a(`<button class="min-h-[44px] px-2 ml-auto text-xs text-purple-600 hover:text-cafe hover:underline transition-colors flex-shrink-0 focus:outline-none focus:ring-2 focus:ring-purple-300 rounded"${r.ssrRenderAttr("aria-label",`Ver todas las citas de ${t.unref(o)}`)} data-v-d022a747> Ver citas ‚Üí </button></div><div class="flex items-center gap-2 text-sm text-gray-600" data-v-d022a747>`),a(r.ssrRenderComponent(t.unref(l),{class:"w-4 h-4 text-purple-600 flex-shrink-0"},null,H)),a(`<span data-v-d022a747>${r.ssrInterpolate(t.unref($))} sesiones completadas</span></div></div>`),t.unref(D)?(a('<div class="mb-5 p-4 bg-gradient-to-br from-purple-600/8 to-rosa/12 rounded-xl border border-purple-600/15" data-v-d022a747><div class="space-y-3" data-v-d022a747><div class="flex items-center justify-between" data-v-d022a747><div class="flex items-center gap-2" data-v-d022a747>'),a(r.ssrRenderComponent(t.unref(d),{class:"w-4 h-4 text-purple-600 flex-shrink-0"},null,H)),a(`<span class="text-sm font-medium text-gray-700" data-v-d022a747>Bono:</span><span class="${r.ssrRenderClass([t.unref(S),"px-2.5 py-1 rounded-lg text-xs font-semibold"])}" data-v-d022a747>${r.ssrInterpolate(t.unref(L))}</span></div><span class="${r.ssrRenderClass([t.unref(F),"px-2.5 py-1 rounded-full text-xs font-semibold flex items-center gap-1.5"])}" data-v-d022a747>`),a(r.ssrRenderComponent(t.unref(i),{class:"w-3 h-3"},null,H)),a(`<span data-v-d022a747>${r.ssrInterpolate(t.unref(B))}</span></span></div><div class="grid grid-cols-1 gap-2" data-v-d022a747><div class="flex items-center gap-2 text-sm" data-v-d022a747>`),a(r.ssrRenderComponent(t.unref(s),{class:"w-4 h-4 text-purple-600 flex-shrink-0"},null,H)),a(`<span class="text-gray-600" data-v-d022a747>Vigencia:</span><span class="${r.ssrRenderClass([e.fechaFinClases,"font-medium"])}" data-v-d022a747>${r.ssrInterpolate(t.unref(P))}</span></div><div class="flex items-center gap-2 text-sm" data-v-d022a747>`),a(r.ssrRenderComponent(t.unref(c),{class:"w-4 h-4 text-purple-600 flex-shrink-0"},null,H)),a(`<span class="text-gray-600" data-v-d022a747>Sesiones:</span><span class="${r.ssrRenderClass([t.unref(M),"font-semibold"])}" data-v-d022a747>${r.ssrInterpolate(t.unref(q))}/${r.ssrInterpolate(t.unref(j))}</span></div></div><div class="pt-1" data-v-d022a747><div class="flex items-center justify-between text-xs text-gray-500 mb-2" data-v-d022a747><span data-v-d022a747>Progreso del bono</span><span class="font-semibold text-gray-700" data-v-d022a747>${r.ssrInterpolate(t.unref(T))}%</span></div><div class="w-full bg-gray-200 rounded-full h-2 overflow-hidden" data-v-d022a747><div class="${r.ssrRenderClass([t.unref(V),"h-2 rounded-full transition-all duration-500"])}" style="${r.ssrRenderStyle({width:`${t.unref(z)}%`})}" data-v-d022a747></div></div></div></div></div>`)):a("\x3c!----\x3e"),a(`<div class="pt-5 border-t border-gray-100" data-v-d022a747><div class="flex items-center justify-between text-xs text-gray-500 mb-2" data-v-d022a747><span data-v-d022a747>Evoluci√≥n general</span><span class="font-semibold text-gray-700" data-v-d022a747>${r.ssrInterpolate(t.unref(A))}%</span></div><div class="w-full bg-gray-200 rounded-full h-2" data-v-d022a747><div class="${r.ssrRenderClass([t.unref(I),"h-2 rounded-full transition-all duration-500"])}" style="${r.ssrRenderStyle({width:`${t.unref(A)}%`})}" data-v-d022a747></div></div></div><div class="mt-5 space-y-2" data-v-d022a747>`),t.unref(N)?(a('<div class="flex items-start gap-3 p-3 bg-red-50 border border-red-200 rounded-lg animate-pulse-subtle" data-v-d022a747>'),a(r.ssrRenderComponent(t.unref(u),{class:"w-4 h-4 text-red-600 flex-shrink-0 mt-0.5"},null,H)),a(`<div class="flex-1" data-v-d022a747><p class="text-xs font-semibold text-red-800 mb-1" data-v-d022a747> Bono casi agotado </p><p class="text-xs text-red-700" data-v-d022a747> Solo queda ${r.ssrInterpolate(t.unref(D).sesiones_restantes)} sesi√≥n. Informar para renovaci√≥n. </p></div></div>`)):t.unref(O)?(a('<div class="flex items-start gap-3 p-3 bg-amber-50 border border-amber-200 rounded-lg" data-v-d022a747>'),a(r.ssrRenderComponent(t.unref(p),{class:"w-4 h-4 text-amber-600 flex-shrink-0 mt-0.5"},null,H)),a(`<div class="flex-1" data-v-d022a747><p class="text-xs font-semibold text-amber-800 mb-1" data-v-d022a747> Bono pr√≥ximo a agotar </p><p class="text-xs text-amber-700" data-v-d022a747> Quedan ${r.ssrInterpolate(t.unref(D).sesiones_restantes)} sesiones. Considerar renovaci√≥n. </p></div></div>`)):a("\x3c!----\x3e"),t.unref(k)?(a('<div class="flex items-start gap-3 p-3 bg-red-50 border border-red-200 rounded-lg animate-pulse-subtle" data-v-d022a747>'),a(r.ssrRenderComponent(t.unref(v),{class:"w-4 h-4 text-red-600 flex-shrink-0 mt-0.5"},null,H)),a(`<div class="flex-1" data-v-d022a747><p class="text-xs font-semibold text-red-800 mb-1" data-v-d022a747> Riesgo de abandono </p><p class="text-xs text-red-700" data-v-d022a747>${r.ssrInterpolate(t.unref(R))} d√≠as sin sesi√≥n. Considera contactar pronto. </p></div></div>`)):a("\x3c!----\x3e"),t.unref(E)?(a('<div class="flex items-start gap-3 p-3 bg-orange-50 border border-orange-200 rounded-lg" data-v-d022a747>'),a(r.ssrRenderComponent(t.unref(p),{class:"w-4 h-4 text-orange-500 flex-shrink-0 mt-0.5"},null,H)),a('<div class="flex-1" data-v-d022a747><p class="text-xs font-semibold text-orange-800" data-v-d022a747> Requiere seguimiento especial por estado emocional </p></div></div>')):a("\x3c!----\x3e"),a("</div></article>")}}},D=E.setup;E.setup=(e,a)=>{const r=t.useSSRContext();return(r.modules||(r.modules=new Set)).add("components/PacienteCard.vue"),D?D(e,a):void 0};const L=o(E,[["__scopeId","data-v-d022a747"]]),S={__name:"ModalNuevoPaciente",__ssrInlineRender:!0,props:{mostrar:{type:Boolean,default:!1}},emits:["cerrar","paciente-creado"],setup(e,{emit:o}){const s=e;f(),b(),x(),a();const n=t.ref({nombre:"",apellido:"",email:"",telefono:"",fecha_nacimiento:"",area_acompanamiento:"",tipo_bono:"",primera_sesion:"",activo:!0,notas_iniciales:"",crear_bono:!1,bono_monto:0,bono_renovacion_automatica:!1}),l=t.ref(!1),d=t.ref(""),i={otro:60,quincenal:100,semanal:160,mensual:180},c=t.computed(()=>{const e=n.value.tipo_bono;if(!e)return 0;return{otro:1,quincenal:2,semanal:4,mensual:4}[e]||0}),u=t.computed(()=>({otro:"A Demanda",quincenal:"Quincenal",semanal:"Semanal",mensual:"Mensual"}[n.value.tipo_bono]||"No seleccionado")),p=t.computed(()=>{const e=c.value,a=n.value.bono_monto;return!e||!a||e<=0?"0.00":(a/e).toFixed(2)}),v=t.computed(()=>{const e=n.value.tipo_bono;return e&&i[e]||0}),m=t.computed(()=>"otro"===n.value.tipo_bono),g=t.computed(()=>{const e=new Date,a=[],formatearDateTime=(e,a)=>`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")}T${a}`,t=new Date(e);t.setDate(t.getDate()+1),a.push({label:"üåÖ Ma√±ana 10:00",datetime:formatearDateTime(t,"10:00")});const r=new Date(e),o=(8-r.getDay())%7;r.setDate(r.getDate()+(o||7)),a.push({label:"üìÖ Pr√≥ximo Lun 09:00",datetime:formatearDateTime(r,"09:00")});const s=new Date(e);return s.setDate(s.getDate()+7),a.push({label:"üóìÔ∏è En 7 d√≠as 16:00",datetime:formatearDateTime(s,"16:00")}),a}),h=t.computed(()=>{const e=n.value.nombre&&n.value.apellido&&n.value.email&&n.value.area_acompanamiento&&n.value.tipo_bono&&n.value.primera_sesion;return n.value.crear_bono?e&&n.value.bono_monto>0:e});t.watch(()=>n.value.tipo_bono,e=>{"otro"===e?(n.value.crear_bono=!1,n.value.bono_monto=0):n.value.crear_bono&&0===n.value.bono_monto&&(n.value.bono_monto=i[e]||0)}),t.watch(()=>n.value.crear_bono,e=>{e&&n.value.tipo_bono&&0===n.value.bono_monto&&(n.value.bono_monto=i[n.value.tipo_bono]||0)}),t.watch(()=>s.mostrar,e=>{e&&resetearFormulario()});const resetearFormulario=()=>{n.value={nombre:"",apellido:"",email:"",telefono:"",fecha_nacimiento:"",area_acompanamiento:"",tipo_bono:"",primera_sesion:"",activo:!0,notas_iniciales:"",crear_bono:!1,bono_monto:0,bono_renovacion_automatica:!1},d.value=""};return(a,o,s,i)=>{e.mostrar?(o(`<div${r.ssrRenderAttrs(t.mergeProps({class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"},i))}><div class="bg-white/95 backdrop-blur-lg rounded-2xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto border border-white/30"><div class="sticky top-0 bg-gradient-to-r from-[#5550F2]/5 via-[#027368]/5 to-[#04BF9D]/5 backdrop-blur-md border-b border-neutral-200 px-6 py-4 flex justify-between items-center shadow-sm"><h2 class="text-2xl font-[&#39;Elms_Sans&#39;] text-neutral-800 font-semibold"> Nuevo Paciente </h2><button class="text-neutral-600 hover:text-[#027368] transition-colors p-2 hover:bg-white/50 rounded-lg" aria-label="Cerrar modal"><svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button></div><form class="px-6 py-6 space-y-6 bg-gradient-to-b from-white/50 to-transparent"><div class="space-y-4"><h3 class="text-lg font-[&#39;Elms_Sans&#39;] text-neutral-800 font-semibold"> Informaci√≥n Personal </h3><div class="grid grid-cols-1 md:grid-cols-2 gap-4"><div><label for="nombre" class="block text-sm font-medium text-neutral-700 mb-1"> Nombre <span class="text-red-500">*</span></label><input id="nombre"${r.ssrRenderAttr("value",n.value.nombre)} type="text" required class="w-full px-4 py-2 border border-neutral-300 rounded-xl focus:ring-2 focus:ring-[#027368]/20 focus:border-[#027368] bg-white/90 backdrop-blur-sm transition-all shadow-sm" placeholder="Nombre del paciente"></div><div><label for="apellido" class="block text-sm font-medium text-neutral-700 mb-1"> Apellido <span class="text-red-500">*</span></label><input id="apellido"${r.ssrRenderAttr("value",n.value.apellido)} type="text" required class="w-full px-4 py-2 border border-neutral-300 rounded-xl focus:ring-2 focus:ring-[#027368]/20 focus:border-[#027368] bg-white/90 backdrop-blur-sm transition-all shadow-sm" placeholder="Apellido(s) del paciente"></div><div><label for="email" class="block text-sm font-medium text-neutral-700 mb-1"> Email <span class="text-red-500">*</span></label><input id="email"${r.ssrRenderAttr("value",n.value.email)} type="email" required class="w-full px-4 py-2 border border-neutral-300 rounded-xl focus:ring-2 focus:ring-[#027368]/20 focus:border-[#027368] bg-white/90 backdrop-blur-sm transition-all shadow-sm" placeholder="correo@ejemplo.com"></div><div><label for="telefono" class="block text-sm font-medium text-neutral-700 mb-1"> Tel√©fono </label><input id="telefono"${r.ssrRenderAttr("value",n.value.telefono)} type="tel" class="w-full px-4 py-2 border border-neutral-300 rounded-xl focus:ring-2 focus:ring-[#027368]/20 focus:border-[#027368] bg-white/90 backdrop-blur-sm transition-all shadow-sm" placeholder="+52 123 456 7890"></div><div><label for="fecha_nacimiento" class="block text-sm font-medium text-[#2D3748] mb-1"> Fecha de Nacimiento </label><div class="relative"><input id="fecha_nacimiento"${r.ssrRenderAttr("value",n.value.fecha_nacimiento)} type="date" class="w-full px-4 py-2 pr-12 border border-[#5550F2]/30 rounded-lg focus:ring-2 focus:ring-[#5550F2] focus:border-transparent bg-white cursor-pointer"><button type="button" class="absolute right-2 top-1/2 -translate-y-1/2 p-2 text-[#5550F2] hover:text-[#2D3748] transition-colors" title="Abrir calendario"><svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path></svg></button></div><p class="text-xs text-cafe/60 mt-1"> üí° Puedes escribir la fecha o usar el calendario </p></div></div></div><div class="space-y-4 pt-4 border-t border-neutral-200"><h3 class="text-lg font-[&#39;Elms_Sans&#39;] text-neutral-800 font-semibold"> Informaci√≥n Terap√©utica </h3><div class="grid grid-cols-1 md:grid-cols-2 gap-4"><div class="md:col-span-2"><label for="area_acompanamiento" class="block text-sm font-medium text-[#2D3748] mb-1"> √Årea de Acompa√±amiento <span class="text-red-500">*</span></label><select id="area_acompanamiento" required class="w-full px-4 py-2 border border-[#5550F2]/30 rounded-lg focus:ring-2 focus:ring-[#5550F2] focus:border-transparent bg-white"><option value=""${r.ssrIncludeBooleanAttr(Array.isArray(n.value.area_acompanamiento)?r.ssrLooseContain(n.value.area_acompanamiento,""):r.ssrLooseEqual(n.value.area_acompanamiento,""))?" selected":""}>Selecciona un √°rea</option><option value="Ansiedad"${r.ssrIncludeBooleanAttr(Array.isArray(n.value.area_acompanamiento)?r.ssrLooseContain(n.value.area_acompanamiento,"Ansiedad"):r.ssrLooseEqual(n.value.area_acompanamiento,"Ansiedad"))?" selected":""}>Ansiedad</option><option value="Depresi√≥n"${r.ssrIncludeBooleanAttr(Array.isArray(n.value.area_acompanamiento)?r.ssrLooseContain(n.value.area_acompanamiento,"Depresi√≥n"):r.ssrLooseEqual(n.value.area_acompanamiento,"Depresi√≥n"))?" selected":""}>Depresi√≥n</option><option value="Autoestima"${r.ssrIncludeBooleanAttr(Array.isArray(n.value.area_acompanamiento)?r.ssrLooseContain(n.value.area_acompanamiento,"Autoestima"):r.ssrLooseEqual(n.value.area_acompanamiento,"Autoestima"))?" selected":""}>Autoestima</option><option value="Relaciones"${r.ssrIncludeBooleanAttr(Array.isArray(n.value.area_acompanamiento)?r.ssrLooseContain(n.value.area_acompanamiento,"Relaciones"):r.ssrLooseEqual(n.value.area_acompanamiento,"Relaciones"))?" selected":""}>Relaciones</option><option value="Duelo"${r.ssrIncludeBooleanAttr(Array.isArray(n.value.area_acompanamiento)?r.ssrLooseContain(n.value.area_acompanamiento,"Duelo"):r.ssrLooseEqual(n.value.area_acompanamiento,"Duelo"))?" selected":""}>Duelo</option><option value="Estr√©s Laboral"${r.ssrIncludeBooleanAttr(Array.isArray(n.value.area_acompanamiento)?r.ssrLooseContain(n.value.area_acompanamiento,"Estr√©s Laboral"):r.ssrLooseEqual(n.value.area_acompanamiento,"Estr√©s Laboral"))?" selected":""}>Estr√©s Laboral</option><option value="Crecimiento Personal"${r.ssrIncludeBooleanAttr(Array.isArray(n.value.area_acompanamiento)?r.ssrLooseContain(n.value.area_acompanamiento,"Crecimiento Personal"):r.ssrLooseEqual(n.value.area_acompanamiento,"Crecimiento Personal"))?" selected":""}>Crecimiento Personal</option><option value="Otro"${r.ssrIncludeBooleanAttr(Array.isArray(n.value.area_acompanamiento)?r.ssrLooseContain(n.value.area_acompanamiento,"Otro"):r.ssrLooseEqual(n.value.area_acompanamiento,"Otro"))?" selected":""}>Otro</option></select></div><div><label for="tipo_bono" class="block text-sm font-medium text-[#2D3748] mb-1"> Tipo de Bono <span class="text-red-500">*</span></label><select id="tipo_bono" required class="w-full px-4 py-2 border border-[#5550F2]/30 rounded-lg focus:ring-2 focus:ring-[#5550F2] focus:border-transparent bg-white"><option value=""${r.ssrIncludeBooleanAttr(Array.isArray(n.value.tipo_bono)?r.ssrLooseContain(n.value.tipo_bono,""):r.ssrLooseEqual(n.value.tipo_bono,""))?" selected":""}>Selecciona tipo de bono</option><option value="otro"${r.ssrIncludeBooleanAttr(Array.isArray(n.value.tipo_bono)?r.ssrLooseContain(n.value.tipo_bono,"otro"):r.ssrLooseEqual(n.value.tipo_bono,"otro"))?" selected":""}>A Demanda (1 sesi√≥n - 60‚Ç¨ - sin compromiso)</option><option value="quincenal"${r.ssrIncludeBooleanAttr(Array.isArray(n.value.tipo_bono)?r.ssrLooseContain(n.value.tipo_bono,"quincenal"):r.ssrLooseEqual(n.value.tipo_bono,"quincenal"))?" selected":""}>Quincenal (2 sesiones/mes - 100‚Ç¨)</option><option value="semanal"${r.ssrIncludeBooleanAttr(Array.isArray(n.value.tipo_bono)?r.ssrLooseContain(n.value.tipo_bono,"semanal"):r.ssrLooseEqual(n.value.tipo_bono,"semanal"))?" selected":""}>Semanal (4 sesiones/mes - 160‚Ç¨)</option><option value="mensual"${r.ssrIncludeBooleanAttr(Array.isArray(n.value.tipo_bono)?r.ssrLooseContain(n.value.tipo_bono,"mensual"):r.ssrLooseEqual(n.value.tipo_bono,"mensual"))?" selected":""}>Mensual</option></select><p class="text-xs text-cafe/60 mt-1"> üé´ Define el tipo de bono del paciente </p></div><div><label for="primera_sesion" class="block text-sm font-medium text-[#2D3748] mb-1"> Primera Sesi√≥n <span class="text-red-500">*</span></label><div class="relative"><input id="primera_sesion"${r.ssrRenderAttr("value",n.value.primera_sesion)} type="datetime-local" required step="1800" class="w-full px-4 py-2 pr-12 border border-[#5550F2]/30 rounded-lg focus:ring-2 focus:ring-[#5550F2] focus:border-transparent bg-white cursor-pointer"><button type="button" class="absolute right-2 top-1/2 -translate-y-1/2 p-2 text-[#5550F2] hover:text-[#2D3748] transition-colors" title="Abrir selector de fecha y hora"><svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg></button></div><div class="flex gap-2 flex-wrap mt-2">\x3c!--[--\x3e`),r.ssrRenderList(t.unref(g),(e,a)=>{o(`<button type="button" class="${r.ssrRenderClass(["text-xs px-3 py-1.5 rounded-lg border transition-all",n.value.primera_sesion===e.datetime?"bg-[#5550F2] text-white border-[#5550F2] font-semibold":"bg-white text-[#2D3748] border-[#5550F2]/30 hover:border-[#5550F2] hover:bg-[#5550F2]/10"])}">${r.ssrInterpolate(e.label)}</button>`)}),o('\x3c!--]--\x3e</div><p class="text-xs text-cafe/60 mt-1"> üí° Puedes escribir la fecha/hora o usar el selector </p></div></div></div><div class="space-y-4 pt-4 border-t border-[#5550F2]/30"><div class="border-t pt-6"><h3 class="text-lg font-serif text-[#2D3748] font-semibold mb-2"> üí≥ Bono Inicial (Opcional) </h3>'),t.unref(m)?o('<div class="bg-amber-50 border-2 border-amber-200 rounded-lg p-4 mb-3"><div class="flex items-start gap-3"><span class="text-2xl">‚ÑπÔ∏è</span><div><p class="text-sm font-semibold text-amber-900 mb-1"> Sesi√≥n &quot;A Demanda&quot; seleccionada </p><p class="text-sm text-amber-800"> Las sesiones a demanda son <strong>sin compromiso</strong> y se pagan individualmente (60‚Ç¨ por sesi√≥n). No es necesario crear un bono prepagado. </p></div></div></div>'):o('<p class="text-sm text-cafe/70 mb-3"> Crea un bono prepagado para que el paciente empiece su tratamiento. Podr√°s confirmar el pago despu√©s. </p>'),o(`<label class="${r.ssrRenderClass([t.unref(m)?"bg-gray-100 border-2 border-gray-200 cursor-not-allowed opacity-60":"bg-purple-50 border-2 border-purple-200 cursor-pointer hover:bg-purple-100","flex items-center gap-3 p-3 rounded-lg transition-colors"])}"><input${r.ssrIncludeBooleanAttr(Array.isArray(n.value.crear_bono)?r.ssrLooseContain(n.value.crear_bono,null):n.value.crear_bono)?" checked":""} type="checkbox"${r.ssrIncludeBooleanAttr(t.unref(m))?" disabled":""} class="w-5 h-5 text-purple-600 border-gray-300 rounded focus:ring-purple-500 disabled:opacity-50 disabled:cursor-not-allowed"><span class="${r.ssrRenderClass([t.unref(m)?"text-gray-500":"text-purple-700","text-sm font-semibold"])}"> ‚úÖ S√≠, crear bono prepagado para este paciente </span></label></div>`),n.value.crear_bono?(o(`<div class="border-2 border-purple-400/40 rounded-lg p-5 space-y-4 bg-gradient-to-br from-purple-50 to-purple-100/50"><div class="bg-white border-2 border-purple-300 rounded-lg p-4 shadow-sm"><div class="flex items-start gap-3"><div class="w-10 h-10 bg-purple-500 rounded-full flex items-center justify-center flex-shrink-0"><span class="text-white text-xl">üéüÔ∏è</span></div><div class="flex-1"><h4 class="font-semibold text-purple-900 mb-1"> Tipo de Bono: ${r.ssrInterpolate(t.unref(u)||"Selecciona un tipo arriba")}</h4><div class="grid grid-cols-2 gap-3 text-sm"><div class="flex items-center gap-2"><span class="text-purple-600">üìä</span><span class="text-purple-800"><strong>${r.ssrInterpolate(t.unref(c))}</strong> ${r.ssrInterpolate(1===t.unref(c)?"sesi√≥n":"sesiones")}</span></div>`),t.unref(v)>0?o(`<div class="flex items-center gap-2"><span class="text-purple-600">üí∞</span><span class="text-purple-800"> Precio sugerido: <strong>‚Ç¨${r.ssrInterpolate(t.unref(v))}</strong></span></div>`):o("\x3c!----\x3e"),o(`</div><p class="text-xs text-purple-600 mt-2 bg-purple-50 p-2 rounded"> üí° <strong>Tip:</strong> Los precios se calcular√°n autom√°ticamente seg√∫n el tipo de bono </p></div></div></div><div class="grid grid-cols-1 md:grid-cols-2 gap-4"><div><label for="bono_monto" class="block text-sm font-medium text-[#2D3748] mb-1"> Monto Total <span class="text-red-500">*</span></label><div class="relative"><span class="absolute left-3 top-1/2 -translate-y-1/2 text-[#2D3748]/60">‚Ç¨</span><input id="bono_monto"${r.ssrRenderAttr("value",n.value.bono_monto)} type="number" min="0" step="0.01"${r.ssrIncludeBooleanAttr(n.value.crear_bono)?" required":""} placeholder="0.00" class="w-full pl-8 pr-4 py-2 border border-purple-300 rounded-lg focus:ring-2 focus:ring-purple-500 bg-white"></div></div><div><label class="block text-sm font-medium text-[#2D3748] mb-1"> Precio por Sesi√≥n </label><div class="px-4 py-2 bg-purple-100 rounded-lg border border-purple-300"><span class="text-lg font-bold text-purple-700">‚Ç¨${r.ssrInterpolate(t.unref(p))}</span></div></div><div class="md:col-span-2"><label class="flex items-start gap-3 p-4 bg-white border-2 border-purple-200 rounded-lg cursor-pointer hover:bg-purple-50 hover:border-purple-300 transition-all"><input${r.ssrIncludeBooleanAttr(Array.isArray(n.value.bono_renovacion_automatica)?r.ssrLooseContain(n.value.bono_renovacion_automatica,null):n.value.bono_renovacion_automatica)?" checked":""} type="checkbox" class="mt-1 w-5 h-5 text-purple-600 border-gray-300 rounded focus:ring-purple-500"><div class="flex-1"><div class="flex items-center gap-2 mb-1"><span class="text-lg">üîÑ</span><span class="text-sm font-semibold text-purple-900"> Renovaci√≥n Autom√°tica </span><span class="ml-auto px-2 py-0.5 bg-purple-100 text-purple-700 text-xs font-medium rounded"> Recomendado </span></div><div class="text-xs text-[#2D3748]/70 space-y-1"><p>‚úì El bono se renovar√° autom√°ticamente cuando se agoten las sesiones o expire</p><p>‚úì Mantiene la continuidad del tratamiento sin interrupciones</p><p>‚úì Puedes desactivar la renovaci√≥n en cualquier momento</p></div></div></label></div></div>`),t.unref(c)>0&&n.value.bono_monto>0?o(`<div class="p-3 bg-white rounded-lg border border-purple-300"><div class="text-xs font-medium text-purple-800 mb-2">üìã Resumen del Bono</div><div class="grid grid-cols-3 gap-2 text-xs"><div><span class="text-[#2D3748]/60">Tipo:</span><span class="font-medium text-[#2D3748] ml-1">${r.ssrInterpolate(t.unref(u))}</span></div><div><span class="text-[#2D3748]/60">Sesiones:</span><span class="font-medium text-[#2D3748] ml-1">${r.ssrInterpolate(t.unref(c))}</span></div><div><span class="text-[#2D3748]/60">Total:</span><span class="font-medium text-[#2D3748] ml-1">‚Ç¨${r.ssrInterpolate(n.value.bono_monto)}</span></div></div></div>`):o("\x3c!----\x3e"),o("</div>")):o("\x3c!----\x3e"),o(`</div><div class="space-y-4 pt-4 border-t border-[#5550F2]/30"><h3 class="text-lg font-serif text-[#2D3748] font-semibold"> Notas Iniciales </h3><div><label for="notas_iniciales" class="block text-sm font-medium text-[#2D3748] mb-1"> Observaciones (Opcional) </label><textarea id="notas_iniciales" rows="3" class="w-full px-4 py-2 border border-[#5550F2]/30 rounded-lg focus:ring-2 focus:ring-[#5550F2] focus:border-transparent bg-white resize-none" placeholder="Observaciones iniciales, motivo de consulta, etc.">${r.ssrInterpolate(n.value.notas_iniciales)}</textarea></div></div>`),d.value?o(`<div class="bg-red-50 border border-red-200 rounded-lg p-4"><p class="text-sm text-red-600">${r.ssrInterpolate(d.value)}</p></div>`):o("\x3c!----\x3e"),o(`<div class="sticky bottom-0 bg-gradient-to-r from-white/95 via-white/90 to-white/95 backdrop-blur-md pt-4 pb-2 border-t border-neutral-200 -mx-6 px-6 mt-6 shadow-sm"><div class="flex justify-between items-center gap-3"><div class="text-xs text-neutral-600"><span class="inline-block w-2 h-2 bg-red-500 rounded-full mr-1"></span> Los campos con * son obligatorios </div><div class="flex gap-3"><button type="button"${r.ssrIncludeBooleanAttr(l.value)?" disabled":""} class="px-6 py-2.5 border-2 border-neutral-300 text-neutral-700 font-medium rounded-xl hover:bg-neutral-50 hover:border-[#027368] transition-all disabled:opacity-50 disabled:cursor-not-allowed"> Cancelar </button><button type="submit"${r.ssrIncludeBooleanAttr(l.value||!t.unref(h))?" disabled":""} class="px-8 py-2.5 bg-gradient-to-r from-[#04BF9D] to-[#027368] text-white font-semibold rounded-xl hover:from-[#027368] hover:to-[#04BF9D] transition-all disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2 shadow-sm hover:shadow-md">`),l.value?o('<span class="inline-block w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"></span>'):o("<span>‚úì</span>"),o(` ${r.ssrInterpolate(l.value?"Creando paciente...":"Crear Paciente")}</button></div></div></div></form></div></div>`)):o("\x3c!----\x3e")}}},B=S.setup;S.setup=(e,a)=>{const r=t.useSSRContext();return(r.modules||(r.modules=new Set)).add("components/ModalNuevoPaciente.vue"),B?B(e,a):void 0};const F=Object.assign(S,{__name:"ModalNuevoPaciente"}),P={__name:"ModalEditarPaciente",__ssrInlineRender:!0,props:{mostrar:{type:Boolean,default:!1},paciente:{type:Object,default:null}},emits:["cerrar","paciente-actualizado"],setup(e,{emit:a}){const o=e;f(),b();const s=t.ref({nombre:"",apellido:"",email:"",telefono:"",fecha_nacimiento:"",area_acompanamiento:"",tipo_bono:"",activo:!0,en_pausa:!1,crear_bono:!1,bono_monto:null,bono_renovacion_automatica:!1}),n=t.computed(()=>{const e=s.value.tipo_bono;if(!e)return"Selecciona tipo";return{a_demanda:1,quincenal:2,semanal:4}[e]||0}),l=t.computed(()=>({a_demanda:"A Demanda",quincenal:"Quincenal",semanal:"Semanal"}[s.value.tipo_bono]||"")),d=t.computed(()=>{const e=n.value,a=s.value.bono_monto;return"Selecciona tipo"===e||!a||e<=0?"0.00":(a/e).toFixed(2)}),i=t.ref(!1),c=t.ref("");t.watch(()=>o.mostrar,e=>{e&&o.paciente&&cargarDatosPaciente()});const cargarDatosPaciente=()=>{const e=o.paciente,a=e.metadata||{},t=(e.nombre_completo||e.nombre||"").split(" "),r=t[0]||a.nombre||"",n=t.slice(1).join(" ")||a.apellido||a.apellido_paterno||"";s.value={nombre:r,apellido:n,email:e.email||"",telefono:e.telefono||"",fecha_nacimiento:a.fecha_nacimiento||"",area_acompanamiento:e.area_de_acompanamiento||e.area_acompanamiento||"",tipo_bono:e.tipo_bono||"",activo:e.activo??!0,en_pausa:e.en_pausa||a.en_pausa||!1,crear_bono:!1,bono_monto:null,bono_renovacion_automatica:!1},c.value=""};return(a,o,u,p)=>{e.mostrar?(o(`<div${r.ssrRenderAttrs(t.mergeProps({class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"},p))} data-v-2464ce35><div class="bg-[#F2F2F2] rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto" data-v-2464ce35><div class="sticky top-0 bg-[#F2F2F2] border-b border-[#5550F2]/30 px-6 py-4 flex justify-between items-center" data-v-2464ce35><h2 class="text-2xl font-serif text-[#2D3748] font-semibold" data-v-2464ce35> Editar Paciente </h2><button class="text-[#2D3748] hover:text-[#5550F2] transition-colors" aria-label="Cerrar modal" data-v-2464ce35><svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-2464ce35><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" data-v-2464ce35></path></svg></button></div><form class="px-6 py-6 space-y-6" data-v-2464ce35><div class="space-y-4" data-v-2464ce35><h3 class="text-lg font-serif text-[#2D3748] font-semibold" data-v-2464ce35> Informaci√≥n Personal </h3><div class="grid grid-cols-1 md:grid-cols-2 gap-4" data-v-2464ce35><div data-v-2464ce35><label for="nombre" class="block text-sm font-medium text-[#2D3748] mb-1" data-v-2464ce35> Nombre <span class="text-red-500" data-v-2464ce35>*</span></label><input id="nombre"${r.ssrRenderAttr("value",s.value.nombre)} type="text" required class="w-full px-4 py-2 border border-[#5550F2]/30 rounded-lg focus:ring-2 focus:ring-[#5550F2] focus:border-transparent bg-white" placeholder="Nombre del paciente" data-v-2464ce35></div><div data-v-2464ce35><label for="apellido" class="block text-sm font-medium text-[#2D3748] mb-1" data-v-2464ce35> Apellido <span class="text-red-500" data-v-2464ce35>*</span></label><input id="apellido"${r.ssrRenderAttr("value",s.value.apellido)} type="text" required class="w-full px-4 py-2 border border-[#5550F2]/30 rounded-lg focus:ring-2 focus:ring-[#5550F2] focus:border-transparent bg-white" placeholder="Apellido(s) del paciente" data-v-2464ce35></div><div data-v-2464ce35><label for="email" class="block text-sm font-medium text-[#2D3748] mb-1" data-v-2464ce35> Email <span class="text-red-500" data-v-2464ce35>*</span></label><input id="email"${r.ssrRenderAttr("value",s.value.email)} type="email" required class="w-full px-4 py-2 border border-[#5550F2]/30 rounded-lg focus:ring-2 focus:ring-[#5550F2] focus:border-transparent bg-white" placeholder="correo@ejemplo.com" data-v-2464ce35></div><div data-v-2464ce35><label for="telefono" class="block text-sm font-medium text-[#2D3748] mb-1" data-v-2464ce35> Tel√©fono </label><input id="telefono"${r.ssrRenderAttr("value",s.value.telefono)} type="tel" class="w-full px-4 py-2 border border-[#5550F2]/30 rounded-lg focus:ring-2 focus:ring-[#5550F2] focus:border-transparent bg-white" placeholder="+52 123 456 7890" data-v-2464ce35></div><div data-v-2464ce35><label for="fecha_nacimiento" class="block text-sm font-medium text-[#2D3748] mb-1" data-v-2464ce35> Fecha de Nacimiento </label><input id="fecha_nacimiento"${r.ssrRenderAttr("value",s.value.fecha_nacimiento)} type="date" class="w-full px-4 py-2 border border-[#5550F2]/30 rounded-lg focus:ring-2 focus:ring-[#5550F2] focus:border-transparent bg-white" data-v-2464ce35></div></div></div><div class="space-y-4 pt-4 border-t border-[#5550F2]/30" data-v-2464ce35><h3 class="text-lg font-serif text-[#2D3748] font-semibold" data-v-2464ce35> Informaci√≥n Terap√©utica </h3><div class="grid grid-cols-1 md:grid-cols-2 gap-4" data-v-2464ce35><div class="md:col-span-2" data-v-2464ce35><label for="area_acompanamiento" class="block text-sm font-medium text-[#2D3748] mb-1" data-v-2464ce35> √Årea de Acompa√±amiento <span class="text-red-500" data-v-2464ce35>*</span></label><select id="area_acompanamiento" required class="w-full px-4 py-2 border border-[#5550F2]/30 rounded-lg focus:ring-2 focus:ring-[#5550F2] focus:border-transparent bg-white" data-v-2464ce35><option value="" data-v-2464ce35${r.ssrIncludeBooleanAttr(Array.isArray(s.value.area_acompanamiento)?r.ssrLooseContain(s.value.area_acompanamiento,""):r.ssrLooseEqual(s.value.area_acompanamiento,""))?" selected":""}>Selecciona un √°rea</option><option value="Ansiedad" data-v-2464ce35${r.ssrIncludeBooleanAttr(Array.isArray(s.value.area_acompanamiento)?r.ssrLooseContain(s.value.area_acompanamiento,"Ansiedad"):r.ssrLooseEqual(s.value.area_acompanamiento,"Ansiedad"))?" selected":""}>Ansiedad</option><option value="Depresi√≥n" data-v-2464ce35${r.ssrIncludeBooleanAttr(Array.isArray(s.value.area_acompanamiento)?r.ssrLooseContain(s.value.area_acompanamiento,"Depresi√≥n"):r.ssrLooseEqual(s.value.area_acompanamiento,"Depresi√≥n"))?" selected":""}>Depresi√≥n</option><option value="Autoestima" data-v-2464ce35${r.ssrIncludeBooleanAttr(Array.isArray(s.value.area_acompanamiento)?r.ssrLooseContain(s.value.area_acompanamiento,"Autoestima"):r.ssrLooseEqual(s.value.area_acompanamiento,"Autoestima"))?" selected":""}>Autoestima</option><option value="Relaciones" data-v-2464ce35${r.ssrIncludeBooleanAttr(Array.isArray(s.value.area_acompanamiento)?r.ssrLooseContain(s.value.area_acompanamiento,"Relaciones"):r.ssrLooseEqual(s.value.area_acompanamiento,"Relaciones"))?" selected":""}>Relaciones</option><option value="Duelo" data-v-2464ce35${r.ssrIncludeBooleanAttr(Array.isArray(s.value.area_acompanamiento)?r.ssrLooseContain(s.value.area_acompanamiento,"Duelo"):r.ssrLooseEqual(s.value.area_acompanamiento,"Duelo"))?" selected":""}>Duelo</option><option value="Estr√©s Laboral" data-v-2464ce35${r.ssrIncludeBooleanAttr(Array.isArray(s.value.area_acompanamiento)?r.ssrLooseContain(s.value.area_acompanamiento,"Estr√©s Laboral"):r.ssrLooseEqual(s.value.area_acompanamiento,"Estr√©s Laboral"))?" selected":""}>Estr√©s Laboral</option><option value="Crecimiento Personal" data-v-2464ce35${r.ssrIncludeBooleanAttr(Array.isArray(s.value.area_acompanamiento)?r.ssrLooseContain(s.value.area_acompanamiento,"Crecimiento Personal"):r.ssrLooseEqual(s.value.area_acompanamiento,"Crecimiento Personal"))?" selected":""}>Crecimiento Personal</option><option value="Otro" data-v-2464ce35${r.ssrIncludeBooleanAttr(Array.isArray(s.value.area_acompanamiento)?r.ssrLooseContain(s.value.area_acompanamiento,"Otro"):r.ssrLooseEqual(s.value.area_acompanamiento,"Otro"))?" selected":""}>Otro</option></select></div><div data-v-2464ce35><label for="tipo_bono" class="block text-sm font-medium text-[#2D3748] mb-1" data-v-2464ce35> Tipo de Bono <span class="text-red-500" data-v-2464ce35>*</span></label><select id="tipo_bono" required class="w-full px-4 py-2 border border-[#5550F2]/30 rounded-lg focus:ring-2 focus:ring-[#5550F2] focus:border-transparent bg-white" data-v-2464ce35><option value="" data-v-2464ce35${r.ssrIncludeBooleanAttr(Array.isArray(s.value.tipo_bono)?r.ssrLooseContain(s.value.tipo_bono,""):r.ssrLooseEqual(s.value.tipo_bono,""))?" selected":""}>Selecciona tipo de bono</option><option value="a_demanda" data-v-2464ce35${r.ssrIncludeBooleanAttr(Array.isArray(s.value.tipo_bono)?r.ssrLooseContain(s.value.tipo_bono,"a_demanda"):r.ssrLooseEqual(s.value.tipo_bono,"a_demanda"))?" selected":""}>A Demanda (1 sesi√≥n)</option><option value="quincenal" data-v-2464ce35${r.ssrIncludeBooleanAttr(Array.isArray(s.value.tipo_bono)?r.ssrLooseContain(s.value.tipo_bono,"quincenal"):r.ssrLooseEqual(s.value.tipo_bono,"quincenal"))?" selected":""}>Quincenal (2 sesiones/mes)</option><option value="semanal" data-v-2464ce35${r.ssrIncludeBooleanAttr(Array.isArray(s.value.tipo_bono)?r.ssrLooseContain(s.value.tipo_bono,"semanal"):r.ssrLooseEqual(s.value.tipo_bono,"semanal"))?" selected":""}>Semanal (4 sesiones/mes)</option></select></div><div data-v-2464ce35><label for="activo" class="block text-sm font-medium text-[#2D3748] mb-1" data-v-2464ce35> Estado </label><select id="activo" class="w-full px-4 py-2 border border-[#5550F2]/30 rounded-lg focus:ring-2 focus:ring-[#5550F2] focus:border-transparent bg-white" data-v-2464ce35><option${r.ssrRenderAttr("value",!0)} data-v-2464ce35${r.ssrIncludeBooleanAttr(Array.isArray(s.value.activo)?r.ssrLooseContain(s.value.activo,!0):r.ssrLooseEqual(s.value.activo,!0))?" selected":""}>Activo</option><option${r.ssrRenderAttr("value",!1)} data-v-2464ce35${r.ssrIncludeBooleanAttr(Array.isArray(s.value.activo)?r.ssrLooseContain(s.value.activo,!1):r.ssrLooseEqual(s.value.activo,!1))?" selected":""}>Inactivo</option></select></div><div class="md:col-span-2" data-v-2464ce35><label class="flex items-center gap-2 cursor-pointer" data-v-2464ce35><input${r.ssrIncludeBooleanAttr(Array.isArray(s.value.en_pausa)?r.ssrLooseContain(s.value.en_pausa,null):s.value.en_pausa)?" checked":""} type="checkbox" class="w-4 h-4 text-[#5550F2] border-gray-300 rounded focus:ring-[#5550F2]" data-v-2464ce35><span class="text-sm font-medium text-[#2D3748]" data-v-2464ce35> Proceso en pausa temporal </span></label><p class="text-xs text-cafe/60 mt-1 ml-6" data-v-2464ce35> ‚è∏Ô∏è Marca esta opci√≥n si el seguimiento est√° pausado temporalmente </p></div></div></div><div class="space-y-4 pt-4 border-t border-[#5550F2]/30" data-v-2464ce35><div class="flex items-center justify-between" data-v-2464ce35><h3 class="text-lg font-serif text-[#2D3748] font-semibold" data-v-2464ce35> Gesti√≥n de Bonos </h3><label class="flex items-center gap-2 cursor-pointer" data-v-2464ce35><input${r.ssrIncludeBooleanAttr(Array.isArray(s.value.crear_bono)?r.ssrLooseContain(s.value.crear_bono,null):s.value.crear_bono)?" checked":""} type="checkbox" class="w-4 h-4 text-purple-600 border-gray-300 rounded focus:ring-purple-500" data-v-2464ce35><span class="text-sm font-medium text-[#2D3748]" data-v-2464ce35> üé´ Crear nuevo bono para este paciente </span></label></div>`),s.value.crear_bono?(o(`<div class="border-2 border-purple-400/40 rounded-lg p-4 space-y-4 bg-purple-50/30" data-v-2464ce35><div class="bg-purple-100 border border-purple-300 rounded-lg p-3 flex items-start gap-2" data-v-2464ce35><svg class="w-5 h-5 text-purple-600 flex-shrink-0 mt-0.5" fill="currentColor" viewBox="0 0 20 20" data-v-2464ce35><path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd" data-v-2464ce35></path></svg><div class="text-sm text-purple-800" data-v-2464ce35><p class="font-medium" data-v-2464ce35>El bono usar√° el tipo seleccionado arriba: <strong data-v-2464ce35>${r.ssrInterpolate(l.value||"Selecciona un tipo primero")}</strong></p><p class="text-xs text-purple-700 mt-1" data-v-2464ce35> Sesiones incluidas: ${r.ssrInterpolate("Selecciona tipo"===n.value?"N/A":n.value)}</p></div></div><div class="grid grid-cols-1 md:grid-cols-2 gap-4" data-v-2464ce35><div data-v-2464ce35><label for="bono_monto" class="block text-sm font-medium text-[#2D3748] mb-1" data-v-2464ce35> Monto Total <span class="text-red-500" data-v-2464ce35>*</span></label><div class="relative" data-v-2464ce35><span class="absolute left-3 top-2.5 text-[#2D3748] font-medium" data-v-2464ce35>‚Ç¨</span><input id="bono_monto"${r.ssrRenderAttr("value",s.value.bono_monto)} type="number" min="0" step="0.01"${r.ssrIncludeBooleanAttr(s.value.crear_bono)?" required":""} class="w-full pl-8 pr-4 py-2 border border-[#5550F2]/30 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent bg-white" placeholder="0.00" data-v-2464ce35></div></div><div data-v-2464ce35><label class="block text-sm font-medium text-[#2D3748] mb-1" data-v-2464ce35> Precio por Sesi√≥n </label><div class="px-4 py-2 bg-purple-100 border-2 border-purple-300 rounded-lg text-purple-900 font-bold" data-v-2464ce35> ‚Ç¨${r.ssrInterpolate(d.value)}</div></div><div class="md:col-span-2" data-v-2464ce35><label class="flex items-center gap-2 cursor-pointer" data-v-2464ce35><input${r.ssrIncludeBooleanAttr(Array.isArray(s.value.bono_renovacion_automatica)?r.ssrLooseContain(s.value.bono_renovacion_automatica,null):s.value.bono_renovacion_automatica)?" checked":""} type="checkbox" class="w-4 h-4 text-purple-600 border-gray-300 rounded focus:ring-purple-500" data-v-2464ce35><span class="text-sm font-medium text-[#2D3748]" data-v-2464ce35> üîÑ Renovaci√≥n autom√°tica al vencer </span></label><p class="text-xs text-cafe/60 mt-1 ml-6" data-v-2464ce35> El sistema crear√° un nuevo bono id√©ntico cuando este expire </p></div></div>`),n.value&&s.value.bono_monto?(o(`<div class="bg-white border border-purple-300 rounded-lg p-4" data-v-2464ce35><p class="text-sm font-medium text-[#2D3748] mb-2" data-v-2464ce35>üìã Resumen del Bono:</p><div class="text-sm text-cafe/80 space-y-1" data-v-2464ce35><p data-v-2464ce35>‚Ä¢ <strong data-v-2464ce35>Tipo:</strong> ${r.ssrInterpolate(l.value)}</p><p data-v-2464ce35>‚Ä¢ <strong data-v-2464ce35>Sesiones:</strong> ${r.ssrInterpolate(n.value)}</p><p data-v-2464ce35>‚Ä¢ <strong data-v-2464ce35>Total:</strong> ‚Ç¨${r.ssrInterpolate(s.value.bono_monto.toFixed(2))}</p><p data-v-2464ce35>‚Ä¢ <strong data-v-2464ce35>Por sesi√≥n:</strong> ‚Ç¨${r.ssrInterpolate(d.value)}</p>`),s.value.bono_renovacion_automatica?o('<p class="text-purple-700" data-v-2464ce35>‚Ä¢ ‚úÖ Con renovaci√≥n autom√°tica</p>'):o("\x3c!----\x3e"),o("</div></div>")):o("\x3c!----\x3e"),o("</div>")):o("\x3c!----\x3e"),o("</div>"),c.value?o(`<div class="bg-red-50 border border-red-200 rounded-lg p-4" data-v-2464ce35><p class="text-sm text-red-600" data-v-2464ce35>${r.ssrInterpolate(c.value)}</p></div>`):o("\x3c!----\x3e"),o(`<div class="flex justify-end gap-3 pt-4 border-t border-[#5550F2]/30" data-v-2464ce35><button type="button"${r.ssrIncludeBooleanAttr(i.value)?" disabled":""} class="px-6 py-2 border border-[#5550F2] text-[#2D3748] rounded-lg hover:bg-[#5550F2]/10 transition-colors disabled:opacity-50 disabled:cursor-not-allowed" data-v-2464ce35> Cancelar </button><button type="submit"${r.ssrIncludeBooleanAttr(i.value)?" disabled":""} class="px-6 py-2 bg-[#5550F2] text-white rounded-lg hover:bg-[#C69F91] transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2" data-v-2464ce35>`),i.value?o('<span class="inline-block w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin" data-v-2464ce35></span>'):o("\x3c!----\x3e"),o(` ${r.ssrInterpolate(i.value?"Actualizando...":"Guardar Cambios")}</button></div></form></div></div>`)):o("\x3c!----\x3e")}}},q=P.setup;P.setup=(e,a)=>{const r=t.useSSRContext();return(r.modules||(r.modules=new Set)).add("components/ModalEditarPaciente.vue"),q?q(e,a):void 0};const j=o(P,[["__scopeId","data-v-2464ce35"]]),M={__name:"ModalEliminarPaciente",__ssrInlineRender:!0,props:{mostrar:{type:Boolean,default:!1},paciente:{type:Object,default:null}},emits:["cerrar","paciente-eliminado","paciente-desactivado"],setup(e,{emit:a}){const o=e;f();const s=t.ref(!1),n=t.ref(""),l=t.computed(()=>o.paciente?o.paciente.nombre_completo||o.paciente.nombre||o.paciente.email||"este paciente":"");return(a,o,d,i)=>{e.mostrar?(o(`<div${r.ssrRenderAttrs(t.mergeProps({class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"},i))} data-v-941153fc><div class="bg-[#F2F2F2] rounded-lg shadow-xl max-w-md w-full" data-v-941153fc><div class="px-6 py-4 border-b border-[#5550F2]/30" data-v-941153fc><div class="flex items-center gap-3" data-v-941153fc><span class="text-3xl" data-v-941153fc>‚ö†Ô∏è</span><h2 class="text-2xl font-serif text-[#2D3748] font-semibold" data-v-941153fc> Eliminar Paciente </h2></div></div><div class="px-6 py-6 space-y-4" data-v-941153fc><p class="text-[#2D3748]" data-v-941153fc> ¬øEst√°s seguro de que deseas eliminar a <strong class="font-semibold" data-v-941153fc>${r.ssrInterpolate(l.value)}</strong>? </p><div class="bg-red-50 border border-red-200 rounded-lg p-4 space-y-2" data-v-941153fc><p class="text-sm text-red-800 font-medium" data-v-941153fc> Esta acci√≥n no se puede deshacer y eliminar√°: </p><ul class="text-sm text-red-700 space-y-1 ml-4 list-disc" data-v-941153fc><li data-v-941153fc>Todos los datos personales del paciente</li><li data-v-941153fc>El historial de sesiones</li><li data-v-941153fc>Las notas terap√©uticas</li><li data-v-941153fc>Las m√©tricas de bienestar</li><li data-v-941153fc>Los bonos asociados</li></ul></div><div class="bg-blue-50 border border-blue-200 rounded-lg p-4" data-v-941153fc><p class="text-sm text-blue-800 font-medium mb-2" data-v-941153fc> üí° Recomendaci√≥n: </p><p class="text-sm text-blue-700 mb-3" data-v-941153fc> En lugar de eliminar, considera <strong data-v-941153fc>desactivar</strong> al paciente. Esto preservar√° el historial para consultas futuras. </p><button type="button"${r.ssrIncludeBooleanAttr(s.value)?" disabled":""} class="w-full px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed text-sm" data-v-941153fc> Desactivar en lugar de eliminar </button></div>`),n.value?o(`<div class="bg-red-50 border border-red-200 rounded-lg p-3" data-v-941153fc><p class="text-sm text-red-600" data-v-941153fc>${r.ssrInterpolate(n.value)}</p></div>`):o("\x3c!----\x3e"),o(`</div><div class="px-6 py-4 border-t border-[#5550F2]/30 flex justify-end gap-3" data-v-941153fc><button type="button"${r.ssrIncludeBooleanAttr(s.value)?" disabled":""} class="px-6 py-2 border border-[#5550F2] text-[#2D3748] rounded-lg hover:bg-[#5550F2]/10 transition-colors disabled:opacity-50 disabled:cursor-not-allowed" data-v-941153fc> Cancelar </button><button type="button"${r.ssrIncludeBooleanAttr(s.value)?" disabled":""} class="px-6 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2" data-v-941153fc>`),s.value?o('<span class="inline-block w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin" data-v-941153fc></span>'):o("\x3c!----\x3e"),o(` ${r.ssrInterpolate(s.value?"Eliminando...":"Eliminar Definitivamente")}</button></div></div></div>`)):o("\x3c!----\x3e")}}},z=M.setup;M.setup=(e,a)=>{const r=t.useSSRContext();return(r.modules||(r.modules=new Set)).add("components/ModalEliminarPaciente.vue"),z?z(e,a):void 0};const T=o(M,[["__scopeId","data-v-941153fc"]]),V=t.defineComponent({__name:"ModalEditarCita",__ssrInlineRender:!0,props:{isOpen:{type:Boolean},citaId:{}},emits:["close","actualizado"],setup(e,{emit:a}){const o=e,s=g(),{getCitasPorDia:n}=x(),l=t.ref(null),d=t.ref(!1),i=t.ref(!1),c=t.ref(!1),u=t.ref({fecha_cita:"",hora_inicio:"",hora_fin:"",duracion:60,modalidad:"presencial",estado:"pendiente",observaciones:""}),p=t.computed(()=>{if(!u.value.fecha_cita)return"";return new Date(u.value.fecha_cita+"T00:00:00").toLocaleDateString("es-ES",{weekday:"long",day:"numeric",month:"long",year:"numeric"})}),v=t.computed(()=>{const e=new Date,a=[],formatearFecha=e=>e.toISOString().split("T")[0];a.push({label:"Hoy",fecha:formatearFecha(e)});const t=new Date(e);t.setDate(t.getDate()+1),a.push({label:"Ma√±ana",fecha:formatearFecha(t)});const r=["Lun","Mar","Mi√©","Jue","Vie"];let o=new Date(e),s=0;for(;s<5;){o.setDate(o.getDate()+1);const e=o.getDay();e>=1&&e<=5&&(a.push({label:`${r[e-1]} ${o.getDate()}`,fecha:formatearFecha(o)}),s++)}return a}),m=["08:00","08:30","09:00","09:30","10:00","10:30","11:00","11:30","12:00","12:30","13:00","13:30","14:00","14:30","15:00","15:30","16:00","16:30","17:00","17:30","18:00","18:30","19:00","19:30","20:00","20:30","21:00","21:30","22:00"],cargarCita=async()=>{if(console.log("üîç [ModalEditarCita] Cargando cita con ID:",o.citaId),o.citaId)try{d.value=!0;const{data:e,error:a}=await s.from("citas").select("\n        *,\n        paciente:pacientes!citas_paciente_id_fkey (\n          id,\n          nombre_completo,\n          email,\n          telefono\n        )\n      ").eq("id",o.citaId).single();if(a)throw console.error("‚ùå [ModalEditarCita] Error en query:",a),a;console.log("‚úÖ [ModalEditarCita] Cita cargada:",e),e&&(l.value=e,u.value={fecha_cita:e.fecha_cita,hora_inicio:e.hora_inicio?.substring(0,5)||"",hora_fin:e.hora_fin?.substring(0,5)||"",duracion:e.duracion||60,modalidad:e.modalidad||"presencial",estado:e.estado||"pendiente",observaciones:e.observaciones||""},console.log("üìù [ModalEditarCita] Formulario llenado:",u.value))}catch(e){console.error("üí• [ModalEditarCita] Error al cargar cita:",e)}finally{d.value=!1}else console.warn("‚ö†Ô∏è [ModalEditarCita] No hay citaId proporcionado")},horaAMinutos=e=>{if(!e||!e.includes(":"))return 0;const[a,t]=e.split(":").map(Number);return 60*(a||0)+(t||0)};return t.watch(()=>u.value.hora_inicio,e=>{if(e&&u.value.duracion){const[a,t]=e.split(":").map(Number),r=60*(a||0)+(t||0)+u.value.duracion,o=Math.floor(r/60),s=r%60;u.value.hora_fin=`${String(o).padStart(2,"0")}:${String(s).padStart(2,"0")}`}}),t.watch(()=>u.value.duracion,e=>{if(u.value.hora_inicio&&e){const[a,t]=u.value.hora_inicio.split(":").map(Number),r=60*(a||0)+(t||0)+e,o=Math.floor(r/60),s=r%60;u.value.hora_fin=`${String(o).padStart(2,"0")}:${String(s).padStart(2,"0")}`}}),t.watch([()=>u.value.fecha_cita,()=>u.value.hora_inicio,()=>u.value.hora_fin],()=>{(async()=>{if(u.value.fecha_cita&&u.value.hora_inicio&&u.value.hora_fin)try{const e=(await n(u.value.fecha_cita)).filter(e=>"cancelada"!==e.estado&&e.id!==o.citaId),a=u.value.hora_inicio,t=u.value.hora_fin;c.value=e.some(e=>{const r=e.hora_inicio?.substring(0,5),o=e.hora_fin?.substring(0,5),s=horaAMinutos(a),n=horaAMinutos(t),l=horaAMinutos(r),d=horaAMinutos(o);return s>=l&&s<d||n>l&&n<=d||s<=l&&n>=d})}catch(e){console.error("Error al verificar conflicto:",e),c.value=!1}else c.value=!1})()}),t.watch(()=>o.isOpen,e=>{console.log("üëÅÔ∏è [ModalEditarCita] Modal abierto:",e,"citaId:",o.citaId),e&&o.citaId&&cargarCita()}),t.watch(()=>o.citaId,e=>{console.log("üîÑ [ModalEditarCita] citaId cambi√≥ a:",e),o.isOpen&&e&&cargarCita()}),(a,t,o,s)=>{r.ssrRenderTeleport(t,a=>{e.isOpen?(a('<div class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4" data-v-e8361a38><div class="bg-white dark:bg-gray-900 rounded-xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-hidden" data-v-e8361a38><div class="px-6 py-4 border-b border-gray-200 dark:border-gray-800 flex items-center justify-between bg-gradient-to-r from-purple-50 to-pink-50 dark:from-purple-900/20 dark:to-pink-900/20" data-v-e8361a38><div data-v-e8361a38><h2 class="text-2xl font-bold text-gray-900 dark:text-white" data-v-e8361a38>‚úèÔ∏è Editar Cita</h2>'),l.value?a(`<p class="text-sm text-gray-600 dark:text-gray-400 mt-1" data-v-e8361a38>${r.ssrInterpolate(l.value.paciente?.nombre_completo||l.value.paciente_nombre)}</p>`):a("\x3c!----\x3e"),a('</div><button class="text-gray-400 hover:text-gray-600 dark:hover:text-gray-200 transition-colors" aria-label="Cerrar" data-v-e8361a38><svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" data-v-e8361a38><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" data-v-e8361a38></path></svg></button></div>'),d.value?a('<div class="p-12 flex flex-col items-center justify-center" data-v-e8361a38><div class="w-12 h-12 border-4 border-purple-200 border-t-purple-600 rounded-full animate-spin mb-4" data-v-e8361a38></div><p class="text-gray-600 dark:text-gray-400" data-v-e8361a38>Cargando...</p></div>'):l.value?(a(`<form class="px-6 py-4 overflow-y-auto max-h-[calc(90vh-200px)]" data-v-e8361a38><div class="space-y-6" data-v-e8361a38><div data-v-e8361a38><label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2" data-v-e8361a38> üìÖ Fecha </label><div class="space-y-2" data-v-e8361a38><input${r.ssrRenderAttr("value",u.value.fecha_cita)} type="date" required class="w-full px-4 py-2 border border-gray-300 dark:border-gray-700 rounded-lg focus:ring-2 focus:ring-purple-500 dark:bg-gray-800 dark:text-white cursor-pointer" data-v-e8361a38><div class="flex gap-2 flex-wrap" data-v-e8361a38>\x3c!--[--\x3e`),r.ssrRenderList(v.value,(e,t)=>{a(`<button type="button" class="${r.ssrRenderClass(["text-xs px-3 py-1.5 rounded-lg border transition-all",u.value.fecha_cita===e.fecha?"bg-purple-600 text-white border-purple-600 font-semibold":"bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300 border-gray-300 dark:border-gray-600 hover:border-purple-500 hover:bg-purple-50 dark:hover:bg-purple-900/20"])}" data-v-e8361a38>${r.ssrInterpolate(e.label)}</button>`)}),a(`\x3c!--]--\x3e</div><p class="text-xs text-gray-500 dark:text-gray-400 capitalize" data-v-e8361a38>${r.ssrInterpolate(p.value)}</p></div></div><div class="grid grid-cols-1 md:grid-cols-3 gap-4" data-v-e8361a38><div class="md:col-span-2" data-v-e8361a38><label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2" data-v-e8361a38> üïê Hora Inicio </label><div class="space-y-3" data-v-e8361a38><div class="grid grid-cols-4 sm:grid-cols-6 gap-2 max-h-48 overflow-y-auto p-3 bg-gray-50 dark:bg-gray-800/50 rounded-lg border border-gray-200 dark:border-gray-700" data-v-e8361a38>\x3c!--[--\x3e`),r.ssrRenderList(m,e=>{a(`<button type="button" class="${r.ssrRenderClass(["px-3 py-2 text-sm font-medium rounded-lg transition-all border-2",u.value.hora_inicio===e?"bg-purple-600 text-white border-purple-600 shadow-md transform scale-105":"bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300 border-gray-200 dark:border-gray-600 hover:border-purple-500 hover:bg-purple-50 dark:hover:bg-purple-900/20 hover:shadow"])}" data-v-e8361a38>${r.ssrInterpolate(e)}</button>`)}),a(`\x3c!--]--\x3e</div><details class="text-xs" data-v-e8361a38><summary class="cursor-pointer text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200 select-none flex items-center gap-1" data-v-e8361a38><span data-v-e8361a38>‚å®Ô∏è</span><span data-v-e8361a38>Ingresar hora manualmente</span></summary><div class="mt-2" data-v-e8361a38><input${r.ssrRenderAttr("value",u.value.hora_inicio)} type="time" required step="1800" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-700 rounded-lg focus:ring-2 focus:ring-purple-500 dark:bg-gray-800 dark:text-white" data-v-e8361a38></div></details></div></div><div data-v-e8361a38><label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2" data-v-e8361a38> ‚è±Ô∏è Duraci√≥n (min) </label><select class="w-full px-4 py-2 border border-gray-300 dark:border-gray-700 rounded-lg focus:ring-2 focus:ring-purple-500 dark:bg-gray-800 dark:text-white" data-v-e8361a38><option${r.ssrRenderAttr("value",30)} data-v-e8361a38${r.ssrIncludeBooleanAttr(Array.isArray(u.value.duracion)?r.ssrLooseContain(u.value.duracion,30):r.ssrLooseEqual(u.value.duracion,30))?" selected":""}>30 min</option><option${r.ssrRenderAttr("value",45)} data-v-e8361a38${r.ssrIncludeBooleanAttr(Array.isArray(u.value.duracion)?r.ssrLooseContain(u.value.duracion,45):r.ssrLooseEqual(u.value.duracion,45))?" selected":""}>45 min</option><option${r.ssrRenderAttr("value",60)} data-v-e8361a38${r.ssrIncludeBooleanAttr(Array.isArray(u.value.duracion)?r.ssrLooseContain(u.value.duracion,60):r.ssrLooseEqual(u.value.duracion,60))?" selected":""}>60 min</option><option${r.ssrRenderAttr("value",90)} data-v-e8361a38${r.ssrIncludeBooleanAttr(Array.isArray(u.value.duracion)?r.ssrLooseContain(u.value.duracion,90):r.ssrLooseEqual(u.value.duracion,90))?" selected":""}>90 min</option></select></div><div data-v-e8361a38><label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2" data-v-e8361a38> üïë Hora Fin </label><input${r.ssrRenderAttr("value",u.value.hora_fin)} type="time" required readonly step="1800" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-700 rounded-lg bg-gray-50 dark:bg-gray-800 dark:text-white" data-v-e8361a38></div></div>`),c.value?a('<div class="p-4 bg-yellow-50 dark:bg-yellow-900/20 border-2 border-yellow-300 dark:border-yellow-700 rounded-lg" data-v-e8361a38><div class="flex items-start gap-3" data-v-e8361a38><span class="text-2xl" data-v-e8361a38>‚ö†Ô∏è</span><div data-v-e8361a38><div class="font-semibold text-yellow-800 dark:text-yellow-300 mb-1" data-v-e8361a38> Conflicto de Horario </div><div class="text-sm text-yellow-700 dark:text-yellow-400" data-v-e8361a38> Ya existe otra cita en este horario. Por favor, selecciona otro horario. </div></div></div></div>'):a("\x3c!----\x3e"),a('<div data-v-e8361a38><label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2" data-v-e8361a38> üíª Modalidad </label><div class="grid grid-cols-3 gap-3" data-v-e8361a38>\x3c!--[--\x3e'),r.ssrRenderList([{valor:"presencial",icono:"üè•",nombre:"Presencial"},{valor:"online",icono:"üíª",nombre:"Online"},{valor:"telefonica",icono:"üìû",nombre:"Tel√©fono"}],e=>{a(`<button type="button" class="${r.ssrRenderClass(["p-3 border-2 rounded-lg transition-all",u.value.modalidad===e.valor?"border-purple-600 bg-purple-50 dark:bg-purple-900/20":"border-gray-300 dark:border-gray-700 hover:border-purple-400"])}" data-v-e8361a38><div class="text-2xl mb-1" data-v-e8361a38>${r.ssrInterpolate(e.icono)}</div><div class="text-sm font-medium text-gray-900 dark:text-white" data-v-e8361a38>${r.ssrInterpolate(e.nombre)}</div></button>`)}),a('\x3c!--]--\x3e</div></div><div data-v-e8361a38><label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2" data-v-e8361a38> üìä Estado </label><div class="grid grid-cols-2 md:grid-cols-4 gap-3" data-v-e8361a38>\x3c!--[--\x3e'),r.ssrRenderList([{valor:"pendiente",icono:"‚è≥",nombre:"Pendiente"},{valor:"confirmada",icono:"‚úÖ",nombre:"Confirmada"},{valor:"realizada",icono:"‚úì",nombre:"Realizada"},{valor:"cancelada",icono:"‚ùå",nombre:"Cancelada"}],e=>{a(`<button type="button" class="${r.ssrRenderClass(["p-2 border-2 rounded-lg transition-all",u.value.estado===e.valor?"border-purple-600 bg-purple-50 dark:bg-purple-900/20":"border-gray-300 dark:border-gray-700 hover:border-purple-400"])}" data-v-e8361a38><div class="text-xl mb-1" data-v-e8361a38>${r.ssrInterpolate(e.icono)}</div><div class="text-xs font-medium text-gray-900 dark:text-white" data-v-e8361a38>${r.ssrInterpolate(e.nombre)}</div></button>`)}),a(`\x3c!--]--\x3e</div></div><div data-v-e8361a38><label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2" data-v-e8361a38> üìù Observaciones </label><textarea rows="3" placeholder="Notas adicionales sobre la cita..." class="w-full px-4 py-2 border border-gray-300 dark:border-gray-700 rounded-lg focus:ring-2 focus:ring-purple-500 dark:bg-gray-800 dark:text-white" data-v-e8361a38>${r.ssrInterpolate(u.value.observaciones)}</textarea></div></div></form>`)):a("\x3c!----\x3e"),a(`<div class="px-6 py-4 border-t border-gray-200 dark:border-gray-800 flex gap-3 bg-gray-50 dark:bg-gray-800" data-v-e8361a38><button type="button" class="flex-1 px-4 py-2 bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-gray-200 rounded-lg hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors font-medium" data-v-e8361a38> Cancelar </button><button${r.ssrIncludeBooleanAttr(i.value||c.value)?" disabled":""} class="${r.ssrRenderClass(["flex-1 px-4 py-2 rounded-lg font-medium transition-colors",i.value||c.value?"bg-gray-400 dark:bg-gray-600 text-gray-200 cursor-not-allowed":"bg-purple-600 hover:bg-purple-700 text-white"])}" data-v-e8361a38>`),i.value?a("<span data-v-e8361a38>Guardando...</span>"):a("<span data-v-e8361a38>üíæ Guardar Cambios</span>"),a("</button></div></div></div>")):a("\x3c!----\x3e")},"body",!1,o)}}}),N=V.setup;V.setup=(e,a)=>{const r=t.useSSRContext();return(r.modules||(r.modules=new Set)).add("components/ModalEditarCita.vue"),N?N(e,a):void 0};const O=Object.assign(o(V,[["__scopeId","data-v-e8361a38"]]),{__name:"ModalEditarCita"}),H=t.ref([]);let U=0;const useToast=()=>{const addToast=(e,a,t=5e3)=>{const r=++U,o={id:r,type:e,message:a,duration:t};return H.value.push(o),t>0&&setTimeout(()=>{removeToast(r)},t),r},removeToast=e=>{const a=H.value.findIndex(a=>a.id===e);a>-1&&H.value.splice(a,1)};return{toasts:H,addToast:addToast,removeToast:removeToast,success:(e,a)=>addToast("success",e,a),error:(e,a)=>addToast("error",e,a),warning:(e,a)=>addToast("warning",e,a),info:(e,a)=>addToast("info",e,a)}},G={__name:"ToastContainer",__ssrInlineRender:!0,setup(e){const{toasts:a}=useToast(),toastClasses=e=>{const a={success:"border-green-200 bg-green-50 text-green-800",error:"border-red-200 bg-red-50 text-red-800",warning:"border-amber-200 bg-amber-50 text-amber-800",info:"border-blue-200 bg-blue-50 text-blue-800"};return a[e]||a.info};return(e,o,s,n)=>{o(`<div${r.ssrRenderAttrs(t.mergeProps({class:"fixed bottom-4 right-4 z-50 flex flex-col gap-3 max-w-sm w-full pointer-events-none",role:"region","aria-live":"polite","aria-label":"Notificaciones"},n))} data-v-4b6dd325>\x3c!--[--\x3e`),r.ssrRenderList(t.unref(a),e=>{o(`<div class="${r.ssrRenderClass([toastClasses(e.type),"pointer-events-auto bg-white rounded-lg shadow-lg border p-4 flex items-start gap-3 transition-all duration-300"])}" role="alert" data-v-4b6dd325><div class="flex-shrink-0" data-v-4b6dd325>`),"success"===e.type?o(r.ssrRenderComponent(t.unref(l),{class:"w-5 h-5","aria-hidden":"true"},null,s)):"error"===e.type?o(r.ssrRenderComponent(t.unref(p),{class:"w-5 h-5","aria-hidden":"true"},null,s)):"warning"===e.type?o(r.ssrRenderComponent(t.unref(u),{class:"w-5 h-5","aria-hidden":"true"},null,s)):o(r.ssrRenderComponent(t.unref(h),{class:"w-5 h-5","aria-hidden":"true"},null,s)),o(`</div><p class="text-sm font-medium flex-1" data-v-4b6dd325>${r.ssrInterpolate(e.message)}</p><button class="min-h-[44px] min-w-[44px] p-2 -mr-2 -mt-2 hover:bg-gray-100 rounded-lg transition-colors focus:outline-none focus:ring-2 focus:ring-gray-300"${r.ssrRenderAttr("aria-label",`Cerrar notificaci√≥n: ${e.message}`)} data-v-4b6dd325>`),o(r.ssrRenderComponent(t.unref(y),{class:"w-4 h-4","aria-hidden":"true"},null,s)),o("</button></div>")}),o("\x3c!--]--\x3e</div>")}}},Q=G.setup;G.setup=(e,a)=>{const r=t.useSSRContext();return(r.modules||(r.modules=new Set)).add("components/ToastContainer.vue"),Q?Q(e,a):void 0};const X=o(G,[["__scopeId","data-v-4b6dd325"]]),Y=t.defineComponent({__name:"FileDropzone",__ssrInlineRender:!0,props:{accept:{default:".csv,.xlsx,.xls"},maxSize:{default:10485760},supportedFormats:{default:"CSV, XLSX"},ariaLabel:{default:"Seleccionar archivo para subir"}},emits:["file-selected","file-removed","error"],setup(e,{expose:a,emit:o}){const s=e,n=o,l=t.ref(null),d=t.ref(!1),i=t.ref(""),c=t.computed(()=>!!i.value),u=t.computed(()=>Math.round(s.maxSize/1048576));return a({removeFile:()=>{l.value=null,i.value="",n("file-removed")}}),(a,o,s,n)=>{o(`<div${r.ssrRenderAttrs(t.mergeProps({class:["relative border-2 border-dashed rounded-xl p-8 transition-all duration-200 text-center",[t.unref(d)?"border-purple-600 bg-purple-50":"border-gray-300 bg-gray-50",t.unref(c)?"border-red-400 bg-red-50":"",t.unref(l)?"border-green-400 bg-green-50":""]]},n))}><div class="mb-4">`),t.unref(l)?o(r.ssrRenderComponent(t.unref(C),{class:"w-12 h-12 mx-auto text-green-600","aria-hidden":"true"},null,s)):o(r.ssrRenderComponent(t.unref(w),{class:["w-12 h-12 mx-auto",t.unref(d)?"text-purple-600":"text-gray-400"],"aria-hidden":"true"},null,s)),o("</div>"),t.unref(l)?(o(`<div class="flex items-center justify-center gap-4"><div class="text-left flex-1"><p class="text-sm font-semibold text-cafe">${r.ssrInterpolate(t.unref(l).name)}</p><p class="text-xs text-gray-500">${r.ssrInterpolate((e=>{if(0===e)return"0 Bytes";const a=Math.floor(Math.log(e)/Math.log(1024));return Math.round(e/Math.pow(1024,a)*100)/100+" "+["Bytes","KB","MB","GB"][a]})(t.unref(l).size))}</p></div><button class="min-h-[44px] min-w-[44px] p-2 text-red-600 hover:bg-red-100 rounded-lg transition-colors focus:outline-none focus:ring-2 focus:ring-red-300" aria-label="Eliminar archivo">`),o(r.ssrRenderComponent(t.unref(y),{class:"w-6 h-6","aria-hidden":"true"},null,s)),o("</button></div>")):(o('<div><p class="text-lg font-medium text-cafe mb-2"> Arrastra tu archivo aqu√≠ </p><p class="text-sm text-gray-500 mb-4"> o haz clic para seleccionar </p><label class="inline-block"><span class="min-h-[44px] px-6 py-3 bg-purple-600 text-white rounded-lg hover:bg-purple-600/90 transition-all font-medium shadow-sm hover:shadow-md cursor-pointer inline-flex items-center gap-2">'),o(r.ssrRenderComponent(t.unref(render),{class:"w-5 h-5","aria-hidden":"true"},null,s)),o(`<span>Seleccionar archivo</span></span><input type="file"${r.ssrRenderAttr("accept",e.accept)} class="hidden"${r.ssrRenderAttr("aria-label",e.ariaLabel)}></label><p class="text-xs text-gray-400 mt-4">${r.ssrInterpolate(e.supportedFormats)}</p><p class="text-xs text-gray-400"> Tama√±o m√°ximo: ${r.ssrInterpolate(t.unref(u))}MB </p></div>`)),t.unref(i)?o(`<div class="mt-4 p-3 bg-red-100 border border-red-300 rounded-lg"><p class="text-sm text-red-800 font-medium">${r.ssrInterpolate(t.unref(i))}</p></div>`):o("\x3c!----\x3e"),o("</div>")}}}),J=Y.setup;Y.setup=(e,a)=>{const r=t.useSSRContext();return(r.modules||(r.modules=new Set)).add("components/shared/FileDropzone.vue"),J?J(e,a):void 0};const Z=Object.assign(Y,{__name:"SharedFileDropzone"}),W=t.defineComponent({__name:"ColumnMappingTable",__ssrInlineRender:!0,props:{detectedColumns:{},mappings:{},validation:{}},emits:["update:mapping"],setup(e,{emit:a}){const o=e,s=[{field:"nombre_completo",label:"Nombre Completo"},{field:"email",label:"Email"},{field:"telefono",label:"Tel√©fono"}],n=[{field:"documento_identidad",label:"Documento de Identidad"},{field:"fecha_nacimiento",label:"Fecha de Nacimiento"},{field:"direccion",label:"Direcci√≥n"},{field:"contacto_emergencia",label:"Contacto de Emergencia"}],d=[{field:"area_de_acompanamiento",label:"√Årea de Acompa√±amiento"},{field:"frecuencia",label:"Frecuencia de Sesiones"},{field:"activo",label:"Estado (Activo/Inactivo)"},{field:"derivacion",label:"Derivaci√≥n"},{field:"medicacion",label:"Medicaci√≥n"},{field:"orientacion_diagnostica",label:"Orientaci√≥n Diagn√≥stica"},{field:"inicio_tratamiento",label:"Inicio del Tratamiento"}],i=[{field:"precio_sesion",label:"Precio por Sesi√≥n"},{field:"comision",label:"Comisi√≥n"},{field:"notas",label:"Notas / Observaciones"}],c=[...s,...n,...d,...i],getMappedField=e=>{const a=o.mappings.find(a=>a.sourceColumn===e);return a?.targetField||""},isFieldUsed=(e,a)=>o.mappings.some(t=>t.targetField===e&&t.sourceColumn!==a),isRequiredField=e=>s.some(a=>a.field===e),v=t.computed(()=>o.mappings.filter(e=>e.targetField).map(e=>e.targetField)),m=t.computed(()=>{if(!o.detectedColumns.length||!v.value.length)return[];const e=Math.min(o.detectedColumns[0]?.sampleValues?.length||0,3),a=[];for(let t=0;t<e;t++){const e={};for(const a of o.mappings)if(a.targetField){const r=o.detectedColumns.find(e=>e.name===a.sourceColumn);e[a.targetField]=r?.sampleValues?.[t]||""}Object.keys(e).length>0&&a.push(e)}return a});return(a,o,f,b)=>{o(`<div${r.ssrRenderAttrs(t.mergeProps({class:"space-y-6"},b))}><div class="bg-blue-50 border border-blue-200 rounded-lg p-4"><div class="flex gap-3">`),o(r.ssrRenderComponent(t.unref(h),{class:"w-5 h-5 text-blue-600 flex-shrink-0 mt-0.5"},null,f)),o('<div><p class="font-semibold text-blue-900 mb-1"> Relaciona las columnas de tu archivo con los campos de Terapl√≠ </p><p class="text-sm text-blue-800"> Hemos detectado autom√°ticamente algunos campos. Revisa y ajusta seg√∫n necesites. </p></div></div></div><div class="overflow-x-auto border border-gray-200 rounded-lg"><table class="w-full text-sm"><thead class="bg-gray-50"><tr><th class="px-4 py-3 text-left font-semibold text-gray-700"> Columna en tu archivo </th><th class="px-4 py-3 text-left font-semibold text-gray-700"> Valores de ejemplo </th><th class="px-4 py-3 text-left font-semibold text-gray-700"> Campo Terapl√≠ </th><th class="px-4 py-3 text-center font-semibold text-gray-700 w-24"> Estado </th></tr></thead><tbody class="divide-y divide-gray-200">\x3c!--[--\x3e'),r.ssrRenderList(e.detectedColumns,e=>{o(`<tr class="hover:bg-gray-50"><td class="px-4 py-3"><span class="font-medium text-gray-900">${r.ssrInterpolate(e.name)}</span></td><td class="px-4 py-3"><div class="flex flex-wrap gap-1 max-w-xs">\x3c!--[--\x3e`),r.ssrRenderList(e.sampleValues.slice(0,3),(e,a)=>{o(`<span class="inline-block px-2 py-0.5 bg-gray-100 text-gray-600 rounded text-xs truncate max-w-[120px]"${r.ssrRenderAttr("title",e)}>${r.ssrInterpolate(e||"(vac√≠o)")}</span>`)}),o(`\x3c!--]--\x3e</div></td><td class="px-4 py-3"><select${r.ssrRenderAttr("value",getMappedField(e.name))} class="${r.ssrRenderClass([{"border-green-400 bg-green-50":getMappedField(e.name)&&isRequiredField(getMappedField(e.name)),"border-blue-300 bg-blue-50":getMappedField(e.name)&&!isRequiredField(getMappedField(e.name))},"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-purple-500 focus:border-purple-500"])}"><option value="">-- No importar --</option><optgroup label="Campos obligatorios">\x3c!--[--\x3e`),r.ssrRenderList(s,a=>{o(`<option${r.ssrRenderAttr("value",a.field)}${r.ssrIncludeBooleanAttr(isFieldUsed(a.field,e.name))?" disabled":""}>${r.ssrInterpolate(a.label)} ${r.ssrInterpolate(isFieldUsed(a.field,e.name)?"(ya usado)":"*")}</option>`)}),o('\x3c!--]--\x3e</optgroup><optgroup label="Contacto">\x3c!--[--\x3e'),r.ssrRenderList(n,a=>{o(`<option${r.ssrRenderAttr("value",a.field)}${r.ssrIncludeBooleanAttr(isFieldUsed(a.field,e.name))?" disabled":""}>${r.ssrInterpolate(a.label)} ${r.ssrInterpolate(isFieldUsed(a.field,e.name)?"(ya usado)":"")}</option>`)}),o('\x3c!--]--\x3e</optgroup><optgroup label="Tratamiento">\x3c!--[--\x3e'),r.ssrRenderList(d,a=>{o(`<option${r.ssrRenderAttr("value",a.field)}${r.ssrIncludeBooleanAttr(isFieldUsed(a.field,e.name))?" disabled":""}>${r.ssrInterpolate(a.label)} ${r.ssrInterpolate(isFieldUsed(a.field,e.name)?"(ya usado)":"")}</option>`)}),o('\x3c!--]--\x3e</optgroup><optgroup label="Otros campos">\x3c!--[--\x3e'),r.ssrRenderList(i,a=>{o(`<option${r.ssrRenderAttr("value",a.field)}${r.ssrIncludeBooleanAttr(isFieldUsed(a.field,e.name))?" disabled":""}>${r.ssrInterpolate(a.label)} ${r.ssrInterpolate(isFieldUsed(a.field,e.name)?"(ya usado)":"")}</option>`)}),o('\x3c!--]--\x3e</optgroup></select></td><td class="px-4 py-3 text-center">'),getMappedField(e.name)&&isRequiredField(getMappedField(e.name))?(o('<span class="inline-flex items-center gap-1 px-2 py-1 bg-green-100 text-green-700 rounded-full text-xs font-medium">'),o(r.ssrRenderComponent(t.unref(l),{class:"w-3.5 h-3.5"},null,f)),o(" Obligatorio </span>")):getMappedField(e.name)?(o('<span class="inline-flex items-center gap-1 px-2 py-1 bg-blue-100 text-blue-700 rounded-full text-xs font-medium">'),o(r.ssrRenderComponent(t.unref(l),{class:"w-3.5 h-3.5"},null,f)),o(" Opcional </span>")):o('<span class="inline-flex items-center gap-1 px-2 py-1 bg-gray-100 text-gray-500 rounded-full text-xs"> No importar </span>'),o("</td></tr>")}),o("\x3c!--]--\x3e</tbody></table></div>"),e.validation?.errors?.length?(o('<div class="bg-red-50 border border-red-200 rounded-lg p-4"><div class="flex gap-3">'),o(r.ssrRenderComponent(t.unref(u),{class:"w-5 h-5 text-red-600 flex-shrink-0 mt-0.5"},null,f)),o('<div><p class="font-semibold text-red-900 mb-2"> Errores que impiden la importaci√≥n: </p><ul class="list-disc list-inside text-red-800 space-y-1 text-sm">\x3c!--[--\x3e'),r.ssrRenderList(e.validation.errors,(e,a)=>{o(`<li>${r.ssrInterpolate(e)}</li>`)}),o("\x3c!--]--\x3e</ul></div></div></div>")):o("\x3c!----\x3e"),e.validation?.warnings?.length&&!e.validation?.errors?.length?(o('<div class="bg-amber-50 border border-amber-200 rounded-lg p-4"><div class="flex gap-3">'),o(r.ssrRenderComponent(t.unref(p),{class:"w-5 h-5 text-amber-600 flex-shrink-0 mt-0.5"},null,f)),o('<div><p class="font-semibold text-amber-900 mb-2"> Advertencias (puedes continuar): </p><ul class="list-disc list-inside text-amber-800 space-y-1 text-sm">\x3c!--[--\x3e'),r.ssrRenderList(e.validation.warnings,(e,a)=>{o(`<li>${r.ssrInterpolate(e)}</li>`)}),o("\x3c!--]--\x3e</ul></div></div></div>")):o("\x3c!----\x3e"),t.unref(m).length>0?(o('<div class="space-y-3"><h4 class="font-semibold text-gray-900 flex items-center gap-2">'),o(r.ssrRenderComponent(t.unref($),{class:"w-5 h-5 text-purple-600"},null,f)),o(' Vista previa con el mapeo aplicado </h4><div class="overflow-x-auto border border-gray-200 rounded-lg"><table class="w-full text-sm"><thead class="bg-purple-50"><tr>\x3c!--[--\x3e'),r.ssrRenderList(t.unref(v),e=>{o(`<th class="px-3 py-2 text-left font-medium text-purple-800 whitespace-nowrap">${r.ssrInterpolate((e=>c.find(a=>a.field===e)?.label||e)(e))}</th>`)}),o('\x3c!--]--\x3e</tr></thead><tbody class="divide-y divide-gray-100">\x3c!--[--\x3e'),r.ssrRenderList(t.unref(m),(e,a)=>{o('<tr class="hover:bg-gray-50">\x3c!--[--\x3e'),r.ssrRenderList(t.unref(v),a=>{o(`<td class="px-3 py-2 text-gray-700 whitespace-nowrap">${r.ssrInterpolate(e[a]||"‚Äî")}</td>`)}),o("\x3c!--]--\x3e</tr>")}),o(`\x3c!--]--\x3e</tbody></table></div><p class="text-xs text-gray-500"> Mostrando las primeras ${r.ssrInterpolate(t.unref(m).length)} fila${r.ssrInterpolate(1!==t.unref(m).length?"s":"")} de tu archivo </p></div>`)):o("\x3c!----\x3e"),o("</div>")}}}),K=W.setup;W.setup=(e,a)=>{const r=t.useSSRContext();return(r.modules||(r.modules=new Set)).add("components/patients/ColumnMappingTable.vue"),K?K(e,a):void 0};const ee=Object.assign(W,{__name:"PatientsColumnMappingTable"});const ae=t.defineComponent({__name:"PatientsImportModal",__ssrInlineRender:!0,props:{modelValue:{type:Boolean},existingPatients:{default:()=>[]}},emits:["update:modelValue","import-complete"],setup(e,{emit:a}){const o=useToast(),s=function(){const e=t.ref(null),a=t.ref([]),r=t.ref(null),o=t.ref(null),s=t.ref(!1),n=t.ref(!1),l=t.ref(!1),d=t.ref(null),validateMapping=async()=>{if(!e.value)return d.value="No hay configuraci√≥n de importaci√≥n",!1;n.value=!0,d.value=null;try{const t=await fetch("/api/patients/import/validate-mapping",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({configId:e.value.id,mappings:a.value})});if(!t.ok){const e=await t.json();throw new Error(e.statusMessage||"Error al validar mapeo")}const o=await t.json();return r.value=o.validation,o.validation?.isValid||!1}catch(e){return d.value=e.message||"Error al validar mapeo",console.error("Error en validateMapping:",e),!1}finally{n.value=!1}},i=t.computed(()=>{const e=new Set(a.value.map(e=>e.targetField).filter(e=>""!==e)),t=e.has("nombre_completo"),r=e.has("email")||e.has("telefono");return t&&r});return{config:e,mappings:a,validation:r,importResult:o,detecting:s,validating:n,importing:l,error:d,detectColumns:async t=>{s.value=!0,d.value=null;try{const r=new FormData;r.append("file",t);const o=await fetch("/api/patients/import/detect-columns",{method:"POST",body:r});if(!o.ok){const e=await o.json();throw new Error(e.statusMessage||"Error al detectar columnas")}const s=await o.json();if(!s.success||!s.config)throw new Error("Respuesta inv√°lida del servidor");return e.value=s.config,a.value=s.config.mappings||[],await validateMapping(),!0}catch(e){return d.value=e.message||"Error al detectar columnas",console.error("Error en detectColumns:",e),!1}finally{s.value=!1}},updateMapping:(e,t)=>{const r=a.value.findIndex(a=>a.sourceColumn===e);r>=0?a.value[r]={sourceColumn:e,targetField:t}:a.value.push({sourceColumn:e,targetField:t}),validateMapping()},validateMapping:validateMapping,executeImport:async(t,s)=>{if(!e.value)return d.value="No hay configuraci√≥n de importaci√≥n",!1;if(!r.value?.isValid)return d.value="El mapeo no es v√°lido",!1;l.value=!0,d.value=null;try{const r=new FormData;r.append("file",t),r.append("configId",e.value.id),r.append("action",s),r.append("mappings",JSON.stringify(a.value));const n=await fetch("/api/patients/import/execute",{method:"POST",body:r});if(!n.ok){const e=await n.json();throw new Error(e.statusMessage||"Error al importar pacientes")}const l=await n.json();return o.value=l.results,l.success}catch(e){return d.value=e.message||"Error al importar pacientes",console.error("Error en executeImport:",e),!1}finally{l.value=!1}},reset:()=>{e.value=null,a.value=[],r.value=null,o.value=null,s.value=!1,n.value=!1,l.value=!1,d.value=null},getMappedField:e=>{const t=a.value.find(a=>a.sourceColumn===e);return t?.targetField||""},getPreviewData:()=>{if(!e.value?.detectedColumns)return[];const t=Math.min(e.value.detectedColumns[0]?.sampleValues?.length||0,3),r=[];for(let o=0;o<t;o++){const t={};for(const r of a.value)if(r.targetField){const a=e.value.detectedColumns.find(e=>e.name===r.sourceColumn);t[r.targetField]=a?.sampleValues?.[o]||""}r.push(t)}return r},hasRequiredFields:i}}(),n=t.ref(1),d=t.ref(null),i=t.ref(!1),c=t.ref(!0),v=t.ref(!1),m={nombre_completo:"Nombre Completo",email:"Email",telefono:"Tel√©fono",documento_identidad:"Documento",fecha_nacimiento:"Fecha Nac.",direccion:"Direcci√≥n",contacto_emergencia:"Contacto Emergencia",area_de_acompanamiento:"√Årea",frecuencia:"Frecuencia",activo:"Estado",derivacion:"Derivaci√≥n",medicacion:"Medicaci√≥n",orientacion_diagnostica:"Diagn√≥stico",inicio_tratamiento:"Inicio Trat.",precio_sesion:"Precio",comision:"Comisi√≥n",notas:"Notas"},getFieldLabel=e=>e?m[e]||e:"";t.computed(()=>null!==d.value||null!==s.config.value||n.value>1);const handleFileSelected=e=>{d.value=e,s.error.value=null,o.info("Archivo seleccionado correctamente")},handleFileRemoved=()=>{d.value=null,s.reset()},handleDropzoneError=e=>{o.error(e)},handleMappingUpdate=(e,a)=>{s.updateMapping(e,a)};return(a,o,m,f)=>{const b=Z,x=ee;r.ssrRenderTeleport(o,a=>{e.modelValue?(a(`<div class="fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50" role="dialog" aria-modal="true" aria-labelledby="import-modal-title" data-v-97261e0d><div class="bg-white rounded-xl shadow-2xl max-w-4xl w-full max-h-[90vh] overflow-hidden flex flex-col" data-v-97261e0d><div class="px-6 py-4 border-b border-gray-200 flex items-center justify-between" data-v-97261e0d><div data-v-97261e0d><h2 id="import-modal-title" class="text-2xl font-serif font-bold text-cafe" data-v-97261e0d> Importar Pacientes </h2><p class="text-sm text-gray-500 mt-1" data-v-97261e0d> Paso ${r.ssrInterpolate(t.unref(n))} de 5 </p></div><button class="min-h-[44px] min-w-[44px] p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors focus:outline-none focus:ring-2 focus:ring-gray-300" aria-label="Cerrar modal" data-v-97261e0d>`),a(r.ssrRenderComponent(t.unref(y),{class:"w-6 h-6","aria-hidden":"true"},null,m)),a('</button></div><div class="px-6 py-3 bg-gray-50" data-v-97261e0d><div class="flex items-center gap-2" data-v-97261e0d>\x3c!--[--\x3e'),r.ssrRenderList(5,e=>{a(`<div class="${r.ssrRenderClass([e<=t.unref(n)?"bg-purple-600":"bg-gray-200","flex-1 h-2 rounded-full transition-all duration-300"])}" data-v-97261e0d></div>`)}),a(`\x3c!--]--\x3e</div><div class="flex justify-between mt-2 text-xs text-gray-500" data-v-97261e0d><span class="${r.ssrRenderClass({"text-purple-600 font-medium":1===t.unref(n)})}" data-v-97261e0d>Info</span><span class="${r.ssrRenderClass({"text-purple-600 font-medium":2===t.unref(n)})}" data-v-97261e0d>Subir</span><span class="${r.ssrRenderClass({"text-purple-600 font-medium":3===t.unref(n)})}" data-v-97261e0d>Mapear</span><span class="${r.ssrRenderClass({"text-purple-600 font-medium":4===t.unref(n)})}" data-v-97261e0d>Revisar</span><span class="${r.ssrRenderClass({"text-purple-600 font-medium":5===t.unref(n)})}" data-v-97261e0d>Resultado</span></div></div><div class="flex-1 overflow-y-auto p-6" data-v-97261e0d>`),1===t.unref(n)?(a('<div class="space-y-6" data-v-97261e0d><div class="text-center" data-v-97261e0d>'),a(r.ssrRenderComponent(t.unref(render$1),{class:"w-16 h-16 mx-auto text-purple-600 mb-4","aria-hidden":"true"},null,m)),a('<h3 class="text-lg font-semibold text-cafe mb-2" data-v-97261e0d> Paso 1: Prepara tu archivo </h3><p class="text-sm text-gray-600 mb-2 max-w-md mx-auto" data-v-97261e0d> Puedes usar <strong data-v-97261e0d>cualquier Excel o CSV</strong> con tus pacientes. El sistema detectar√° las columnas autom√°ticamente. </p></div><div class="bg-green-50 border border-green-200 rounded-lg p-4 text-sm" data-v-97261e0d><div class="flex gap-3" data-v-97261e0d>'),a(r.ssrRenderComponent(t.unref(l),{class:"w-5 h-5 text-green-600 flex-shrink-0 mt-0.5","aria-hidden":"true"},null,m)),a('<div data-v-97261e0d><p class="font-semibold text-green-900 mb-2" data-v-97261e0d>¬øYa tienes un Excel con pacientes?</p><p class="text-green-800" data-v-97261e0d> ¬°Perfecto! Puedes subirlo directamente. En el siguiente paso podr√°s relacionar las columnas de tu archivo con los campos de Terapl√≠. </p></div></div></div><div class="bg-blue-50 border border-blue-200 rounded-lg p-4 text-sm" data-v-97261e0d><div class="flex gap-3" data-v-97261e0d>'),a(r.ssrRenderComponent(t.unref(h),{class:"w-5 h-5 text-blue-600 flex-shrink-0 mt-0.5","aria-hidden":"true"},null,m)),a(`<div class="space-y-3" data-v-97261e0d><div data-v-97261e0d><p class="font-semibold text-blue-900 mb-1" data-v-97261e0d>Formatos aceptados:</p><p class="text-blue-800" data-v-97261e0d>CSV (.csv) y Excel (.xlsx, .xls)</p><p class="text-xs text-blue-700 mt-1" data-v-97261e0d>Tama√±o m√°ximo: 10MB | M√°ximo 5,000 filas</p></div><div data-v-97261e0d><p class="font-semibold text-blue-900 mb-1" data-v-97261e0d>Campos m√≠nimos necesarios:</p><ul class="list-disc list-inside text-blue-800 space-y-1" data-v-97261e0d><li data-v-97261e0d><strong data-v-97261e0d>Nombre</strong> del paciente (obligatorio)</li><li data-v-97261e0d><strong data-v-97261e0d>Email</strong> o <strong data-v-97261e0d>Tel√©fono</strong> (al menos uno)</li></ul></div><div data-v-97261e0d><p class="font-semibold text-blue-900 mb-1" data-v-97261e0d>Campos adicionales soportados:</p><p class="text-blue-800 text-xs" data-v-97261e0d> Documento de identidad, Direcci√≥n, Fecha de nacimiento, √Årea de tratamiento, Frecuencia, Derivaci√≥n, Medicaci√≥n, Diagn√≥stico, Notas, Precio, y m√°s... </p></div></div></div></div><div class="flex gap-3 justify-center pt-2" data-v-97261e0d><button${r.ssrIncludeBooleanAttr(t.unref(i))?" disabled":""} class="min-h-[44px] px-4 py-2 bg-white border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-all text-sm disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2" data-v-97261e0d>`),a(r.ssrRenderComponent(t.unref(C),{class:"w-4 h-4","aria-hidden":"true"},null,m)),a(`<span data-v-97261e0d>Descargar plantilla CSV</span></button><button${r.ssrIncludeBooleanAttr(t.unref(i))?" disabled":""} class="min-h-[44px] px-4 py-2 bg-white border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-all text-sm disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2" data-v-97261e0d>`),a(r.ssrRenderComponent(t.unref(C),{class:"w-4 h-4","aria-hidden":"true"},null,m)),a("<span data-v-97261e0d>Descargar plantilla Excel</span></button></div></div>")):a("\x3c!----\x3e"),2===t.unref(n)?(a('<div class="space-y-6" data-v-97261e0d><div class="text-center mb-6" data-v-97261e0d>'),a(r.ssrRenderComponent(t.unref(w),{class:"w-16 h-16 mx-auto text-purple-600 mb-4","aria-hidden":"true"},null,m)),a('<h3 class="text-lg font-semibold text-cafe mb-2" data-v-97261e0d> Paso 2: Sube tu archivo </h3><p class="text-sm text-gray-600 mb-1" data-v-97261e0d> Arrastra tu archivo o haz clic para seleccionarlo </p><p class="text-xs text-gray-500" data-v-97261e0d> Detectaremos las columnas autom√°ticamente </p></div>'),a(r.ssrRenderComponent(b,{onFileSelected:handleFileSelected,onFileRemoved:handleFileRemoved,onError:handleDropzoneError},null,m)),t.unref(d)&&!t.unref(s).detecting.value?(a('<div class="bg-green-50 border border-green-200 rounded-lg p-4 text-sm" data-v-97261e0d><div class="flex gap-3" data-v-97261e0d>'),a(r.ssrRenderComponent(t.unref(l),{class:"w-5 h-5 text-green-600 flex-shrink-0 mt-0.5","aria-hidden":"true"},null,m)),a(`<div class="flex-1" data-v-97261e0d><p class="font-semibold text-green-900 mb-1" data-v-97261e0d>Archivo seleccionado correctamente</p><p class="text-green-800" data-v-97261e0d>${r.ssrInterpolate(t.unref(d).name)}</p><p class="text-xs text-green-700 mt-1" data-v-97261e0d> Haz clic en &quot;Detectar columnas&quot; para continuar </p></div></div></div>`)):a("\x3c!----\x3e"),t.unref(s).detecting.value?a('<div class="bg-purple-50 border border-purple-200 rounded-lg p-6" data-v-97261e0d><div class="flex flex-col items-center justify-center gap-4" data-v-97261e0d><div class="animate-spin w-12 h-12 border-4 border-purple-600 border-t-transparent rounded-full" data-v-97261e0d></div><div class="text-center" data-v-97261e0d><p class="text-purple-900 font-medium mb-1" data-v-97261e0d>Analizando archivo...</p><p class="text-sm text-purple-700" data-v-97261e0d>Detectando columnas y sugiriendo mapeo</p></div></div></div>'):a("\x3c!----\x3e"),t.unref(s).error.value?(a('<div class="bg-red-50 border border-red-200 rounded-lg p-4 text-sm" data-v-97261e0d><div class="flex gap-3" data-v-97261e0d>'),a(r.ssrRenderComponent(t.unref(u),{class:"w-5 h-5 text-red-600 flex-shrink-0 mt-0.5","aria-hidden":"true"},null,m)),a(`<div data-v-97261e0d><p class="font-semibold text-red-900 mb-1" data-v-97261e0d>Error al procesar archivo</p><p class="text-red-800" data-v-97261e0d>${r.ssrInterpolate(t.unref(s).error.value)}</p></div></div></div>`)):a("\x3c!----\x3e"),a("</div>")):a("\x3c!----\x3e"),3===t.unref(n)?(a('<div class="space-y-6" data-v-97261e0d><div class="text-center mb-6" data-v-97261e0d>'),a(r.ssrRenderComponent(t.unref(render$3),{class:"w-16 h-16 mx-auto text-purple-600 mb-4","aria-hidden":"true"},null,m)),a('<h3 class="text-lg font-semibold text-cafe mb-2" data-v-97261e0d> Paso 3: Mapea las columnas </h3><p class="text-sm text-gray-600" data-v-97261e0d> Relaciona las columnas de tu archivo con los campos de Terapl√≠ </p></div>'),a(r.ssrRenderComponent(x,{"detected-columns":t.unref(s).config.value?.detectedColumns||[],mappings:t.unref(s).mappings.value,validation:t.unref(s).validation.value,"onUpdate:mapping":handleMappingUpdate},null,m)),a("</div>")):a("\x3c!----\x3e"),4===t.unref(n)?(a('<div class="space-y-6" data-v-97261e0d><div class="text-center mb-6" data-v-97261e0d>'),a(r.ssrRenderComponent(t.unref(render$2),{class:"w-16 h-16 mx-auto text-purple-600 mb-4","aria-hidden":"true"},null,m)),a('<h3 class="text-lg font-semibold text-cafe mb-2" data-v-97261e0d> Paso 4: Confirma la importaci√≥n </h3><p class="text-sm text-gray-600" data-v-97261e0d> Revisa el resumen antes de importar </p></div><div class="bg-gray-50 border border-gray-200 rounded-lg p-4" data-v-97261e0d><h4 class="font-semibold text-gray-900 mb-3" data-v-97261e0d>Campos que se importar√°n:</h4><div class="flex flex-wrap gap-2" data-v-97261e0d>\x3c!--[--\x3e'),r.ssrRenderList(t.unref(s).mappings.value.filter(e=>e.targetField),e=>{a('<span class="inline-flex items-center gap-1 px-3 py-1 bg-purple-100 text-purple-800 rounded-full text-sm" data-v-97261e0d>'),a(r.ssrRenderComponent(t.unref(l),{class:"w-4 h-4"},null,m)),a(` ${r.ssrInterpolate(getFieldLabel(e.targetField))}</span>`)}),a("\x3c!--]--\x3e</div></div>"),t.unref(s).validation.value?.warnings?.length?(a('<div class="bg-amber-50 border border-amber-200 rounded-lg p-4" data-v-97261e0d><div class="flex gap-3" data-v-97261e0d>'),a(r.ssrRenderComponent(t.unref(p),{class:"w-5 h-5 text-amber-600 flex-shrink-0 mt-0.5","aria-hidden":"true"},null,m)),a('<div data-v-97261e0d><p class="font-semibold text-amber-900 mb-2" data-v-97261e0d>Advertencias:</p><ul class="text-sm text-amber-800 space-y-1" data-v-97261e0d>\x3c!--[--\x3e'),r.ssrRenderList(t.unref(s).validation.value.warnings,(e,t)=>{a(`<li data-v-97261e0d> ‚Ä¢ ${r.ssrInterpolate(e)}</li>`)}),a("\x3c!--]--\x3e</ul></div></div></div>")):a("\x3c!----\x3e"),a(`<div class="bg-blue-50 border border-blue-200 rounded-lg p-4" data-v-97261e0d><label class="flex items-start gap-3 cursor-pointer" data-v-97261e0d><input type="checkbox"${r.ssrIncludeBooleanAttr(Array.isArray(t.unref(c))?r.ssrLooseContain(t.unref(c),null):t.unref(c))?" checked":""} class="mt-1 w-5 h-5 text-purple-600 border-gray-300 rounded focus:ring-2 focus:ring-purple-300 cursor-pointer" data-v-97261e0d><div class="flex-1" data-v-97261e0d><p class="font-semibold text-blue-900 mb-1" data-v-97261e0d> Actualizar pacientes existentes </p><p class="text-sm text-blue-800" data-v-97261e0d> Si un paciente ya existe (mismo email o tel√©fono), actualizar sus datos con la informaci√≥n del archivo. </p><p class="text-xs text-blue-700 mt-1" data-v-97261e0d> Si no marcas esta opci√≥n, los pacientes duplicados se omitir√°n. </p></div></label></div>`),t.unref(s).getPreviewData().length>0?(a('<div class="space-y-3" data-v-97261e0d><h4 class="font-semibold text-gray-900" data-v-97261e0d>Vista previa de datos:</h4><div class="overflow-x-auto border border-gray-200 rounded-lg" data-v-97261e0d><table class="w-full text-sm" data-v-97261e0d><thead class="bg-gray-50" data-v-97261e0d><tr data-v-97261e0d>\x3c!--[--\x3e'),r.ssrRenderList(t.unref(s).mappings.value.filter(e=>e.targetField),e=>{a(`<th class="px-3 py-2 text-left font-medium text-gray-700 whitespace-nowrap" data-v-97261e0d>${r.ssrInterpolate(getFieldLabel(e.targetField))}</th>`)}),a('\x3c!--]--\x3e</tr></thead><tbody class="divide-y divide-gray-100" data-v-97261e0d>\x3c!--[--\x3e'),r.ssrRenderList(t.unref(s).getPreviewData(),(e,o)=>{a("<tr data-v-97261e0d>\x3c!--[--\x3e"),r.ssrRenderList(t.unref(s).mappings.value.filter(e=>e.targetField),t=>{a(`<td class="px-3 py-2 text-gray-600 whitespace-nowrap" data-v-97261e0d>${r.ssrInterpolate(e[t.targetField]||"‚Äî")}</td>`)}),a("\x3c!--]--\x3e</tr>")}),a('\x3c!--]--\x3e</tbody></table></div><p class="text-xs text-gray-500" data-v-97261e0d>Vista previa de las primeras filas</p></div>')):a("\x3c!----\x3e"),a("</div>")):a("\x3c!----\x3e"),5===t.unref(n)?(a('<div class="space-y-6" data-v-97261e0d><div class="text-center mb-6" data-v-97261e0d>'),t.unref(v)?a(r.ssrRenderComponent(t.unref(l),{class:"w-16 h-16 mx-auto text-green-600 mb-4","aria-hidden":"true"},null,m)):a(r.ssrRenderComponent(t.unref(p),{class:"w-16 h-16 mx-auto text-amber-600 mb-4","aria-hidden":"true"},null,m)),a(`<h3 class="text-lg font-semibold text-cafe mb-2" data-v-97261e0d>${r.ssrInterpolate(t.unref(v)?"Importaci√≥n completada con √©xito":"Importaci√≥n completada con advertencias")}</h3><p class="text-sm text-gray-600" data-v-97261e0d>${r.ssrInterpolate(t.unref(v)?"Los pacientes se han importado correctamente":"La importaci√≥n se complet√≥ pero algunos pacientes tienen perfil incompleto")}</p></div>`),t.unref(s).importResult.value?a(`<div class="grid grid-cols-2 md:grid-cols-4 gap-4" data-v-97261e0d><div class="bg-gray-50 rounded-lg p-4 text-center" data-v-97261e0d><p class="text-2xl font-bold text-cafe" data-v-97261e0d>${r.ssrInterpolate(t.unref(s).importResult.value.total)}</p><p class="text-xs text-gray-600" data-v-97261e0d>Total</p></div><div class="bg-green-50 rounded-lg p-4 text-center" data-v-97261e0d><p class="text-2xl font-bold text-green-700" data-v-97261e0d>${r.ssrInterpolate(t.unref(s).importResult.value.created)}</p><p class="text-xs text-gray-600" data-v-97261e0d>Creados</p></div><div class="bg-blue-50 rounded-lg p-4 text-center" data-v-97261e0d><p class="text-2xl font-bold text-blue-700" data-v-97261e0d>${r.ssrInterpolate(t.unref(s).importResult.value.updated)}</p><p class="text-xs text-gray-600" data-v-97261e0d>Actualizados</p></div><div class="bg-gray-100 rounded-lg p-4 text-center" data-v-97261e0d><p class="text-2xl font-bold text-gray-700" data-v-97261e0d>${r.ssrInterpolate(t.unref(s).importResult.value.skipped)}</p><p class="text-xs text-gray-600" data-v-97261e0d>Omitidos</p></div></div>`):a("\x3c!----\x3e"),t.unref(v)?(a('<div class="bg-green-50 border border-green-200 rounded-lg p-4" data-v-97261e0d><div class="flex gap-3" data-v-97261e0d>'),a(r.ssrRenderComponent(t.unref(l),{class:"w-6 h-6 text-green-600 flex-shrink-0 mt-0.5","aria-hidden":"true"},null,m)),a('<div class="flex-1" data-v-97261e0d><p class="font-semibold text-green-900 mb-2" data-v-97261e0d>¬°Importaci√≥n exitosa!</p><p class="text-sm text-green-800" data-v-97261e0d> Los pacientes se han a√±adido a tu lista y ya puedes gestionar sus citas y tratamientos. </p></div></div></div>')):a("\x3c!----\x3e"),t.unref(s).importResult.value?.incompleteProfiles?.length?(a('<div class="bg-amber-50 border border-amber-200 rounded-lg p-4" data-v-97261e0d><div class="flex gap-3" data-v-97261e0d>'),a(r.ssrRenderComponent(t.unref(p),{class:"w-6 h-6 text-amber-600 flex-shrink-0 mt-0.5","aria-hidden":"true"},null,m)),a(`<div class="flex-1" data-v-97261e0d><p class="font-semibold text-amber-900 mb-2" data-v-97261e0d>${r.ssrInterpolate(t.unref(s).importResult.value.incompleteProfiles.length)} paciente${r.ssrInterpolate(1!==t.unref(s).importResult.value.incompleteProfiles.length?"s":"")} con perfil incompleto </p><p class="text-sm text-amber-800 mb-3" data-v-97261e0d> Los siguientes pacientes fueron importados pero les faltan datos importantes: </p><div class="max-h-40 overflow-y-auto space-y-2" data-v-97261e0d>\x3c!--[--\x3e`),r.ssrRenderList(t.unref(s).importResult.value.incompleteProfiles.slice(0,5),e=>{a(`<div class="bg-white border border-amber-200 rounded p-2 text-sm" data-v-97261e0d><span class="font-medium text-amber-900" data-v-97261e0d>${r.ssrInterpolate(e.nombre_completo)}</span><span class="text-amber-700" data-v-97261e0d> ‚Äî Faltan: ${r.ssrInterpolate(e.missingFields.join(", "))}</span></div>`)}),a("\x3c!--]--\x3e"),t.unref(s).importResult.value.incompleteProfiles.length>5?a(`<p class="text-xs text-amber-700 italic" data-v-97261e0d> ... y ${r.ssrInterpolate(t.unref(s).importResult.value.incompleteProfiles.length-5)} m√°s </p>`):a("\x3c!----\x3e"),a('</div><p class="text-xs text-amber-700 mt-3" data-v-97261e0d> üí° Puedes completar esta informaci√≥n editando cada paciente desde la lista. </p></div></div></div>')):a("\x3c!----\x3e"),t.unref(s).importResult.value?.errors?.length?(a('<div class="bg-red-50 border border-red-200 rounded-lg p-4" data-v-97261e0d><h4 class="font-semibold text-red-900 mb-3 flex items-center gap-2" data-v-97261e0d>'),a(r.ssrRenderComponent(t.unref(u),{class:"w-5 h-5","aria-hidden":"true"},null,m)),a(` Errores durante la importaci√≥n (${r.ssrInterpolate(t.unref(s).importResult.value.errors.length)}) </h4><div class="max-h-40 overflow-y-auto space-y-2" data-v-97261e0d>\x3c!--[--\x3e`),r.ssrRenderList(t.unref(s).importResult.value.errors.slice(0,10),(e,t)=>{a(`<div class="bg-white border border-red-200 rounded p-2 text-sm text-red-800" data-v-97261e0d><span class="font-semibold" data-v-97261e0d>Fila ${r.ssrInterpolate(e.row)}:</span> ${r.ssrInterpolate(e.error)}</div>`)}),a("\x3c!--]--\x3e</div></div>")):a("\x3c!----\x3e"),a("</div>")):a("\x3c!----\x3e"),a('</div><div class="px-6 py-4 border-t border-gray-200 flex items-center justify-between bg-gray-50" data-v-97261e0d>'),t.unref(n)>1&&t.unref(n)<5?a(`<button${r.ssrIncludeBooleanAttr(t.unref(s).importing.value||t.unref(s).detecting.value)?" disabled":""} class="min-h-[44px] px-6 py-2.5 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-all font-medium disabled:opacity-50 disabled:cursor-not-allowed focus:outline-none focus:ring-2 focus:ring-gray-300" data-v-97261e0d> Atr√°s </button>`):a("<div data-v-97261e0d></div>"),a('<div class="flex gap-3" data-v-97261e0d>'),t.unref(n)<5?a(`<button${r.ssrIncludeBooleanAttr(t.unref(s).importing.value)?" disabled":""} class="min-h-[44px] px-6 py-2.5 bg-white border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-all font-medium disabled:opacity-50 disabled:cursor-not-allowed focus:outline-none focus:ring-2 focus:ring-gray-300" data-v-97261e0d> Cancelar </button>`):a("\x3c!----\x3e"),1===t.unref(n)?a('<button class="min-h-[44px] px-6 py-2.5 bg-purple-600 text-white rounded-lg hover:bg-purple-600/90 transition-all font-medium shadow-sm hover:shadow-md focus:outline-none focus:ring-2 focus:ring-purple-300" data-v-97261e0d> Continuar </button>'):a("\x3c!----\x3e"),2===t.unref(n)?(a(`<button${r.ssrIncludeBooleanAttr(!t.unref(d)||t.unref(s).detecting.value)?" disabled":""} class="min-h-[44px] px-6 py-2.5 bg-purple-600 text-white rounded-lg hover:bg-purple-600/90 transition-all font-medium shadow-sm hover:shadow-md disabled:opacity-50 disabled:cursor-not-allowed focus:outline-none focus:ring-2 focus:ring-purple-300 flex items-center gap-2" data-v-97261e0d>`),t.unref(s).detecting.value?a('<div class="animate-spin w-4 h-4 border-2 border-white border-t-transparent rounded-full" data-v-97261e0d></div>'):a("\x3c!----\x3e"),a(`<span data-v-97261e0d>${r.ssrInterpolate(t.unref(s).detecting.value?"Analizando...":"Detectar columnas")}</span></button>`)):a("\x3c!----\x3e"),3===t.unref(n)?a(`<button${r.ssrIncludeBooleanAttr(!t.unref(s).validation.value?.isValid)?" disabled":""} class="min-h-[44px] px-6 py-2.5 bg-purple-600 text-white rounded-lg hover:bg-purple-600/90 transition-all font-medium shadow-sm hover:shadow-md disabled:opacity-50 disabled:cursor-not-allowed focus:outline-none focus:ring-2 focus:ring-purple-300" data-v-97261e0d> Continuar </button>`):a("\x3c!----\x3e"),4===t.unref(n)?(a(`<button${r.ssrIncludeBooleanAttr(t.unref(s).importing.value)?" disabled":""} class="min-h-[44px] px-6 py-2.5 bg-purple-600 text-white rounded-lg hover:bg-purple-600/90 transition-all font-medium shadow-sm hover:shadow-md disabled:opacity-50 disabled:cursor-not-allowed focus:outline-none focus:ring-2 focus:ring-purple-300 flex items-center gap-2" data-v-97261e0d>`),t.unref(s).importing.value?a('<div class="animate-spin w-4 h-4 border-2 border-white border-t-transparent rounded-full" data-v-97261e0d></div>'):a("\x3c!----\x3e"),a(`<span data-v-97261e0d>${r.ssrInterpolate(t.unref(s).importing.value?"Importando...":"Importar pacientes")}</span></button>`)):a("\x3c!----\x3e"),5===t.unref(n)?a('<button class="min-h-[44px] px-6 py-2.5 bg-purple-600 text-white rounded-lg hover:bg-purple-600/90 transition-all font-medium shadow-sm hover:shadow-md focus:outline-none focus:ring-2 focus:ring-purple-300" data-v-97261e0d> Finalizar </button>'):a("\x3c!----\x3e"),a("</div></div></div></div>")):a("\x3c!----\x3e")},"body",!1,m)}}}),te=ae.setup;ae.setup=(e,a)=>{const r=t.useSSRContext();return(r.modules||(r.modules=new Set)).add("components/patients/PatientsImportModal.vue"),te?te(e,a):void 0};const re=Object.assign(o(ae,[["__scopeId","data-v-97261e0d"]]),{__name:"PatientsImportModal"}),oe=t.defineComponent({__name:"PatientsExportModal",__ssrInlineRender:!0,props:{modelValue:{type:Boolean},totalPatients:{},filteredCount:{},selectedCount:{default:0},hasFilters:{type:Boolean,default:!1},currentFilters:{default:()=>({})},selectedIds:{default:()=>[]}},emits:["update:modelValue"],setup(e,{emit:a}){const o=e,s=t.ref("csv"),n=t.ref("all"),l=t.ref(["nombre_completo","email","telefono","area_de_acompanamiento","frecuencia","activo"]),d=t.ref(!1),i=[{value:"nombre_completo",label:"Nombre Completo"},{value:"email",label:"Email"},{value:"telefono",label:"Tel√©fono"},{value:"area_de_acompanamiento",label:"√Årea"},{value:"frecuencia",label:"Frecuencia"},{value:"activo",label:"Estado"},{value:"ultima_sesion",label:"√öltima Sesi√≥n"},{value:"proxima_sesion",label:"Pr√≥xima Sesi√≥n"},{value:"total_sesiones",label:"Total Sesiones"},{value:"created_at",label:"Fecha de Registro"}];return t.watchEffect(()=>{o.selectedCount>0?n.value="selected":o.hasFilters?n.value="filtered":n.value="all"}),(a,o,c,u)=>{r.ssrRenderTeleport(o,a=>{e.modelValue?(a('<div class="fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50" role="dialog" aria-modal="true" aria-labelledby="export-modal-title" data-v-797ad56f><div class="bg-white rounded-xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-hidden flex flex-col" data-v-797ad56f><div class="px-6 py-4 border-b border-gray-200 flex items-center justify-between" data-v-797ad56f><div data-v-797ad56f><h2 id="export-modal-title" class="text-2xl font-serif font-bold text-cafe" data-v-797ad56f> Exportar Pacientes </h2><p class="text-sm text-gray-500 mt-1" data-v-797ad56f> Selecciona las opciones de exportaci√≥n </p></div><button class="min-h-[44px] min-w-[44px] p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors focus:outline-none focus:ring-2 focus:ring-gray-300" aria-label="Cerrar modal" data-v-797ad56f>'),a(r.ssrRenderComponent(t.unref(y),{class:"w-6 h-6","aria-hidden":"true"},null,c)),a(`</button></div><div class="flex-1 overflow-y-auto p-6 space-y-6" data-v-797ad56f><div data-v-797ad56f><label class="block text-sm font-semibold text-cafe mb-3" data-v-797ad56f> Formato de archivo </label><div class="flex gap-3" data-v-797ad56f><button class="${r.ssrRenderClass(["csv"===t.unref(s)?"border-purple-600 bg-purple-50 text-purple-600":"border-gray-200 bg-white text-gray-600 hover:border-gray-300","min-h-[44px] flex-1 px-4 py-3 rounded-lg border-2 transition-all font-medium flex items-center justify-center gap-2"])}" data-v-797ad56f>`),a(r.ssrRenderComponent(t.unref(C),{class:"w-5 h-5","aria-hidden":"true"},null,c)),a(`<span data-v-797ad56f>CSV</span></button><button class="${r.ssrRenderClass(["xlsx"===t.unref(s)?"border-purple-600 bg-purple-50 text-purple-600":"border-gray-200 bg-white text-gray-600 hover:border-gray-300","min-h-[44px] flex-1 px-4 py-3 rounded-lg border-2 transition-all font-medium flex items-center justify-center gap-2"])}" data-v-797ad56f>`),a(r.ssrRenderComponent(t.unref(C),{class:"w-5 h-5","aria-hidden":"true"},null,c)),a(`<span data-v-797ad56f>XLSX</span></button></div></div><div data-v-797ad56f><label class="block text-sm font-semibold text-cafe mb-3" data-v-797ad56f> ¬øQu√© pacientes exportar? </label><div class="space-y-2" data-v-797ad56f><label class="${r.ssrRenderClass(["all"===t.unref(n)?"border-purple-600 bg-purple-50":"border-gray-200 bg-white hover:border-gray-300","flex items-center gap-3 p-3 border-2 rounded-lg cursor-pointer transition-all"])}" data-v-797ad56f><input type="radio"${r.ssrIncludeBooleanAttr(r.ssrLooseEqual(t.unref(n),"all"))?" checked":""} value="all" class="w-4 h-4 text-purple-600 border-gray-300 focus:ring-2 focus:ring-purple-300" data-v-797ad56f><div class="flex-1" data-v-797ad56f><p class="font-medium text-cafe" data-v-797ad56f>Todos los pacientes</p><p class="text-xs text-gray-600" data-v-797ad56f>Exportar todos los pacientes (${r.ssrInterpolate(e.totalPatients)})</p></div></label>`),e.hasFilters?a(`<label class="${r.ssrRenderClass(["filtered"===t.unref(n)?"border-purple-600 bg-purple-50":"border-gray-200 bg-white hover:border-gray-300","flex items-center gap-3 p-3 border-2 rounded-lg cursor-pointer transition-all"])}" data-v-797ad56f><input type="radio"${r.ssrIncludeBooleanAttr(r.ssrLooseEqual(t.unref(n),"filtered"))?" checked":""} value="filtered" class="w-4 h-4 text-purple-600 border-gray-300 focus:ring-2 focus:ring-purple-300" data-v-797ad56f><div class="flex-1" data-v-797ad56f><p class="font-medium text-cafe" data-v-797ad56f>Pacientes filtrados</p><p class="text-xs text-gray-600" data-v-797ad56f>Exportar solo los pacientes que cumplen los filtros actuales (${r.ssrInterpolate(e.filteredCount)})</p></div></label>`):a("\x3c!----\x3e"),e.selectedCount>0?a(`<label class="${r.ssrRenderClass(["selected"===t.unref(n)?"border-purple-600 bg-purple-50":"border-gray-200 bg-white hover:border-gray-300","flex items-center gap-3 p-3 border-2 rounded-lg cursor-pointer transition-all"])}" data-v-797ad56f><input type="radio"${r.ssrIncludeBooleanAttr(r.ssrLooseEqual(t.unref(n),"selected"))?" checked":""} value="selected" class="w-4 h-4 text-purple-600 border-gray-300 focus:ring-2 focus:ring-purple-300" data-v-797ad56f><div class="flex-1" data-v-797ad56f><p class="font-medium text-cafe" data-v-797ad56f>Pacientes seleccionados</p><p class="text-xs text-gray-600" data-v-797ad56f>Exportar solo los pacientes seleccionados (${r.ssrInterpolate(e.selectedCount)})</p></div></label>`):a("\x3c!----\x3e"),a('</div></div><div data-v-797ad56f><label class="block text-sm font-semibold text-cafe mb-3" data-v-797ad56f> Campos a exportar </label><div class="grid grid-cols-2 gap-2" data-v-797ad56f>\x3c!--[--\x3e'),r.ssrRenderList(i,e=>{a(`<label class="flex items-center gap-2 p-2 border rounded-lg cursor-pointer hover:bg-gray-50 transition-colors" data-v-797ad56f><input type="checkbox"${r.ssrIncludeBooleanAttr(Array.isArray(t.unref(l))?r.ssrLooseContain(t.unref(l),e.value):t.unref(l))?" checked":""}${r.ssrRenderAttr("value",e.value)} class="w-4 h-4 text-purple-600 border-gray-300 rounded focus:ring-2 focus:ring-purple-300" data-v-797ad56f><span class="text-sm text-cafe" data-v-797ad56f>${r.ssrInterpolate(e.label)}</span></label>`)}),a(`\x3c!--]--\x3e</div><button class="mt-2 text-xs text-purple-600 hover:text-purple-700 font-medium" data-v-797ad56f>${r.ssrInterpolate(t.unref(l).length===i.length?"Deseleccionar todos":"Seleccionar todos")}</button></div></div><div class="px-6 py-4 border-t border-gray-200 flex items-center justify-between bg-gray-50" data-v-797ad56f><button${r.ssrIncludeBooleanAttr(t.unref(d))?" disabled":""} class="min-h-[44px] px-6 py-2.5 bg-white border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-all font-medium disabled:opacity-50 disabled:cursor-not-allowed focus:outline-none focus:ring-2 focus:ring-gray-300" data-v-797ad56f> Cancelar </button><button${r.ssrIncludeBooleanAttr(t.unref(d)||0===t.unref(l).length)?" disabled":""} class="min-h-[44px] px-6 py-2.5 bg-purple-600 text-white rounded-lg hover:bg-purple-600/90 transition-all font-medium shadow-sm hover:shadow-md disabled:opacity-50 disabled:cursor-not-allowed focus:outline-none focus:ring-2 focus:ring-purple-300 flex items-center gap-2" data-v-797ad56f>`),t.unref(d)?a("\x3c!----\x3e"):a(r.ssrRenderComponent(t.unref(_),{class:"w-5 h-5","aria-hidden":"true"},null,c)),t.unref(d)?a("<span data-v-797ad56f>Exportando...</span>"):a("<span data-v-797ad56f>Exportar</span>"),a("</button></div></div></div>")):a("\x3c!----\x3e")},"body",!1,c)}}}),se=oe.setup;oe.setup=(e,a)=>{const r=t.useSSRContext();return(r.modules||(r.modules=new Set)).add("components/patients/PatientsExportModal.vue"),se?se(e,a):void 0};const ne=Object.assign(o(oe,[["__scopeId","data-v-797ad56f"]]),{__name:"PatientsExportModal"}),le={__name:"pacientes",__ssrInlineRender:!0,setup(o){const s=e(),n=g(),{getUserId:l}=f(),d=a(),i=useToast();console.log("[Pacientes] Estado inicial del usuario:",{existe:!!d.value,id:l(),email:d.value?.email}),t.watch(d,(e,a)=>{console.log("[Pacientes] Usuario cambi√≥:",{antes:a?.email||"null",ahora:e?.email||"null",id:l()})});const c=t.ref(!1),p=t.ref(!1),v=t.ref(!1),b=t.ref(!1),x=t.ref(!1),h=t.ref(!1),y=t.ref(!1),C=t.ref(null),$=t.ref(null),E=t.ref(null),D=t.ref([]),S=t.ref(!0),B=t.ref(""),P=t.ref(""),q=t.ref("todos"),M=t.ref(""),z=t.ref({sinProximaCita:!1,sinSesionRegistrada:!1,requiereAtencion:!1}),V=[{valor:"todos",label:"Todos"},{valor:"activo",label:"Activos"},{valor:"pausa",label:"En pausa"},{valor:"finalizado",label:"Finalizados"}],N=t.computed(()=>({activos:D.value.filter(e=>e.activo&&!e.en_pausa).length,enPausa:D.value.filter(e=>e.activo&&e.en_pausa).length,finalizados:D.value.filter(e=>!e.activo).length})),H=t.computed(()=>V.map(e=>{let a=0;return"todos"===e.valor?a=D.value.length:"activo"===e.valor?a=N.value.activos:"pausa"===e.valor?a=N.value.enPausa:"finalizado"===e.valor&&(a=N.value.finalizados),{...e,count:a}})),U=t.computed(()=>{const e=new Set(D.value.map(e=>e.area_de_acompanamiento).filter(Boolean));return Array.from(e).sort()}),G=t.computed(()=>""!==M.value||z.value.sinProximaCita||z.value.sinSesionRegistrada||z.value.requiereAtencion),cargarPacientes=async()=>{S.value=!0;try{const e=l();if(console.log("[Pacientes] Iniciando carga de pacientes..."),console.log("[Pacientes] Usuario actual:",{existe:!!d.value,id:e,email:d.value?.email}),!e)return console.error("[Pacientes] Usuario no autenticado"),void(S.value=!1);console.log("‚úÖ [Pacientes] Usuario verificado, consultando database...");const{data:a,error:t}=await n.from("pacientes").select("\n        id,\n        created_at,\n        activo,\n        email,\n        nombre_completo,\n        telefono,\n        area_de_acompanamiento,\n        frecuencia,\n        metadata\n      ").eq("terapeuta_id",e).order("created_at",{ascending:!1});if(t)throw t;const r=await Promise.all(a.map(async e=>{const{data:a}=await n.from("citas").select("fecha_cita").eq("paciente_id",e.id).eq("estado","realizada").order("fecha_cita",{ascending:!1}).limit(1).maybeSingle(),{data:t}=await n.from("citas").select("id, fecha_cita, hora_inicio").eq("paciente_id",e.id).in("estado",["pendiente","confirmada"]).gte("fecha_cita",(new Date).toISOString().split("T")[0]).order("fecha_cita",{ascending:!0}).order("hora_inicio",{ascending:!0}).limit(1).maybeSingle(),{count:r}=await n.from("citas").select("*",{count:"exact",head:!0}).eq("paciente_id",e.id).eq("estado","realizada");let o=null;try{const{data:a}=await n.from("bonos").select("id, tipo, estado, sesiones_totales, sesiones_restantes, fecha_fin, created_at").eq("paciente_id",e.id).order("created_at",{ascending:!1});console.log(`[Bonos] Paciente ${e.nombre_completo}:`,a);const{data:t,error:r}=await n.from("bonos").select("id, tipo, estado, sesiones_totales, sesiones_restantes, fecha_fin, created_at").eq("paciente_id",e.id).in("estado",["activo","pendiente"]).order("created_at",{ascending:!1}).limit(1).maybeSingle();r?console.warn("[Bonos] Error en consulta:",r.message):(o=t,console.log("‚úÖ [Bonos] Bono activo encontrado:",o))}catch(e){console.warn("[Bonos] Error inesperado:",e)}let s=0,l=0;o&&(l=o.sesiones_totales,s=l-o.sesiones_restantes);const d=new Date;d.setDate(d.getDate()-7);const{data:i}=await n.from("metricas_bienestar").select("estado_animo, nivel_energia, nivel_estres").eq("paciente_id",e.id).gte("fecha",d.toISOString());let c=3,u=!1,p=50;if(i&&i.length>0){const e=i.reduce((e,a)=>e+a.estado_animo,0)/i.length;c=e,p=Math.round(e/10*100);const a=i.slice(-3);a.length>=3&&(u=a.every(e=>e.estado_animo<=4))}const v=e.nombre_completo||e.metadata?.nombre_completo||e.email;return{id:e.id,nombre:v,apellidos:"",email:e.email,telefono:e.telefono,activo:e.activo,en_pausa:e.metadata?.en_pausa||!1,area_de_acompanamiento:e.area_de_acompanamiento,frecuencia:e.frecuencia,ultima_sesion:a?.fecha_cita||null,proxima_sesion:t?`${t.fecha_cita}T${t.hora_inicio}`:null,proxima_cita_id:t?.id||null,total_sesiones:r||0,estado_emocional_promedio:c,evolucion_porcentaje:p,requiere_atencion:u,created_at:e.created_at,bono_activo:o?{tipo:o.tipo,estado:o.estado,fecha_fin:o.fecha_fin,sesiones_completadas:s,sesiones_totales:l,sesiones_restantes:o.sesiones_restantes}:null}}));D.value=r}catch(e){console.error("Error al cargar pacientes:",e),i.error("Error al cargar los pacientes. Por favor, recarga la p√°gina.")}finally{S.value=!1}},Q=t.computed(()=>{let e=D.value;if(B.value){const a=B.value.toLowerCase();e=e.filter(e=>(e.nombre||"").toLowerCase().includes(a)||(e.email||"").toLowerCase().includes(a))}return"todos"!==q.value&&(e=e.filter(e=>"activo"===q.value?e.activo&&!e.en_pausa:"pausa"===q.value?e.activo&&e.en_pausa:"finalizado"!==q.value||!e.activo)),M.value&&(e=e.filter(e=>e.area_de_acompanamiento===M.value)),z.value.sinProximaCita&&(e=e.filter(e=>!e.proxima_sesion)),z.value.sinSesionRegistrada&&(e=e.filter(e=>!e.ultima_sesion)),z.value.requiereAtencion&&(e=e.filter(e=>e.requiere_atencion)),e}),Y=t.computed(()=>D.value.length),cerrarModalNuevo=()=>{c.value=!1},abrirModalEditar=e=>{console.log("Abriendo modal de edici√≥n para:",e),$.value=e,p.value=!0},cerrarModalEditar=()=>{p.value=!1,$.value=null},abrirModalEliminar=e=>{console.log("Abriendo modal de eliminaci√≥n para:",e),$.value=e,v.value=!0},cerrarModalEliminar=()=>{v.value=!1,$.value=null},manejarPacienteCreado=async e=>{console.log("Nuevo paciente creado:",e),await cargarPacientes(),i.success("Paciente creado exitosamente")},manejarPacienteActualizado=async e=>{console.log("Paciente actualizado:",e),await cargarPacientes(),i.success("Informaci√≥n del paciente actualizada correctamente")},manejarPacienteEliminado=async e=>{console.log("Paciente eliminado:",e),D.value=D.value.filter(a=>a.id!==e),i.success("Paciente eliminado exitosamente")},manejarPacienteDesactivado=async e=>{console.log("Paciente desactivado:",e),await cargarPacientes(),i.success("Paciente desactivado correctamente")},cerrarModalAsignarCita=()=>{b.value=!1,E.value=null},manejarCitaCreada=async e=>{console.log("Nueva cita creada:",e),await cargarPacientes(),cerrarModalAsignarCita(),i.success("Cita asignada exitosamente")},verCitasPaciente=e=>{s.push(`/agenda?paciente=${e.id}`)},gestionarBonosPaciente=e=>{s.push(`/terapeuta/pacientes/${e.id}/bonos`)},handleImportComplete=async()=>{await cargarPacientes(),i.success("Importaci√≥n completada. Lista de pacientes actualizada.")},J=t.computed(()=>{const e={};return"todos"!==q.value&&(e.estado=q.value),M.value&&(e.area=M.value),e}),abrirModalEditarCita=e=>{console.log("Abriendo modal de edici√≥n de cita:",e),C.value=e,x.value=!0},cerrarModalEditarCita=()=>{x.value=!1,C.value=null},handleCitaActualizada=async()=>{console.log("Cita actualizada, recargando pacientes..."),await cargarPacientes(),cerrarModalEditarCita(),i.success("Cita actualizada correctamente")};return t.watch(()=>l(),(e,a)=>{console.log("[Pacientes] ID de usuario cambi√≥:",{antes:a,ahora:e}),e&&0===D.value.length&&(console.log("[Pacientes] Recargando pacientes por cambio de usuario..."),cargarPacientes())}),(e,a,o,s)=>{const n=L,l=m,d=F,i=j,f=T,g=O,V=X,Z=re,W=ne;a(`<div${r.ssrRenderAttrs(s)} data-v-c9c8455f><header class="mb-6" data-v-c9c8455f><div class="flex flex-col sm:flex-row sm:items-end sm:justify-between gap-3 mb-6" data-v-c9c8455f><div data-v-c9c8455f><h1 class="text-3xl font-serif font-bold text-cafe mb-1" data-v-c9c8455f> Pacientes </h1><div class="flex flex-wrap items-center gap-2 text-sm text-cafe/60" data-v-c9c8455f><span data-v-c9c8455f>Activos: <strong class="text-cafe font-semibold" data-v-c9c8455f>${r.ssrInterpolate(t.unref(N).activos)}</strong></span><span class="text-gray-300" data-v-c9c8455f>¬∑</span><span data-v-c9c8455f>En pausa: <strong class="text-cafe font-semibold" data-v-c9c8455f>${r.ssrInterpolate(t.unref(N).enPausa)}</strong></span><span class="text-gray-300" data-v-c9c8455f>¬∑</span><span data-v-c9c8455f>Finalizados: <strong class="text-cafe font-semibold" data-v-c9c8455f>${r.ssrInterpolate(t.unref(N).finalizados)}</strong></span></div></div><div class="flex flex-wrap gap-2" data-v-c9c8455f><button class="min-h-[44px] px-4 py-2.5 bg-white border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-all flex items-center gap-2 whitespace-nowrap font-medium focus:outline-none focus:ring-2 focus:ring-gray-300" aria-label="Importar pacientes" data-v-c9c8455f>`),a(r.ssrRenderComponent(t.unref(w),{class:"w-5 h-5","aria-hidden":"true"},null,o)),a('<span data-v-c9c8455f>Importar</span></button><button class="min-h-[44px] px-4 py-2.5 bg-white border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-all flex items-center gap-2 whitespace-nowrap font-medium focus:outline-none focus:ring-2 focus:ring-gray-300" aria-label="Exportar pacientes" data-v-c9c8455f>'),a(r.ssrRenderComponent(t.unref(_),{class:"w-5 h-5","aria-hidden":"true"},null,o)),a(`<span data-v-c9c8455f>Exportar</span></button><button class="min-h-[44px] px-6 py-2.5 bg-purple-600 text-white rounded-lg hover:bg-purple-600/90 transition-all flex items-center gap-2 whitespace-nowrap font-medium shadow-sm hover:shadow-md focus:outline-none focus:ring-2 focus:ring-purple-300" aria-label="A√±adir nuevo paciente" data-v-c9c8455f><span class="text-lg leading-none" data-v-c9c8455f>+</span><span data-v-c9c8455f>Nuevo Paciente</span></button></div></div><div class="bg-white rounded-xl shadow-sm border border-gray-100 p-5" data-v-c9c8455f><div class="mb-4" data-v-c9c8455f><div class="relative" data-v-c9c8455f><input${r.ssrRenderAttr("value",t.unref(P))} type="text" placeholder="Buscar paciente por nombre o email..." class="min-h-[44px] w-full px-4 py-3 pl-11 bg-gray-50 border border-gray-200 rounded-lg focus:border-purple-600 focus:ring-2 focus:ring-purple-300/20 focus:bg-white transition-all text-cafe placeholder-gray-400" aria-label="Buscar pacientes" data-v-c9c8455f>`),a(r.ssrRenderComponent(t.unref(A),{class:"w-5 h-5 absolute left-3 top-1/2 -translate-y-1/2 text-gray-400","aria-hidden":"true"},null,o)),a('</div></div><div class="flex flex-col gap-3" data-v-c9c8455f><div class="flex items-center gap-2 text-xs text-gray-500 font-medium uppercase tracking-wide" data-v-c9c8455f><span data-v-c9c8455f>Estado</span></div><div class="flex flex-wrap gap-2" data-v-c9c8455f>\x3c!--[--\x3e'),r.ssrRenderList(t.unref(H),e=>{a(`<button class="${r.ssrRenderClass([t.unref(q)===e.valor?"bg-purple-600 text-white shadow-sm":"bg-gray-50 text-gray-600 hover:bg-gray-100 border border-gray-200","min-h-[44px] px-4 py-2 rounded-lg text-sm font-medium transition-all flex items-center gap-2"])}"${r.ssrRenderAttr("aria-pressed",t.unref(q)===e.valor)}${r.ssrRenderAttr("aria-label",`Filtrar por ${e.label.toLowerCase()}: ${e.count} pacientes`)} data-v-c9c8455f><span data-v-c9c8455f>${r.ssrInterpolate(e.label)}</span><span class="${r.ssrRenderClass([t.unref(q)===e.valor?"bg-white/20 text-white":"bg-gray-200 text-gray-600","px-2 py-0.5 rounded-full text-xs font-semibold"])}" data-v-c9c8455f>${r.ssrInterpolate(e.count)}</span></button>`)}),a(`\x3c!--]--\x3e</div></div><div class="mt-4 pt-4 border-t border-gray-100" data-v-c9c8455f><div class="flex items-center gap-2 text-xs text-gray-500 font-medium uppercase tracking-wide mb-3" data-v-c9c8455f><span data-v-c9c8455f>Filtros Avanzados</span></div><div class="flex flex-wrap gap-2" data-v-c9c8455f><select class="min-h-[44px] px-3 py-2 bg-gray-50 border border-gray-200 rounded-lg text-sm text-cafe focus:border-purple-600 focus:ring-2 focus:ring-purple-300/20 transition-all" aria-label="Filtrar por √°rea de acompa√±amiento" data-v-c9c8455f><option value="" data-v-c9c8455f${r.ssrIncludeBooleanAttr(Array.isArray(t.unref(M))?r.ssrLooseContain(t.unref(M),""):r.ssrLooseEqual(t.unref(M),""))?" selected":""}>Todas las √°reas</option>\x3c!--[--\x3e`),r.ssrRenderList(t.unref(U),e=>{a(`<option${r.ssrRenderAttr("value",e)} data-v-c9c8455f${r.ssrIncludeBooleanAttr(Array.isArray(t.unref(M))?r.ssrLooseContain(t.unref(M),e):r.ssrLooseEqual(t.unref(M),e))?" selected":""}>${r.ssrInterpolate(e)}</option>`)}),a(`\x3c!--]--\x3e</select><button class="${r.ssrRenderClass([t.unref(z).sinProximaCita?"bg-orange-100 text-orange-700 border border-orange-300":"bg-gray-50 text-gray-600 hover:bg-gray-100 border border-gray-200","min-h-[44px] px-4 py-2 rounded-lg text-sm font-medium transition-all flex items-center gap-2"])}"${r.ssrRenderAttr("aria-pressed",t.unref(z).sinProximaCita)} aria-label="Filtrar pacientes sin pr√≥xima cita programada" data-v-c9c8455f>`),a(r.ssrRenderComponent(t.unref(I),{class:"w-4 h-4","aria-hidden":"true"},null,o)),a(`<span data-v-c9c8455f>Sin pr√≥xima cita</span></button><button class="${r.ssrRenderClass([t.unref(z).sinSesionRegistrada?"bg-amber-100 text-amber-700 border border-amber-300":"bg-gray-50 text-gray-600 hover:bg-gray-100 border border-gray-200","min-h-[44px] px-4 py-2 rounded-lg text-sm font-medium transition-all flex items-center gap-2"])}"${r.ssrRenderAttr("aria-pressed",t.unref(z).sinSesionRegistrada)} aria-label="Filtrar pacientes sin sesi√≥n registrada" data-v-c9c8455f>`),a(r.ssrRenderComponent(t.unref(R),{class:"w-4 h-4","aria-hidden":"true"},null,o)),a(`<span data-v-c9c8455f>Sin sesi√≥n registrada</span></button><button class="${r.ssrRenderClass([t.unref(z).requiereAtencion?"bg-red-100 text-red-700 border border-red-300":"bg-gray-50 text-gray-600 hover:bg-gray-100 border border-gray-200","min-h-[44px] px-4 py-2 rounded-lg text-sm font-medium transition-all flex items-center gap-2"])}"${r.ssrRenderAttr("aria-pressed",t.unref(z).requiereAtencion)} aria-label="Filtrar pacientes que requieren atenci√≥n" data-v-c9c8455f>`),a(r.ssrRenderComponent(t.unref(u),{class:"w-4 h-4","aria-hidden":"true"},null,o)),a("<span data-v-c9c8455f>Requiere atenci√≥n</span></button>"),t.unref(G)?a('<button class="min-h-[44px] px-4 py-2 rounded-lg text-sm font-medium transition-all text-gray-500 hover:text-gray-700 hover:bg-gray-100" aria-label="Limpiar todos los filtros" data-v-c9c8455f> Limpiar filtros </button>'):a("\x3c!----\x3e"),a("</div></div></div></header><section data-v-c9c8455f>"),t.unref(S)?a('<div class="flex flex-col items-center justify-center py-16" role="status" aria-live="polite" data-v-c9c8455f><div class="animate-spin w-12 h-12 border-4 border-purple-600 border-t-transparent rounded-full mb-6" aria-hidden="true" data-v-c9c8455f></div><p class="text-gray-500 font-medium" data-v-c9c8455f>Cargando pacientes...</p></div>'):0===t.unref(Q).length?(a('<div class="bg-white rounded-xl shadow-sm border border-gray-100 p-8 text-center" role="status" aria-live="polite" data-v-c9c8455f>'),a(r.ssrRenderComponent(t.unref(k),{class:"w-20 h-20 mx-auto mb-6 text-gray-300","aria-hidden":"true"},null,o)),a(`<h3 class="text-xl font-serif font-semibold text-cafe mb-3" data-v-c9c8455f>${r.ssrInterpolate(t.unref(G)||t.unref(B)||"todos"!==t.unref(q)?"No se encontraron pacientes":"A√∫n no tienes pacientes registrados")}</h3><p class="text-gray-500 mb-6 max-w-md mx-auto" data-v-c9c8455f>${r.ssrInterpolate(t.unref(G)||t.unref(B)||"todos"!==t.unref(q)?"Intenta ajustar los filtros de b√∫squeda para encontrar lo que buscas":"Comienza a√±adiendo tu primer paciente para gestionar su proceso terap√©utico")}</p>`),t.unref(G)||t.unref(B)||"todos"!==t.unref(q)?a('<button class="min-h-[44px] px-6 py-3 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-all font-medium focus:outline-none focus:ring-2 focus:ring-gray-300" aria-label="Limpiar todos los filtros de b√∫squeda" data-v-c9c8455f> Limpiar filtros </button>'):a('<button class="min-h-[44px] px-6 py-3 bg-purple-600 text-white rounded-lg hover:bg-purple-600/90 transition-all font-medium shadow-sm hover:shadow-md focus:outline-none focus:ring-2 focus:ring-purple-300" aria-label="A√±adir tu primer paciente" data-v-c9c8455f> + A√±adir Primer Paciente </button>'),a("</div>")):(a('<div class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6" role="list" aria-label="Lista de pacientes" data-v-c9c8455f>\x3c!--[--\x3e'),r.ssrRenderList(t.unref(Q),e=>{a('<div class="relative group cursor-pointer" role="listitem" data-v-c9c8455f>'),a(r.ssrRenderComponent(n,{paciente:e,onEditar:abrirModalEditar,onEliminar:abrirModalEliminar,onVerCitas:verCitasPaciente,onGestionarBonos:gestionarBonosPaciente,onEditarCita:abrirModalEditarCita},null,o)),e.activo&&!e.en_pausa?(a(`<button class="hidden md:flex absolute bottom-4 right-4 min-h-[44px] px-4 py-2.5 bg-gradient-to-r from-purple-600 to-rosa text-white text-sm font-medium rounded-lg shadow-lg hover:shadow-xl hover:scale-105 transition-all duration-200 items-center gap-2 z-10 opacity-0 group-hover:opacity-100 group-focus-within:opacity-100 pointer-events-none group-hover:pointer-events-auto group-focus-within:pointer-events-auto focus:outline-none focus:ring-2 focus:ring-purple-300"${r.ssrRenderAttr("aria-label",`Asignar nueva cita a ${e.nombre}`)} data-v-c9c8455f>`),a(r.ssrRenderComponent(t.unref(I),{class:"w-4 h-4","aria-hidden":"true"},null,o)),a("<span data-v-c9c8455f>Asignar Cita</span></button>")):a("\x3c!----\x3e"),e.activo&&!e.en_pausa?(a(`<button class="md:hidden absolute bottom-4 right-4 min-h-[44px] px-4 py-2.5 bg-gradient-to-r from-purple-600 to-rosa text-white text-sm font-medium rounded-lg shadow-lg hover:shadow-xl hover:scale-105 transition-all duration-200 flex items-center gap-2 z-10 focus:outline-none focus:ring-2 focus:ring-purple-300"${r.ssrRenderAttr("aria-label",`Asignar nueva cita a ${e.nombre}`)} data-v-c9c8455f>`),a(r.ssrRenderComponent(t.unref(I),{class:"w-4 h-4","aria-hidden":"true"},null,o)),a("<span data-v-c9c8455f>Asignar Cita</span></button>")):a("\x3c!----\x3e"),a("</div>")}),a("\x3c!--]--\x3e</div>")),t.unref(Q).length>0?(a(`<footer class="mt-8 pt-6 border-t border-gray-100 flex items-center justify-between flex-wrap gap-4" role="contentinfo" data-v-c9c8455f><p class="text-sm text-gray-500" aria-live="polite" data-v-c9c8455f> Mostrando ${r.ssrInterpolate(t.unref(Q).length)} de ${r.ssrInterpolate(t.unref(Y))} pacientes </p>`),t.unref(Y)>t.unref(Q).length?a('<div class="flex gap-2" data-v-c9c8455f><button class="min-h-[44px] px-4 py-2 bg-white border border-gray-200 text-gray-600 rounded-lg hover:bg-gray-50 transition-colors text-sm font-medium focus:outline-none focus:ring-2 focus:ring-gray-300" aria-label="Ver m√°s pacientes" data-v-c9c8455f> Ver m√°s </button></div>'):a("\x3c!----\x3e"),a("</footer>")):a("\x3c!----\x3e"),a("</section>"),a(r.ssrRenderComponent(l,{mostrar:t.unref(b),"paciente-preseleccionado":t.unref(E),onCerrar:cerrarModalAsignarCita,onCitaCreada:manejarCitaCreada},null,o)),a(r.ssrRenderComponent(d,{mostrar:t.unref(c),onCerrar:cerrarModalNuevo,onPacienteCreado:manejarPacienteCreado},null,o)),a(r.ssrRenderComponent(i,{mostrar:t.unref(p),paciente:t.unref($),onCerrar:cerrarModalEditar,onPacienteActualizado:manejarPacienteActualizado},null,o)),a(r.ssrRenderComponent(f,{mostrar:t.unref(v),paciente:t.unref($),onCerrar:cerrarModalEliminar,onPacienteEliminado:manejarPacienteEliminado,onPacienteDesactivado:manejarPacienteDesactivado},null,o)),a(r.ssrRenderComponent(g,{isOpen:t.unref(x),citaId:t.unref(C),onClose:cerrarModalEditarCita,onActualizado:handleCitaActualizada},null,o)),a(r.ssrRenderComponent(V,null,null,o)),a(r.ssrRenderComponent(Z,{modelValue:t.unref(h),"onUpdate:modelValue":e=>t.isRef(h)?h.value=e:null,"existing-patients":t.unref(D),onImportComplete:handleImportComplete},null,o)),a(r.ssrRenderComponent(W,{modelValue:t.unref(y),"onUpdate:modelValue":e=>t.isRef(y)?y.value=e:null,"total-patients":t.unref(Y),"filtered-count":t.unref(Q).length,"has-filters":t.unref(G)||"todos"!==t.unref(q)||""!==t.unref(B),"current-filters":t.unref(J)},null,o)),a("</div>")}}},de=le.setup;le.setup=(e,a)=>{const r=t.useSSRContext();return(r.modules||(r.modules=new Set)).add("pages/terapeuta/pacientes.vue"),de?de(e,a):void 0};const ie=o(le,[["__scopeId","data-v-c9c8455f"]]);export{ie as default};
//# sourceMappingURL=pacientes-0LvVc8ge.mjs.map
