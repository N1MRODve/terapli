import{a as e,e as a,v as t,s as o}from"./server.mjs";import{_ as s}from"./_plugin-vue_export-helper-1tPrXgE0.mjs";import{r}from"./CalendarIcon-BrsGHJBC.mjs";import{r as n}from"./ClockIcon-BxdFtPqx.mjs";import{r as l}from"./CheckCircleIcon-CT9fzVFs.mjs";import{r as i}from"./TicketIcon-zZdrc71S.mjs";import{r as d}from"./CurrencyDollarIcon-COwB3mCA.mjs";import{r as c}from"./ChartBarIcon-BEEST7f0.mjs";import{r as u}from"./ExclamationTriangleIcon-DQdM2y0F.mjs";import{r as p}from"./ExclamationCircleIcon-DhXgUVTW.mjs";import{r as m}from"./BellAlertIcon-DDdTQQDY.mjs";import{_ as v}from"./ModalNuevaCita-QWHLrbsw.mjs";import{u as b}from"./useSupabase-CA5R4uuJ.mjs";import{u as f}from"./useBonos-BES-yO_A.mjs";import{u as x}from"./useCitas-DyEZH6RI.mjs";import{_ as g}from"./ModalEditarCita-DXjLuO3L.mjs";import{u as h}from"./useSupabaseClient-DykwVqLQ.mjs";import{r as _}from"./MagnifyingGlassIcon-GsbNDyPZ.mjs";import{r as A}from"./UserGroupIcon-BhthmHUw.mjs";import{r as y}from"./CalendarDaysIcon-f8DhK37e.mjs";import"entities/lib/decode.js";import"../routes/renderer.mjs";import"../nitro/nitro.mjs";import"node:http";import"node:https";import"node:events";import"node:buffer";import"node:fs";import"node:path";import"node:crypto";import"../_/shared.cjs.prod.mjs";import"estree-walker";import"source-map-js";import"node:stream";import"devalue";import"@supabase/ssr";import"@vercel/analytics/nuxt";import"./UserIcon-CrHYaeI9.mjs";import"./XCircleIcon-BCxujS_I.mjs";const w={__name:"PacienteCard",__ssrInlineRender:!0,props:{paciente:{type:Object,required:!0}},emits:["editar","eliminar","ver-citas","gestionar-bonos","editar-cita"],setup(e){const a=e,s=t.computed(()=>{const e=a.paciente.nombre||"Sin nombre";if("Sin nombre"===e)return"Sin nombre";const t=e.trim().split(" ");if(t.length>2){return`${t[0]} ${t[1]} ${t[t.length-1].charAt(0)}.`}return e}),v=t.computed(()=>{const e=a.paciente.nombre||"";if(!e)return"??";const t=e.trim().split(" ");return`${t[0]?.charAt(0).toUpperCase()||"?"}${t[1]?.charAt(0).toUpperCase()||""}`}),b=t.computed(()=>{const e=["#D8AFA0","#C89B8A","#B7C6B0","#A8C5B5","#D4A5A5","#C4B5A0"];return e[a.paciente.id.charCodeAt(0)%e.length]}),f=t.computed(()=>{const e=a.paciente.estado_emocional_promedio||3;return e>=4?"ÔøΩ":e>=3?"üòê":"ÔøΩ"}),x=t.computed(()=>{const e=a.paciente.estado_emocional_promedio||3;return e>=4?"Estado positivo":e>=3?"Estado neutro":"Requiere atenci√≥n"}),g=t.computed(()=>a.paciente.activo?a.paciente.en_pausa?"En pausa":"Activo":"Finalizado"),h=t.computed(()=>a.paciente.activo?a.paciente.en_pausa?"bg-yellow-100 text-yellow-700":"bg-green-100 text-green-700":"bg-gray-100 text-gray-600"),_=t.computed(()=>a.paciente.area_de_acompanamiento||null),A=t.computed(()=>{if(!a.paciente.ultima_sesion)return"Sin registro";const e=new Date(a.paciente.ultima_sesion),t=new Date,o=Math.floor((t-e)/864e5);return 0===o?"Hoy":1===o?"Ayer":o<7?`Hace ${o} d√≠as`:o<30?`Hace ${Math.floor(o/7)} semanas`:e.toLocaleDateString("es-ES",{day:"numeric",month:"short"})}),y=t.computed(()=>{if(!a.paciente.proxima_sesion)return null;try{let e=a.paciente.proxima_sesion;e.includes("T")||(e+="T00:00:00");const t=new Date(e);return isNaN(t.getTime())?(console.warn("Fecha inv√°lida en pr√≥xima sesi√≥n:",a.paciente.proxima_sesion),null):t.toLocaleDateString("es-ES",{weekday:"short",day:"numeric",month:"short",hour:"2-digit",minute:"2-digit"})}catch(e){return console.error("Error al formatear pr√≥xima sesi√≥n:",e,a.paciente.proxima_sesion),null}}),w=t.computed(()=>a.paciente.total_sesiones||0),D=t.computed(()=>a.paciente.evolucion_porcentaje||50),C=t.computed(()=>{const e=D.value;return e>=70?"bg-green-500":e>=50?"bg-yellow-500":"bg-orange-500"}),$=t.computed(()=>{if(!a.paciente.ultima_sesion)return 0;const e=new Date(a.paciente.ultima_sesion),t=new Date;return Math.floor((t-e)/864e5)}),I=t.computed(()=>!(!a.paciente.activo||a.paciente.en_pausa)&&$.value>30),L=t.computed(()=>a.paciente.requiere_atencion||!1),k=t.computed(()=>a.paciente.bono_activo||null),B=t.computed(()=>{if(!k.value?.tipo)return"Sin tipo";return{otro:"A demanda",quincenal:"Quincenal",semanal:"Semanal",mensual:"Mensual",personalizado:"Personalizado"}[k.value.tipo]||k.value.tipo}),R=t.computed(()=>{if(!k.value?.tipo)return"bg-gray-100 text-gray-600";return{otro:"bg-blue-100 text-blue-700",quincenal:"bg-purple-100 text-purple-700",semanal:"bg-indigo-100 text-indigo-700",mensual:"bg-teal-100 text-teal-700",personalizado:"bg-pink-100 text-pink-700"}[k.value.tipo]||"bg-gray-100 text-gray-600"}),E=t.computed(()=>{if(!k.value?.estado)return"Sin estado";return{activo:"Activo",pendiente:"Pendiente",vencido:"Vencido",completado:"Completado"}[k.value.estado]||k.value.estado}),q=t.computed(()=>{if(!k.value?.estado)return"bg-gray-100 text-gray-600";return{activo:"bg-green-100 text-green-700",pendiente:"bg-yellow-100 text-yellow-700",vencido:"bg-red-100 text-red-700",completado:"bg-gray-100 text-gray-600"}[k.value.estado]||"bg-gray-100 text-gray-600"}),F=t.computed(()=>{if(!k.value?.fecha_fin)return"Sin fecha";try{return new Date(k.value.fecha_fin).toLocaleDateString("es-ES",{day:"numeric",month:"short",year:"numeric"})}catch(e){return"Fecha inv√°lida"}});t.computed(()=>{if(!k.value?.fecha_fin)return"text-cafe/60";const e=new Date(k.value.fecha_fin),a=new Date,t=Math.floor((e-a)/864e5);return t<0?"text-red-600 font-semibold":t<=7?"text-orange-600 font-semibold":t<=14?"text-amber-600":"text-cafe/80"});const S=t.computed(()=>k.value?k.value.sesiones_totales-k.value.sesiones_restantes:0),P=t.computed(()=>k.value?.sesiones_totales||0),j=t.computed(()=>{if(!k.value)return"text-terracota";const e=k.value.sesiones_restantes;return 0===e?"text-red-600 font-bold":1===e?"text-red-600 font-semibold":2===e?"text-orange-600 font-semibold":"text-terracota font-semibold"}),M=t.computed(()=>{if(!k.value)return 0;const e=k.value.sesiones_totales,a=k.value.sesiones_restantes;if(0===e)return 0;const t=e-a;return Math.round(t/e*100)}),z=t.computed(()=>M.value.toString()),T=t.computed(()=>{if(!k.value)return"bg-gray-400";return{activo:"bg-green-500",pendiente:"bg-yellow-500",vencido:"bg-red-500",completado:"bg-gray-400"}[k.value.estado]||"bg-gray-400"}),N=t.computed(()=>!!k.value&&1===k.value.sesiones_restantes),O=t.computed(()=>!!k.value&&2===k.value.sesiones_restantes);return(e,a,H,V)=>{a(`<div${o.ssrRenderAttrs(t.mergeProps({class:"bg-white rounded-xl shadow-sm border border-gray-100 p-6 hover:shadow-lg hover:border-gray-200 transition-all duration-300 group relative cursor-pointer"},V))} data-v-e4c2174f><div class="absolute top-4 right-4 flex gap-1.5 opacity-0 group-hover:opacity-100 transition-all duration-200 z-10" data-v-e4c2174f><button class="p-1.5 bg-purple-500 text-white rounded-lg hover:bg-purple-600 transition-colors shadow-md hover:shadow-lg" title="Gestionar bonos" data-v-e4c2174f><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-e4c2174f><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 5v2m0 4v2m0 4v2M5 5a2 2 0 00-2 2v3a2 2 0 110 4v3a2 2 0 002 2h14a2 2 0 002-2v-3a2 2 0 110-4V7a2 2 0 00-2-2H5z" data-v-e4c2174f></path></svg></button><button class="p-1.5 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors shadow-md hover:shadow-lg" title="Editar paciente" data-v-e4c2174f><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-e4c2174f><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z" data-v-e4c2174f></path></svg></button><button class="p-1.5 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors shadow-md hover:shadow-lg" title="Eliminar paciente" data-v-e4c2174f><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-e4c2174f><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" data-v-e4c2174f></path></svg></button></div><div class="flex items-start justify-between mb-5" data-v-e4c2174f><div class="flex items-center gap-3" data-v-e4c2174f><div class="w-12 h-12 rounded-full flex items-center justify-center text-white font-semibold text-lg flex-shrink-0 shadow-sm" style="${o.ssrRenderStyle({backgroundColor:t.unref(b)})}" data-v-e4c2174f>${o.ssrInterpolate(t.unref(v))}</div><div data-v-e4c2174f><h3 class="font-serif text-lg font-semibold text-cafe group-hover:text-terracota transition-colors leading-tight" data-v-e4c2174f>${o.ssrInterpolate(t.unref(s))}</h3><div class="flex items-center gap-2 mt-1" data-v-e4c2174f><span class="text-lg"${o.ssrRenderAttr("title",t.unref(x))} data-v-e4c2174f>${o.ssrInterpolate(t.unref(f))}</span><span class="text-xs text-gray-500" data-v-e4c2174f>${o.ssrInterpolate(t.unref(x))}</span></div></div></div><span class="${o.ssrRenderClass([t.unref(h),"px-2.5 py-1 text-xs font-medium rounded-full whitespace-nowrap"])}" data-v-e4c2174f>${o.ssrInterpolate(t.unref(g))}</span></div>`),t.unref(_)?a(`<div class="mb-4 flex items-center gap-2" data-v-e4c2174f><span class="text-xs text-gray-400 uppercase tracking-wide" data-v-e4c2174f>√Årea:</span><span class="text-sm text-gray-700 font-medium" data-v-e4c2174f>${o.ssrInterpolate(t.unref(_))}</span></div>`):a("\x3c!----\x3e"),a('<div class="space-y-3 mb-5" data-v-e4c2174f><div class="flex items-center gap-2 text-sm text-gray-600" data-v-e4c2174f>'),a(o.ssrRenderComponent(t.unref(r),{class:"w-4 h-4 text-terracota flex-shrink-0"},null,H)),a(`<span data-v-e4c2174f>√öltima sesi√≥n: </span><span class="font-medium" data-v-e4c2174f>${o.ssrInterpolate(t.unref(A))}</span></div><div class="flex items-center gap-2 text-sm text-gray-600" data-v-e4c2174f>`),a(o.ssrRenderComponent(t.unref(n),{class:"w-4 h-4 text-terracota flex-shrink-0"},null,H)),a("<span data-v-e4c2174f>Pr√≥xima: </span>"),t.unref(y)?a(`<button class="text-terracota hover:text-cafe font-medium hover:underline transition-colors flex-shrink-0"${o.ssrRenderAttr("title",`Editar cita del ${t.unref(y)}`)} data-v-e4c2174f>${o.ssrInterpolate(t.unref(y))}</button>`):a('<span class="text-gray-400 font-medium" data-v-e4c2174f>No programada</span>'),a('<button class="ml-auto text-xs text-terracota hover:text-cafe hover:underline transition-colors flex-shrink-0" title="Ver todas las citas" data-v-e4c2174f> Ver citas ‚Üí </button></div><div class="flex items-center gap-2 text-sm text-gray-600" data-v-e4c2174f>'),a(o.ssrRenderComponent(t.unref(l),{class:"w-4 h-4 text-terracota flex-shrink-0"},null,H)),a(`<span data-v-e4c2174f>${o.ssrInterpolate(t.unref(w))} sesiones completadas</span></div></div>`),t.unref(k)?(a('<div class="mb-5 p-4 bg-gradient-to-br from-terracota/8 to-rosa/12 rounded-xl border border-terracota/15" data-v-e4c2174f><div class="space-y-3" data-v-e4c2174f><div class="flex items-center justify-between" data-v-e4c2174f><div class="flex items-center gap-2" data-v-e4c2174f>'),a(o.ssrRenderComponent(t.unref(i),{class:"w-4 h-4 text-terracota flex-shrink-0"},null,H)),a(`<span class="text-sm font-medium text-gray-700" data-v-e4c2174f>Bono:</span><span class="${o.ssrRenderClass([t.unref(R),"px-2.5 py-1 rounded-lg text-xs font-semibold"])}" data-v-e4c2174f>${o.ssrInterpolate(t.unref(B))}</span></div><span class="${o.ssrRenderClass([t.unref(q),"px-2.5 py-1 rounded-full text-xs font-semibold flex items-center gap-1.5"])}" data-v-e4c2174f>`),a(o.ssrRenderComponent(t.unref(d),{class:"w-3 h-3"},null,H)),a(`<span data-v-e4c2174f>${o.ssrInterpolate(t.unref(E))}</span></span></div><div class="grid grid-cols-1 gap-2" data-v-e4c2174f><div class="flex items-center gap-2 text-sm" data-v-e4c2174f>`),a(o.ssrRenderComponent(t.unref(r),{class:"w-4 h-4 text-terracota flex-shrink-0"},null,H)),a(`<span class="text-gray-600" data-v-e4c2174f>Vigencia:</span><span class="${o.ssrRenderClass([e.fechaFinClases,"font-medium"])}" data-v-e4c2174f>${o.ssrInterpolate(t.unref(F))}</span></div><div class="flex items-center gap-2 text-sm" data-v-e4c2174f>`),a(o.ssrRenderComponent(t.unref(c),{class:"w-4 h-4 text-terracota flex-shrink-0"},null,H)),a(`<span class="text-gray-600" data-v-e4c2174f>Sesiones:</span><span class="${o.ssrRenderClass([t.unref(j),"font-semibold"])}" data-v-e4c2174f>${o.ssrInterpolate(t.unref(S))}/${o.ssrInterpolate(t.unref(P))}</span></div></div><div class="pt-1" data-v-e4c2174f><div class="flex items-center justify-between text-xs text-gray-500 mb-2" data-v-e4c2174f><span data-v-e4c2174f>Progreso del bono</span><span class="font-semibold text-gray-700" data-v-e4c2174f>${o.ssrInterpolate(t.unref(z))}%</span></div><div class="w-full bg-gray-200 rounded-full h-2 overflow-hidden" data-v-e4c2174f><div class="${o.ssrRenderClass([t.unref(T),"h-2 rounded-full transition-all duration-500"])}" style="${o.ssrRenderStyle({width:`${t.unref(M)}%`})}" data-v-e4c2174f></div></div></div></div></div>`)):a("\x3c!----\x3e"),a(`<div class="pt-5 border-t border-gray-100" data-v-e4c2174f><div class="flex items-center justify-between text-xs text-gray-500 mb-2" data-v-e4c2174f><span data-v-e4c2174f>Evoluci√≥n general</span><span class="font-semibold text-gray-700" data-v-e4c2174f>${o.ssrInterpolate(t.unref(D))}%</span></div><div class="w-full bg-gray-200 rounded-full h-2" data-v-e4c2174f><div class="${o.ssrRenderClass([t.unref(C),"h-2 rounded-full transition-all duration-500"])}" style="${o.ssrRenderStyle({width:`${t.unref(D)}%`})}" data-v-e4c2174f></div></div></div><div class="mt-5 space-y-2" data-v-e4c2174f>`),t.unref(N)?(a('<div class="flex items-start gap-3 p-3 bg-red-50 border border-red-200 rounded-lg animate-pulse-subtle" data-v-e4c2174f>'),a(o.ssrRenderComponent(t.unref(u),{class:"w-4 h-4 text-red-600 flex-shrink-0 mt-0.5"},null,H)),a(`<div class="flex-1" data-v-e4c2174f><p class="text-xs font-semibold text-red-800 mb-1" data-v-e4c2174f> Bono casi agotado </p><p class="text-xs text-red-700" data-v-e4c2174f> Solo queda ${o.ssrInterpolate(t.unref(k).sesiones_restantes)} sesi√≥n. Informar para renovaci√≥n. </p></div></div>`)):t.unref(O)?(a('<div class="flex items-start gap-3 p-3 bg-amber-50 border border-amber-200 rounded-lg" data-v-e4c2174f>'),a(o.ssrRenderComponent(t.unref(p),{class:"w-4 h-4 text-amber-600 flex-shrink-0 mt-0.5"},null,H)),a(`<div class="flex-1" data-v-e4c2174f><p class="text-xs font-semibold text-amber-800 mb-1" data-v-e4c2174f> Bono pr√≥ximo a agotar </p><p class="text-xs text-amber-700" data-v-e4c2174f> Quedan ${o.ssrInterpolate(t.unref(k).sesiones_restantes)} sesiones. Considerar renovaci√≥n. </p></div></div>`)):a("\x3c!----\x3e"),t.unref(I)?(a('<div class="flex items-start gap-3 p-3 bg-red-50 border border-red-200 rounded-lg animate-pulse-subtle" data-v-e4c2174f>'),a(o.ssrRenderComponent(t.unref(m),{class:"w-4 h-4 text-red-600 flex-shrink-0 mt-0.5"},null,H)),a(`<div class="flex-1" data-v-e4c2174f><p class="text-xs font-semibold text-red-800 mb-1" data-v-e4c2174f> Riesgo de abandono </p><p class="text-xs text-red-700" data-v-e4c2174f>${o.ssrInterpolate(t.unref($))} d√≠as sin sesi√≥n. Considera contactar pronto. </p></div></div>`)):a("\x3c!----\x3e"),t.unref(L)?(a('<div class="flex items-start gap-3 p-3 bg-orange-50 border border-orange-200 rounded-lg" data-v-e4c2174f>'),a(o.ssrRenderComponent(t.unref(p),{class:"w-4 h-4 text-orange-500 flex-shrink-0 mt-0.5"},null,H)),a('<div class="flex-1" data-v-e4c2174f><p class="text-xs font-semibold text-orange-800" data-v-e4c2174f> Requiere seguimiento especial por estado emocional </p></div></div>')):a("\x3c!----\x3e"),a("</div></div>")}}},D=w.setup;w.setup=(e,a)=>{const o=t.useSSRContext();return(o.modules||(o.modules=new Set)).add("components/PacienteCard.vue"),D?D(e,a):void 0};const C=s(w,[["__scopeId","data-v-e4c2174f"]]),$={__name:"ModalNuevoPaciente",__ssrInlineRender:!0,props:{mostrar:{type:Boolean,default:!1}},emits:["cerrar","paciente-creado"],setup(e,{emit:s}){const r=e;b(),f(),x(),a();const n=t.ref({nombre:"",apellido:"",email:"",telefono:"",fecha_nacimiento:"",area_acompanamiento:"",tipo_bono:"",primera_sesion:"",activo:!0,notas_iniciales:"",crear_bono:!1,bono_monto:0,bono_renovacion_automatica:!1}),l=t.ref(!1),i=t.ref(""),d={otro:60,quincenal:100,semanal:160,mensual:180},c=t.computed(()=>{const e=n.value.tipo_bono;if(!e)return 0;return{otro:1,quincenal:2,semanal:4,mensual:4}[e]||0}),u=t.computed(()=>({otro:"A Demanda",quincenal:"Quincenal",semanal:"Semanal",mensual:"Mensual"}[n.value.tipo_bono]||"No seleccionado")),p=t.computed(()=>{const e=c.value,a=n.value.bono_monto;return!e||!a||e<=0?"0.00":(a/e).toFixed(2)}),m=t.computed(()=>{const e=n.value.tipo_bono;return e&&d[e]||0}),v=t.computed(()=>"otro"===n.value.tipo_bono),g=t.computed(()=>{const e=new Date,a=[],formatearDateTime=(e,a)=>`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")}T${a}`,t=new Date(e);t.setDate(t.getDate()+1),a.push({label:"üåÖ Ma√±ana 10:00",datetime:formatearDateTime(t,"10:00")});const o=new Date(e),s=(8-o.getDay())%7;o.setDate(o.getDate()+(s||7)),a.push({label:"üìÖ Pr√≥ximo Lun 09:00",datetime:formatearDateTime(o,"09:00")});const r=new Date(e);return r.setDate(r.getDate()+7),a.push({label:"üóìÔ∏è En 7 d√≠as 16:00",datetime:formatearDateTime(r,"16:00")}),a}),h=t.computed(()=>{const e=n.value.nombre&&n.value.apellido&&n.value.email&&n.value.area_acompanamiento&&n.value.tipo_bono&&n.value.primera_sesion;return n.value.crear_bono?e&&n.value.bono_monto>0:e});t.watch(()=>n.value.tipo_bono,e=>{"otro"===e?(n.value.crear_bono=!1,n.value.bono_monto=0):n.value.crear_bono&&0===n.value.bono_monto&&(n.value.bono_monto=d[e]||0)}),t.watch(()=>n.value.crear_bono,e=>{e&&n.value.tipo_bono&&0===n.value.bono_monto&&(n.value.bono_monto=d[n.value.tipo_bono]||0)}),t.watch(()=>r.mostrar,e=>{e&&resetearFormulario()});const resetearFormulario=()=>{n.value={nombre:"",apellido:"",email:"",telefono:"",fecha_nacimiento:"",area_acompanamiento:"",tipo_bono:"",primera_sesion:"",activo:!0,notas_iniciales:"",crear_bono:!1,bono_monto:0,bono_renovacion_automatica:!1},i.value=""};return(a,s,r,d)=>{e.mostrar?(s(`<div${o.ssrRenderAttrs(t.mergeProps({class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"},d))}><div class="bg-white/95 backdrop-blur-lg rounded-2xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto border border-white/30"><div class="sticky top-0 bg-gradient-to-r from-[#5550F2]/5 via-[#027368]/5 to-[#04BF9D]/5 backdrop-blur-md border-b border-neutral-200 px-6 py-4 flex justify-between items-center shadow-sm"><h2 class="text-2xl font-[&#39;Elms_Sans&#39;] text-neutral-800 font-semibold"> Nuevo Paciente </h2><button class="text-neutral-600 hover:text-[#027368] transition-colors p-2 hover:bg-white/50 rounded-lg" aria-label="Cerrar modal"><svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button></div><form class="px-6 py-6 space-y-6 bg-gradient-to-b from-white/50 to-transparent"><div class="space-y-4"><h3 class="text-lg font-[&#39;Elms_Sans&#39;] text-neutral-800 font-semibold"> Informaci√≥n Personal </h3><div class="grid grid-cols-1 md:grid-cols-2 gap-4"><div><label for="nombre" class="block text-sm font-medium text-neutral-700 mb-1"> Nombre <span class="text-red-500">*</span></label><input id="nombre"${o.ssrRenderAttr("value",n.value.nombre)} type="text" required class="w-full px-4 py-2 border border-neutral-300 rounded-xl focus:ring-2 focus:ring-[#027368]/20 focus:border-[#027368] bg-white/90 backdrop-blur-sm transition-all shadow-sm" placeholder="Nombre del paciente"></div><div><label for="apellido" class="block text-sm font-medium text-neutral-700 mb-1"> Apellido <span class="text-red-500">*</span></label><input id="apellido"${o.ssrRenderAttr("value",n.value.apellido)} type="text" required class="w-full px-4 py-2 border border-neutral-300 rounded-xl focus:ring-2 focus:ring-[#027368]/20 focus:border-[#027368] bg-white/90 backdrop-blur-sm transition-all shadow-sm" placeholder="Apellido(s) del paciente"></div><div><label for="email" class="block text-sm font-medium text-neutral-700 mb-1"> Email <span class="text-red-500">*</span></label><input id="email"${o.ssrRenderAttr("value",n.value.email)} type="email" required class="w-full px-4 py-2 border border-neutral-300 rounded-xl focus:ring-2 focus:ring-[#027368]/20 focus:border-[#027368] bg-white/90 backdrop-blur-sm transition-all shadow-sm" placeholder="correo@ejemplo.com"></div><div><label for="telefono" class="block text-sm font-medium text-neutral-700 mb-1"> Tel√©fono </label><input id="telefono"${o.ssrRenderAttr("value",n.value.telefono)} type="tel" class="w-full px-4 py-2 border border-neutral-300 rounded-xl focus:ring-2 focus:ring-[#027368]/20 focus:border-[#027368] bg-white/90 backdrop-blur-sm transition-all shadow-sm" placeholder="+52 123 456 7890"></div><div><label for="fecha_nacimiento" class="block text-sm font-medium text-[#5D4A44] mb-1"> Fecha de Nacimiento </label><div class="relative"><input id="fecha_nacimiento"${o.ssrRenderAttr("value",n.value.fecha_nacimiento)} type="date" class="w-full px-4 py-2 pr-12 border border-[#D8AFA0]/30 rounded-lg focus:ring-2 focus:ring-[#D8AFA0] focus:border-transparent bg-white cursor-pointer"><button type="button" class="absolute right-2 top-1/2 -translate-y-1/2 p-2 text-[#D8AFA0] hover:text-[#5D4A44] transition-colors" title="Abrir calendario"><svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path></svg></button></div><p class="text-xs text-cafe/60 mt-1"> üí° Puedes escribir la fecha o usar el calendario </p></div></div></div><div class="space-y-4 pt-4 border-t border-neutral-200"><h3 class="text-lg font-[&#39;Elms_Sans&#39;] text-neutral-800 font-semibold"> Informaci√≥n Terap√©utica </h3><div class="grid grid-cols-1 md:grid-cols-2 gap-4"><div class="md:col-span-2"><label for="area_acompanamiento" class="block text-sm font-medium text-[#5D4A44] mb-1"> √Årea de Acompa√±amiento <span class="text-red-500">*</span></label><select id="area_acompanamiento" required class="w-full px-4 py-2 border border-[#D8AFA0]/30 rounded-lg focus:ring-2 focus:ring-[#D8AFA0] focus:border-transparent bg-white"><option value=""${o.ssrIncludeBooleanAttr(Array.isArray(n.value.area_acompanamiento)?o.ssrLooseContain(n.value.area_acompanamiento,""):o.ssrLooseEqual(n.value.area_acompanamiento,""))?" selected":""}>Selecciona un √°rea</option><option value="Ansiedad"${o.ssrIncludeBooleanAttr(Array.isArray(n.value.area_acompanamiento)?o.ssrLooseContain(n.value.area_acompanamiento,"Ansiedad"):o.ssrLooseEqual(n.value.area_acompanamiento,"Ansiedad"))?" selected":""}>Ansiedad</option><option value="Depresi√≥n"${o.ssrIncludeBooleanAttr(Array.isArray(n.value.area_acompanamiento)?o.ssrLooseContain(n.value.area_acompanamiento,"Depresi√≥n"):o.ssrLooseEqual(n.value.area_acompanamiento,"Depresi√≥n"))?" selected":""}>Depresi√≥n</option><option value="Autoestima"${o.ssrIncludeBooleanAttr(Array.isArray(n.value.area_acompanamiento)?o.ssrLooseContain(n.value.area_acompanamiento,"Autoestima"):o.ssrLooseEqual(n.value.area_acompanamiento,"Autoestima"))?" selected":""}>Autoestima</option><option value="Relaciones"${o.ssrIncludeBooleanAttr(Array.isArray(n.value.area_acompanamiento)?o.ssrLooseContain(n.value.area_acompanamiento,"Relaciones"):o.ssrLooseEqual(n.value.area_acompanamiento,"Relaciones"))?" selected":""}>Relaciones</option><option value="Duelo"${o.ssrIncludeBooleanAttr(Array.isArray(n.value.area_acompanamiento)?o.ssrLooseContain(n.value.area_acompanamiento,"Duelo"):o.ssrLooseEqual(n.value.area_acompanamiento,"Duelo"))?" selected":""}>Duelo</option><option value="Estr√©s Laboral"${o.ssrIncludeBooleanAttr(Array.isArray(n.value.area_acompanamiento)?o.ssrLooseContain(n.value.area_acompanamiento,"Estr√©s Laboral"):o.ssrLooseEqual(n.value.area_acompanamiento,"Estr√©s Laboral"))?" selected":""}>Estr√©s Laboral</option><option value="Crecimiento Personal"${o.ssrIncludeBooleanAttr(Array.isArray(n.value.area_acompanamiento)?o.ssrLooseContain(n.value.area_acompanamiento,"Crecimiento Personal"):o.ssrLooseEqual(n.value.area_acompanamiento,"Crecimiento Personal"))?" selected":""}>Crecimiento Personal</option><option value="Otro"${o.ssrIncludeBooleanAttr(Array.isArray(n.value.area_acompanamiento)?o.ssrLooseContain(n.value.area_acompanamiento,"Otro"):o.ssrLooseEqual(n.value.area_acompanamiento,"Otro"))?" selected":""}>Otro</option></select></div><div><label for="tipo_bono" class="block text-sm font-medium text-[#5D4A44] mb-1"> Tipo de Bono <span class="text-red-500">*</span></label><select id="tipo_bono" required class="w-full px-4 py-2 border border-[#D8AFA0]/30 rounded-lg focus:ring-2 focus:ring-[#D8AFA0] focus:border-transparent bg-white"><option value=""${o.ssrIncludeBooleanAttr(Array.isArray(n.value.tipo_bono)?o.ssrLooseContain(n.value.tipo_bono,""):o.ssrLooseEqual(n.value.tipo_bono,""))?" selected":""}>Selecciona tipo de bono</option><option value="otro"${o.ssrIncludeBooleanAttr(Array.isArray(n.value.tipo_bono)?o.ssrLooseContain(n.value.tipo_bono,"otro"):o.ssrLooseEqual(n.value.tipo_bono,"otro"))?" selected":""}>A Demanda (1 sesi√≥n - 60‚Ç¨ - sin compromiso)</option><option value="quincenal"${o.ssrIncludeBooleanAttr(Array.isArray(n.value.tipo_bono)?o.ssrLooseContain(n.value.tipo_bono,"quincenal"):o.ssrLooseEqual(n.value.tipo_bono,"quincenal"))?" selected":""}>Quincenal (2 sesiones/mes - 100‚Ç¨)</option><option value="semanal"${o.ssrIncludeBooleanAttr(Array.isArray(n.value.tipo_bono)?o.ssrLooseContain(n.value.tipo_bono,"semanal"):o.ssrLooseEqual(n.value.tipo_bono,"semanal"))?" selected":""}>Semanal (4 sesiones/mes - 160‚Ç¨)</option><option value="mensual"${o.ssrIncludeBooleanAttr(Array.isArray(n.value.tipo_bono)?o.ssrLooseContain(n.value.tipo_bono,"mensual"):o.ssrLooseEqual(n.value.tipo_bono,"mensual"))?" selected":""}>Mensual</option></select><p class="text-xs text-cafe/60 mt-1"> üé´ Define el tipo de bono del paciente </p></div><div><label for="primera_sesion" class="block text-sm font-medium text-[#5D4A44] mb-1"> Primera Sesi√≥n <span class="text-red-500">*</span></label><div class="relative"><input id="primera_sesion"${o.ssrRenderAttr("value",n.value.primera_sesion)} type="datetime-local" required step="1800" class="w-full px-4 py-2 pr-12 border border-[#D8AFA0]/30 rounded-lg focus:ring-2 focus:ring-[#D8AFA0] focus:border-transparent bg-white cursor-pointer"><button type="button" class="absolute right-2 top-1/2 -translate-y-1/2 p-2 text-[#D8AFA0] hover:text-[#5D4A44] transition-colors" title="Abrir selector de fecha y hora"><svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg></button></div><div class="flex gap-2 flex-wrap mt-2">\x3c!--[--\x3e`),o.ssrRenderList(t.unref(g),(e,a)=>{s(`<button type="button" class="${o.ssrRenderClass(["text-xs px-3 py-1.5 rounded-lg border transition-all",n.value.primera_sesion===e.datetime?"bg-[#D8AFA0] text-white border-[#D8AFA0] font-semibold":"bg-white text-[#5D4A44] border-[#D8AFA0]/30 hover:border-[#D8AFA0] hover:bg-[#D8AFA0]/10"])}">${o.ssrInterpolate(e.label)}</button>`)}),s('\x3c!--]--\x3e</div><p class="text-xs text-cafe/60 mt-1"> üí° Puedes escribir la fecha/hora o usar el selector </p></div></div></div><div class="space-y-4 pt-4 border-t border-[#D8AFA0]/30"><div class="border-t pt-6"><h3 class="text-lg font-[&#39;Lora&#39;] text-[#5D4A44] font-semibold mb-2"> üí≥ Bono Inicial (Opcional) </h3>'),t.unref(v)?s('<div class="bg-amber-50 border-2 border-amber-200 rounded-lg p-4 mb-3"><div class="flex items-start gap-3"><span class="text-2xl">‚ÑπÔ∏è</span><div><p class="text-sm font-semibold text-amber-900 mb-1"> Sesi√≥n &quot;A Demanda&quot; seleccionada </p><p class="text-sm text-amber-800"> Las sesiones a demanda son <strong>sin compromiso</strong> y se pagan individualmente (60‚Ç¨ por sesi√≥n). No es necesario crear un bono prepagado. </p></div></div></div>'):s('<p class="text-sm text-cafe/70 mb-3"> Crea un bono prepagado para que el paciente empiece su tratamiento. Podr√°s confirmar el pago despu√©s. </p>'),s(`<label class="${o.ssrRenderClass([t.unref(v)?"bg-gray-100 border-2 border-gray-200 cursor-not-allowed opacity-60":"bg-purple-50 border-2 border-purple-200 cursor-pointer hover:bg-purple-100","flex items-center gap-3 p-3 rounded-lg transition-colors"])}"><input${o.ssrIncludeBooleanAttr(Array.isArray(n.value.crear_bono)?o.ssrLooseContain(n.value.crear_bono,null):n.value.crear_bono)?" checked":""} type="checkbox"${o.ssrIncludeBooleanAttr(t.unref(v))?" disabled":""} class="w-5 h-5 text-purple-600 border-gray-300 rounded focus:ring-purple-500 disabled:opacity-50 disabled:cursor-not-allowed"><span class="${o.ssrRenderClass([t.unref(v)?"text-gray-500":"text-purple-700","text-sm font-semibold"])}"> ‚úÖ S√≠, crear bono prepagado para este paciente </span></label></div>`),n.value.crear_bono?(s(`<div class="border-2 border-purple-400/40 rounded-lg p-5 space-y-4 bg-gradient-to-br from-purple-50 to-purple-100/50"><div class="bg-white border-2 border-purple-300 rounded-lg p-4 shadow-sm"><div class="flex items-start gap-3"><div class="w-10 h-10 bg-purple-500 rounded-full flex items-center justify-center flex-shrink-0"><span class="text-white text-xl">üéüÔ∏è</span></div><div class="flex-1"><h4 class="font-semibold text-purple-900 mb-1"> Tipo de Bono: ${o.ssrInterpolate(t.unref(u)||"Selecciona un tipo arriba")}</h4><div class="grid grid-cols-2 gap-3 text-sm"><div class="flex items-center gap-2"><span class="text-purple-600">üìä</span><span class="text-purple-800"><strong>${o.ssrInterpolate(t.unref(c))}</strong> ${o.ssrInterpolate(1===t.unref(c)?"sesi√≥n":"sesiones")}</span></div>`),t.unref(m)>0?s(`<div class="flex items-center gap-2"><span class="text-purple-600">üí∞</span><span class="text-purple-800"> Precio sugerido: <strong>‚Ç¨${o.ssrInterpolate(t.unref(m))}</strong></span></div>`):s("\x3c!----\x3e"),s(`</div><p class="text-xs text-purple-600 mt-2 bg-purple-50 p-2 rounded"> üí° <strong>Tip:</strong> Los precios se calcular√°n autom√°ticamente seg√∫n el tipo de bono </p></div></div></div><div class="grid grid-cols-1 md:grid-cols-2 gap-4"><div><label for="bono_monto" class="block text-sm font-medium text-[#5D4A44] mb-1"> Monto Total <span class="text-red-500">*</span></label><div class="relative"><span class="absolute left-3 top-1/2 -translate-y-1/2 text-[#5D4A44]/60">‚Ç¨</span><input id="bono_monto"${o.ssrRenderAttr("value",n.value.bono_monto)} type="number" min="0" step="0.01"${o.ssrIncludeBooleanAttr(n.value.crear_bono)?" required":""} placeholder="0.00" class="w-full pl-8 pr-4 py-2 border border-purple-300 rounded-lg focus:ring-2 focus:ring-purple-500 bg-white"></div></div><div><label class="block text-sm font-medium text-[#5D4A44] mb-1"> Precio por Sesi√≥n </label><div class="px-4 py-2 bg-purple-100 rounded-lg border border-purple-300"><span class="text-lg font-bold text-purple-700">‚Ç¨${o.ssrInterpolate(t.unref(p))}</span></div></div><div class="md:col-span-2"><label class="flex items-start gap-3 p-4 bg-white border-2 border-purple-200 rounded-lg cursor-pointer hover:bg-purple-50 hover:border-purple-300 transition-all"><input${o.ssrIncludeBooleanAttr(Array.isArray(n.value.bono_renovacion_automatica)?o.ssrLooseContain(n.value.bono_renovacion_automatica,null):n.value.bono_renovacion_automatica)?" checked":""} type="checkbox" class="mt-1 w-5 h-5 text-purple-600 border-gray-300 rounded focus:ring-purple-500"><div class="flex-1"><div class="flex items-center gap-2 mb-1"><span class="text-lg">üîÑ</span><span class="text-sm font-semibold text-purple-900"> Renovaci√≥n Autom√°tica </span><span class="ml-auto px-2 py-0.5 bg-purple-100 text-purple-700 text-xs font-medium rounded"> Recomendado </span></div><div class="text-xs text-[#5D4A44]/70 space-y-1"><p>‚úì El bono se renovar√° autom√°ticamente cuando se agoten las sesiones o expire</p><p>‚úì Mantiene la continuidad del tratamiento sin interrupciones</p><p>‚úì Puedes desactivar la renovaci√≥n en cualquier momento</p></div></div></label></div></div>`),t.unref(c)>0&&n.value.bono_monto>0?s(`<div class="p-3 bg-white rounded-lg border border-purple-300"><div class="text-xs font-medium text-purple-800 mb-2">üìã Resumen del Bono</div><div class="grid grid-cols-3 gap-2 text-xs"><div><span class="text-[#5D4A44]/60">Tipo:</span><span class="font-medium text-[#5D4A44] ml-1">${o.ssrInterpolate(t.unref(u))}</span></div><div><span class="text-[#5D4A44]/60">Sesiones:</span><span class="font-medium text-[#5D4A44] ml-1">${o.ssrInterpolate(t.unref(c))}</span></div><div><span class="text-[#5D4A44]/60">Total:</span><span class="font-medium text-[#5D4A44] ml-1">‚Ç¨${o.ssrInterpolate(n.value.bono_monto)}</span></div></div></div>`):s("\x3c!----\x3e"),s("</div>")):s("\x3c!----\x3e"),s(`</div><div class="space-y-4 pt-4 border-t border-[#D8AFA0]/30"><h3 class="text-lg font-[&#39;Lora&#39;] text-[#5D4A44] font-semibold"> Notas Iniciales </h3><div><label for="notas_iniciales" class="block text-sm font-medium text-[#5D4A44] mb-1"> Observaciones (Opcional) </label><textarea id="notas_iniciales" rows="3" class="w-full px-4 py-2 border border-[#D8AFA0]/30 rounded-lg focus:ring-2 focus:ring-[#D8AFA0] focus:border-transparent bg-white resize-none" placeholder="Observaciones iniciales, motivo de consulta, etc.">${o.ssrInterpolate(n.value.notas_iniciales)}</textarea></div></div>`),i.value?s(`<div class="bg-red-50 border border-red-200 rounded-lg p-4"><p class="text-sm text-red-600">${o.ssrInterpolate(i.value)}</p></div>`):s("\x3c!----\x3e"),s(`<div class="sticky bottom-0 bg-gradient-to-r from-white/95 via-white/90 to-white/95 backdrop-blur-md pt-4 pb-2 border-t border-neutral-200 -mx-6 px-6 mt-6 shadow-sm"><div class="flex justify-between items-center gap-3"><div class="text-xs text-neutral-600"><span class="inline-block w-2 h-2 bg-red-500 rounded-full mr-1"></span> Los campos con * son obligatorios </div><div class="flex gap-3"><button type="button"${o.ssrIncludeBooleanAttr(l.value)?" disabled":""} class="px-6 py-2.5 border-2 border-neutral-300 text-neutral-700 font-medium rounded-xl hover:bg-neutral-50 hover:border-[#027368] transition-all disabled:opacity-50 disabled:cursor-not-allowed"> Cancelar </button><button type="submit"${o.ssrIncludeBooleanAttr(l.value||!t.unref(h))?" disabled":""} class="px-8 py-2.5 bg-gradient-to-r from-[#04BF9D] to-[#027368] text-white font-semibold rounded-xl hover:from-[#027368] hover:to-[#04BF9D] transition-all disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2 shadow-sm hover:shadow-md">`),l.value?s('<span class="inline-block w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"></span>'):s("<span>‚úì</span>"),s(` ${o.ssrInterpolate(l.value?"Creando paciente...":"Crear Paciente")}</button></div></div></div></form></div></div>`)):s("\x3c!----\x3e")}}},I=$.setup;$.setup=(e,a)=>{const o=t.useSSRContext();return(o.modules||(o.modules=new Set)).add("components/ModalNuevoPaciente.vue"),I?I(e,a):void 0};const L=Object.assign($,{__name:"ModalNuevoPaciente"}),k={__name:"ModalEditarPaciente",__ssrInlineRender:!0,props:{mostrar:{type:Boolean,default:!1},paciente:{type:Object,default:null}},emits:["cerrar","paciente-actualizado"],setup(e,{emit:a}){const s=e;b(),f();const r=t.ref({nombre:"",apellido:"",email:"",telefono:"",fecha_nacimiento:"",area_acompanamiento:"",tipo_bono:"",activo:!0,en_pausa:!1,crear_bono:!1,bono_monto:null,bono_renovacion_automatica:!1}),n=t.computed(()=>{const e=r.value.tipo_bono;if(!e)return"Selecciona tipo";return{a_demanda:1,quincenal:2,semanal:4}[e]||0}),l=t.computed(()=>({a_demanda:"A Demanda",quincenal:"Quincenal",semanal:"Semanal"}[r.value.tipo_bono]||"")),i=t.computed(()=>{const e=n.value,a=r.value.bono_monto;return"Selecciona tipo"===e||!a||e<=0?"0.00":(a/e).toFixed(2)}),d=t.ref(!1),c=t.ref("");t.watch(()=>s.mostrar,e=>{e&&s.paciente&&cargarDatosPaciente()});const cargarDatosPaciente=()=>{const e=s.paciente,a=e.metadata||{},t=(e.nombre_completo||e.nombre||"").split(" "),o=t[0]||a.nombre||"",n=t.slice(1).join(" ")||a.apellido||a.apellido_paterno||"";r.value={nombre:o,apellido:n,email:e.email||"",telefono:e.telefono||"",fecha_nacimiento:a.fecha_nacimiento||"",area_acompanamiento:e.area_de_acompanamiento||e.area_acompanamiento||"",tipo_bono:e.tipo_bono||"",activo:e.activo??!0,en_pausa:e.en_pausa||a.en_pausa||!1,crear_bono:!1,bono_monto:null,bono_renovacion_automatica:!1},c.value=""};return(a,s,u,p)=>{e.mostrar?(s(`<div${o.ssrRenderAttrs(t.mergeProps({class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"},p))} data-v-931716c5><div class="bg-[#F9F7F3] rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto" data-v-931716c5><div class="sticky top-0 bg-[#F9F7F3] border-b border-[#D8AFA0]/30 px-6 py-4 flex justify-between items-center" data-v-931716c5><h2 class="text-2xl font-[&#39;Lora&#39;] text-[#5D4A44] font-semibold" data-v-931716c5> Editar Paciente </h2><button class="text-[#5D4A44] hover:text-[#D8AFA0] transition-colors" aria-label="Cerrar modal" data-v-931716c5><svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-931716c5><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" data-v-931716c5></path></svg></button></div><form class="px-6 py-6 space-y-6" data-v-931716c5><div class="space-y-4" data-v-931716c5><h3 class="text-lg font-[&#39;Lora&#39;] text-[#5D4A44] font-semibold" data-v-931716c5> Informaci√≥n Personal </h3><div class="grid grid-cols-1 md:grid-cols-2 gap-4" data-v-931716c5><div data-v-931716c5><label for="nombre" class="block text-sm font-medium text-[#5D4A44] mb-1" data-v-931716c5> Nombre <span class="text-red-500" data-v-931716c5>*</span></label><input id="nombre"${o.ssrRenderAttr("value",r.value.nombre)} type="text" required class="w-full px-4 py-2 border border-[#D8AFA0]/30 rounded-lg focus:ring-2 focus:ring-[#D8AFA0] focus:border-transparent bg-white" placeholder="Nombre del paciente" data-v-931716c5></div><div data-v-931716c5><label for="apellido" class="block text-sm font-medium text-[#5D4A44] mb-1" data-v-931716c5> Apellido <span class="text-red-500" data-v-931716c5>*</span></label><input id="apellido"${o.ssrRenderAttr("value",r.value.apellido)} type="text" required class="w-full px-4 py-2 border border-[#D8AFA0]/30 rounded-lg focus:ring-2 focus:ring-[#D8AFA0] focus:border-transparent bg-white" placeholder="Apellido(s) del paciente" data-v-931716c5></div><div data-v-931716c5><label for="email" class="block text-sm font-medium text-[#5D4A44] mb-1" data-v-931716c5> Email <span class="text-red-500" data-v-931716c5>*</span></label><input id="email"${o.ssrRenderAttr("value",r.value.email)} type="email" required class="w-full px-4 py-2 border border-[#D8AFA0]/30 rounded-lg focus:ring-2 focus:ring-[#D8AFA0] focus:border-transparent bg-white" placeholder="correo@ejemplo.com" data-v-931716c5></div><div data-v-931716c5><label for="telefono" class="block text-sm font-medium text-[#5D4A44] mb-1" data-v-931716c5> Tel√©fono </label><input id="telefono"${o.ssrRenderAttr("value",r.value.telefono)} type="tel" class="w-full px-4 py-2 border border-[#D8AFA0]/30 rounded-lg focus:ring-2 focus:ring-[#D8AFA0] focus:border-transparent bg-white" placeholder="+52 123 456 7890" data-v-931716c5></div><div data-v-931716c5><label for="fecha_nacimiento" class="block text-sm font-medium text-[#5D4A44] mb-1" data-v-931716c5> Fecha de Nacimiento </label><input id="fecha_nacimiento"${o.ssrRenderAttr("value",r.value.fecha_nacimiento)} type="date" class="w-full px-4 py-2 border border-[#D8AFA0]/30 rounded-lg focus:ring-2 focus:ring-[#D8AFA0] focus:border-transparent bg-white" data-v-931716c5></div></div></div><div class="space-y-4 pt-4 border-t border-[#D8AFA0]/30" data-v-931716c5><h3 class="text-lg font-[&#39;Lora&#39;] text-[#5D4A44] font-semibold" data-v-931716c5> Informaci√≥n Terap√©utica </h3><div class="grid grid-cols-1 md:grid-cols-2 gap-4" data-v-931716c5><div class="md:col-span-2" data-v-931716c5><label for="area_acompanamiento" class="block text-sm font-medium text-[#5D4A44] mb-1" data-v-931716c5> √Årea de Acompa√±amiento <span class="text-red-500" data-v-931716c5>*</span></label><select id="area_acompanamiento" required class="w-full px-4 py-2 border border-[#D8AFA0]/30 rounded-lg focus:ring-2 focus:ring-[#D8AFA0] focus:border-transparent bg-white" data-v-931716c5><option value="" data-v-931716c5${o.ssrIncludeBooleanAttr(Array.isArray(r.value.area_acompanamiento)?o.ssrLooseContain(r.value.area_acompanamiento,""):o.ssrLooseEqual(r.value.area_acompanamiento,""))?" selected":""}>Selecciona un √°rea</option><option value="Ansiedad" data-v-931716c5${o.ssrIncludeBooleanAttr(Array.isArray(r.value.area_acompanamiento)?o.ssrLooseContain(r.value.area_acompanamiento,"Ansiedad"):o.ssrLooseEqual(r.value.area_acompanamiento,"Ansiedad"))?" selected":""}>Ansiedad</option><option value="Depresi√≥n" data-v-931716c5${o.ssrIncludeBooleanAttr(Array.isArray(r.value.area_acompanamiento)?o.ssrLooseContain(r.value.area_acompanamiento,"Depresi√≥n"):o.ssrLooseEqual(r.value.area_acompanamiento,"Depresi√≥n"))?" selected":""}>Depresi√≥n</option><option value="Autoestima" data-v-931716c5${o.ssrIncludeBooleanAttr(Array.isArray(r.value.area_acompanamiento)?o.ssrLooseContain(r.value.area_acompanamiento,"Autoestima"):o.ssrLooseEqual(r.value.area_acompanamiento,"Autoestima"))?" selected":""}>Autoestima</option><option value="Relaciones" data-v-931716c5${o.ssrIncludeBooleanAttr(Array.isArray(r.value.area_acompanamiento)?o.ssrLooseContain(r.value.area_acompanamiento,"Relaciones"):o.ssrLooseEqual(r.value.area_acompanamiento,"Relaciones"))?" selected":""}>Relaciones</option><option value="Duelo" data-v-931716c5${o.ssrIncludeBooleanAttr(Array.isArray(r.value.area_acompanamiento)?o.ssrLooseContain(r.value.area_acompanamiento,"Duelo"):o.ssrLooseEqual(r.value.area_acompanamiento,"Duelo"))?" selected":""}>Duelo</option><option value="Estr√©s Laboral" data-v-931716c5${o.ssrIncludeBooleanAttr(Array.isArray(r.value.area_acompanamiento)?o.ssrLooseContain(r.value.area_acompanamiento,"Estr√©s Laboral"):o.ssrLooseEqual(r.value.area_acompanamiento,"Estr√©s Laboral"))?" selected":""}>Estr√©s Laboral</option><option value="Crecimiento Personal" data-v-931716c5${o.ssrIncludeBooleanAttr(Array.isArray(r.value.area_acompanamiento)?o.ssrLooseContain(r.value.area_acompanamiento,"Crecimiento Personal"):o.ssrLooseEqual(r.value.area_acompanamiento,"Crecimiento Personal"))?" selected":""}>Crecimiento Personal</option><option value="Otro" data-v-931716c5${o.ssrIncludeBooleanAttr(Array.isArray(r.value.area_acompanamiento)?o.ssrLooseContain(r.value.area_acompanamiento,"Otro"):o.ssrLooseEqual(r.value.area_acompanamiento,"Otro"))?" selected":""}>Otro</option></select></div><div data-v-931716c5><label for="tipo_bono" class="block text-sm font-medium text-[#5D4A44] mb-1" data-v-931716c5> Tipo de Bono <span class="text-red-500" data-v-931716c5>*</span></label><select id="tipo_bono" required class="w-full px-4 py-2 border border-[#D8AFA0]/30 rounded-lg focus:ring-2 focus:ring-[#D8AFA0] focus:border-transparent bg-white" data-v-931716c5><option value="" data-v-931716c5${o.ssrIncludeBooleanAttr(Array.isArray(r.value.tipo_bono)?o.ssrLooseContain(r.value.tipo_bono,""):o.ssrLooseEqual(r.value.tipo_bono,""))?" selected":""}>Selecciona tipo de bono</option><option value="a_demanda" data-v-931716c5${o.ssrIncludeBooleanAttr(Array.isArray(r.value.tipo_bono)?o.ssrLooseContain(r.value.tipo_bono,"a_demanda"):o.ssrLooseEqual(r.value.tipo_bono,"a_demanda"))?" selected":""}>A Demanda (1 sesi√≥n)</option><option value="quincenal" data-v-931716c5${o.ssrIncludeBooleanAttr(Array.isArray(r.value.tipo_bono)?o.ssrLooseContain(r.value.tipo_bono,"quincenal"):o.ssrLooseEqual(r.value.tipo_bono,"quincenal"))?" selected":""}>Quincenal (2 sesiones/mes)</option><option value="semanal" data-v-931716c5${o.ssrIncludeBooleanAttr(Array.isArray(r.value.tipo_bono)?o.ssrLooseContain(r.value.tipo_bono,"semanal"):o.ssrLooseEqual(r.value.tipo_bono,"semanal"))?" selected":""}>Semanal (4 sesiones/mes)</option></select></div><div data-v-931716c5><label for="activo" class="block text-sm font-medium text-[#5D4A44] mb-1" data-v-931716c5> Estado </label><select id="activo" class="w-full px-4 py-2 border border-[#D8AFA0]/30 rounded-lg focus:ring-2 focus:ring-[#D8AFA0] focus:border-transparent bg-white" data-v-931716c5><option${o.ssrRenderAttr("value",!0)} data-v-931716c5${o.ssrIncludeBooleanAttr(Array.isArray(r.value.activo)?o.ssrLooseContain(r.value.activo,!0):o.ssrLooseEqual(r.value.activo,!0))?" selected":""}>Activo</option><option${o.ssrRenderAttr("value",!1)} data-v-931716c5${o.ssrIncludeBooleanAttr(Array.isArray(r.value.activo)?o.ssrLooseContain(r.value.activo,!1):o.ssrLooseEqual(r.value.activo,!1))?" selected":""}>Inactivo</option></select></div><div class="md:col-span-2" data-v-931716c5><label class="flex items-center gap-2 cursor-pointer" data-v-931716c5><input${o.ssrIncludeBooleanAttr(Array.isArray(r.value.en_pausa)?o.ssrLooseContain(r.value.en_pausa,null):r.value.en_pausa)?" checked":""} type="checkbox" class="w-4 h-4 text-[#D8AFA0] border-gray-300 rounded focus:ring-[#D8AFA0]" data-v-931716c5><span class="text-sm font-medium text-[#5D4A44]" data-v-931716c5> Proceso en pausa temporal </span></label><p class="text-xs text-cafe/60 mt-1 ml-6" data-v-931716c5> ‚è∏Ô∏è Marca esta opci√≥n si el seguimiento est√° pausado temporalmente </p></div></div></div><div class="space-y-4 pt-4 border-t border-[#D8AFA0]/30" data-v-931716c5><div class="flex items-center justify-between" data-v-931716c5><h3 class="text-lg font-[&#39;Lora&#39;] text-[#5D4A44] font-semibold" data-v-931716c5> Gesti√≥n de Bonos </h3><label class="flex items-center gap-2 cursor-pointer" data-v-931716c5><input${o.ssrIncludeBooleanAttr(Array.isArray(r.value.crear_bono)?o.ssrLooseContain(r.value.crear_bono,null):r.value.crear_bono)?" checked":""} type="checkbox" class="w-4 h-4 text-purple-600 border-gray-300 rounded focus:ring-purple-500" data-v-931716c5><span class="text-sm font-medium text-[#5D4A44]" data-v-931716c5> üé´ Crear nuevo bono para este paciente </span></label></div>`),r.value.crear_bono?(s(`<div class="border-2 border-purple-400/40 rounded-lg p-4 space-y-4 bg-purple-50/30" data-v-931716c5><div class="bg-purple-100 border border-purple-300 rounded-lg p-3 flex items-start gap-2" data-v-931716c5><svg class="w-5 h-5 text-purple-600 flex-shrink-0 mt-0.5" fill="currentColor" viewBox="0 0 20 20" data-v-931716c5><path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd" data-v-931716c5></path></svg><div class="text-sm text-purple-800" data-v-931716c5><p class="font-medium" data-v-931716c5>El bono usar√° el tipo seleccionado arriba: <strong data-v-931716c5>${o.ssrInterpolate(l.value||"Selecciona un tipo primero")}</strong></p><p class="text-xs text-purple-700 mt-1" data-v-931716c5> Sesiones incluidas: ${o.ssrInterpolate("Selecciona tipo"===n.value?"N/A":n.value)}</p></div></div><div class="grid grid-cols-1 md:grid-cols-2 gap-4" data-v-931716c5><div data-v-931716c5><label for="bono_monto" class="block text-sm font-medium text-[#5D4A44] mb-1" data-v-931716c5> Monto Total <span class="text-red-500" data-v-931716c5>*</span></label><div class="relative" data-v-931716c5><span class="absolute left-3 top-2.5 text-[#5D4A44] font-medium" data-v-931716c5>‚Ç¨</span><input id="bono_monto"${o.ssrRenderAttr("value",r.value.bono_monto)} type="number" min="0" step="0.01"${o.ssrIncludeBooleanAttr(r.value.crear_bono)?" required":""} class="w-full pl-8 pr-4 py-2 border border-[#D8AFA0]/30 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent bg-white" placeholder="0.00" data-v-931716c5></div></div><div data-v-931716c5><label class="block text-sm font-medium text-[#5D4A44] mb-1" data-v-931716c5> Precio por Sesi√≥n </label><div class="px-4 py-2 bg-purple-100 border-2 border-purple-300 rounded-lg text-purple-900 font-bold" data-v-931716c5> ‚Ç¨${o.ssrInterpolate(i.value)}</div></div><div class="md:col-span-2" data-v-931716c5><label class="flex items-center gap-2 cursor-pointer" data-v-931716c5><input${o.ssrIncludeBooleanAttr(Array.isArray(r.value.bono_renovacion_automatica)?o.ssrLooseContain(r.value.bono_renovacion_automatica,null):r.value.bono_renovacion_automatica)?" checked":""} type="checkbox" class="w-4 h-4 text-purple-600 border-gray-300 rounded focus:ring-purple-500" data-v-931716c5><span class="text-sm font-medium text-[#5D4A44]" data-v-931716c5> üîÑ Renovaci√≥n autom√°tica al vencer </span></label><p class="text-xs text-cafe/60 mt-1 ml-6" data-v-931716c5> El sistema crear√° un nuevo bono id√©ntico cuando este expire </p></div></div>`),n.value&&r.value.bono_monto?(s(`<div class="bg-white border border-purple-300 rounded-lg p-4" data-v-931716c5><p class="text-sm font-medium text-[#5D4A44] mb-2" data-v-931716c5>üìã Resumen del Bono:</p><div class="text-sm text-cafe/80 space-y-1" data-v-931716c5><p data-v-931716c5>‚Ä¢ <strong data-v-931716c5>Tipo:</strong> ${o.ssrInterpolate(l.value)}</p><p data-v-931716c5>‚Ä¢ <strong data-v-931716c5>Sesiones:</strong> ${o.ssrInterpolate(n.value)}</p><p data-v-931716c5>‚Ä¢ <strong data-v-931716c5>Total:</strong> ‚Ç¨${o.ssrInterpolate(r.value.bono_monto.toFixed(2))}</p><p data-v-931716c5>‚Ä¢ <strong data-v-931716c5>Por sesi√≥n:</strong> ‚Ç¨${o.ssrInterpolate(i.value)}</p>`),r.value.bono_renovacion_automatica?s('<p class="text-purple-700" data-v-931716c5>‚Ä¢ ‚úÖ Con renovaci√≥n autom√°tica</p>'):s("\x3c!----\x3e"),s("</div></div>")):s("\x3c!----\x3e"),s("</div>")):s("\x3c!----\x3e"),s("</div>"),c.value?s(`<div class="bg-red-50 border border-red-200 rounded-lg p-4" data-v-931716c5><p class="text-sm text-red-600" data-v-931716c5>${o.ssrInterpolate(c.value)}</p></div>`):s("\x3c!----\x3e"),s(`<div class="flex justify-end gap-3 pt-4 border-t border-[#D8AFA0]/30" data-v-931716c5><button type="button"${o.ssrIncludeBooleanAttr(d.value)?" disabled":""} class="px-6 py-2 border border-[#D8AFA0] text-[#5D4A44] rounded-lg hover:bg-[#D8AFA0]/10 transition-colors disabled:opacity-50 disabled:cursor-not-allowed" data-v-931716c5> Cancelar </button><button type="submit"${o.ssrIncludeBooleanAttr(d.value)?" disabled":""} class="px-6 py-2 bg-[#D8AFA0] text-white rounded-lg hover:bg-[#C69F91] transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2" data-v-931716c5>`),d.value?s('<span class="inline-block w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin" data-v-931716c5></span>'):s("\x3c!----\x3e"),s(` ${o.ssrInterpolate(d.value?"Actualizando...":"Guardar Cambios")}</button></div></form></div></div>`)):s("\x3c!----\x3e")}}},B=k.setup;k.setup=(e,a)=>{const o=t.useSSRContext();return(o.modules||(o.modules=new Set)).add("components/ModalEditarPaciente.vue"),B?B(e,a):void 0};const R=s(k,[["__scopeId","data-v-931716c5"]]),E={__name:"ModalEliminarPaciente",__ssrInlineRender:!0,props:{mostrar:{type:Boolean,default:!1},paciente:{type:Object,default:null}},emits:["cerrar","paciente-eliminado","paciente-desactivado"],setup(e,{emit:a}){const s=e;b();const r=t.ref(!1),n=t.ref(""),l=t.computed(()=>s.paciente?s.paciente.nombre_completo||s.paciente.nombre||s.paciente.email||"este paciente":"");return(a,s,i,d)=>{e.mostrar?(s(`<div${o.ssrRenderAttrs(t.mergeProps({class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"},d))} data-v-650451a2><div class="bg-[#F9F7F3] rounded-lg shadow-xl max-w-md w-full" data-v-650451a2><div class="px-6 py-4 border-b border-[#D8AFA0]/30" data-v-650451a2><div class="flex items-center gap-3" data-v-650451a2><span class="text-3xl" data-v-650451a2>‚ö†Ô∏è</span><h2 class="text-2xl font-[&#39;Lora&#39;] text-[#5D4A44] font-semibold" data-v-650451a2> Eliminar Paciente </h2></div></div><div class="px-6 py-6 space-y-4" data-v-650451a2><p class="text-[#5D4A44]" data-v-650451a2> ¬øEst√°s seguro de que deseas eliminar a <strong class="font-semibold" data-v-650451a2>${o.ssrInterpolate(l.value)}</strong>? </p><div class="bg-red-50 border border-red-200 rounded-lg p-4 space-y-2" data-v-650451a2><p class="text-sm text-red-800 font-medium" data-v-650451a2> Esta acci√≥n no se puede deshacer y eliminar√°: </p><ul class="text-sm text-red-700 space-y-1 ml-4 list-disc" data-v-650451a2><li data-v-650451a2>Todos los datos personales del paciente</li><li data-v-650451a2>El historial de sesiones</li><li data-v-650451a2>Las notas terap√©uticas</li><li data-v-650451a2>Las m√©tricas de bienestar</li><li data-v-650451a2>Los bonos asociados</li></ul></div><div class="bg-blue-50 border border-blue-200 rounded-lg p-4" data-v-650451a2><p class="text-sm text-blue-800 font-medium mb-2" data-v-650451a2> üí° Recomendaci√≥n: </p><p class="text-sm text-blue-700 mb-3" data-v-650451a2> En lugar de eliminar, considera <strong data-v-650451a2>desactivar</strong> al paciente. Esto preservar√° el historial para consultas futuras. </p><button type="button"${o.ssrIncludeBooleanAttr(r.value)?" disabled":""} class="w-full px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed text-sm" data-v-650451a2> Desactivar en lugar de eliminar </button></div>`),n.value?s(`<div class="bg-red-50 border border-red-200 rounded-lg p-3" data-v-650451a2><p class="text-sm text-red-600" data-v-650451a2>${o.ssrInterpolate(n.value)}</p></div>`):s("\x3c!----\x3e"),s(`</div><div class="px-6 py-4 border-t border-[#D8AFA0]/30 flex justify-end gap-3" data-v-650451a2><button type="button"${o.ssrIncludeBooleanAttr(r.value)?" disabled":""} class="px-6 py-2 border border-[#D8AFA0] text-[#5D4A44] rounded-lg hover:bg-[#D8AFA0]/10 transition-colors disabled:opacity-50 disabled:cursor-not-allowed" data-v-650451a2> Cancelar </button><button type="button"${o.ssrIncludeBooleanAttr(r.value)?" disabled":""} class="px-6 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2" data-v-650451a2>`),r.value?s('<span class="inline-block w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin" data-v-650451a2></span>'):s("\x3c!----\x3e"),s(` ${o.ssrInterpolate(r.value?"Eliminando...":"Eliminar Definitivamente")}</button></div></div></div>`)):s("\x3c!----\x3e")}}},q=E.setup;E.setup=(e,a)=>{const o=t.useSSRContext();return(o.modules||(o.modules=new Set)).add("components/ModalEliminarPaciente.vue"),q?q(e,a):void 0};const F=s(E,[["__scopeId","data-v-650451a2"]]),S={__name:"pacientes",__ssrInlineRender:!0,setup(s){const r=e(),n=h(),{getUserId:l}=b(),i=a();console.log("[Pacientes] Estado inicial del usuario:",{existe:!!i.value,id:l(),email:i.value?.email}),t.watch(i,(e,a)=>{console.log("[Pacientes] Usuario cambi√≥:",{antes:a?.email||"null",ahora:e?.email||"null",id:l()})});const d=t.ref(!1),c=t.ref(!1),u=t.ref(!1),p=t.ref(!1),m=t.ref(!1),f=t.ref(null),x=t.ref(null),w=t.ref(null),D=t.ref([]),$=t.ref(!0),I=t.ref(""),k=t.ref("todos"),B=[{valor:"todos",label:"Todos"},{valor:"activo",label:"Activos"},{valor:"pausa",label:"En pausa"},{valor:"finalizado",label:"Finalizados"}],cargarPacientes=async()=>{$.value=!0;try{const e=l();if(console.log("[Pacientes] Iniciando carga de pacientes..."),console.log("[Pacientes] Usuario actual:",{existe:!!i.value,id:e,email:i.value?.email}),!e)return console.error("[Pacientes] Usuario no autenticado"),void($.value=!1);console.log("‚úÖ [Pacientes] Usuario verificado, consultando database...");const{data:a,error:t}=await n.from("pacientes").select("\n        id,\n        created_at,\n        activo,\n        email,\n        nombre_completo,\n        telefono,\n        area_de_acompanamiento,\n        frecuencia,\n        metadata\n      ").eq("terapeuta_id",e).order("created_at",{ascending:!1});if(t)throw t;const o=await Promise.all(a.map(async e=>{const{data:a}=await n.from("citas").select("fecha_cita").eq("paciente_id",e.id).eq("estado","realizada").order("fecha_cita",{ascending:!1}).limit(1).maybeSingle(),{data:t}=await n.from("citas").select("id, fecha_cita, hora_inicio").eq("paciente_id",e.id).in("estado",["pendiente","confirmada"]).gte("fecha_cita",(new Date).toISOString().split("T")[0]).order("fecha_cita",{ascending:!0}).order("hora_inicio",{ascending:!0}).limit(1).maybeSingle(),{count:o}=await n.from("citas").select("*",{count:"exact",head:!0}).eq("paciente_id",e.id).eq("estado","realizada");let s=null;try{const{data:a}=await n.from("bonos").select("id, tipo, estado, sesiones_totales, sesiones_restantes, fecha_fin, created_at").eq("paciente_id",e.id).order("created_at",{ascending:!1});console.log(`[Bonos] Paciente ${e.nombre_completo}:`,a);const{data:t,error:o}=await n.from("bonos").select("id, tipo, estado, sesiones_totales, sesiones_restantes, fecha_fin, created_at").eq("paciente_id",e.id).in("estado",["activo","pendiente"]).order("created_at",{ascending:!1}).limit(1).maybeSingle();o?console.warn("[Bonos] Error en consulta:",o.message):(s=t,console.log("‚úÖ [Bonos] Bono activo encontrado:",s))}catch(e){console.warn("[Bonos] Error inesperado:",e)}let r=0,l=0;s&&(l=s.sesiones_totales,r=l-s.sesiones_restantes);const i=new Date;i.setDate(i.getDate()-7);const{data:d}=await n.from("metricas_bienestar").select("estado_animo, nivel_energia, nivel_estres").eq("paciente_id",e.id).gte("fecha",i.toISOString());let c=3,u=!1,p=50;if(d&&d.length>0){const e=d.reduce((e,a)=>e+a.estado_animo,0)/d.length;c=e,p=Math.round(e/10*100);const a=d.slice(-3);a.length>=3&&(u=a.every(e=>e.estado_animo<=4))}const m=e.nombre_completo||e.metadata?.nombre_completo||e.email;return{id:e.id,nombre:m,apellidos:"",email:e.email,telefono:e.telefono,activo:e.activo,en_pausa:e.metadata?.en_pausa||!1,area_de_acompanamiento:e.area_de_acompanamiento,frecuencia:e.frecuencia,ultima_sesion:a?.fecha_cita||null,proxima_sesion:t?`${t.fecha_cita}T${t.hora_inicio}`:null,proxima_cita_id:t?.id||null,total_sesiones:o||0,estado_emocional_promedio:c,evolucion_porcentaje:p,requiere_atencion:u,created_at:e.created_at,bono_activo:s?{tipo:s.tipo,estado:s.estado,fecha_fin:s.fecha_fin,sesiones_completadas:r,sesiones_totales:l,sesiones_restantes:s.sesiones_restantes}:null}}));D.value=o}catch(e){console.error("Error al cargar pacientes:",e),alert("Hubo un error al cargar los pacientes. Por favor, recarga la p√°gina.")}finally{$.value=!1}},E=t.computed(()=>{let e=D.value;if(I.value){const a=I.value.toLowerCase();e=e.filter(e=>(e.nombre||"").toLowerCase().includes(a)||(e.email||"").toLowerCase().includes(a))}return"todos"!==k.value&&(e=e.filter(e=>"activo"===k.value?e.activo&&!e.en_pausa:"pausa"===k.value?e.activo&&e.en_pausa:"finalizado"!==k.value||!e.activo)),e}),q=t.computed(()=>D.value.length),cerrarModalNuevo=()=>{d.value=!1},abrirModalEditar=e=>{console.log("Abriendo modal de edici√≥n para:",e),x.value=e,c.value=!0},cerrarModalEditar=()=>{c.value=!1,x.value=null},abrirModalEliminar=e=>{console.log("Abriendo modal de eliminaci√≥n para:",e),x.value=e,u.value=!0},cerrarModalEliminar=()=>{u.value=!1,x.value=null},manejarPacienteCreado=async e=>{console.log("Nuevo paciente creado:",e),await cargarPacientes()},manejarPacienteActualizado=async e=>{console.log("Paciente actualizado:",e),await cargarPacientes()},manejarPacienteEliminado=async e=>{console.log("Paciente eliminado:",e),D.value=D.value.filter(a=>a.id!==e)},manejarPacienteDesactivado=async e=>{console.log("Paciente desactivado:",e),await cargarPacientes()},cerrarModalAsignarCita=()=>{p.value=!1,w.value=null},manejarCitaCreada=async e=>{console.log("Nueva cita creada:",e),await cargarPacientes(),cerrarModalAsignarCita()},verCitasPaciente=e=>{r.push(`/agenda?paciente=${e.id}`)},gestionarBonosPaciente=e=>{r.push(`/terapeuta/pacientes/${e.id}/bonos`)},abrirModalEditarCita=e=>{console.log("Abriendo modal de edici√≥n de cita:",e),f.value=e,m.value=!0},cerrarModalEditarCita=()=>{m.value=!1,f.value=null},handleCitaActualizada=async()=>{console.log("Cita actualizada, recargando pacientes..."),await cargarPacientes(),cerrarModalEditarCita()};return t.watch(()=>l(),(e,a)=>{console.log("[Pacientes] ID de usuario cambi√≥:",{antes:a,ahora:e}),e&&0===D.value.length&&(console.log("[Pacientes] Recargando pacientes por cambio de usuario..."),cargarPacientes())}),(e,a,s,r)=>{const n=C,l=v,i=L,b=R,h=F,D=g;a(`<div${o.ssrRenderAttrs(r)} data-v-da126003><header class="mb-8" data-v-da126003><h1 class="text-3xl font-serif font-bold text-cafe mb-2" data-v-da126003> Pacientes </h1><p class="text-cafe/60" data-v-da126003> Gesti√≥n de pacientes activos </p></header><section class="mb-8" data-v-da126003><div class="bg-white rounded-xl shadow-sm border border-gray-100 p-6" data-v-da126003><div class="flex flex-col lg:flex-row gap-4" data-v-da126003><div class="flex-1" data-v-da126003><div class="relative" data-v-da126003><input${o.ssrRenderAttr("value",t.unref(I))} type="text" placeholder="Buscar paciente por nombre o email..." class="w-full px-4 py-3 pl-11 bg-gray-50 border border-gray-200 rounded-lg focus:border-terracota focus:ring-2 focus:ring-terracota/20 focus:bg-white transition-all text-cafe placeholder-gray-400" data-v-da126003>`),a(o.ssrRenderComponent(t.unref(_),{class:"w-5 h-5 absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"},null,s)),a('</div></div><div class="flex flex-wrap gap-2" data-v-da126003>\x3c!--[--\x3e'),o.ssrRenderList(B,e=>{a(`<button class="${o.ssrRenderClass([t.unref(k)===e.valor?"bg-terracota text-white shadow-sm":"bg-gray-50 text-gray-600 hover:bg-gray-100 border border-gray-200","px-4 py-2.5 rounded-lg text-sm font-medium transition-all whitespace-nowrap"])}" data-v-da126003>${o.ssrInterpolate(e.label)}</button>`)}),a('\x3c!--]--\x3e</div><button class="px-6 py-2.5 bg-terracota text-white rounded-lg hover:bg-terracota/90 transition-all flex items-center gap-2 whitespace-nowrap font-medium shadow-sm hover:shadow-md" data-v-da126003><span class="text-lg leading-none" data-v-da126003>+</span><span data-v-da126003>Nuevo Paciente</span></button></div></div></section><section data-v-da126003>'),t.unref($)?a('<div class="flex flex-col items-center justify-center py-16" data-v-da126003><div class="animate-spin w-12 h-12 border-4 border-terracota border-t-transparent rounded-full mb-6" data-v-da126003></div><p class="text-gray-500 font-medium" data-v-da126003>Cargando pacientes...</p></div>'):0===t.unref(E).length?(a('<div class="bg-white rounded-xl shadow-sm border border-gray-100 p-8 text-center" data-v-da126003>'),a(o.ssrRenderComponent(t.unref(A),{class:"w-20 h-20 mx-auto mb-6 text-gray-300"},null,s)),a(`<h3 class="text-xl font-serif font-semibold text-cafe mb-3" data-v-da126003>${o.ssrInterpolate(t.unref(I)||"todos"!==t.unref(k)?"No se encontraron pacientes":"A√∫n no tienes pacientes registrados")}</h3><p class="text-gray-500 mb-6 max-w-md mx-auto" data-v-da126003>${o.ssrInterpolate(t.unref(I)||"todos"!==t.unref(k)?"Intenta ajustar los filtros de b√∫squeda para encontrar lo que buscas":"Comienza a√±adiendo tu primer paciente para gestionar su proceso terap√©utico")}</p>`),t.unref(I)||"todos"!==t.unref(k)?a("\x3c!----\x3e"):a('<button class="px-6 py-3 bg-terracota text-white rounded-lg hover:bg-terracota/90 transition-all font-medium shadow-sm hover:shadow-md" data-v-da126003> + A√±adir Primer Paciente </button>'),a("</div>")):(a('<div class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6" data-v-da126003>\x3c!--[--\x3e'),o.ssrRenderList(t.unref(E),e=>{a('<div class="relative group cursor-pointer" data-v-da126003>'),a(o.ssrRenderComponent(n,{paciente:e,onEditar:abrirModalEditar,onEliminar:abrirModalEliminar,onVerCitas:verCitasPaciente,onGestionarBonos:gestionarBonosPaciente,onEditarCita:abrirModalEditarCita},null,s)),e.activo&&!e.en_pausa?(a('<button class="hidden md:flex absolute bottom-4 right-4 px-3 py-2 bg-gradient-to-r from-terracota to-rosa text-white text-sm font-medium rounded-lg shadow-lg hover:shadow-xl hover:scale-105 transition-all duration-200 items-center gap-2 z-10 opacity-0 group-hover:opacity-100 pointer-events-none group-hover:pointer-events-auto" title="Asignar nueva cita" data-v-da126003>'),a(o.ssrRenderComponent(t.unref(y),{class:"w-4 h-4"},null,s)),a("<span data-v-da126003>Asignar Cita</span></button>")):a("\x3c!----\x3e"),e.activo&&!e.en_pausa?(a('<button class="md:hidden absolute bottom-4 right-4 px-3 py-2 bg-gradient-to-r from-terracota to-rosa text-white text-sm font-medium rounded-lg shadow-lg hover:shadow-xl hover:scale-105 transition-all duration-200 flex items-center gap-2 z-10" title="Asignar nueva cita" data-v-da126003>'),a(o.ssrRenderComponent(t.unref(y),{class:"w-4 h-4"},null,s)),a("<span data-v-da126003>Asignar Cita</span></button>")):a("\x3c!----\x3e"),a("</div>")}),a("\x3c!--]--\x3e</div>")),t.unref(E).length>0?(a(`<footer class="mt-8 pt-6 border-t border-gray-100 flex items-center justify-between" data-v-da126003><p class="text-sm text-gray-500" data-v-da126003> Mostrando ${o.ssrInterpolate(t.unref(E).length)} de ${o.ssrInterpolate(t.unref(q))} pacientes </p>`),t.unref(q)>t.unref(E).length?a('<div class="flex gap-2" data-v-da126003><button class="px-4 py-2 bg-white border border-gray-200 text-gray-600 rounded-lg hover:bg-gray-50 transition-colors text-sm font-medium" data-v-da126003> Ver m√°s </button></div>'):a("\x3c!----\x3e"),a("</footer>")):a("\x3c!----\x3e"),a("</section>"),a(o.ssrRenderComponent(l,{mostrar:t.unref(p),"paciente-preseleccionado":t.unref(w),onCerrar:cerrarModalAsignarCita,onCitaCreada:manejarCitaCreada},null,s)),a(o.ssrRenderComponent(i,{mostrar:t.unref(d),onCerrar:cerrarModalNuevo,onPacienteCreado:manejarPacienteCreado},null,s)),a(o.ssrRenderComponent(b,{mostrar:t.unref(c),paciente:t.unref(x),onCerrar:cerrarModalEditar,onPacienteActualizado:manejarPacienteActualizado},null,s)),a(o.ssrRenderComponent(h,{mostrar:t.unref(u),paciente:t.unref(x),onCerrar:cerrarModalEliminar,onPacienteEliminado:manejarPacienteEliminado,onPacienteDesactivado:manejarPacienteDesactivado},null,s)),a(o.ssrRenderComponent(D,{isOpen:t.unref(m),citaId:t.unref(f),onClose:cerrarModalEditarCita,onActualizado:handleCitaActualizada},null,s)),a("</div>")}}},P=S.setup;S.setup=(e,a)=>{const o=t.useSSRContext();return(o.modules||(o.modules=new Set)).add("pages/terapeuta/pacientes.vue"),P?P(e,a):void 0};const j=s(S,[["__scopeId","data-v-da126003"]]);export{j as default};
//# sourceMappingURL=pacientes-B8W47FTK.mjs.map
