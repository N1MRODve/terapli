{"version":3,"file":"mensajes-DT3OypVu.mjs","sources":["../../../../../../components/MensajeCard.vue","../../../../../../components/MensajeInput.vue","../../../../../../pages/terapeuta/mensajes.vue","../../../../../../composables/useMensajes.ts"],"sourcesContent":null,"names":["class","__props","remitente","_attrs","serverRenderer_cjs_prodExports","ssrInterpolate","texto","ssrRenderClass","_ssrInterpolate","fecha","date","Date","ahora","diferencia","getTime","minutos","Math","floor","horas","dias","toLocaleDateString","day","month","year","getFullYear","formatearFecha","visto","enviarMensaje","enviarMensajeApi","useMensajeria","contenido","ref","enviando","puedeEnviar","computed","textoLimpio","value","trim","length","_ssrRenderAttrs","_mergeProps","_ssrRenderAttr","placeholder","ssrIncludeBooleanAttr","ssrRenderStyle","_push","_ssrIncludeBooleanAttr","conversaciones","mensajes","loadingConversaciones","loadingMensajes","listarConversaciones","supabase","useSupabaseClient","user","useSupabaseUser","loading","error","canal","listarConversacionesAlternativo","async","data","fetchError","from","select","or","id","order","ascending","conversacionesMap","Map","forEach","m","esRemitente","remitente_id","otroUsuarioId","destinatario_id","otroUsuario","destinatario","has","set","otro_usuario_id","otro_usuario_nombre","nombre","otro_usuario_avatar","avatar_url","ultimo_mensaje","mensaje","ultimo_mensaje_fecha","created_at","mensajes_no_vistos","get","Array","values","e","message","console","listarConversacion","participanteId","enviar","destinatarioId","sesionId","insertError","insert","sesion_id","single","push","marcarVistos","updateError","update","eq","map","rpc","usuario_id","warn","contarNoVistos","count","countError","head","suscribirseAConversacion","channel","on","event","schema","table","filter","payload","new","subscribe","desuscribirse","removeChannel","useMensajes","getUserId","useSupabase","pacienteSeleccionado","mensajesContainer","esMensajeMio","handleMensajeEnviado","nextTick","scrollTop","scrollHeight","obtenerIniciales","split","n","slice","join","toUpperCase","watch","deep","_unref","_ssrRenderList","conv","ssrRenderAttr","_ssrRenderClass","key","_parent","onMensajeEnviado"],"mappings":"mxBAEKA,MAAK,CAAA,yDAA0EC,EAAAC,UAAA,8CAAA,6DAS3EC,+IAAAC,EAAAC,eAAAJ,EAAAK,yBAAKF,EAAAG,eAAA,CAIwCN,EAAAC,UAAS,cAAA,gBAAA,oIAEpDM,EAAAA,eA4BY,CAACC,IACtB,MAAMC,EAAwB,iBAAVD,EAAqB,IAAIE,KAAKF,GAASA,EACrDG,MAAYD,KACZE,EAAaD,EAAME,UAAYJ,EAAKI,UACpCC,EAAUC,KAAKC,MAAMJ,EAAa,KAClCK,EAAQF,KAAKC,MAAMJ,EAAa,MAChCM,EAAOH,KAAKC,MAAMJ,EAAa,OAGrC,OAAIE,EAAU,EAAU,QAGpBA,EAAU,GAAW,QAAQA,KAG7BG,EAAQ,GAAW,QAAQA,KAG3BC,EAAO,EAAU,QAAQA,KAGtBT,EAAKU,mBAAmB,QAAS,CACtCC,IAAK,UACLC,MAAO,QACPC,KAAMb,EAAKc,gBAAkBZ,EAAMY,cAAgB,eAAY,KApDxDC,CAAexB,EAAAQ,eAKZR,EAAAC,YAAcD,EAAAyB,mjBCiD5B,MAAQC,cAAeC,GAAqBC,gBACtCC,EAAYC,EAAAA,IAAI,IAChBC,EAAWD,EAAAA,KAAI,GACDA,EAAAA,IAAgC,MAKpD,MAAME,EAAcC,EAAAA,SAAS,KAC3B,MAAMC,EAAcL,EAAUM,MAAMC,OACpC,OAAOF,EAAYG,OAAS,GAAKH,EAAYG,QAAU,MAASN,EAASI,0BAhFpEG,EAAAA,OAAAA,EAAAA,eAAAC,EAAAA,WAAA,CAAAxC,MAAM,uEAAqEG,6EAMzEsC,EAAAA,cAAA,cAAaxC,EAAAyC,uBAAWtC,EAAAG,eAAA,CAAA,CAAA,gCAIkByB,EAAAI,OAAQ,gNAAAhC,EAAAuC,sBACxCX,EAAAI,OAAQ,YAAA,sBAAAhC,EAAAwC,eAEnB,CAAA,aAAA,OAAA,aAAA,8BAA4CxC,EAAAC,eARnCyB,EAAAM,qBAaHN,EAAAM,MAAUE,OAAM,EAGnBO,EAAA,8GAAArC,EAAAA,eAAAsB,EAAAM,MAAUE,0CAOHQ,EAAAA,gBAAAA,EAAAA,uBAAAb,EAAAG,OAAeJ,EAAAI,OAAQ,YAAA,aAAAhC,EAAAG,eAAA,CAAA,CAAA,gBAERyB,EAAAI,OAAQ,yPAG1BJ,EAAAI,kQAaIJ,EAAAI,gaCkMnB,MAAMW,eAAEA,EAAgBC,SAAAA,EAAAA,sBAAUC,kBAAuBC,EAAAC,qBAAiBA,GC1M/C,MACzB,MAAMC,EAAWC,IACXC,EAAOC,IAEPP,EAAWjB,EAAAA,IAAe,IAC1BgB,EAAiBhB,EAAAA,IAAoB,IACrCyB,EAAUzB,EAAAA,KAAI,GACd0B,EAAQ1B,EAAAA,IAAmB,MAC3B2B,EAAQ3B,EAAAA,IAA4B,MA4JpC4B,gCAAkCC,UACtC,IAAKN,EAAKlB,MAAO,MAAO,GAExB,IACE,MAAMyB,KAAEA,EAAMJ,MAAOK,SAAqBV,EACvCW,KAAK,YACLC,OAAO,qMAKPC,GAAG,mBAAmBX,EAAKlB,MAAM8B,yBAAyBZ,EAAKlB,MAAM8B,MACrEC,MAAM,aAAc,CAAEC,WAAW,IAEpC,GAAIN,EAAY,MAAMA,EAGtB,MAAMO,MAAwBC,IA0B9B,OAxBAT,GAAMU,QAASC,IACb,MAAMC,EAAcD,EAAEE,eAAiBpB,EAAKlB,MAAO8B,GAC7CS,EAAgBF,EAAcD,EAAEI,gBAAkBJ,EAAEE,aACpDG,EAAcJ,EAAcD,EAAEM,aAAeN,EAAEtE,UAEhDmE,EAAkBU,IAAIJ,IACzBN,EAAkBW,IAAIL,EAAe,CACnCM,gBAAiBN,EACjBO,oBAAqBL,GAAaM,QAAU,UAC5CC,oBAAqBP,GAAaQ,WAClCC,eAAgBd,EAAEe,QAClBC,qBAAsBhB,EAAEiB,WACxBC,mBAAoB,IAKnBjB,GAAgBD,EAAE9C,OACR2C,EAAkBsB,IAAIhB,GAC9Be,uBAIT3C,EAAeX,MAAQwD,MAAM7B,KAAKM,EAAkBwB,UAC7C9C,EAAeX,KACxB,OAAS0D,GAGP,OAFArC,EAAMrB,MAAQ0D,EAAEC,SAAW,iCAC3BC,QAAQvC,MAAM,4CAA6CqC,GACpD,EACT,GA4EF,MAAO,CACL9C,SAAAA,EACAD,iBACAS,UACAC,QACAwC,mBAxRyBrC,MAAOsC,IAChC,IAAK5C,EAAKlB,MAER,OADAqB,EAAMrB,MAAQ,yBACP,GAGToB,EAAQpB,OAAQ,EAChBqB,EAAMrB,MAAQ,KAEd,IACE,MAAMyB,KAAEA,EAAMJ,MAAOK,SAAqBV,EACvCW,KAAK,YACLC,OAAO,+MAKPC,GAAG,uBAAuBX,EAAKlB,MAAM8B,yBAAyBgC,0BAAuCA,wBAAqC5C,EAAKlB,MAAM8B,OACrJC,MAAM,aAAc,CAAEC,WAAW,IAEpC,GAAIN,EAAY,MAAMA,EAGtB,OADAd,EAASZ,MAAQyB,GAAQ,GAClBA,GAAQ,EACjB,OAASiC,GAGP,OAFArC,EAAMrB,MAAQ0D,EAAEC,SAAW,+BAC3BC,QAAQvC,MAAM,+BAAgCqC,GACvC,EACT,CAAA,QACEtC,EAAQpB,OAAQ,CAClB,GA2PA+D,OArPavC,MACbwC,EACAtE,EACAuE,KAEA,IAAK/C,EAAKlB,MAER,OADAqB,EAAMrB,MAAQ,yBACP,KAGT,IAAKN,EAAUO,OAEb,OADAoB,EAAMrB,MAAQ,kCACP,KAGToB,EAAQpB,OAAQ,EAChBqB,EAAMrB,MAAQ,KAEd,IACE,MAAMyB,KAAEA,EAAMJ,MAAO6C,SAAsBlD,EACxCW,KAAK,YACLwC,OAAO,CACN7B,aAAcpB,EAAKlB,MAAM8B,GACzBU,gBAAiBwB,EACjBb,QAASzD,EAAUO,OACnBmE,UAAWH,GAAY,KACvB3E,OAAO,IAERsC,OAAO,+MAKPyC,SAEH,GAAIH,EAAa,MAAMA,EAOvB,OAJIzC,GACFb,EAASZ,MAAMsE,KAAK7C,GAGfA,CACT,OAASiC,GAGP,OAFArC,EAAMrB,MAAQ0D,EAAEC,SAAW,0BAC3BC,QAAQvC,MAAM,mBAAoBqC,GAC3B,IACT,CAAA,QACEtC,EAAQpB,OAAQ,CAClB,GAqMAuE,aA9LmB/C,MAAOsC,IAC1B,GAAK5C,EAAKlB,MAEV,IACE,MAAQqB,MAAOmD,SAAsBxD,EAClCW,KAAK,YACL8C,OAAO,CAAEnF,OAAO,IAChBoF,GAAG,kBAAmBxD,EAAKlB,MAAM8B,IACjC4C,GAAG,eAAgBZ,GACnBY,GAAG,SAAS,GAEf,GAAIF,EAAa,MAAMA,EAGvB5D,EAASZ,MAAQY,EAASZ,MAAM2E,IAAIvC,GAC9BA,EAAEE,eAAiBwB,GAAkB1B,EAAEI,kBAAoBtB,EAAKlB,MAAO8B,GAClE,IAAKM,EAAG9C,OAAO,GAEjB8C,EAEX,OAASsB,GACPE,QAAQvC,MAAM,wCAAyCqC,EACzD,GAyKA3C,qBAnK2BS,UAC3B,IAAKN,EAAKlB,MAER,OADAqB,EAAMrB,MAAQ,yBACP,GAGToB,EAAQpB,OAAQ,EAChBqB,EAAMrB,MAAQ,KAEd,IACE,MAAMyB,KAAEA,EAAMJ,MAAOK,SAAqBV,EACvC4D,IAAI,iCAAkC,CACrCC,WAAY3D,EAAKlB,MAAM8B,KAG3B,GAAIJ,EAAY,MAAMA,EAGtB,OADAf,EAAeX,MAAQyB,GAAQ,GACxBA,GAAQ,EACjB,OAASiC,GAGP,OADAE,QAAQkB,KAAK,iDAAkDpB,SAClDnC,iCACf,CAAA,QACEH,EAAQpB,OAAQ,CAClB,GA2IA+E,eA/EqBvD,UACrB,IAAKN,EAAKlB,MAAO,OAAO,EAExB,IACE,MAAMgF,MAAEA,EAAO3D,MAAO4D,SAAqBjE,EACxCW,KAAK,YACLC,OAAO,IAAK,CAAEoD,MAAO,QAASE,MAAM,IACpCR,GAAG,kBAAmBxD,EAAKlB,MAAM8B,IACjC4C,GAAG,SAAS,GAEf,GAAIO,EAAY,MAAMA,EAEtB,OAAOD,GAAS,CAClB,OAAStB,GAEP,OADAE,QAAQvC,MAAM,sCAAuCqC,GAC9C,CACT,GAgEAyB,yBA1DgCrB,IAC3B5C,EAAKlB,QAASsB,EAAMtB,QAEzBsB,EAAMtB,MAAQgB,EACXoE,QAAQ,YAAYlE,EAAKlB,MAAM8B,MAAMgC,KACrCuB,GACC,mBACA,CACEC,MAAO,SACPC,OAAQ,SACRC,MAAO,WACPC,OAAQ,sBAAsBvE,EAAKlB,MAAM8B,MAE3CN,MAAOkE,IAEL,MAAMjE,KAAEA,SAAeT,EACpBW,KAAK,YACLC,OAAO,+NAKP8C,GAAG,KAAMgB,EAAQC,IAAI7D,IACrBuC,SAEC5C,GACFb,EAASZ,MAAMsE,KAAK7C,KAIzBmE,cA6BHC,cAvBoBrE,UAChBF,EAAMtB,cACFgB,EAAS8E,cAAcxE,EAAMtB,OACnCsB,EAAMtB,MAAQ,SD7E0J+F,GACjK5E,IACb,MAAM6E,UAAEA,GAAcC,IAEhBC,EAAuBvG,EAAAA,IAAS,MAChCwG,EAAoBxG,EAAAA,IAA2B,MAgC/CyG,aAAgBjD,GACbA,EAAQb,eAAiB0D,IAW5BK,qBAAuB,KAC3BC,EAAAA,SAAS,KAPLH,EAAkBnG,QACpBmG,EAAkBnG,MAAMuG,UAAYJ,EAAkBnG,MAAMwG,iBAY1DC,iBAAoB1D,GACjBA,EACJ2D,MAAM,KACN/B,OAASgC,EAAE,IACXC,MAAM,EAAG,GACTC,KAAK,IACLC,qBAwBLC,EAAAA,MAAMnG,EAAU,KACVA,EAASZ,MAAME,OAAS,GAC1Ba,KAED,CAAEiG,MAAM,uCA1UJ7G,EAAAA,eAAAC,EAAAA,WAAA,CAAAxC,MAAM,+DAA6DG,qCAAAC,EAAAG,eAAA,CAAA,CAAA,kBAIvC8I,EAAAA,MAAAf,IAAoB,yWAQ1C9H,iBAAA6I,EAAAA,MAAAtG,GAAeT,iGAOT+G,EAAAA,MAAApG,2LAMuB,IAArBoG,EAAAA,MAAAtG,GAAeT,gkBAqBXgH,EAAAA,cAAAD,EAAAA,MAAAtG,GAARwG,2CAIwD,wCAAAF,EAAAA,MAAAf,IAAsBrD,kBAAoBsE,EAAKtE,iBAAA,2NAQlGsE,EAAKnE,oBAIRvC,EAAA,2EAAAzC,EAAAoJ,cAAA,MAAKD,EAAKnE,uBAAmBhF,EAAAoJ,cAC7B,MAAKD,EAAKrE,kFASRrC,EAAA,mLAAAzC,EAAAC,eAAAwI,iBAAiBU,EAAKrE,sCAUEuE,EAAAA,oIAAAA,EAAAA,eAAA,CAAA,CAAA,gBAAAF,EAAK7D,mBAAkB,GAAA,8EAE/ClF,EAAAA,eAAA+I,EAAKrE,4GAAmB9E,EAAAC,eA8NtB,CAACI,IACtB,MAAMC,EAAO,IAAIC,KAAKF,GAEhBI,OADYF,MACOG,UAAYJ,EAAKI,UACpCC,EAAUC,KAAKC,MAAMJ,EAAa,KAClCK,EAAQF,KAAKC,MAAMJ,EAAa,MAChCM,EAAOH,KAAKC,MAAMJ,EAAa,OAErC,OAAIE,EAAU,EAAU,QACpBA,EAAU,GAAW,GAAGA,KACxBG,EAAQ,GAAW,GAAGA,KACtBC,EAAO,EAAU,GAAGA,KAEjBT,EAAKU,mBAAmB,QAAS,CACtCC,IAAK,UACLC,MAAO,WA1OUG,CAAe8H,EAAK/D,gDAMAiE,EAAAA,eAAA,CAAA,CAAA,cAAAF,EAAK7D,mBAAkB,GAAA,0EAE7ClF,EAAAA,eAAA+I,EAAKjE,uBAKFiE,EAAK7D,mBAAkB,EAG1B7C,EAAA,4IAAArC,EAAAA,eAAA+I,EAAK7D,2OAYT2D,EAAAA,MAAAf,ijBAqDKe,EAAAA,MAAAf,GAAqBlD,iHAIxB,MAAKiE,EAAAA,MAAAf,GAAqBlD,uCAC1B,MAAKiE,EAAAA,MAAAf,GAAqBpD,kFASxBrC,EAAA,mLAAAzC,EAAAC,eAAAwI,iBAAiBQ,EAAAA,MAAAf,GAAqBpD,sCAMtCrC,EAAA,qGAAArC,iBAAA6I,EAAAA,MAAAf,GAAqBpD,iNAenBmE,EAAAA,MAAAnG,wOAOWoG,EAAAA,cAAAD,EAAAA,MAAArG,GAAXuC,8BACNmE,IAAKnE,EAAQrB,GACb5D,MAAOiF,EAAQA,QACf9E,MAAO8E,EAAQE,WACfvF,UAAWsI,aAAajD,GACxB7D,MAAO6D,EAAQ7D,OAAA,KAAAiI,oHAQZN,EAAAA,MAAAf,6BACL,kBAAiBe,EAAAA,MAAAf,GAAqBrD,gBACvCvC,YAAY,oCACXkH,iBAAiBnB,sBAAA,KAAAkB"}