{"version":3,"file":"create.post.mjs","sources":["../../../../../../../../server/api/appointments/create.post.ts"],"sourcesContent":null,"names":["create_post","defineEventHandler","async","event","startTime","Date","now","config","useRuntimeConfig","supabaseUrl","public","supabaseKey","createError","statusCode","statusMessage","supabaseClient","createServerClient","cookies","get","name","getCookie","set","value","options","setCookie","remove","deleteCookie","data","user","error","userError","auth","getUser","profile","profileError","from","select","eq","id","single","isTerapeuta","rol","isAdmin","isCoordinadora","body","readBody","paciente_id","fecha_cita","hora_inicio","hora_fin","modalidad","estado","ubicacion","enlace_videollamada","observaciones","bono_id","descontar_de_bono","terapeuta_id","existingAppointments","queryError","neq","console","validation","validateAppointment","valid","warn","formatValidationError","errorCode","details","bonoData","bonoError","tipoBono","_a","tipo","toLowerCase","limiteMensual","includes","fechaCitaDate","inicioMes","getFullYear","getMonth","finMes","inicioMesStr","toISOString","split","finMesStr","citasMes","citasMesError","gte","lte","in","citasEnMes","length","frecuencia","citaData","sesion_descontada","recordatorio_enviado","newAppointment","insertError","insert","message","code","duration","info","citaId","fecha","hora","terapeuta","success"],"mappings":"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"}