{"version":3,"file":"update.patch.mjs","sources":["../../../../../../../../../server/api/appointments/[id]/update.patch.ts"],"sourcesContent":null,"names":["update_patch","defineEventHandler","async","event","startTime","Date","now","citaId","getRouterParam","createError","statusCode","statusMessage","config","useRuntimeConfig","supabaseUrl","public","supabaseKey","supabaseClient","createServerClient","cookies","get","name","getCookie","set","value","options","setCookie","remove","deleteCookie","data","user","error","userError","auth","getUser","profile","profileError","from","select","eq","id","single","isTerapeuta","rol","isAdmin","isCoordinadora","existingCita","fetchError","terapeuta_id","body","readBody","fecha_cita","hora_inicio","hora_fin","estado","modalidad","ubicacion","enlace_videollamada","observaciones","notas_terapeuta","stateValidation","validateStateTransition","valid","errorCode","details","newFecha","newHoraInicio","newHoraFin","otherAppointments","queryError","neq","console","appointmentToValidate","validation","validateAppointment","warn","formatValidationError","updates","updated_at","toISOString","length","updatedCita","updateError","update","message","includes","duration","changes","Object","keys","filter","k","info","success"],"mappings":"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"}