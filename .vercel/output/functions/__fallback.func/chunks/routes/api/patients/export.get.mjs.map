{"version":3,"file":"export.get.mjs","sources":["../../../../../../../../server/api/patients/export.get.ts"],"sourcesContent":null,"names":["export_get","defineEventHandler","async","event","query","getQuery","format","scope","fields","split","includes","createError","statusCode","statusMessage","config","useRuntimeConfig","supabaseUrl","public","supabaseKey","supabaseClient","createServerClient","cookies","get","name","getCookie","set","value","options","setCookie","remove","deleteCookie","data","user","error","userError","auth","getUser","profile","profileError","from","select","eq","id","single","isTerapeuta","rol","isAdmin","patientsQuery","filters","JSON","parse","estado","area","selectedIds","length","in","patients","patientsError","exportData","map","patient","row","nombre_completo","email","telefono","area_de_acompanamiento","frecuencia","enPausa","_a","metadata","en_pausa","activo","created_at","Date","toLocaleDateString","csv","Papa","unparse","quotes","delimiter","header","setResponseHeaders","toISOString","wb","XLSX.utils","book_new","ws","json_to_sheet","colWidths","Object","keys","key","wch","Math","max","String","book_append_sheet","xlsxBuffer","XLSX.write","bookType","type","console","message"],"mappings":"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"}