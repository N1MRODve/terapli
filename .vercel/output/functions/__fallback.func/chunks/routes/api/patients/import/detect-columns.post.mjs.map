{"version":3,"file":"detect-columns.post.mjs","sources":["../../../../../../../../../server/api/patients/import/detect-columns.post.ts"],"sourcesContent":null,"names":["detectColumns_post","defineEventHandler","async","event","form","readMultipartFormData","length","createError","statusCode","statusMessage","fileData","find","item","name","filename","extension","_a","split","pop","toLowerCase","includes","headers","sampleRows","csvContent","data","toString","parseResult","Papa","parse","header","skipEmptyLines","preview","meta","fields","workbook","XLSX.read","type","firstSheetName","SheetNames","worksheet","Sheets","jsonData","XLSX.utils","sheet_to_json","defval","dataRows","slice","MAX_SAMPLE_ROWS","map","row","obj","forEach","index","detectedColumns","sampleValues","String","trim","filter","val","suggestedMapping","mappings","autoMapColumns","col","mapping","m","sourceColumn","targetField","runtimeConfig","useRuntimeConfig","supabaseUrl","process","env","NUXT_PUBLIC_SUPABASE_URL","SUPABASE_URL","supabaseKey","NUXT_PUBLIC_SUPABASE_ANON_KEY","SUPABASE_KEY","supabaseClient","createServerClient","cookies","get","getCookie","set","value","options","setCookie","remove","deleteCookie","user","error","userError","auth","getUser","now","Date","expiresAt","getTime","config","id","crypto","randomUUID","userId","fileName","created_at","toISOString","expires_at","insertError","from","insert","user_id","file_name","detected_columns","console","success","createdAt","message"],"mappings":"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"}