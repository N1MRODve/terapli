import{d as e,h as t,c as o,i as a}from"../../../nitro/nitro.mjs";import{x as n}from"../../../_/xlsx.mjs";import"node:http";import"node:https";import"node:events";import"node:buffer";import"node:fs";import"node:path";import"node:crypto";import"/Users/dieterlorenzo/terapli/node_modules/xlsx/dist/cpexcel.js";import"../../../virtual/_commonjsHelpers.mjs";import"fs";import"stream";const s=e(async e=>{const s=t(e).format||"csv";if(!["csv","xlsx"].includes(s))throw o({statusCode:400,statusMessage:"Formato no válido. Use csv o xlsx"});const i=[{nombre_completo:"María García López",email:"maria.garcia@example.com",telefono:"+34 612 345 678",area_de_acompanamiento:"Ansiedad",frecuencia:"Semanal",activo:"true",notas:"Paciente con seguimiento regular"},{nombre_completo:"Juan Pérez Martínez",email:"juan.perez@example.com",telefono:"+34 623 456 789",area_de_acompanamiento:"Depresión",frecuencia:"Quincenal",activo:"true",notas:"Primera sesión próximamente"},{nombre_completo:"Ana Rodríguez",email:"ana.rodriguez@example.com",telefono:"+34 634 567 890",area_de_acompanamiento:"Trastornos del sueño",frecuencia:"Mensual",activo:"false",notas:"Tratamiento finalizado"}];if("csv"===s){const t=Object.keys(i[0]),o=[t.join(","),...i.map(e=>t.map(t=>{const o=e[t],a=String(o).replace(/"/g,'""');return a.includes(",")?`"${a}"`:a}).join(","))].join("\n");return a(e,{"Content-Type":"text/csv; charset=utf-8","Content-Disposition":'attachment; filename="plantilla_pacientes.csv"'}),o}{const t=n.utils.book_new(),o=n.utils.json_to_sheet(i),s=Object.keys(i[0]).map(e=>({wch:Math.max(e.length,...i.map(t=>String(t[e]).length))+2}));o["!cols"]=s,n.utils.book_append_sheet(t,o,"Pacientes");const r=n.write(t,{bookType:"xlsx",type:"buffer"});return a(e,{"Content-Type":"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","Content-Disposition":'attachment; filename="plantilla_pacientes.xlsx"'}),r}});export{s as default};
//# sourceMappingURL=template.get.mjs.map
